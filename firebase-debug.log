[debug] [2024-11-12T21:57:25.801Z] ----------------------------------------------------------------------
[debug] [2024-11-12T21:57:25.804Z] Command:       C:\Program Files\nodejs\node.exe C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\bin\firebase.js emulators:start
[debug] [2024-11-12T21:57:25.804Z] CLI Version:   13.24.2
[debug] [2024-11-12T21:57:25.805Z] Platform:      win32
[debug] [2024-11-12T21:57:25.805Z] Node Version:  v20.18.0
[debug] [2024-11-12T21:57:25.805Z] Time:          Wed Nov 13 2024 08:57:25 GMT+1100 (Australian Eastern Daylight Time)
[debug] [2024-11-12T21:57:25.805Z] ----------------------------------------------------------------------
[debug] 
[debug] [2024-11-12T21:57:25.934Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2024-11-12T21:57:25.935Z] > authorizing via signed-in user (lisakhun58@gmail.com)
[debug] [2024-11-12T21:57:26.064Z] java version "21.0.5" 2024-10-15 LTS

[debug] [2024-11-12T21:57:26.064Z] Java(TM) SE Runtime Environment (build 21.0.5+9-LTS-239)
Java HotSpot(TM) 64-Bit Server VM (build 21.0.5+9-LTS-239, mixed mode, sharing)

[debug] [2024-11-12T21:57:26.085Z] Parsed Java major version: 21
[info] i  emulators: Starting emulators: auth, functions, firestore, extensions {"metadata":{"emulator":{"name":"hub"},"message":"Starting emulators: auth, functions, firestore, extensions"}}
[debug] [2024-11-12T21:57:26.088Z] Checked if tokens are valid: true, expires at: 1731451302034
[debug] [2024-11-12T21:57:26.089Z] Checked if tokens are valid: true, expires at: 1731451302034
[debug] [2024-11-12T21:57:26.090Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc [none]
[debug] [2024-11-12T21:57:26.888Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc 200
[debug] [2024-11-12T21:57:26.888Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc {"projectId":"notalone-de4fc","projectNumber":"784029337452","displayName":"NotAlone","name":"projects/notalone-de4fc","resources":{"hostingSite":"notalone-de4fc"},"state":"ACTIVE","etag":"1_570ddbb0-4c2c-4e94-b3b3-0005c847d3e1"}
[debug] [2024-11-12T21:57:26.904Z] [logging] Logging Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-12T21:57:26.904Z] [auth] Authentication Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-12T21:57:26.904Z] [firestore] Firestore Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-12T21:57:26.904Z] [firestore.websocket] websocket server for firestore only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-12T21:57:26.904Z] assigned listening specs for emulators {"user":{"hub":[{"address":"127.0.0.1","family":"IPv4","port":4400},{"address":"::1","family":"IPv6","port":4400}],"ui":[{"address":"127.0.0.1","family":"IPv4","port":4000},{"address":"::1","family":"IPv6","port":4000}],"logging":[{"address":"127.0.0.1","family":"IPv4","port":4500}],"auth":[{"address":"127.0.0.1","family":"IPv4","port":9099}],"firestore":[{"address":"127.0.0.1","family":"IPv4","port":8080}],"firestore.websocket":[{"address":"127.0.0.1","family":"IPv4","port":9150}]},"metadata":{"message":"assigned listening specs for emulators"}}
[debug] [2024-11-12T21:57:26.910Z] [hub] writing locator at C:\Users\Rob\AppData\Local\Temp\hub-notalone-de4fc.json
[debug] [2024-11-12T21:57:26.919Z] [Extensions] Started Extensions emulator, this is a noop.
[debug] [2024-11-12T21:57:26.924Z] [functions] Functions Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-12T21:57:26.924Z] [eventarc] Eventarc Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-12T21:57:26.924Z] [tasks] Cloud Tasks Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-12T21:57:26.924Z] late-assigned ports for functions and eventarc emulators {"user":{"hub":[{"address":"127.0.0.1","family":"IPv4","port":4400},{"address":"::1","family":"IPv6","port":4400}],"ui":[{"address":"127.0.0.1","family":"IPv4","port":4000},{"address":"::1","family":"IPv6","port":4000}],"logging":[{"address":"127.0.0.1","family":"IPv4","port":4500}],"auth":[{"address":"127.0.0.1","family":"IPv4","port":9099}],"firestore":[{"address":"127.0.0.1","family":"IPv4","port":8080}],"firestore.websocket":[{"address":"127.0.0.1","family":"IPv4","port":9150}],"functions":[{"address":"127.0.0.1","family":"IPv4","port":5001}],"eventarc":[{"address":"127.0.0.1","family":"IPv4","port":9299}],"tasks":[{"address":"127.0.0.1","family":"IPv4","port":9499}]},"metadata":{"message":"late-assigned ports for functions and eventarc emulators"}}
[warn] !  functions: The following emulators are not running, calls to these services from the Functions emulator will affect production: database, hosting, pubsub, storage, dataconnect {"metadata":{"emulator":{"name":"functions"},"message":"The following emulators are not running, calls to these services from the Functions emulator will affect production: \u001b[1mdatabase, hosting, pubsub, storage, dataconnect\u001b[22m"}}
[debug] [2024-11-12T21:57:26.928Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T21:57:26.930Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[debug] [2024-11-12T21:57:26.930Z] Checked if tokens are valid: true, expires at: 1731451302034
[debug] [2024-11-12T21:57:26.930Z] Checked if tokens are valid: true, expires at: 1731451302034
[debug] [2024-11-12T21:57:26.931Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc/adminSdkConfig [none]
[debug] [2024-11-12T21:57:27.376Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc/adminSdkConfig 200
[debug] [2024-11-12T21:57:27.376Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc/adminSdkConfig {"projectId":"notalone-de4fc","storageBucket":"notalone-de4fc.firebasestorage.app"}
[debug] [2024-11-12T21:57:27.396Z] Ignoring unsupported arg: auto_download {"metadata":{"emulator":{"name":"firestore"},"message":"Ignoring unsupported arg: auto_download"}}
[debug] [2024-11-12T21:57:27.396Z] Ignoring unsupported arg: single_project_mode_error {"metadata":{"emulator":{"name":"firestore"},"message":"Ignoring unsupported arg: single_project_mode_error"}}
[debug] [2024-11-12T21:57:27.396Z] Starting Firestore Emulator with command {"binary":"java","args":["-Dgoogle.cloud_firestore.debug_log_level=FINE","-Duser.language=en","-jar","C:\\Users\\Rob\\.cache\\firebase\\emulators\\cloud-firestore-emulator-v1.19.8.jar","--host","127.0.0.1","--port",8080,"--websocket_port",9150,"--project_id","notalone-de4fc","--rules","C:\\Users\\Rob\\Apps\\not-alone\\firestore.rules","--single_project_mode",true,"--functions_emulator","127.0.0.1:5001"],"optionalArgs":["port","webchannel_port","host","rules","websocket_port","functions_emulator","seed_from_export","project_id","single_project_mode"],"joinArgs":false,"shell":false,"port":8080} {"metadata":{"emulator":{"name":"firestore"},"message":"Starting Firestore Emulator with command {\"binary\":\"java\",\"args\":[\"-Dgoogle.cloud_firestore.debug_log_level=FINE\",\"-Duser.language=en\",\"-jar\",\"C:\\\\Users\\\\Rob\\\\.cache\\\\firebase\\\\emulators\\\\cloud-firestore-emulator-v1.19.8.jar\",\"--host\",\"127.0.0.1\",\"--port\",8080,\"--websocket_port\",9150,\"--project_id\",\"notalone-de4fc\",\"--rules\",\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\firestore.rules\",\"--single_project_mode\",true,\"--functions_emulator\",\"127.0.0.1:5001\"],\"optionalArgs\":[\"port\",\"webchannel_port\",\"host\",\"rules\",\"websocket_port\",\"functions_emulator\",\"seed_from_export\",\"project_id\",\"single_project_mode\"],\"joinArgs\":false,\"shell\":false,\"port\":8080}"}}
[info] i  firestore: Firestore Emulator logging to firestore-debug.log {"metadata":{"emulator":{"name":"firestore"},"message":"Firestore Emulator logging to \u001b[1mfirestore-debug.log\u001b[22m"}}
[info] +  firestore: Firestore Emulator UI websocket is running on 9150. {"metadata":{"emulator":{"name":"firestore"},"message":"Firestore Emulator UI websocket is running on 9150."}}
[debug] [2024-11-12T21:57:36.724Z] Ignoring unsupported arg: auto_download {"metadata":{"emulator":{"name":"ui"},"message":"Ignoring unsupported arg: auto_download"}}
[debug] [2024-11-12T21:57:36.725Z] Ignoring unsupported arg: port {"metadata":{"emulator":{"name":"ui"},"message":"Ignoring unsupported arg: port"}}
[debug] [2024-11-12T21:57:36.725Z] Starting Emulator UI with command {"binary":"node","args":["C:\\Users\\Rob\\.cache\\firebase\\emulators\\ui-v1.14.0\\server\\server.mjs"],"optionalArgs":[],"joinArgs":false,"shell":false,"port":4000} {"metadata":{"emulator":{"name":"ui"},"message":"Starting Emulator UI with command {\"binary\":\"node\",\"args\":[\"C:\\\\Users\\\\Rob\\\\.cache\\\\firebase\\\\emulators\\\\ui-v1.14.0\\\\server\\\\server.mjs\"],\"optionalArgs\":[],\"joinArgs\":false,\"shell\":false,\"port\":4000}"}}
[info] i  ui: Emulator UI logging to ui-debug.log {"metadata":{"emulator":{"name":"ui"},"message":"Emulator UI logging to \u001b[1mui-debug.log\u001b[22m"}}
[debug] [2024-11-12T21:57:36.881Z] Web / API server started at 127.0.0.1:4000
 {"metadata":{"emulator":{"name":"ui"},"message":"Web / API server started at 127.0.0.1:4000\n"}}
[debug] [2024-11-12T21:57:36.882Z] Web / API server started at ::1:4000
 {"metadata":{"emulator":{"name":"ui"},"message":"Web / API server started at ::1:4000\n"}}
[debug] [2024-11-12T21:57:36.942Z] [Extensions] Connecting Extensions emulator, this is a noop.
[info] i  functions: Watching "C:\Users\Rob\Apps\not-alone\functions" for Cloud Functions... {"metadata":{"emulator":{"name":"functions"},"message":"Watching \"C:\\Users\\Rob\\Apps\\not-alone\\functions\" for Cloud Functions..."}}
[debug] [2024-11-12T21:57:36.949Z] Validating nodejs source
[debug] [2024-11-12T21:57:37.887Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T21:57:37.887Z] Building nodejs source
[debug] [2024-11-12T21:57:37.888Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T21:57:37.890Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T21:57:37.899Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8506

[debug] [2024-11-12T21:57:38.609Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T21:57:42.648Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T21:57:42.648Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[info] +  functions[us-central1-processChat]: http function initialized (http://127.0.0.1:5001/notalone-de4fc/us-central1/processChat). {"metadata":{"emulator":{"name":"functions"},"message":"\u001b[1mhttp\u001b[22m function initialized (http://127.0.0.1:5001/notalone-de4fc/us-central1/processChat)."}}
[debug] [2024-11-12T21:57:42.656Z] Could not find VSCode notification endpoint: FetchError: request to http://localhost:40001/vscode/notify failed, reason: . If you are not running the Firebase Data Connect VSCode extension, this is expected and not an issue.
[info] 
┌─────────────────────────────────────────────────────────────┐
│ ✔  All emulators ready! It is now safe to connect your app. │
│ i  View Emulator UI at http://127.0.0.1:4000/               │
└─────────────────────────────────────────────────────────────┘

┌────────────────┬────────────────┬──────────────────────────────────┐
│ Emulator       │ Host:Port      │ View in Emulator UI              │
├────────────────┼────────────────┼──────────────────────────────────┤
│ Authentication │ 127.0.0.1:9099 │ http://127.0.0.1:4000/auth       │
├────────────────┼────────────────┼──────────────────────────────────┤
│ Functions      │ 127.0.0.1:5001 │ http://127.0.0.1:4000/functions  │
├────────────────┼────────────────┼──────────────────────────────────┤
│ Firestore      │ 127.0.0.1:8080 │ http://127.0.0.1:4000/firestore  │
├────────────────┼────────────────┼──────────────────────────────────┤
│ Extensions     │ 127.0.0.1:5001 │ http://127.0.0.1:4000/extensions │
└────────────────┴────────────────┴──────────────────────────────────┘
  Emulator Hub running at 127.0.0.1:4400
  Other reserved ports: 4500, 9150
┌─────────────────────────┬───────────────┬─────────────────────┐
│ Extension Instance Name │ Extension Ref │ View in Emulator UI │
└─────────────────────────┴───────────────┴─────────────────────┘
Issues? Report them at https://github.com/firebase/firebase-tools/issues and attach the *-debug.log files.
 
[debug] [2024-11-12T21:58:02.026Z] File C:\Users\Rob\Apps\not-alone\functions\tsconfig.eslint.json changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\tsconfig.eslint.json changed, reloading triggers"}}
[debug] [2024-11-12T21:58:03.040Z] Validating nodejs source
[debug] [2024-11-12T21:58:03.949Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T21:58:03.949Z] Building nodejs source
[debug] [2024-11-12T21:58:03.949Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T21:58:03.951Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T21:58:03.961Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8888

[debug] [2024-11-12T21:58:04.576Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T21:58:08.610Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T21:58:08.611Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T21:58:18.556Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-12T21:58:18.559Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-12T21:58:19.567Z] Validating nodejs source
[debug] [2024-11-12T21:58:20.498Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T21:58:20.498Z] Building nodejs source
[debug] [2024-11-12T21:58:20.498Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T21:58:20.500Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T21:58:20.510Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8128

[debug] [2024-11-12T21:58:21.233Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T21:58:25.267Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T21:58:25.268Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T21:58:33.625Z] >>> [apiv2][query] POST http://127.0.0.1:5001/functions/projects/notalone-de4fc/trigger_multicast [none]
[debug] [2024-11-12T21:58:33.625Z] >>> [apiv2][body] POST http://127.0.0.1:5001/functions/projects/notalone-de4fc/trigger_multicast {"eventId":"a4168ef1-4883-4422-9c7b-722117f60ab8","eventType":"providers/firebase.auth/eventTypes/user.create","resource":{"name":"projects/notalone-de4fc","service":"firebaseauth.googleapis.com"},"params":{},"timestamp":"2024-11-12T21:58:33.624Z","data":{"uid":"34b2XQAnQgS78q5A6Qeek4Tashl4","email":"chicken.algae.413@example.com","emailVerified":true,"displayName":"Chicken Algae","metadata":{"creationTime":"2024-11-12T21:58:33.623Z","lastSignInTime":"2024-11-12T21:58:33.623Z"},"customClaims":{},"providerData":[{"providerId":"google.com","rawId":"9878074379227360780432902531142499276830","federatedId":"9878074379227360780432902531142499276830","displayName":"Chicken Algae","email":"chicken.algae.413@example.com","screenName":"algae_chicken"}]}}
[debug] [2024-11-12T21:58:33.636Z] <<< [apiv2][status] POST http://127.0.0.1:5001/functions/projects/notalone-de4fc/trigger_multicast 200
[debug] [2024-11-12T21:58:33.636Z] <<< [apiv2][body] POST http://127.0.0.1:5001/functions/projects/notalone-de4fc/trigger_multicast {"status":"multicast_acknowledged"}
[debug] [2024-11-12T21:58:35.317Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T21:58:35.317Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T21:58:35.317Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T21:58:35.317Z"],"workRunningCount":1}
[debug] [2024-11-12T21:58:35.318Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T21:58:35.320Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T21:58:35.321Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T21:58:35.332Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-12T21:58:35.333Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-12T21:58:36.884Z] [runtime-status] [33232] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33232] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T21:58:36.885Z] [runtime-status] [33232] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33232] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T21:58:36.885Z] [runtime-status] [33232] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33232] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-12T21:58:36.885Z] [runtime-status] [33232] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33232] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-12T21:58:36.887Z] [runtime-status] [33232] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33232] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T21:58:37.203Z] [runtime-status] [33232] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33232] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-12T21:58:37.203Z] [runtime-status] [33232] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33232] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-12T21:58:37.204Z] [runtime-status] [33232] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33232] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T21:58:37.209Z] [runtime-status] [33232] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33232] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T21:58:37.212Z] [runtime-status] [33232] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33232] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T21:58:37.213Z] [runtime-status] [33232] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33232] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2024-11-12T21:58:37.304Z] [runtime-status] [33232] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33232] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-12T21:58:37.305Z] [runtime-status] [33232] Listening to port: \\?\pipe\fire_emu_f69cc1ae7844ccfb {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33232] Listening to port: \\\\?\\pipe\\fire_emu_f69cc1ae7844ccfb"}}
[debug] [2024-11-12T21:58:37.315Z] [worker-us-central1-processChat-d1cb888a-bf04-4e39-98df-dbff51cfe247]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-d1cb888a-bf04-4e39-98df-dbff51cfe247]: IDLE"}}
[debug] [2024-11-12T21:58:37.315Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T21:58:37.316Z] [worker-us-central1-processChat-d1cb888a-bf04-4e39-98df-dbff51cfe247]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-d1cb888a-bf04-4e39-98df-dbff51cfe247]: BUSY"}}
[debug] [2024-11-12T21:58:37.322Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 5.5548ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 5.5548ms"}}
[debug] [2024-11-12T21:58:37.323Z] [worker-us-central1-processChat-d1cb888a-bf04-4e39-98df-dbff51cfe247]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-d1cb888a-bf04-4e39-98df-dbff51cfe247]: IDLE"}}
[debug] [2024-11-12T21:58:37.323Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T21:58:37.323Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T21:58:37.324Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T21:58:37.326Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T21:58:37.326Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T21:58:37.326Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T21:58:37.326Z"],"workRunningCount":1}
[debug] [2024-11-12T21:58:37.326Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T21:58:37.328Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T21:58:37.328Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T21:58:37.328Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T21:58:37.329Z] [worker-us-central1-processChat-d1cb888a-bf04-4e39-98df-dbff51cfe247]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-d1cb888a-bf04-4e39-98df-dbff51cfe247]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[debug] [2024-11-12T21:58:39.071Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 1742.6889ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 1742.6889ms"}}
[debug] [2024-11-12T21:58:39.072Z] [worker-us-central1-processChat-d1cb888a-bf04-4e39-98df-dbff51cfe247]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-d1cb888a-bf04-4e39-98df-dbff51cfe247]: IDLE"}}
[debug] [2024-11-12T21:58:39.073Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T21:58:39.073Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T21:58:39.073Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:00:30.264Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-12T22:00:31.276Z] Validating nodejs source
[debug] [2024-11-12T22:00:32.227Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:00:32.228Z] Building nodejs source
[debug] [2024-11-12T22:00:32.228Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:00:32.229Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:00:32.238Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8677

[debug] [2024-11-12T22:00:33.016Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:00:37.042Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:00:37.043Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:00:37.044Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-12T22:00:37.044Z] [worker-us-central1-processChat-d1cb888a-bf04-4e39-98df-dbff51cfe247]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-d1cb888a-bf04-4e39-98df-dbff51cfe247]: FINISHING"}}
[debug] [2024-11-12T22:00:37.058Z] [worker-us-central1-processChat-d1cb888a-bf04-4e39-98df-dbff51cfe247]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-d1cb888a-bf04-4e39-98df-dbff51cfe247]: exited"}}
[debug] [2024-11-12T22:00:37.058Z] [worker-us-central1-processChat-d1cb888a-bf04-4e39-98df-dbff51cfe247]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-d1cb888a-bf04-4e39-98df-dbff51cfe247]: FINISHED"}}
[debug] [2024-11-12T22:00:38.812Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-12T22:00:38.812Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-12T22:00:39.815Z] Validating nodejs source
[debug] [2024-11-12T22:00:41.387Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:00:41.387Z] Building nodejs source
[debug] [2024-11-12T22:00:41.387Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:00:41.388Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:00:41.396Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8582

[debug] [2024-11-12T22:00:42.020Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:00:46.048Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:00:46.049Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:01:02.919Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:01:02.919Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:01:02.919Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:01:02.919Z"],"workRunningCount":1}
[debug] [2024-11-12T22:01:02.919Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:01:02.922Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:01:02.922Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:01:02.922Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-12T22:01:02.931Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-12T22:01:02.931Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-12T22:01:04.434Z] [runtime-status] [23344] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23344] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:01:04.436Z] [runtime-status] [23344] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23344] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:01:04.436Z] [runtime-status] [23344] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23344] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-12T22:01:04.437Z] [runtime-status] [23344] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23344] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-12T22:01:04.437Z] [runtime-status] [23344] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23344] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:01:04.746Z] [runtime-status] [23344] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23344] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-12T22:01:04.746Z] [runtime-status] [23344] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23344] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-12T22:01:04.747Z] [runtime-status] [23344] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23344] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:01:04.753Z] [runtime-status] [23344] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23344] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:01:04.756Z] [runtime-status] [23344] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23344] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:01:04.756Z] [runtime-status] [23344] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23344] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2024-11-12T22:01:04.847Z] [runtime-status] [23344] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23344] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-12T22:01:04.848Z] [runtime-status] [23344] Listening to port: \\?\pipe\fire_emu_180c6f671e6a6c9f {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23344] Listening to port: \\\\?\\pipe\\fire_emu_180c6f671e6a6c9f"}}
[debug] [2024-11-12T22:01:04.915Z] [worker-us-central1-processChat-06e4cc8d-d68c-4915-8d26-4640ff3493f4]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-06e4cc8d-d68c-4915-8d26-4640ff3493f4]: IDLE"}}
[debug] [2024-11-12T22:01:04.915Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:01:04.916Z] [worker-us-central1-processChat-06e4cc8d-d68c-4915-8d26-4640ff3493f4]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-06e4cc8d-d68c-4915-8d26-4640ff3493f4]: BUSY"}}
[debug] [2024-11-12T22:01:04.920Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4.1736ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4.1736ms"}}
[debug] [2024-11-12T22:01:04.921Z] [worker-us-central1-processChat-06e4cc8d-d68c-4915-8d26-4640ff3493f4]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-06e4cc8d-d68c-4915-8d26-4640ff3493f4]: IDLE"}}
[debug] [2024-11-12T22:01:04.921Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:01:04.921Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:01:04.921Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:01:04.923Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:01:04.923Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:01:04.923Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:01:04.923Z"],"workRunningCount":1}
[debug] [2024-11-12T22:01:04.923Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:01:04.924Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:01:04.924Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:01:04.924Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:01:04.925Z] [worker-us-central1-processChat-06e4cc8d-d68c-4915-8d26-4640ff3493f4]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-06e4cc8d-d68c-4915-8d26-4640ff3493f4]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello', history: [] } } {"user":"🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello', history: [] } }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello', history: [] } }"}}
[info] >  📥 Processing request: { messageLength: 5, historyLength: 0, userId: undefined } {"user":"📥 Processing request: { messageLength: 5, historyLength: 0, userId: undefined }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: { messageLength: 5, historyLength: 0, userId: undefined }"}}
[info] >  🔄 Chat history: [] {"user":"🔄 Chat history: []","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔄 Chat history: []"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  📊 Raw Gemini response: { {"user":"📊 Raw Gemini response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📊 Raw Gemini response: {"}}
[info] >    candidates: [ {"user":"  candidates: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   candidates: ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        content: [Object], {"user":"      content: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       content: [Object],"}}
[info] >        finishReason: 'STOP', {"user":"      finishReason: 'STOP',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       finishReason: 'STOP',"}}
[info] >        avgLogprobs: -0.00043960745361718267, {"user":"      avgLogprobs: -0.00043960745361718267,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       avgLogprobs: -0.00043960745361718267,"}}
[info] >        index: 0 {"user":"      index: 0","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       index: 0"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    usageMetadata: { {"user":"  usageMetadata: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   usageMetadata: {"}}
[info] >      promptTokenCount: 1, {"user":"    promptTokenCount: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     promptTokenCount: 1,"}}
[info] >      candidatesTokenCount: 11, {"user":"    candidatesTokenCount: 11,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     candidatesTokenCount: 11,"}}
[info] >      totalTokenCount: 12 {"user":"    totalTokenCount: 12","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     totalTokenCount: 12"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    modelVersion: 'gemini-1.5-flash-002' {"user":"  modelVersion: 'gemini-1.5-flash-002'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   modelVersion: 'gemini-1.5-flash-002'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:01:06.528Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 1602.5965999999999ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 1602.5965999999999ms"}}
[debug] [2024-11-12T22:01:06.528Z] [worker-us-central1-processChat-06e4cc8d-d68c-4915-8d26-4640ff3493f4]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-06e4cc8d-d68c-4915-8d26-4640ff3493f4]: IDLE"}}
[debug] [2024-11-12T22:01:06.528Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:01:06.529Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:01:06.529Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  ✅ Processed response: { responseLength: 38, timestamp: '2024-11-12T22:01:06.518Z' } {"user":"✅ Processed response: { responseLength: 38, timestamp: '2024-11-12T22:01:06.518Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Processed response: { responseLength: 38, timestamp: '2024-11-12T22:01:06.518Z' }"}}
[info] >  📤 Sending final response: { {"user":"📤 Sending final response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending final response: {"}}
[info] >    message: 'Hello there! How can I help you today?', {"user":"  message: 'Hello there! How can I help you today?',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Hello there! How can I help you today?',"}}
[info] >    userMessage: 'hello', {"user":"  userMessage: 'hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hello',"}}
[info] >    timestamp: '2024-11-12T22:01:06.518Z' {"user":"  timestamp: '2024-11-12T22:01:06.518Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:01:06.518Z'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:03:28.091Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-12T22:03:29.101Z] Validating nodejs source
[debug] [2024-11-12T22:03:30.122Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:03:30.122Z] Building nodejs source
[debug] [2024-11-12T22:03:30.122Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:03:30.124Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:03:30.137Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8582

[debug] [2024-11-12T22:03:30.760Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:03:34.784Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:03:34.785Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:03:34.786Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-12T22:03:34.786Z] [worker-us-central1-processChat-06e4cc8d-d68c-4915-8d26-4640ff3493f4]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-06e4cc8d-d68c-4915-8d26-4640ff3493f4]: FINISHING"}}
[debug] [2024-11-12T22:03:34.799Z] [worker-us-central1-processChat-06e4cc8d-d68c-4915-8d26-4640ff3493f4]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-06e4cc8d-d68c-4915-8d26-4640ff3493f4]: exited"}}
[debug] [2024-11-12T22:03:34.799Z] [worker-us-central1-processChat-06e4cc8d-d68c-4915-8d26-4640ff3493f4]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-06e4cc8d-d68c-4915-8d26-4640ff3493f4]: FINISHED"}}
[debug] [2024-11-12T22:04:16.287Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-12T22:04:16.288Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-12T22:04:17.292Z] Validating nodejs source
[debug] [2024-11-12T22:04:18.201Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:04:18.202Z] Building nodejs source
[debug] [2024-11-12T22:04:18.202Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:04:18.203Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:04:18.211Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8802

[debug] [2024-11-12T22:04:18.809Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:04:22.830Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:04:22.830Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:04:33.448Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:04:33.448Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:04:33.448Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:04:33.448Z"],"workRunningCount":1}
[debug] [2024-11-12T22:04:33.449Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:04:33.451Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:04:33.451Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:04:33.451Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-12T22:04:33.459Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-12T22:04:33.459Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-12T22:04:34.874Z] [runtime-status] [3472] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [3472] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:04:34.875Z] [runtime-status] [3472] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [3472] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:04:34.876Z] [runtime-status] [3472] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [3472] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-12T22:04:34.876Z] [runtime-status] [3472] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [3472] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-12T22:04:34.877Z] [runtime-status] [3472] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [3472] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:04:35.162Z] [runtime-status] [3472] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [3472] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-12T22:04:35.163Z] [runtime-status] [3472] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [3472] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-12T22:04:35.164Z] [runtime-status] [3472] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [3472] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:04:35.169Z] [runtime-status] [3472] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [3472] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:04:35.172Z] [runtime-status] [3472] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [3472] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:04:35.172Z] [runtime-status] [3472] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [3472] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2024-11-12T22:04:35.256Z] [runtime-status] [3472] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [3472] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-12T22:04:35.257Z] [runtime-status] [3472] Listening to port: \\?\pipe\fire_emu_eb2cd9de46805b03 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [3472] Listening to port: \\\\?\\pipe\\fire_emu_eb2cd9de46805b03"}}
[debug] [2024-11-12T22:04:35.343Z] [worker-us-central1-processChat-74209002-33e5-4084-a4bf-138e780294ce]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-74209002-33e5-4084-a4bf-138e780294ce]: IDLE"}}
[debug] [2024-11-12T22:04:35.344Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:04:35.345Z] [worker-us-central1-processChat-74209002-33e5-4084-a4bf-138e780294ce]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-74209002-33e5-4084-a4bf-138e780294ce]: BUSY"}}
[debug] [2024-11-12T22:04:35.348Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 3.9732ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 3.9732ms"}}
[debug] [2024-11-12T22:04:35.349Z] [worker-us-central1-processChat-74209002-33e5-4084-a4bf-138e780294ce]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-74209002-33e5-4084-a4bf-138e780294ce]: IDLE"}}
[debug] [2024-11-12T22:04:35.350Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:04:35.350Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:04:35.350Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:04:35.353Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:04:35.353Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:04:35.353Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:04:35.353Z"],"workRunningCount":1}
[debug] [2024-11-12T22:04:35.353Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:04:35.354Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:04:35.354Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:04:35.354Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:04:35.355Z] [worker-us-central1-processChat-74209002-33e5-4084-a4bf-138e780294ce]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-74209002-33e5-4084-a4bf-138e780294ce]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello', history: [] } } {"user":"🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello', history: [] } }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello', history: [] } }"}}
[info] >  📥 Processing request: { messageLength: 5, historyLength: 0, userId: undefined } {"user":"📥 Processing request: { messageLength: 5, historyLength: 0, userId: undefined }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: { messageLength: 5, historyLength: 0, userId: undefined }"}}
[info] >  🔄 Chat history: [] {"user":"🔄 Chat history: []","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔄 Chat history: []"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  📊 Raw Gemini response: { {"user":"📊 Raw Gemini response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📊 Raw Gemini response: {"}}
[info] >    candidates: [ {"user":"  candidates: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   candidates: ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        content: [Object], {"user":"      content: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       content: [Object],"}}
[info] >        finishReason: 'STOP', {"user":"      finishReason: 'STOP',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       finishReason: 'STOP',"}}
[info] >        avgLogprobs: -0.00040638302876190704, {"user":"      avgLogprobs: -0.00040638302876190704,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       avgLogprobs: -0.00040638302876190704,"}}
[info] >        index: 0 {"user":"      index: 0","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       index: 0"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    usageMetadata: { {"user":"  usageMetadata: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   usageMetadata: {"}}
[info] >      promptTokenCount: 1, {"user":"    promptTokenCount: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     promptTokenCount: 1,"}}
[info] >      candidatesTokenCount: 11, {"user":"    candidatesTokenCount: 11,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     candidatesTokenCount: 11,"}}
[info] >      totalTokenCount: 12 {"user":"    totalTokenCount: 12","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     totalTokenCount: 12"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    modelVersion: 'gemini-1.5-flash-002' {"user":"  modelVersion: 'gemini-1.5-flash-002'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   modelVersion: 'gemini-1.5-flash-002'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:04:37.061Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 1705.7345ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 1705.7345ms"}}
[debug] [2024-11-12T22:04:37.062Z] [worker-us-central1-processChat-74209002-33e5-4084-a4bf-138e780294ce]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-74209002-33e5-4084-a4bf-138e780294ce]: IDLE"}}
[debug] [2024-11-12T22:04:37.062Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:04:37.062Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:04:37.062Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  ✅ Processed response: { responseLength: 38, timestamp: '2024-11-12T22:04:37.048Z' } {"user":"✅ Processed response: { responseLength: 38, timestamp: '2024-11-12T22:04:37.048Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Processed response: { responseLength: 38, timestamp: '2024-11-12T22:04:37.048Z' }"}}
[info] >  📤 Sending final response: { {"user":"📤 Sending final response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending final response: {"}}
[info] >    message: 'Hello there! How can I help you today?', {"user":"  message: 'Hello there! How can I help you today?',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Hello there! How can I help you today?',"}}
[info] >    userMessage: 'hello', {"user":"  userMessage: 'hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hello',"}}
[info] >    timestamp: '2024-11-12T22:04:37.048Z', {"user":"  timestamp: '2024-11-12T22:04:37.048Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:04:37.048Z',"}}
[info] >    userId: undefined {"user":"  userId: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: undefined"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:07:09.650Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-12T22:07:10.655Z] Validating nodejs source
[debug] [2024-11-12T22:07:11.729Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:07:11.729Z] Building nodejs source
[debug] [2024-11-12T22:07:11.730Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:07:11.731Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:07:11.743Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8264

[debug] [2024-11-12T22:07:12.731Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:07:16.774Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:07:16.775Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:07:16.777Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-12T22:07:16.777Z] [worker-us-central1-processChat-74209002-33e5-4084-a4bf-138e780294ce]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-74209002-33e5-4084-a4bf-138e780294ce]: FINISHING"}}
[debug] [2024-11-12T22:07:16.791Z] [worker-us-central1-processChat-74209002-33e5-4084-a4bf-138e780294ce]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-74209002-33e5-4084-a4bf-138e780294ce]: exited"}}
[debug] [2024-11-12T22:07:16.792Z] [worker-us-central1-processChat-74209002-33e5-4084-a4bf-138e780294ce]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-74209002-33e5-4084-a4bf-138e780294ce]: FINISHED"}}
[debug] [2024-11-12T22:07:18.327Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-12T22:07:18.331Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-12T22:07:19.340Z] Validating nodejs source
[debug] [2024-11-12T22:07:20.456Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:07:20.456Z] Building nodejs source
[debug] [2024-11-12T22:07:20.456Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:07:20.458Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:07:20.468Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8784

[debug] [2024-11-12T22:07:21.253Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:07:25.276Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:07:25.276Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:07:29.452Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:07:29.452Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:07:29.452Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:07:29.452Z"],"workRunningCount":1}
[debug] [2024-11-12T22:07:29.452Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:07:29.456Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:07:29.457Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:07:29.457Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-12T22:07:29.467Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-12T22:07:29.467Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-12T22:07:31.236Z] [runtime-status] [14452] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [14452] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:07:31.238Z] [runtime-status] [14452] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [14452] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:07:31.238Z] [runtime-status] [14452] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [14452] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-12T22:07:31.239Z] [runtime-status] [14452] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [14452] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-12T22:07:31.241Z] [runtime-status] [14452] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [14452] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:07:31.611Z] [runtime-status] [14452] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [14452] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-12T22:07:31.612Z] [runtime-status] [14452] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [14452] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-12T22:07:31.612Z] [runtime-status] [14452] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [14452] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:07:31.618Z] [runtime-status] [14452] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [14452] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:07:31.621Z] [runtime-status] [14452] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [14452] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:07:31.621Z] [runtime-status] [14452] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [14452] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2024-11-12T22:07:31.728Z] [runtime-status] [14452] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [14452] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-12T22:07:31.729Z] [runtime-status] [14452] Listening to port: \\?\pipe\fire_emu_fcc7b88af8373146 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [14452] Listening to port: \\\\?\\pipe\\fire_emu_fcc7b88af8373146"}}
[debug] [2024-11-12T22:07:31.780Z] [worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: IDLE"}}
[debug] [2024-11-12T22:07:31.781Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:07:31.782Z] [worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: BUSY"}}
[debug] [2024-11-12T22:07:31.786Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4.3241ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4.3241ms"}}
[debug] [2024-11-12T22:07:31.787Z] [worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: IDLE"}}
[debug] [2024-11-12T22:07:31.787Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:07:31.787Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:07:31.788Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:07:31.789Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:07:31.788Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:07:31.789Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:07:31.788Z"],"workRunningCount":1}
[debug] [2024-11-12T22:07:31.789Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:07:31.790Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:07:31.790Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:07:31.790Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:07:31.791Z] [worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello', history: [] } } {"user":"🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello', history: [] } }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello', history: [] } }"}}
[info] >  📥 Processing request: { messageLength: 5, userId: undefined } {"user":"📥 Processing request: { messageLength: 5, userId: undefined }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: { messageLength: 5, userId: undefined }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  📊 Raw Gemini response: { {"user":"📊 Raw Gemini response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📊 Raw Gemini response: {"}}
[info] >    candidates: [ {"user":"  candidates: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   candidates: ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        content: [Object], {"user":"      content: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       content: [Object],"}}
[info] >        finishReason: 'STOP', {"user":"      finishReason: 'STOP',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       finishReason: 'STOP',"}}
[info] >        avgLogprobs: -0.0004650911908935417, {"user":"      avgLogprobs: -0.0004650911908935417,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       avgLogprobs: -0.0004650911908935417,"}}
[info] >        index: 0 {"user":"      index: 0","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       index: 0"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    usageMetadata: { {"user":"  usageMetadata: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   usageMetadata: {"}}
[info] >      promptTokenCount: 1, {"user":"    promptTokenCount: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     promptTokenCount: 1,"}}
[info] >      candidatesTokenCount: 11, {"user":"    candidatesTokenCount: 11,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     candidatesTokenCount: 11,"}}
[info] >      totalTokenCount: 12 {"user":"    totalTokenCount: 12","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     totalTokenCount: 12"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    modelVersion: 'gemini-1.5-flash-002' {"user":"  modelVersion: 'gemini-1.5-flash-002'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   modelVersion: 'gemini-1.5-flash-002'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:07:33.587Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 1795.5199ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 1795.5199ms"}}
[debug] [2024-11-12T22:07:33.588Z] [worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: IDLE"}}
[debug] [2024-11-12T22:07:33.588Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:07:33.588Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:07:33.588Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  ✅ Processed response: { responseLength: 39, timestamp: '2024-11-12T22:07:33.576Z' } {"user":"✅ Processed response: { responseLength: 39, timestamp: '2024-11-12T22:07:33.576Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Processed response: { responseLength: 39, timestamp: '2024-11-12T22:07:33.576Z' }"}}
[info] >  📤 Sending final response: { {"user":"📤 Sending final response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending final response: {"}}
[info] >    message: 'Hello there! How can I help you today?\n', {"user":"  message: 'Hello there! How can I help you today?\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Hello there! How can I help you today?\\n',"}}
[info] >    userMessage: 'hello', {"user":"  userMessage: 'hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hello',"}}
[info] >    timestamp: '2024-11-12T22:07:33.576Z', {"user":"  timestamp: '2024-11-12T22:07:33.576Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:07:33.576Z',"}}
[info] >    userId: undefined {"user":"  userId: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: undefined"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:12:00.253Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:12:00.253Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:12:00.254Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:12:00.253Z"],"workRunningCount":1}
[debug] [2024-11-12T22:12:00.254Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:12:00.256Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:12:00.256Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:12:00.256Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:12:00.257Z] [worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: BUSY"}}
[debug] [2024-11-12T22:12:00.260Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 3.499ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 3.499ms"}}
[debug] [2024-11-12T22:12:00.261Z] [worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: IDLE"}}
[debug] [2024-11-12T22:12:00.262Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:12:00.262Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:12:00.262Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:12:00.263Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:12:00.263Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:12:00.263Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:12:00.263Z"],"workRunningCount":1}
[debug] [2024-11-12T22:12:00.263Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:12:00.266Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:12:00.266Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:12:00.266Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:12:00.268Z] [worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello', history: {} } } {"user":"🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello', history: {} } }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello', history: {} } }"}}
[info] >  📥 Processing request: { messageLength: 5, userId: '34b2XQAnQgS78q5A6Qeek4Tashl4' } {"user":"📥 Processing request: { messageLength: 5, userId: '34b2XQAnQgS78q5A6Qeek4Tashl4' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: { messageLength: 5, userId: '34b2XQAnQgS78q5A6Qeek4Tashl4' }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[info] >  📊 Raw Gemini response: { {"user":"📊 Raw Gemini response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📊 Raw Gemini response: {"}}
[info] >    candidates: [ {"user":"  candidates: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   candidates: ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        content: [Object], {"user":"      content: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       content: [Object],"}}
[info] >        finishReason: 'STOP', {"user":"      finishReason: 'STOP',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       finishReason: 'STOP',"}}
[info] >        avgLogprobs: -0.059575037522749466, {"user":"      avgLogprobs: -0.059575037522749466,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       avgLogprobs: -0.059575037522749466,"}}
[info] >        index: 0 {"user":"      index: 0","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       index: 0"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    usageMetadata: { {"user":"  usageMetadata: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   usageMetadata: {"}}
[info] >      promptTokenCount: 1, {"user":"    promptTokenCount: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     promptTokenCount: 1,"}}
[info] >      candidatesTokenCount: 11, {"user":"    candidatesTokenCount: 11,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     candidatesTokenCount: 11,"}}
[info] >      totalTokenCount: 12 {"user":"    totalTokenCount: 12","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     totalTokenCount: 12"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    modelVersion: 'gemini-1.5-flash-002' {"user":"  modelVersion: 'gemini-1.5-flash-002'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   modelVersion: 'gemini-1.5-flash-002'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:12:01.686Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 1418.4437ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 1418.4437ms"}}
[debug] [2024-11-12T22:12:01.688Z] [worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: IDLE"}}
[debug] [2024-11-12T22:12:01.688Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:12:01.688Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:12:01.688Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  ✅ Processed response: { responseLength: 39, timestamp: '2024-11-12T22:12:01.672Z' } {"user":"✅ Processed response: { responseLength: 39, timestamp: '2024-11-12T22:12:01.672Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Processed response: { responseLength: 39, timestamp: '2024-11-12T22:12:01.672Z' }"}}
[info] >  📤 Sending final response: { {"user":"📤 Sending final response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending final response: {"}}
[info] >    message: 'Hello there! How can I help you today?\n', {"user":"  message: 'Hello there! How can I help you today?\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Hello there! How can I help you today?\\n',"}}
[info] >    userMessage: 'hello', {"user":"  userMessage: 'hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hello',"}}
[info] >    timestamp: '2024-11-12T22:12:01.672Z', {"user":"  timestamp: '2024-11-12T22:12:01.672Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:12:01.672Z',"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4' {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:12:58.953Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-12T22:12:59.968Z] Validating nodejs source
[debug] [2024-11-12T22:13:01.147Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:13:01.147Z] Building nodejs source
[debug] [2024-11-12T22:13:01.147Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:13:01.148Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:13:01.160Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8048

[debug] [2024-11-12T22:13:01.928Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:13:05.967Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:13:05.968Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:13:05.970Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-12T22:13:05.970Z] [worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: FINISHING"}}
[debug] [2024-11-12T22:13:05.984Z] [worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: exited"}}
[debug] [2024-11-12T22:13:05.984Z] [worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f9f95747-e811-45d5-8ed2-500680387880]: FINISHED"}}
[debug] [2024-11-12T22:13:33.925Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:13:33.925Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:13:33.925Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:13:33.925Z"],"workRunningCount":1}
[debug] [2024-11-12T22:13:33.925Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:13:33.927Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:13:33.927Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:13:33.927Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-12T22:13:33.935Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-12T22:13:33.935Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-12T22:13:35.537Z] [runtime-status] [32760] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32760] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:13:35.539Z] [runtime-status] [32760] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32760] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:13:35.540Z] [runtime-status] [32760] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32760] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-12T22:13:35.540Z] [runtime-status] [32760] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32760] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-12T22:13:35.541Z] [runtime-status] [32760] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32760] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:13:35.847Z] [runtime-status] [32760] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32760] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-12T22:13:35.847Z] [runtime-status] [32760] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32760] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-12T22:13:35.848Z] [runtime-status] [32760] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32760] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:13:35.853Z] [runtime-status] [32760] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32760] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:13:35.856Z] [runtime-status] [32760] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32760] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:13:35.856Z] [runtime-status] [32760] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32760] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2024-11-12T22:13:35.952Z] [runtime-status] [32760] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32760] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-12T22:13:35.953Z] [runtime-status] [32760] Listening to port: \\?\pipe\fire_emu_73bc5dcfbf9054e1 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32760] Listening to port: \\\\?\\pipe\\fire_emu_73bc5dcfbf9054e1"}}
[debug] [2024-11-12T22:13:36.042Z] [worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: IDLE"}}
[debug] [2024-11-12T22:13:36.042Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:13:36.043Z] [worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: BUSY"}}
[debug] [2024-11-12T22:13:36.047Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 3.9539ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 3.9539ms"}}
[debug] [2024-11-12T22:13:36.047Z] [worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: IDLE"}}
[debug] [2024-11-12T22:13:36.048Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:13:36.048Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:13:36.048Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:13:36.049Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:13:36.049Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:13:36.050Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:13:36.049Z"],"workRunningCount":1}
[debug] [2024-11-12T22:13:36.050Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:13:36.051Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:13:36.051Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:13:36.051Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:13:36.052Z] [worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { auth: 'Authenticated', data: { message: 'helllo', history: {} } } {"user":"🚀 Incoming request: { auth: 'Authenticated', data: { message: 'helllo', history: {} } }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: { auth: 'Authenticated', data: { message: 'helllo', history: {} } }"}}
[info] >  📥 Processing request: { messageLength: 6, userId: '34b2XQAnQgS78q5A6Qeek4Tashl4' } {"user":"📥 Processing request: { messageLength: 6, userId: '34b2XQAnQgS78q5A6Qeek4Tashl4' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: { messageLength: 6, userId: '34b2XQAnQgS78q5A6Qeek4Tashl4' }"}}
[info] >  💬 Sending message to Gemini: helllo {"user":"💬 Sending message to Gemini: helllo","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: helllo"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  📊 Raw Gemini response: { {"user":"📊 Raw Gemini response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📊 Raw Gemini response: {"}}
[info] >    candidates: [ {"user":"  candidates: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   candidates: ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        content: [Object], {"user":"      content: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       content: [Object],"}}
[info] >        finishReason: 'STOP', {"user":"      finishReason: 'STOP',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       finishReason: 'STOP',"}}
[info] >        avgLogprobs: -0.12961306355216287, {"user":"      avgLogprobs: -0.12961306355216287,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       avgLogprobs: -0.12961306355216287,"}}
[info] >        index: 0 {"user":"      index: 0","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       index: 0"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    usageMetadata: { {"user":"  usageMetadata: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   usageMetadata: {"}}
[info] >      promptTokenCount: 2, {"user":"    promptTokenCount: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     promptTokenCount: 2,"}}
[info] >      candidatesTokenCount: 11, {"user":"    candidatesTokenCount: 11,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     candidatesTokenCount: 11,"}}
[info] >      totalTokenCount: 13 {"user":"    totalTokenCount: 13","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     totalTokenCount: 13"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    modelVersion: 'gemini-1.5-flash-002' {"user":"  modelVersion: 'gemini-1.5-flash-002'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   modelVersion: 'gemini-1.5-flash-002'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:13:37.811Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 1759.2993999999999ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 1759.2993999999999ms"}}
[debug] [2024-11-12T22:13:37.812Z] [worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: IDLE"}}
[debug] [2024-11-12T22:13:37.812Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:13:37.812Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:13:37.812Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  ✅ Processed response: { responseLength: 39, timestamp: '2024-11-12T22:13:37.802Z' } {"user":"✅ Processed response: { responseLength: 39, timestamp: '2024-11-12T22:13:37.802Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Processed response: { responseLength: 39, timestamp: '2024-11-12T22:13:37.802Z' }"}}
[info] >  📤 Sending final response: { {"user":"📤 Sending final response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending final response: {"}}
[info] >    message: 'Hello there! How can I help you today?\n', {"user":"  message: 'Hello there! How can I help you today?\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Hello there! How can I help you today?\\n',"}}
[info] >    userMessage: 'helllo', {"user":"  userMessage: 'helllo',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'helllo',"}}
[info] >    timestamp: '2024-11-12T22:13:37.802Z', {"user":"  timestamp: '2024-11-12T22:13:37.802Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:13:37.802Z',"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4' {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:13:48.839Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:13:48.839Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:13:48.839Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:13:48.839Z"],"workRunningCount":1}
[debug] [2024-11-12T22:13:48.839Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:13:48.841Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:13:48.841Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:13:48.842Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:13:48.842Z] [worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: BUSY"}}
[debug] [2024-11-12T22:13:48.845Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2.9564ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2.9564ms"}}
[debug] [2024-11-12T22:13:48.846Z] [worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: IDLE"}}
[debug] [2024-11-12T22:13:48.846Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:13:48.846Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:13:48.846Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:13:48.846Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:13:48.846Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:13:48.847Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:13:48.846Z"],"workRunningCount":1}
[debug] [2024-11-12T22:13:48.847Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:13:48.849Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:13:48.849Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:13:48.849Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:13:48.850Z] [worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello', history: {} } } {"user":"🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello', history: {} } }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello', history: {} } }"}}
[info] >  📥 Processing request: { messageLength: 5, userId: '34b2XQAnQgS78q5A6Qeek4Tashl4' } {"user":"📥 Processing request: { messageLength: 5, userId: '34b2XQAnQgS78q5A6Qeek4Tashl4' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: { messageLength: 5, userId: '34b2XQAnQgS78q5A6Qeek4Tashl4' }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[info] >  📊 Raw Gemini response: { {"user":"📊 Raw Gemini response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📊 Raw Gemini response: {"}}
[info] >    candidates: [ {"user":"  candidates: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   candidates: ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        content: [Object], {"user":"      content: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       content: [Object],"}}
[info] >        finishReason: 'STOP', {"user":"      finishReason: 'STOP',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       finishReason: 'STOP',"}}
[info] >        avgLogprobs: -0.000406393865970048, {"user":"      avgLogprobs: -0.000406393865970048,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       avgLogprobs: -0.000406393865970048,"}}
[info] >        index: 0 {"user":"      index: 0","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       index: 0"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    usageMetadata: { {"user":"  usageMetadata: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   usageMetadata: {"}}
[info] >      promptTokenCount: 1, {"user":"    promptTokenCount: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     promptTokenCount: 1,"}}
[info] >      candidatesTokenCount: 11, {"user":"    candidatesTokenCount: 11,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     candidatesTokenCount: 11,"}}
[info] >      totalTokenCount: 12 {"user":"    totalTokenCount: 12","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     totalTokenCount: 12"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    modelVersion: 'gemini-1.5-flash-002' {"user":"  modelVersion: 'gemini-1.5-flash-002'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   modelVersion: 'gemini-1.5-flash-002'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:13:49.880Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 1030.6186ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 1030.6186ms"}}
[debug] [2024-11-12T22:13:49.881Z] [worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: IDLE"}}
[debug] [2024-11-12T22:13:49.881Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:13:49.881Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:13:49.882Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  ✅ Processed response: { responseLength: 39, timestamp: '2024-11-12T22:13:49.864Z' } {"user":"✅ Processed response: { responseLength: 39, timestamp: '2024-11-12T22:13:49.864Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Processed response: { responseLength: 39, timestamp: '2024-11-12T22:13:49.864Z' }"}}
[info] >  📤 Sending final response: { {"user":"📤 Sending final response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending final response: {"}}
[info] >    message: 'Hello there! How can I help you today?\n', {"user":"  message: 'Hello there! How can I help you today?\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Hello there! How can I help you today?\\n',"}}
[info] >    userMessage: 'hello', {"user":"  userMessage: 'hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hello',"}}
[info] >    timestamp: '2024-11-12T22:13:49.864Z', {"user":"  timestamp: '2024-11-12T22:13:49.864Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:13:49.864Z',"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4' {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:14:00.071Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:14:00.071Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:14:00.071Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:14:00.071Z"],"workRunningCount":1}
[debug] [2024-11-12T22:14:00.072Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:14:00.075Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:14:00.075Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:14:00.075Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:14:00.076Z] [worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: BUSY"}}
[debug] [2024-11-12T22:14:00.079Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2.5191ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2.5191ms"}}
[debug] [2024-11-12T22:14:00.080Z] [worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: IDLE"}}
[debug] [2024-11-12T22:14:00.080Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:14:00.080Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:14:00.080Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:14:00.081Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:14:00.081Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:14:00.081Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:14:00.081Z"],"workRunningCount":1}
[debug] [2024-11-12T22:14:00.081Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:14:00.084Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:14:00.085Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:14:00.085Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:14:00.086Z] [worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi', history: {} } } {"user":"🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi', history: {} } }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi', history: {} } }"}}
[info] >  📥 Processing request: { messageLength: 2, userId: '34b2XQAnQgS78q5A6Qeek4Tashl4' } {"user":"📥 Processing request: { messageLength: 2, userId: '34b2XQAnQgS78q5A6Qeek4Tashl4' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: { messageLength: 2, userId: '34b2XQAnQgS78q5A6Qeek4Tashl4' }"}}
[info] >  💬 Sending message to Gemini: hi {"user":"💬 Sending message to Gemini: hi","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hi"}}
[info] >  📊 Raw Gemini response: { {"user":"📊 Raw Gemini response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📊 Raw Gemini response: {"}}
[info] >    candidates: [ {"user":"  candidates: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   candidates: ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        content: [Object], {"user":"      content: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       content: [Object],"}}
[info] >        finishReason: 'STOP', {"user":"      finishReason: 'STOP',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       finishReason: 'STOP',"}}
[info] >        avgLogprobs: -0.0003862054595215754, {"user":"      avgLogprobs: -0.0003862054595215754,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       avgLogprobs: -0.0003862054595215754,"}}
[info] >        index: 0 {"user":"      index: 0","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       index: 0"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    usageMetadata: { {"user":"  usageMetadata: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   usageMetadata: {"}}
[info] >      promptTokenCount: 1, {"user":"    promptTokenCount: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     promptTokenCount: 1,"}}
[info] >      candidatesTokenCount: 11, {"user":"    candidatesTokenCount: 11,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     candidatesTokenCount: 11,"}}
[info] >      totalTokenCount: 12 {"user":"    totalTokenCount: 12","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     totalTokenCount: 12"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    modelVersion: 'gemini-1.5-flash-002' {"user":"  modelVersion: 'gemini-1.5-flash-002'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   modelVersion: 'gemini-1.5-flash-002'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:14:01.082Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 996.1646ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 996.1646ms"}}
[debug] [2024-11-12T22:14:01.082Z] [worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: IDLE"}}
[debug] [2024-11-12T22:14:01.083Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:14:01.083Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:14:01.083Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  ✅ Processed response: { responseLength: 36, timestamp: '2024-11-12T22:14:01.072Z' } {"user":"✅ Processed response: { responseLength: 36, timestamp: '2024-11-12T22:14:01.072Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Processed response: { responseLength: 36, timestamp: '2024-11-12T22:14:01.072Z' }"}}
[info] >  📤 Sending final response: { {"user":"📤 Sending final response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending final response: {"}}
[info] >    message: 'Hi there! How can I help you today?\n', {"user":"  message: 'Hi there! How can I help you today?\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Hi there! How can I help you today?\\n',"}}
[info] >    userMessage: 'hi', {"user":"  userMessage: 'hi',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hi',"}}
[info] >    timestamp: '2024-11-12T22:14:01.072Z', {"user":"  timestamp: '2024-11-12T22:14:01.072Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:14:01.072Z',"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4' {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:17:53.281Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-12T22:17:54.288Z] Validating nodejs source
[debug] [2024-11-12T22:17:55.308Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:17:55.309Z] Building nodejs source
[debug] [2024-11-12T22:17:55.309Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:17:55.310Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:17:55.324Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8620

[debug] [2024-11-12T22:17:56.033Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:18:00.061Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:18:00.062Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:18:00.063Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-12T22:18:00.063Z] [worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: FINISHING"}}
[debug] [2024-11-12T22:18:00.076Z] [worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: exited"}}
[debug] [2024-11-12T22:18:00.076Z] [worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-2faec876-7995-4576-9b0a-352e089d2d86]: FINISHED"}}
[debug] [2024-11-12T22:20:27.126Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-12T22:20:27.128Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-12T22:20:28.129Z] Validating nodejs source
[debug] [2024-11-12T22:20:29.111Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:20:29.111Z] Building nodejs source
[debug] [2024-11-12T22:20:29.111Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:20:29.112Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:20:29.120Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8738

[debug] [2024-11-12T22:20:29.746Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:20:33.775Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:20:33.776Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:20:50.582Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-12T22:20:51.590Z] Validating nodejs source
[debug] [2024-11-12T22:20:52.602Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:20:52.602Z] Building nodejs source
[debug] [2024-11-12T22:20:52.602Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:20:52.603Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:20:52.615Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8235

[debug] [2024-11-12T22:20:53.233Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:20:57.262Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:20:57.262Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:21:22.516Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-12T22:21:22.516Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-12T22:21:23.532Z] Validating nodejs source
[debug] [2024-11-12T22:21:24.516Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:21:24.516Z] Building nodejs source
[debug] [2024-11-12T22:21:24.516Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:21:24.517Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:21:24.525Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8999

[debug] [2024-11-12T22:21:25.161Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:21:29.183Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:21:29.184Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:21:47.364Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-12T22:21:48.367Z] Validating nodejs source
[debug] [2024-11-12T22:21:49.316Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:21:49.316Z] Building nodejs source
[debug] [2024-11-12T22:21:49.316Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:21:49.317Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:21:49.327Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8389

[debug] [2024-11-12T22:21:49.993Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:21:54.021Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:21:54.021Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:21:59.273Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-12T22:21:59.276Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-12T22:22:00.280Z] Validating nodejs source
[debug] [2024-11-12T22:22:01.194Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:22:01.194Z] Building nodejs source
[debug] [2024-11-12T22:22:01.194Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:22:01.196Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:22:01.204Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8548

[debug] [2024-11-12T22:22:01.862Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:22:05.888Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:22:05.889Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:22:08.994Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:22:08.994Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:22:08.994Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:22:08.994Z"],"workRunningCount":1}
[debug] [2024-11-12T22:22:08.994Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:22:08.997Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:22:08.997Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:22:08.997Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-12T22:22:09.006Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-12T22:22:09.006Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-12T22:22:10.699Z] [runtime-status] [23352] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23352] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:22:10.701Z] [runtime-status] [23352] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23352] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:22:10.701Z] [runtime-status] [23352] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23352] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-12T22:22:10.702Z] [runtime-status] [23352] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23352] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-12T22:22:10.702Z] [runtime-status] [23352] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23352] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:22:11.042Z] [runtime-status] [23352] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23352] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-12T22:22:11.043Z] [runtime-status] [23352] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23352] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-12T22:22:11.043Z] [runtime-status] [23352] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23352] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:22:11.048Z] [runtime-status] [23352] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23352] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:22:11.051Z] [runtime-status] [23352] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23352] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:22:11.051Z] [runtime-status] [23352] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23352] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2024-11-12T22:22:11.148Z] [runtime-status] [23352] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23352] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-12T22:22:11.149Z] [runtime-status] [23352] Listening to port: \\?\pipe\fire_emu_963228aa506c97cc {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23352] Listening to port: \\\\?\\pipe\\fire_emu_963228aa506c97cc"}}
[debug] [2024-11-12T22:22:11.210Z] [worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: IDLE"}}
[debug] [2024-11-12T22:22:11.210Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:22:11.211Z] [worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: BUSY"}}
[debug] [2024-11-12T22:22:11.214Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 3.7112ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 3.7112ms"}}
[debug] [2024-11-12T22:22:11.215Z] [worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: IDLE"}}
[debug] [2024-11-12T22:22:11.215Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:22:11.215Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:22:11.215Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:22:11.216Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:22:11.216Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:22:11.216Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:22:11.216Z"],"workRunningCount":1}
[debug] [2024-11-12T22:22:11.216Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:22:11.217Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:22:11.217Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:22:11.217Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:22:11.218Z] [worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'Understanding my emotions', chatId: 'default-chat' } {"user":"  data: { message: 'Understanding my emotions', chatId: 'default-chat' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'Understanding my emotions', chatId: 'default-chat' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 25, {"user":"  messageLength: 25,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 25,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: default-chat {"user":"🆕 Creating new chat session: default-chat","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: default-chat"}}
[info] >  📝 Chat session created: { chatId: 'default-chat', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'default-chat', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'default-chat', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: Understanding my emotions {"user":"💬 Sending message to Gemini: Understanding my emotions","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: Understanding my emotions"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  🔄 Starting stream processing {"user":"🔄 Starting stream processing","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔄 Starting stream processing"}}
[info] >  💥 Chat processing error: TypeError: Cannot read properties of undefined (reading 'Symbol(Symbol.asyncIterator)') {"user":"💥 Chat processing error: TypeError: Cannot read properties of undefined (reading 'Symbol(Symbol.asyncIterator)')","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💥 Chat processing error: TypeError: Cannot read properties of undefined (reading 'Symbol(Symbol.asyncIterator)')"}}
[info] >      at __asyncValues (C:\Users\Rob\Apps\not-alone\functions\lib\index.js:27:14) {"user":"    at __asyncValues (C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js:27:14)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at __asyncValues (C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js:27:14)"}}
[info] >      at C:\Users\Rob\Apps\not-alone\functions\lib\index.js:109:38 {"user":"    at C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js:109:38","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js:109:38"}}
[info] >      at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >      at async C:\Users\Rob\Apps\not-alone\functions\node_modules\firebase-functions\lib\common\providers\https.js:467:26 {"user":"    at async C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at async C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26"}}
[info] >      at async runFunction (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:506:9) {"user":"    at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)"}}
[info] >      at async runHTTPS (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:531:5) {"user":"    at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)"}}
[info] >      at async C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:694:21 {"user":"    at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21"}}
[debug] [2024-11-12T22:22:17.063Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 5844.9022ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 5844.9022ms"}}
[debug] [2024-11-12T22:22:17.064Z] [worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: IDLE"}}
[debug] [2024-11-12T22:22:17.064Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:22:17.064Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:22:17.064Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:22:31.795Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:22:31.795Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:22:31.796Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:22:31.795Z"],"workRunningCount":1}
[debug] [2024-11-12T22:22:31.796Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:22:31.797Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:22:31.797Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:22:31.798Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:22:31.798Z] [worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: BUSY"}}
[debug] [2024-11-12T22:22:31.801Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2.6883ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2.6883ms"}}
[debug] [2024-11-12T22:22:31.801Z] [worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: IDLE"}}
[debug] [2024-11-12T22:22:31.802Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:22:31.802Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:22:31.802Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:22:31.803Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:22:31.803Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:22:31.803Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:22:31.803Z"],"workRunningCount":1}
[debug] [2024-11-12T22:22:31.803Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:22:31.805Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:22:31.805Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:22:31.805Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:22:31.806Z] [worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'hello', chatId: 'default-chat' } {"user":"  data: { message: 'hello', chatId: 'default-chat' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'hello', chatId: 'default-chat' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 5, {"user":"  messageLength: 5,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 5,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[info] >  🔄 Starting stream processing {"user":"🔄 Starting stream processing","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔄 Starting stream processing"}}
[info] >  💥 Chat processing error: TypeError: Cannot read properties of undefined (reading 'Symbol(Symbol.asyncIterator)') {"user":"💥 Chat processing error: TypeError: Cannot read properties of undefined (reading 'Symbol(Symbol.asyncIterator)')","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💥 Chat processing error: TypeError: Cannot read properties of undefined (reading 'Symbol(Symbol.asyncIterator)')"}}
[info] >      at __asyncValues (C:\Users\Rob\Apps\not-alone\functions\lib\index.js:27:14) {"user":"    at __asyncValues (C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js:27:14)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at __asyncValues (C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js:27:14)"}}
[info] >      at C:\Users\Rob\Apps\not-alone\functions\lib\index.js:109:38 {"user":"    at C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js:109:38","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js:109:38"}}
[info] >      at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >      at async C:\Users\Rob\Apps\not-alone\functions\node_modules\firebase-functions\lib\common\providers\https.js:467:26 {"user":"    at async C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at async C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26"}}
[info] >      at async runFunction (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:506:9) {"user":"    at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)"}}
[info] >      at async runHTTPS (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:531:5) {"user":"    at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)"}}
[info] >      at async C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:694:21 {"user":"    at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21"}}
[debug] [2024-11-12T22:22:33.428Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 1622.6237999999998ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 1622.6237999999998ms"}}
[debug] [2024-11-12T22:22:33.430Z] [worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: IDLE"}}
[debug] [2024-11-12T22:22:33.430Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:22:33.430Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:22:33.431Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:23:41.731Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-12T22:23:42.744Z] Validating nodejs source
[debug] [2024-11-12T22:23:43.671Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:23:43.671Z] Building nodejs source
[debug] [2024-11-12T22:23:43.671Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:23:43.673Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:23:43.681Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8769

[debug] [2024-11-12T22:23:44.343Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:23:48.368Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:23:48.368Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:23:48.369Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-12T22:23:48.369Z] [worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: FINISHING"}}
[debug] [2024-11-12T22:23:48.381Z] [worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: exited"}}
[debug] [2024-11-12T22:23:48.381Z] [worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-f533725e-1360-45d8-9a62-ef7ff7b39ec2]: FINISHED"}}
[debug] [2024-11-12T22:24:12.493Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-12T22:24:12.493Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-12T22:24:13.503Z] Validating nodejs source
[debug] [2024-11-12T22:24:14.500Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:24:14.500Z] Building nodejs source
[debug] [2024-11-12T22:24:14.500Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:24:14.502Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:24:14.513Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8862

[debug] [2024-11-12T22:24:15.244Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:24:19.127Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:24:19.127Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:24:19.127Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:24:19.127Z"],"workRunningCount":1}
[debug] [2024-11-12T22:24:19.127Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:24:19.129Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:24:19.129Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:24:19.129Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-12T22:24:19.138Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-12T22:24:19.138Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-12T22:24:19.279Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:24:19.280Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:24:20.888Z] [runtime-status] [26416] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26416] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:24:20.889Z] [runtime-status] [26416] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26416] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:24:20.890Z] [runtime-status] [26416] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26416] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-12T22:24:20.890Z] [runtime-status] [26416] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26416] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-12T22:24:20.891Z] [runtime-status] [26416] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26416] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:24:21.230Z] [runtime-status] [26416] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26416] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-12T22:24:21.230Z] [runtime-status] [26416] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26416] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-12T22:24:21.231Z] [runtime-status] [26416] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26416] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:24:21.238Z] [runtime-status] [26416] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26416] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:24:21.242Z] [runtime-status] [26416] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26416] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:24:21.242Z] [runtime-status] [26416] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26416] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2024-11-12T22:24:21.344Z] [runtime-status] [26416] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26416] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-12T22:24:21.344Z] [runtime-status] [26416] Listening to port: \\?\pipe\fire_emu_44b82d4e87e8f057 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26416] Listening to port: \\\\?\\pipe\\fire_emu_44b82d4e87e8f057"}}
[debug] [2024-11-12T22:24:21.440Z] [worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: IDLE"}}
[debug] [2024-11-12T22:24:21.441Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:24:21.442Z] [worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: BUSY"}}
[debug] [2024-11-12T22:24:21.446Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4.0935ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4.0935ms"}}
[debug] [2024-11-12T22:24:21.446Z] [worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: IDLE"}}
[debug] [2024-11-12T22:24:21.447Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:24:21.447Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:24:21.447Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:24:21.448Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:24:21.448Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:24:21.448Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:24:21.448Z"],"workRunningCount":1}
[debug] [2024-11-12T22:24:21.448Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:24:21.449Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:24:21.450Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:24:21.450Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:24:21.451Z] [worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'hello', chatId: 'default-chat' } {"user":"  data: { message: 'hello', chatId: 'default-chat' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'hello', chatId: 'default-chat' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 5, {"user":"  messageLength: 5,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 5,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: default-chat {"user":"🆕 Creating new chat session: default-chat","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: default-chat"}}
[info] >  📝 Chat session created: { chatId: 'default-chat', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'default-chat', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'default-chat', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  🔄 Processing response {"user":"🔄 Processing response","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔄 Processing response"}}
[info] >  📦 Received response: { length: 57 } {"user":"📦 Received response: { length: 57 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Received response: { length: 57 }"}}
[info] >  ✅ Stream complete: { {"user":"✅ Stream complete: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Stream complete: {"}}
[info] >    totalChunks: 1, {"user":"  totalChunks: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalChunks: 1,"}}
[info] >    finalLength: 57, {"user":"  finalLength: 57,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   finalLength: 57,"}}
[info] >    timestamp: '2024-11-12T22:24:23.270Z' {"user":"  timestamp: '2024-11-12T22:24:23.270Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:24:23.270Z'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📤 Sending final response: { {"user":"📤 Sending final response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending final response: {"}}
[info] >    message: 'Hello. How can I help you with your relationships today?\n', {"user":"  message: 'Hello. How can I help you with your relationships today?\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Hello. How can I help you with your relationships today?\\n',"}}
[info] >    userMessage: 'hello', {"user":"  userMessage: 'hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hello',"}}
[info] >    timestamp: '2024-11-12T22:24:23.270Z', {"user":"  timestamp: '2024-11-12T22:24:23.270Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:24:23.270Z',"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat', {"user":"  chatId: 'default-chat',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat',"}}
[info] >    chunks: [ 'Hello. How can I help you with your relationships today?\n' ] {"user":"  chunks: [ 'Hello. How can I help you with your relationships today?\\n' ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunks: [ 'Hello. How can I help you with your relationships today?\\n' ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:24:23.283Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 1833.0354ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 1833.0354ms"}}
[debug] [2024-11-12T22:24:23.284Z] [worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: IDLE"}}
[debug] [2024-11-12T22:24:23.285Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:24:23.285Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:24:23.285Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:24:50.238Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:24:50.238Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:24:50.238Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:24:50.238Z"],"workRunningCount":1}
[debug] [2024-11-12T22:24:50.238Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:24:50.240Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:24:50.240Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:24:50.241Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:24:50.241Z] [worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: BUSY"}}
[debug] [2024-11-12T22:24:50.244Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2.7155ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2.7155ms"}}
[debug] [2024-11-12T22:24:50.245Z] [worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: IDLE"}}
[debug] [2024-11-12T22:24:50.245Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:24:50.245Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:24:50.245Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:24:50.246Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:24:50.246Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:24:50.246Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:24:50.246Z"],"workRunningCount":1}
[debug] [2024-11-12T22:24:50.246Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:24:50.248Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:24:50.248Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:24:50.248Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:24:50.249Z] [worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'understand my emotions', chatId: 'default-chat' } {"user":"  data: { message: 'understand my emotions', chatId: 'default-chat' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'understand my emotions', chatId: 'default-chat' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 22, {"user":"  messageLength: 22,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 22,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: understand my emotions {"user":"💬 Sending message to Gemini: understand my emotions","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: understand my emotions"}}
[info] >  🔄 Processing response {"user":"🔄 Processing response","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔄 Processing response"}}
[info] >  📦 Received response: { length: 800 } {"user":"📦 Received response: { length: 800 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Received response: { length: 800 }"}}
[info] >  ✅ Stream complete: { {"user":"✅ Stream complete: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Stream complete: {"}}
[info] >    totalChunks: 1, {"user":"  totalChunks: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalChunks: 1,"}}
[info] >    finalLength: 800, {"user":"  finalLength: 800,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   finalLength: 800,"}}
[info] >    timestamp: '2024-11-12T22:24:54.295Z' {"user":"  timestamp: '2024-11-12T22:24:54.295Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:24:54.295Z'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:24:54.302Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4052.9448ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4052.9448ms"}}
[debug] [2024-11-12T22:24:54.303Z] [worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: IDLE"}}
[debug] [2024-11-12T22:24:54.303Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:24:54.303Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:24:54.303Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  📤 Sending final response: { {"user":"📤 Sending final response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending final response: {"}}
[info] >    message: 'Understanding your emotions is a crucial step toward improving your relationships. To help you with this, I need some more information.  Tell me:\n' + {"user":"  message: 'Understanding your emotions is a crucial step toward improving your relationships. To help you with this, I need some more information.  Tell me:\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Understanding your emotions is a crucial step toward improving your relationships. To help you with this, I need some more information.  Tell me:\\n' +"}}
[info] >      '\n' + {"user":"    '\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '\\n' +"}}
[info] >      '* **What kind of relationships are you thinking about?** (Romantic, familial, platonic friendships, work relationships etc.)\n' + {"user":"    '* **What kind of relationships are you thinking about?** (Romantic, familial, platonic friendships, work relationships etc.)\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '* **What kind of relationships are you thinking about?** (Romantic, familial, platonic friendships, work relationships etc.)\\n' +"}}
[info] >      '* **What specific emotions are you struggling to understand or manage?** (e.g., anger, sadness, jealousy, anxiety, confusion)\n' + {"user":"    '* **What specific emotions are you struggling to understand or manage?** (e.g., anger, sadness, jealousy, anxiety, confusion)\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '* **What specific emotions are you struggling to understand or manage?** (e.g., anger, sadness, jealousy, anxiety, confusion)\\n' +"}}
[info] >      '* **Are there any specific situations or interactions that trigger these emotions?**  Providing examples will be helpful.\n' + {"user":"    '* **Are there any specific situations or interactions that trigger these emotions?**  Providing examples will be helpful.\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '* **Are there any specific situations or interactions that trigger these emotions?**  Providing examples will be helpful.\\n' +"}}
[info] >      '* **What have you already tried to understand your emotions?**  Have you kept a journal, talked to someone, or tried any other strategies?\n' + {"user":"    '* **What have you already tried to understand your emotions?**  Have you kept a journal, talked to someone, or tried any other strategies?\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '* **What have you already tried to understand your emotions?**  Have you kept a journal, talked to someone, or tried any other strategies?\\n' +"}}
[info] >      '\n' + {"user":"    '\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '\\n' +"}}
[info] >      "The more detail you provide, the better I can assist you.  Remember, there's no judgment here – just a safe space to explore your feelings.\n", {"user":"    \"The more detail you provide, the better I can assist you.  Remember, there's no judgment here – just a safe space to explore your feelings.\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"The more detail you provide, the better I can assist you.  Remember, there's no judgment here – just a safe space to explore your feelings.\\n\","}}
[info] >    userMessage: 'understand my emotions', {"user":"  userMessage: 'understand my emotions',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'understand my emotions',"}}
[info] >    timestamp: '2024-11-12T22:24:54.295Z', {"user":"  timestamp: '2024-11-12T22:24:54.295Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:24:54.295Z',"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat', {"user":"  chatId: 'default-chat',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat',"}}
[info] >    chunks: [ {"user":"  chunks: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunks: ["}}
[info] >      'Understanding your emotions is a crucial step toward improving your relationships. To help you with this, I need some more information.  Tell me:\n' + {"user":"    'Understanding your emotions is a crucial step toward improving your relationships. To help you with this, I need some more information.  Tell me:\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'Understanding your emotions is a crucial step toward improving your relationships. To help you with this, I need some more information.  Tell me:\\n' +"}}
[info] >        '\n' + {"user":"      '\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       '\\n' +"}}
[info] >        '* **What kind of relationships are you thinking about?** (Romantic, familial, platonic friendships, work relationships etc.)\n' + {"user":"      '* **What kind of relationships are you thinking about?** (Romantic, familial, platonic friendships, work relationships etc.)\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       '* **What kind of relationships are you thinking about?** (Romantic, familial, platonic friendships, work relationships etc.)\\n' +"}}
[info] >        '* **What specific emotions are you struggling to understand or manage?** (e.g., anger, sadness, jealousy, anxiety, confusion)\n' + {"user":"      '* **What specific emotions are you struggling to understand or manage?** (e.g., anger, sadness, jealousy, anxiety, confusion)\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       '* **What specific emotions are you struggling to understand or manage?** (e.g., anger, sadness, jealousy, anxiety, confusion)\\n' +"}}
[info] >        '* **Are there any specific situations or interactions that trigger these emotions?**  Providing examples will be helpful.\n' + {"user":"      '* **Are there any specific situations or interactions that trigger these emotions?**  Providing examples will be helpful.\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       '* **Are there any specific situations or interactions that trigger these emotions?**  Providing examples will be helpful.\\n' +"}}
[info] >        '* **What have you already tried to understand your emotions?**  Have you kept a journal, talked to someone, or tried any other strategies?\n' + {"user":"      '* **What have you already tried to understand your emotions?**  Have you kept a journal, talked to someone, or tried any other strategies?\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       '* **What have you already tried to understand your emotions?**  Have you kept a journal, talked to someone, or tried any other strategies?\\n' +"}}
[info] >        '\n' + {"user":"      '\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       '\\n' +"}}
[info] >        "The more detail you provide, the better I can assist you.  Remember, there's no judgment here – just a safe space to explore your feelings.\n" {"user":"The more detail you provide, the better I can assist you.  Remember, there's no judgment here – just a safe space to explore your feelings.\n","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"The more detail you provide, the better I can assist you.  Remember, there's no judgment here – just a safe space to explore your feelings.\\n\""}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:28:23.692Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-12T22:28:24.705Z] Validating nodejs source
[debug] [2024-11-12T22:28:25.877Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:28:25.877Z] Building nodejs source
[debug] [2024-11-12T22:28:25.877Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:28:25.878Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:28:25.886Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8281

[debug] [2024-11-12T22:28:26.524Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:28:30.549Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:28:30.550Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:28:30.550Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-12T22:28:30.550Z] [worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: FINISHING"}}
[debug] [2024-11-12T22:28:30.564Z] [worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: exited"}}
[debug] [2024-11-12T22:28:30.565Z] [worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e2ecf684-7ccb-402a-b8a0-3cb50d884c83]: FINISHED"}}
[debug] [2024-11-12T22:29:47.089Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-12T22:29:47.089Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-12T22:29:48.090Z] Validating nodejs source
[debug] [2024-11-12T22:29:49.279Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:29:49.279Z] Building nodejs source
[debug] [2024-11-12T22:29:49.279Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:29:49.280Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:29:49.292Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8233

[debug] [2024-11-12T22:29:50.020Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:29:54.052Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:29:54.053Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:30:14.795Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:30:14.795Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:30:14.795Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:30:14.795Z"],"workRunningCount":1}
[debug] [2024-11-12T22:30:14.795Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:30:14.797Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:30:14.797Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:30:14.797Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-12T22:30:14.806Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-12T22:30:14.806Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-12T22:30:16.597Z] [runtime-status] [28556] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28556] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:30:16.599Z] [runtime-status] [28556] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28556] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:30:16.599Z] [runtime-status] [28556] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28556] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-12T22:30:16.600Z] [runtime-status] [28556] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28556] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-12T22:30:16.600Z] [runtime-status] [28556] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28556] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:30:16.923Z] [runtime-status] [28556] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28556] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-12T22:30:16.923Z] [runtime-status] [28556] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28556] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-12T22:30:16.924Z] [runtime-status] [28556] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28556] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:30:16.929Z] [runtime-status] [28556] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28556] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:30:16.931Z] [runtime-status] [28556] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28556] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:30:16.932Z] [runtime-status] [28556] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28556] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2024-11-12T22:30:17.036Z] [runtime-status] [28556] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28556] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-12T22:30:17.036Z] [runtime-status] [28556] Listening to port: \\?\pipe\fire_emu_d3749ccb6737dbcb {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28556] Listening to port: \\\\?\\pipe\\fire_emu_d3749ccb6737dbcb"}}
[debug] [2024-11-12T22:30:17.133Z] [worker-us-central1-processChat-fb615859-5b7b-487c-b7e6-0bb23f6cd3db]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-fb615859-5b7b-487c-b7e6-0bb23f6cd3db]: IDLE"}}
[debug] [2024-11-12T22:30:17.134Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:30:17.134Z] [worker-us-central1-processChat-fb615859-5b7b-487c-b7e6-0bb23f6cd3db]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-fb615859-5b7b-487c-b7e6-0bb23f6cd3db]: BUSY"}}
[debug] [2024-11-12T22:30:17.138Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4.2753ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4.2753ms"}}
[debug] [2024-11-12T22:30:17.139Z] [worker-us-central1-processChat-fb615859-5b7b-487c-b7e6-0bb23f6cd3db]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-fb615859-5b7b-487c-b7e6-0bb23f6cd3db]: IDLE"}}
[debug] [2024-11-12T22:30:17.139Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:30:17.139Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:30:17.140Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:30:17.141Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:30:17.141Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:30:17.141Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:30:17.141Z"],"workRunningCount":1}
[debug] [2024-11-12T22:30:17.141Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:30:17.141Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:30:17.142Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:30:17.142Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:30:17.142Z] [worker-us-central1-processChat-fb615859-5b7b-487c-b7e6-0bb23f6cd3db]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-fb615859-5b7b-487c-b7e6-0bb23f6cd3db]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'hello', chatId: 'default-chat' } {"user":"  data: { message: 'hello', chatId: 'default-chat' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'hello', chatId: 'default-chat' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 5, {"user":"  messageLength: 5,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 5,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: default-chat {"user":"🆕 Creating new chat session: default-chat","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: default-chat"}}
[info] >  📝 Chat session created: { chatId: 'default-chat', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'default-chat', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'default-chat', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  🔄 Starting stream processing {"user":"🔄 Starting stream processing","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔄 Starting stream processing"}}
[info] >  💥 Chat processing error: TypeError: Cannot read properties of undefined (reading 'Symbol(Symbol.asyncIterator)') {"user":"💥 Chat processing error: TypeError: Cannot read properties of undefined (reading 'Symbol(Symbol.asyncIterator)')","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💥 Chat processing error: TypeError: Cannot read properties of undefined (reading 'Symbol(Symbol.asyncIterator)')"}}
[info] >      at __asyncValues (C:\Users\Rob\Apps\not-alone\functions\lib\index.js:27:14) {"user":"    at __asyncValues (C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js:27:14)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at __asyncValues (C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js:27:14)"}}
[info] >      at C:\Users\Rob\Apps\not-alone\functions\lib\index.js:109:38 {"user":"    at C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js:109:38","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js:109:38"}}
[info] >      at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >      at async C:\Users\Rob\Apps\not-alone\functions\node_modules\firebase-functions\lib\common\providers\https.js:467:26 {"user":"    at async C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at async C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26"}}
[info] >      at async runFunction (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:506:9) {"user":"    at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)"}}
[info] >      at async runHTTPS (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:531:5) {"user":"    at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)"}}
[info] >      at async C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:694:21 {"user":"    at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21"}}
[debug] [2024-11-12T22:30:21.427Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4284.6458ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4284.6458ms"}}
[debug] [2024-11-12T22:30:21.428Z] [worker-us-central1-processChat-fb615859-5b7b-487c-b7e6-0bb23f6cd3db]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-fb615859-5b7b-487c-b7e6-0bb23f6cd3db]: IDLE"}}
[debug] [2024-11-12T22:30:21.428Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:30:21.428Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:30:21.428Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:34:16.653Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-12T22:34:17.659Z] Validating nodejs source
[debug] [2024-11-12T22:34:18.781Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:34:18.782Z] Building nodejs source
[debug] [2024-11-12T22:34:18.782Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:34:18.784Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:34:18.800Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8968

[debug] [2024-11-12T22:34:19.705Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:34:23.737Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:34:23.738Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:34:23.740Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-12T22:34:23.740Z] [worker-us-central1-processChat-fb615859-5b7b-487c-b7e6-0bb23f6cd3db]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-fb615859-5b7b-487c-b7e6-0bb23f6cd3db]: FINISHING"}}
[debug] [2024-11-12T22:34:23.758Z] [worker-us-central1-processChat-fb615859-5b7b-487c-b7e6-0bb23f6cd3db]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-fb615859-5b7b-487c-b7e6-0bb23f6cd3db]: exited"}}
[debug] [2024-11-12T22:34:23.758Z] [worker-us-central1-processChat-fb615859-5b7b-487c-b7e6-0bb23f6cd3db]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-fb615859-5b7b-487c-b7e6-0bb23f6cd3db]: FINISHED"}}
[debug] [2024-11-12T22:35:02.273Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-12T22:35:02.274Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-12T22:35:03.281Z] Validating nodejs source
[debug] [2024-11-12T22:35:04.505Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:35:04.505Z] Building nodejs source
[debug] [2024-11-12T22:35:04.505Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:35:04.506Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:35:04.516Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8029

[debug] [2024-11-12T22:35:05.437Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:35:09.466Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:35:09.467Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:35:10.420Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:35:10.420Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:35:10.420Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:35:10.420Z"],"workRunningCount":1}
[debug] [2024-11-12T22:35:10.420Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:35:10.422Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:35:10.422Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:35:10.422Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-12T22:35:10.430Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-12T22:35:10.430Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-12T22:35:12.098Z] [runtime-status] [33300] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33300] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:35:12.100Z] [runtime-status] [33300] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33300] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:35:12.100Z] [runtime-status] [33300] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33300] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-12T22:35:12.101Z] [runtime-status] [33300] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33300] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-12T22:35:12.102Z] [runtime-status] [33300] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33300] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:35:12.428Z] [runtime-status] [33300] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33300] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-12T22:35:12.428Z] [runtime-status] [33300] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33300] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-12T22:35:12.429Z] [runtime-status] [33300] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33300] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:35:12.434Z] [runtime-status] [33300] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33300] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:35:12.437Z] [runtime-status] [33300] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33300] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:35:12.437Z] [runtime-status] [33300] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33300] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2024-11-12T22:35:12.532Z] [runtime-status] [33300] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33300] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-12T22:35:12.532Z] [runtime-status] [33300] Listening to port: \\?\pipe\fire_emu_773fd3fc26f441a9 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33300] Listening to port: \\\\?\\pipe\\fire_emu_773fd3fc26f441a9"}}
[debug] [2024-11-12T22:35:12.627Z] [worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: IDLE"}}
[debug] [2024-11-12T22:35:12.627Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:35:12.628Z] [worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: BUSY"}}
[debug] [2024-11-12T22:35:12.631Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 3.7873ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 3.7873ms"}}
[debug] [2024-11-12T22:35:12.632Z] [worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: IDLE"}}
[debug] [2024-11-12T22:35:12.632Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:35:12.632Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:35:12.632Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:35:12.633Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:35:12.633Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:35:12.634Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:35:12.633Z"],"workRunningCount":1}
[debug] [2024-11-12T22:35:12.634Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:35:12.634Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:35:12.634Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:35:12.634Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:35:12.635Z] [worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'hello', chatId: 'default-chat' } {"user":"  data: { message: 'hello', chatId: 'default-chat' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'hello', chatId: 'default-chat' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 5, {"user":"  messageLength: 5,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 5,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: default-chat {"user":"🆕 Creating new chat session: default-chat","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: default-chat"}}
[info] >  📝 Chat session created: { chatId: 'default-chat', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'default-chat', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'default-chat', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  🔄 Starting stream processing {"user":"🔄 Starting stream processing","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔄 Starting stream processing"}}
[info] >  📦 Sending chunk: { chunkLength: 5, totalLength: 5 } {"user":"📦 Sending chunk: { chunkLength: 5, totalLength: 5 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: { chunkLength: 5, totalLength: 5 }"}}
[info] >  📦 Sending chunk: { chunkLength: 60, totalLength: 65 } {"user":"📦 Sending chunk: { chunkLength: 60, totalLength: 65 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: { chunkLength: 60, totalLength: 65 }"}}
[info] >  📦 Sending chunk: { chunkLength: 102, totalLength: 167 } {"user":"📦 Sending chunk: { chunkLength: 102, totalLength: 167 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: { chunkLength: 102, totalLength: 167 }"}}
[info] >  📦 Sending chunk: { chunkLength: 35, totalLength: 202 } {"user":"📦 Sending chunk: { chunkLength: 35, totalLength: 202 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: { chunkLength: 35, totalLength: 202 }"}}
[info] >  ✅ Stream complete: { {"user":"✅ Stream complete: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Stream complete: {"}}
[info] >    totalChunks: 4, {"user":"  totalChunks: 4,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalChunks: 4,"}}
[info] >    finalLength: 202, {"user":"  finalLength: 202,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   finalLength: 202,"}}
[info] >    timestamp: '2024-11-12T22:35:15.115Z' {"user":"  timestamp: '2024-11-12T22:35:15.115Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:35:15.115Z'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:35:15.119Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2483.812ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2483.812ms"}}
[debug] [2024-11-12T22:35:15.120Z] [worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: IDLE"}}
[debug] [2024-11-12T22:35:15.120Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:35:15.120Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:35:15.120Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  📤 Sending final response: { {"user":"📤 Sending final response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending final response: {"}}
[info] >    message: "Hello! How can I help you today?  Are you looking for advice on a specific relationship, or are you interested in learning more about relationship dynamics in general?  Let me know what's on your mind.\n", {"user":"  message: \"Hello! How can I help you today?  Are you looking for advice on a specific relationship, or are you interested in learning more about relationship dynamics in general?  Let me know what's on your mind.\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: \"Hello! How can I help you today?  Are you looking for advice on a specific relationship, or are you interested in learning more about relationship dynamics in general?  Let me know what's on your mind.\\n\","}}
[info] >    userMessage: 'hello', {"user":"  userMessage: 'hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hello',"}}
[info] >    timestamp: '2024-11-12T22:35:15.115Z', {"user":"  timestamp: '2024-11-12T22:35:15.115Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:35:15.115Z',"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat', {"user":"  chatId: 'default-chat',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat',"}}
[info] >    chunks: [ {"user":"  chunks: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunks: ["}}
[info] >      'Hello', {"user":"    'Hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'Hello',"}}
[info] >      '! How can I help you today?  Are you looking for advice on a', {"user":"    '! How can I help you today?  Are you looking for advice on a',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '! How can I help you today?  Are you looking for advice on a',"}}
[info] >      ' specific relationship, or are you interested in learning more about relationship dynamics in general?', {"user":"    ' specific relationship, or are you interested in learning more about relationship dynamics in general?',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     ' specific relationship, or are you interested in learning more about relationship dynamics in general?',"}}
[info] >      "  Let me know what's on your mind.\n" {"user":"  Let me know what's on your mind.\n","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"  Let me know what's on your mind.\\n\""}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:38:06.619Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:38:06.619Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:38:06.619Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:38:06.619Z"],"workRunningCount":1}
[debug] [2024-11-12T22:38:06.619Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:38:06.621Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:38:06.621Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:38:06.622Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:38:06.622Z] [worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: BUSY"}}
[debug] [2024-11-12T22:38:06.625Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 3.0888ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 3.0888ms"}}
[debug] [2024-11-12T22:38:06.626Z] [worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: IDLE"}}
[debug] [2024-11-12T22:38:06.626Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:38:06.626Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:38:06.626Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:38:06.627Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:38:06.627Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:38:06.628Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:38:06.627Z"],"workRunningCount":1}
[debug] [2024-11-12T22:38:06.628Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:38:06.629Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:38:06.630Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:38:06.630Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:38:06.630Z] [worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'hello', chatId: 'default-chat' } {"user":"  data: { message: 'hello', chatId: 'default-chat' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'hello', chatId: 'default-chat' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 5, {"user":"  messageLength: 5,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 5,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[info] >  🔄 Starting stream processing {"user":"🔄 Starting stream processing","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔄 Starting stream processing"}}
[info] >  📦 Sending chunk: { chunkLength: 5, totalLength: 5 } {"user":"📦 Sending chunk: { chunkLength: 5, totalLength: 5 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: { chunkLength: 5, totalLength: 5 }"}}
[info] >  📦 Sending chunk: { chunkLength: 29, totalLength: 34 } {"user":"📦 Sending chunk: { chunkLength: 29, totalLength: 34 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: { chunkLength: 29, totalLength: 34 }"}}
[info] >  ✅ Stream complete: { {"user":"✅ Stream complete: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Stream complete: {"}}
[info] >    totalChunks: 2, {"user":"  totalChunks: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalChunks: 2,"}}
[info] >    finalLength: 34, {"user":"  finalLength: 34,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   finalLength: 34,"}}
[info] >    timestamp: '2024-11-12T22:38:08.110Z' {"user":"  timestamp: '2024-11-12T22:38:08.110Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:38:08.110Z'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:38:08.114Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 1484.0621ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 1484.0621ms"}}
[debug] [2024-11-12T22:38:08.115Z] [worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: IDLE"}}
[debug] [2024-11-12T22:38:08.115Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:38:08.115Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:38:08.115Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  📤 Sending final response: { {"user":"📤 Sending final response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending final response: {"}}
[info] >    message: 'Hello!  How can I help you today?\n', {"user":"  message: 'Hello!  How can I help you today?\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Hello!  How can I help you today?\\n',"}}
[info] >    userMessage: 'hello', {"user":"  userMessage: 'hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hello',"}}
[info] >    timestamp: '2024-11-12T22:38:08.110Z', {"user":"  timestamp: '2024-11-12T22:38:08.110Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:38:08.110Z',"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat', {"user":"  chatId: 'default-chat',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat',"}}
[info] >    chunks: [ 'Hello', '!  How can I help you today?\n' ] {"user":"  chunks: [ 'Hello', '!  How can I help you today?\\n' ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunks: [ 'Hello', '!  How can I help you today?\\n' ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:38:19.297Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:38:19.296Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:38:19.297Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:38:19.296Z"],"workRunningCount":1}
[debug] [2024-11-12T22:38:19.297Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:38:19.299Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:38:19.299Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:38:19.299Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:38:19.300Z] [worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: BUSY"}}
[debug] [2024-11-12T22:38:19.303Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2.9227ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2.9227ms"}}
[debug] [2024-11-12T22:38:19.304Z] [worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: IDLE"}}
[debug] [2024-11-12T22:38:19.304Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:38:19.304Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:38:19.304Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:38:19.305Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:38:19.305Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:38:19.305Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:38:19.305Z"],"workRunningCount":1}
[debug] [2024-11-12T22:38:19.306Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:38:19.308Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:38:19.308Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:38:19.308Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:38:19.309Z] [worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'hello', chatId: 'default-chat' } {"user":"  data: { message: 'hello', chatId: 'default-chat' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'hello', chatId: 'default-chat' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 5, {"user":"  messageLength: 5,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 5,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[info] >  🔄 Starting stream processing {"user":"🔄 Starting stream processing","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔄 Starting stream processing"}}
[info] >  📦 Sending chunk: { chunkLength: 5, totalLength: 5 } {"user":"📦 Sending chunk: { chunkLength: 5, totalLength: 5 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: { chunkLength: 5, totalLength: 5 }"}}
[info] >  📦 Sending chunk: { chunkLength: 85, totalLength: 90 } {"user":"📦 Sending chunk: { chunkLength: 85, totalLength: 90 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: { chunkLength: 85, totalLength: 90 }"}}
[info] >  📦 Sending chunk: { chunkLength: 41, totalLength: 131 } {"user":"📦 Sending chunk: { chunkLength: 41, totalLength: 131 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: { chunkLength: 41, totalLength: 131 }"}}
[info] >  ✅ Stream complete: { {"user":"✅ Stream complete: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Stream complete: {"}}
[info] >    totalChunks: 3, {"user":"  totalChunks: 3,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalChunks: 3,"}}
[info] >    finalLength: 131, {"user":"  finalLength: 131,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   finalLength: 131,"}}
[info] >    timestamp: '2024-11-12T22:38:20.934Z' {"user":"  timestamp: '2024-11-12T22:38:20.934Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:38:20.934Z'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:38:20.939Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 1630.5347000000002ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 1630.5347000000002ms"}}
[debug] [2024-11-12T22:38:20.940Z] [worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: IDLE"}}
[debug] [2024-11-12T22:38:20.940Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:38:20.940Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:38:20.940Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  📤 Sending final response: { {"user":"📤 Sending final response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending final response: {"}}
[info] >    message: "Hello there!  Is there something specific you'd like to talk about regarding relationships?  I'm here to listen and offer support.\n", {"user":"  message: \"Hello there!  Is there something specific you'd like to talk about regarding relationships?  I'm here to listen and offer support.\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: \"Hello there!  Is there something specific you'd like to talk about regarding relationships?  I'm here to listen and offer support.\\n\","}}
[info] >    userMessage: 'hello', {"user":"  userMessage: 'hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hello',"}}
[info] >    timestamp: '2024-11-12T22:38:20.934Z', {"user":"  timestamp: '2024-11-12T22:38:20.934Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:38:20.934Z',"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat', {"user":"  chatId: 'default-chat',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat',"}}
[info] >    chunks: [ {"user":"  chunks: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunks: ["}}
[info] >      'Hello', {"user":"    'Hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'Hello',"}}
[info] >      " there!  Is there something specific you'd like to talk about regarding relationships", {"user":"    \" there!  Is there something specific you'd like to talk about regarding relationships\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \" there!  Is there something specific you'd like to talk about regarding relationships\","}}
[info] >      "?  I'm here to listen and offer support.\n" {"user":"?  I'm here to listen and offer support.\n","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"?  I'm here to listen and offer support.\\n\""}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:40:33.472Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:40:33.472Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:40:33.472Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:40:33.472Z"],"workRunningCount":1}
[debug] [2024-11-12T22:40:33.473Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:40:33.474Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:40:33.474Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:40:33.475Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:40:33.476Z] [worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: BUSY"}}
[debug] [2024-11-12T22:40:33.477Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2.1054ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2.1054ms"}}
[debug] [2024-11-12T22:40:33.478Z] [worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: IDLE"}}
[debug] [2024-11-12T22:40:33.479Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:40:33.479Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:40:33.479Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:40:33.479Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:40:33.479Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:40:33.479Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:40:33.479Z"],"workRunningCount":1}
[debug] [2024-11-12T22:40:33.479Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:40:33.481Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:40:33.481Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:40:33.481Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:40:33.482Z] [worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'hello', chatId: 'default-chat' } {"user":"  data: { message: 'hello', chatId: 'default-chat' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'hello', chatId: 'default-chat' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 5, {"user":"  messageLength: 5,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 5,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[info] >  🔄 Starting stream processing {"user":"🔄 Starting stream processing","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔄 Starting stream processing"}}
[info] >  📦 Sending chunk: { chunkLength: 5, totalLength: 5 } {"user":"📦 Sending chunk: { chunkLength: 5, totalLength: 5 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: { chunkLength: 5, totalLength: 5 }"}}
[info] >  📦 Sending chunk: { chunkLength: 35, totalLength: 40 } {"user":"📦 Sending chunk: { chunkLength: 35, totalLength: 40 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: { chunkLength: 35, totalLength: 40 }"}}
[info] >  📦 Sending chunk: { chunkLength: 68, totalLength: 108 } {"user":"📦 Sending chunk: { chunkLength: 68, totalLength: 108 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: { chunkLength: 68, totalLength: 108 }"}}
[info] >  📦 Sending chunk: { chunkLength: 38, totalLength: 146 } {"user":"📦 Sending chunk: { chunkLength: 38, totalLength: 146 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: { chunkLength: 38, totalLength: 146 }"}}
[info] >  ✅ Stream complete: { {"user":"✅ Stream complete: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Stream complete: {"}}
[info] >    totalChunks: 4, {"user":"  totalChunks: 4,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalChunks: 4,"}}
[info] >    finalLength: 146, {"user":"  finalLength: 146,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   finalLength: 146,"}}
[info] >    timestamp: '2024-11-12T22:40:35.340Z' {"user":"  timestamp: '2024-11-12T22:40:35.340Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:40:35.340Z'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:40:35.344Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 1861.3944999999999ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 1861.3944999999999ms"}}
[debug] [2024-11-12T22:40:35.344Z] [worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: IDLE"}}
[debug] [2024-11-12T22:40:35.344Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:40:35.344Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:40:35.345Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  📤 Sending final response: { {"user":"📤 Sending final response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending final response: {"}}
[info] >    message: `Hello!  It's nice to "meet" you.  What's on your mind today?  Are you looking for advice, or just wanting to chat about relationships in general?\n`, {"user":"  message: `Hello!  It's nice to \"meet\" you.  What's on your mind today?  Are you looking for advice, or just wanting to chat about relationships in general?\\n`,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: `Hello!  It's nice to \"meet\" you.  What's on your mind today?  Are you looking for advice, or just wanting to chat about relationships in general?\\n`,"}}
[info] >    userMessage: 'hello', {"user":"  userMessage: 'hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hello',"}}
[info] >    timestamp: '2024-11-12T22:40:35.340Z', {"user":"  timestamp: '2024-11-12T22:40:35.340Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:40:35.340Z',"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat', {"user":"  chatId: 'default-chat',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat',"}}
[info] >    chunks: [ {"user":"  chunks: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunks: ["}}
[info] >      'Hello', {"user":"    'Hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'Hello',"}}
[info] >      `!  It's nice to "meet" you.  What's`, {"user":"    `!  It's nice to \"meet\" you.  What's`,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     `!  It's nice to \"meet\" you.  What's`,"}}
[info] >      ' on your mind today?  Are you looking for advice, or just wanting to', {"user":"    ' on your mind today?  Are you looking for advice, or just wanting to',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     ' on your mind today?  Are you looking for advice, or just wanting to',"}}
[info] >      ' chat about relationships in general?\n' {"user":"    ' chat about relationships in general?\\n'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     ' chat about relationships in general?\\n'"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:42:49.990Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-12T22:42:50.999Z] Validating nodejs source
[debug] [2024-11-12T22:42:52.065Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:42:52.065Z] Building nodejs source
[debug] [2024-11-12T22:42:52.065Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:42:52.067Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:42:52.077Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8803

[debug] [2024-11-12T22:42:52.840Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:42:56.870Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:42:56.871Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:42:56.872Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-12T22:42:56.872Z] [worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: FINISHING"}}
[debug] [2024-11-12T22:42:56.885Z] [worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: exited"}}
[debug] [2024-11-12T22:42:56.885Z] [worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-be32f3dc-d756-4f13-aa3e-5ceb7fe09c9b]: FINISHED"}}
[debug] [2024-11-12T22:43:11.960Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-12T22:43:11.961Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-12T22:43:12.966Z] Validating nodejs source
[debug] [2024-11-12T22:43:13.903Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:43:13.903Z] Building nodejs source
[debug] [2024-11-12T22:43:13.903Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:43:13.904Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:43:13.914Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8922

[debug] [2024-11-12T22:43:14.574Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:43:18.602Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:43:18.603Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:44:13.612Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:44:13.612Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:44:13.612Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:44:13.612Z"],"workRunningCount":1}
[debug] [2024-11-12T22:44:13.612Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:44:13.615Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:44:13.615Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:44:13.615Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-12T22:44:13.625Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-12T22:44:13.625Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-12T22:44:15.187Z] [runtime-status] [23996] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23996] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:44:15.189Z] [runtime-status] [23996] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23996] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:44:15.189Z] [runtime-status] [23996] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23996] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-12T22:44:15.189Z] [runtime-status] [23996] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23996] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-12T22:44:15.190Z] [runtime-status] [23996] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23996] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:44:15.476Z] [runtime-status] [23996] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23996] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-12T22:44:15.477Z] [runtime-status] [23996] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23996] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-12T22:44:15.477Z] [runtime-status] [23996] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23996] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:44:15.482Z] [runtime-status] [23996] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23996] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:44:15.484Z] [runtime-status] [23996] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23996] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:44:15.485Z] [runtime-status] [23996] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23996] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2024-11-12T22:44:15.573Z] [runtime-status] [23996] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23996] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-12T22:44:15.573Z] [runtime-status] [23996] Listening to port: \\?\pipe\fire_emu_a00cd5c147145cbe {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23996] Listening to port: \\\\?\\pipe\\fire_emu_a00cd5c147145cbe"}}
[debug] [2024-11-12T22:44:15.624Z] [worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: IDLE"}}
[debug] [2024-11-12T22:44:15.624Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:44:15.625Z] [worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: BUSY"}}
[debug] [2024-11-12T22:44:15.629Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4.3954ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4.3954ms"}}
[debug] [2024-11-12T22:44:15.630Z] [worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: IDLE"}}
[debug] [2024-11-12T22:44:15.630Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:44:15.630Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:44:15.630Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:44:15.631Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:44:15.631Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:44:15.631Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:44:15.631Z"],"workRunningCount":1}
[debug] [2024-11-12T22:44:15.631Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:44:15.632Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:44:15.632Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:44:15.632Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:44:15.633Z] [worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'hello', chatId: 'default-chat' } {"user":"  data: { message: 'hello', chatId: 'default-chat' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'hello', chatId: 'default-chat' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 5, {"user":"  messageLength: 5,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 5,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: default-chat {"user":"🆕 Creating new chat session: default-chat","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: default-chat"}}
[info] >  📝 Chat session created: { chatId: 'default-chat', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'default-chat', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'default-chat', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  🔄 Starting stream processing {"user":"🔄 Starting stream processing","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔄 Starting stream processing"}}
[info] >  Raw chunk received: { {"user":"Raw chunk received: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Raw chunk received: {"}}
[info] >    candidates: [ { content: [Object], index: 0 } ], {"user":"  candidates: [ { content: [Object], index: 0 } ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   candidates: [ { content: [Object], index: 0 } ],"}}
[info] >    modelVersion: 'gemini-1.5-flash-002' {"user":"  modelVersion: 'gemini-1.5-flash-002'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   modelVersion: 'gemini-1.5-flash-002'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  Extracted chunk text: Hello {"user":"Extracted chunk text: Hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Extracted chunk text: Hello"}}
[info] >  📦 Sending chunk: { chunkText: 'Hello', chunkLength: 5, totalLength: 5, totalChunks: 1 } {"user":"📦 Sending chunk: { chunkText: 'Hello', chunkLength: 5, totalLength: 5, totalChunks: 1 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: { chunkText: 'Hello', chunkLength: 5, totalLength: 5, totalChunks: 1 }"}}
[info] >  Raw chunk received: { {"user":"Raw chunk received: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Raw chunk received: {"}}
[info] >    candidates: [ { content: [Object], index: 0 } ], {"user":"  candidates: [ { content: [Object], index: 0 } ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   candidates: [ { content: [Object], index: 0 } ],"}}
[info] >    modelVersion: 'gemini-1.5-flash-002' {"user":"  modelVersion: 'gemini-1.5-flash-002'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   modelVersion: 'gemini-1.5-flash-002'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  Extracted chunk text: !  Tell me more about what's on your mind regarding your relationships. {"user":"Extracted chunk text: !  Tell me more about what's on your mind regarding your relationships.","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Extracted chunk text: !  Tell me more about what's on your mind regarding your relationships."}}
[info] >  📦 Sending chunk: { {"user":"📦 Sending chunk: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: {"}}
[info] >    chunkText: "!  Tell me more about what's on your mind regarding your relationships.", {"user":"  chunkText: \"!  Tell me more about what's on your mind regarding your relationships.\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunkText: \"!  Tell me more about what's on your mind regarding your relationships.\","}}
[info] >    chunkLength: 71, {"user":"  chunkLength: 71,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunkLength: 71,"}}
[info] >    totalLength: 76, {"user":"  totalLength: 76,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalLength: 76,"}}
[info] >    totalChunks: 2 {"user":"  totalChunks: 2","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalChunks: 2"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  Raw chunk received: { {"user":"Raw chunk received: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Raw chunk received: {"}}
[info] >    candidates: [ { content: [Object], finishReason: 'STOP', index: 0 } ], {"user":"  candidates: [ { content: [Object], finishReason: 'STOP', index: 0 } ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   candidates: [ { content: [Object], finishReason: 'STOP', index: 0 } ],"}}
[info] >    usageMetadata: { {"user":"  usageMetadata: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   usageMetadata: {"}}
[info] >      promptTokenCount: 69, {"user":"    promptTokenCount: 69,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     promptTokenCount: 69,"}}
[info] >      candidatesTokenCount: 29, {"user":"    candidatesTokenCount: 29,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     candidatesTokenCount: 29,"}}
[info] >      totalTokenCount: 98 {"user":"    totalTokenCount: 98","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     totalTokenCount: 98"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    modelVersion: 'gemini-1.5-flash-002' {"user":"  modelVersion: 'gemini-1.5-flash-002'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   modelVersion: 'gemini-1.5-flash-002'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  Extracted chunk text:   To best help you, I need some context. {"user":"Extracted chunk text:   To best help you, I need some context.","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Extracted chunk text:   To best help you, I need some context."}}
[info] >   {"user":"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m "}}
[info] >  📦 Sending chunk: { {"user":"📦 Sending chunk: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: {"}}
[info] >    chunkText: '  To best help you, I need some context.\n', {"user":"  chunkText: '  To best help you, I need some context.\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunkText: '  To best help you, I need some context.\\n',"}}
[info] >    chunkLength: 41, {"user":"  chunkLength: 41,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunkLength: 41,"}}
[info] >    totalLength: 117, {"user":"  totalLength: 117,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalLength: 117,"}}
[info] >    totalChunks: 3 {"user":"  totalChunks: 3","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalChunks: 3"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Stream complete: { {"user":"✅ Stream complete: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Stream complete: {"}}
[info] >    totalChunks: 3, {"user":"  totalChunks: 3,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalChunks: 3,"}}
[info] >    finalLength: 117, {"user":"  finalLength: 117,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   finalLength: 117,"}}
[info] >    timestamp: '2024-11-12T22:44:18.053Z' {"user":"  timestamp: '2024-11-12T22:44:18.053Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:44:18.053Z'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:44:18.057Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2424.4453ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2424.4453ms"}}
[debug] [2024-11-12T22:44:18.058Z] [worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: IDLE"}}
[debug] [2024-11-12T22:44:18.058Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:44:18.058Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:44:18.058Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  📤 Sending final response: { {"user":"📤 Sending final response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending final response: {"}}
[info] >    message: "Hello!  Tell me more about what's on your mind regarding your relationships.  To best help you, I need some context.\n", {"user":"  message: \"Hello!  Tell me more about what's on your mind regarding your relationships.  To best help you, I need some context.\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: \"Hello!  Tell me more about what's on your mind regarding your relationships.  To best help you, I need some context.\\n\","}}
[info] >    userMessage: 'hello', {"user":"  userMessage: 'hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hello',"}}
[info] >    timestamp: '2024-11-12T22:44:18.053Z', {"user":"  timestamp: '2024-11-12T22:44:18.053Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:44:18.053Z',"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat', {"user":"  chatId: 'default-chat',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat',"}}
[info] >    chunks: [ {"user":"  chunks: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunks: ["}}
[info] >      'Hello', {"user":"    'Hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'Hello',"}}
[info] >      "!  Tell me more about what's on your mind regarding your relationships.", {"user":"    \"!  Tell me more about what's on your mind regarding your relationships.\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"!  Tell me more about what's on your mind regarding your relationships.\","}}
[info] >      '  To best help you, I need some context.\n' {"user":"    '  To best help you, I need some context.\\n'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '  To best help you, I need some context.\\n'"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:44:25.104Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:44:25.104Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:44:25.104Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:44:25.104Z"],"workRunningCount":1}
[debug] [2024-11-12T22:44:25.104Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:44:25.106Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:44:25.106Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:44:25.106Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:44:25.107Z] [worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: BUSY"}}
[debug] [2024-11-12T22:44:25.110Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 3.2842ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 3.2842ms"}}
[debug] [2024-11-12T22:44:25.111Z] [worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: IDLE"}}
[debug] [2024-11-12T22:44:25.111Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:44:25.111Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:44:25.111Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:44:25.112Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:44:25.112Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:44:25.112Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:44:25.112Z"],"workRunningCount":1}
[debug] [2024-11-12T22:44:25.112Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:44:25.115Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:44:25.115Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:44:25.115Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:44:25.116Z] [worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'hello', chatId: 'default-chat' } {"user":"  data: { message: 'hello', chatId: 'default-chat' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'hello', chatId: 'default-chat' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 5, {"user":"  messageLength: 5,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 5,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[info] >  🔄 Starting stream processing {"user":"🔄 Starting stream processing","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔄 Starting stream processing"}}
[info] >  Raw chunk received: { {"user":"Raw chunk received: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Raw chunk received: {"}}
[info] >    candidates: [ { content: [Object], index: 0 } ], {"user":"  candidates: [ { content: [Object], index: 0 } ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   candidates: [ { content: [Object], index: 0 } ],"}}
[info] >    modelVersion: 'gemini-1.5-flash-002' {"user":"  modelVersion: 'gemini-1.5-flash-002'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   modelVersion: 'gemini-1.5-flash-002'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  Extracted chunk text: Hello {"user":"Extracted chunk text: Hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Extracted chunk text: Hello"}}
[info] >  📦 Sending chunk: { chunkText: 'Hello', chunkLength: 5, totalLength: 5, totalChunks: 1 } {"user":"📦 Sending chunk: { chunkText: 'Hello', chunkLength: 5, totalLength: 5, totalChunks: 1 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: { chunkText: 'Hello', chunkLength: 5, totalLength: 5, totalChunks: 1 }"}}
[info] >  Raw chunk received: { {"user":"Raw chunk received: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Raw chunk received: {"}}
[info] >    candidates: [ { content: [Object], index: 0 } ], {"user":"  candidates: [ { content: [Object], index: 0 } ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   candidates: [ { content: [Object], index: 0 } ],"}}
[info] >    modelVersion: 'gemini-1.5-flash-002' {"user":"  modelVersion: 'gemini-1.5-flash-002'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   modelVersion: 'gemini-1.5-flash-002'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  Extracted chunk text:  there!  How can I help you today?  Are you looking for advice {"user":"Extracted chunk text:  there!  How can I help you today?  Are you looking for advice","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Extracted chunk text:  there!  How can I help you today?  Are you looking for advice"}}
[info] >  📦 Sending chunk: { {"user":"📦 Sending chunk: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: {"}}
[info] >    chunkText: ' there!  How can I help you today?  Are you looking for advice', {"user":"  chunkText: ' there!  How can I help you today?  Are you looking for advice',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunkText: ' there!  How can I help you today?  Are you looking for advice',"}}
[info] >    chunkLength: 62, {"user":"  chunkLength: 62,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunkLength: 62,"}}
[info] >    totalLength: 67, {"user":"  totalLength: 67,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalLength: 67,"}}
[info] >    totalChunks: 2 {"user":"  totalChunks: 2","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalChunks: 2"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  Raw chunk received: { {"user":"Raw chunk received: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Raw chunk received: {"}}
[info] >    candidates: [ { content: [Object], index: 0 } ], {"user":"  candidates: [ { content: [Object], index: 0 } ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   candidates: [ { content: [Object], index: 0 } ],"}}
[info] >    modelVersion: 'gemini-1.5-flash-002' {"user":"  modelVersion: 'gemini-1.5-flash-002'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   modelVersion: 'gemini-1.5-flash-002'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  Extracted chunk text:  on a specific relationship, or do you have a more general question about relationships? {"user":"Extracted chunk text:  on a specific relationship, or do you have a more general question about relationships?","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Extracted chunk text:  on a specific relationship, or do you have a more general question about relationships?"}}
[info] >  📦 Sending chunk: { {"user":"📦 Sending chunk: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: {"}}
[info] >    chunkText: ' on a specific relationship, or do you have a more general question about relationships?', {"user":"  chunkText: ' on a specific relationship, or do you have a more general question about relationships?',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunkText: ' on a specific relationship, or do you have a more general question about relationships?',"}}
[info] >    chunkLength: 88, {"user":"  chunkLength: 88,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunkLength: 88,"}}
[info] >    totalLength: 155, {"user":"  totalLength: 155,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalLength: 155,"}}
[info] >    totalChunks: 3 {"user":"  totalChunks: 3","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalChunks: 3"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  Raw chunk received: { {"user":"Raw chunk received: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Raw chunk received: {"}}
[info] >    candidates: [ { content: [Object], finishReason: 'STOP', index: 0 } ], {"user":"  candidates: [ { content: [Object], finishReason: 'STOP', index: 0 } ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   candidates: [ { content: [Object], finishReason: 'STOP', index: 0 } ],"}}
[info] >    usageMetadata: { {"user":"  usageMetadata: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   usageMetadata: {"}}
[info] >      promptTokenCount: 99, {"user":"    promptTokenCount: 99,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     promptTokenCount: 99,"}}
[info] >      candidatesTokenCount: 49, {"user":"    candidatesTokenCount: 49,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     candidatesTokenCount: 49,"}}
[info] >      totalTokenCount: 148 {"user":"    totalTokenCount: 148","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     totalTokenCount: 148"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    modelVersion: 'gemini-1.5-flash-002' {"user":"  modelVersion: 'gemini-1.5-flash-002'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   modelVersion: 'gemini-1.5-flash-002'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  Extracted chunk text:   The more information you can provide, the better I can assist you. {"user":"Extracted chunk text:   The more information you can provide, the better I can assist you.","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Extracted chunk text:   The more information you can provide, the better I can assist you."}}
[info] >   {"user":"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m "}}
[info] >  📦 Sending chunk: { {"user":"📦 Sending chunk: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: {"}}
[info] >    chunkText: '  The more information you can provide, the better I can assist you.\n', {"user":"  chunkText: '  The more information you can provide, the better I can assist you.\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunkText: '  The more information you can provide, the better I can assist you.\\n',"}}
[info] >    chunkLength: 69, {"user":"  chunkLength: 69,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunkLength: 69,"}}
[info] >    totalLength: 224, {"user":"  totalLength: 224,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalLength: 224,"}}
[info] >    totalChunks: 4 {"user":"  totalChunks: 4","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalChunks: 4"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Stream complete: { {"user":"✅ Stream complete: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Stream complete: {"}}
[info] >    totalChunks: 4, {"user":"  totalChunks: 4,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalChunks: 4,"}}
[info] >    finalLength: 224, {"user":"  finalLength: 224,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   finalLength: 224,"}}
[info] >    timestamp: '2024-11-12T22:44:26.910Z' {"user":"  timestamp: '2024-11-12T22:44:26.910Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:44:26.910Z'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:44:26.913Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 1797.2095ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 1797.2095ms"}}
[debug] [2024-11-12T22:44:26.914Z] [worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: IDLE"}}
[debug] [2024-11-12T22:44:26.914Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:44:26.914Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:44:26.914Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  📤 Sending final response: { {"user":"📤 Sending final response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending final response: {"}}
[info] >    message: 'Hello there!  How can I help you today?  Are you looking for advice on a specific relationship, or do you have a more general question about relationships?  The more information you can provide, the better I can assist you.\n', {"user":"  message: 'Hello there!  How can I help you today?  Are you looking for advice on a specific relationship, or do you have a more general question about relationships?  The more information you can provide, the better I can assist you.\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Hello there!  How can I help you today?  Are you looking for advice on a specific relationship, or do you have a more general question about relationships?  The more information you can provide, the better I can assist you.\\n',"}}
[info] >    userMessage: 'hello', {"user":"  userMessage: 'hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hello',"}}
[info] >    timestamp: '2024-11-12T22:44:26.910Z', {"user":"  timestamp: '2024-11-12T22:44:26.910Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:44:26.910Z',"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat', {"user":"  chatId: 'default-chat',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat',"}}
[info] >    chunks: [ {"user":"  chunks: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunks: ["}}
[info] >      'Hello', {"user":"    'Hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'Hello',"}}
[info] >      ' there!  How can I help you today?  Are you looking for advice', {"user":"    ' there!  How can I help you today?  Are you looking for advice',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     ' there!  How can I help you today?  Are you looking for advice',"}}
[info] >      ' on a specific relationship, or do you have a more general question about relationships?', {"user":"    ' on a specific relationship, or do you have a more general question about relationships?',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     ' on a specific relationship, or do you have a more general question about relationships?',"}}
[info] >      '  The more information you can provide, the better I can assist you.\n' {"user":"    '  The more information you can provide, the better I can assist you.\\n'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '  The more information you can provide, the better I can assist you.\\n'"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:44:31.366Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:44:31.366Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:44:31.366Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:44:31.366Z"],"workRunningCount":1}
[debug] [2024-11-12T22:44:31.366Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:44:31.368Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:44:31.368Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:44:31.368Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:44:31.369Z] [worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: BUSY"}}
[debug] [2024-11-12T22:44:31.372Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2.8142ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2.8142ms"}}
[debug] [2024-11-12T22:44:31.373Z] [worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: IDLE"}}
[debug] [2024-11-12T22:44:31.373Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:44:31.373Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:44:31.373Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:44:31.374Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:44:31.374Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:44:31.374Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:44:31.374Z"],"workRunningCount":1}
[debug] [2024-11-12T22:44:31.374Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:44:31.376Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:44:31.376Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:44:31.376Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:44:31.377Z] [worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'hello', chatId: 'default-chat' } {"user":"  data: { message: 'hello', chatId: 'default-chat' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'hello', chatId: 'default-chat' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 5, {"user":"  messageLength: 5,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 5,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[info] >  🔄 Starting stream processing {"user":"🔄 Starting stream processing","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔄 Starting stream processing"}}
[info] >  Raw chunk received: { {"user":"Raw chunk received: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Raw chunk received: {"}}
[info] >    candidates: [ { content: [Object], index: 0 } ], {"user":"  candidates: [ { content: [Object], index: 0 } ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   candidates: [ { content: [Object], index: 0 } ],"}}
[info] >    modelVersion: 'gemini-1.5-flash-002' {"user":"  modelVersion: 'gemini-1.5-flash-002'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   modelVersion: 'gemini-1.5-flash-002'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  Extracted chunk text: Hello {"user":"Extracted chunk text: Hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Extracted chunk text: Hello"}}
[info] >  📦 Sending chunk: { chunkText: 'Hello', chunkLength: 5, totalLength: 5, totalChunks: 1 } {"user":"📦 Sending chunk: { chunkText: 'Hello', chunkLength: 5, totalLength: 5, totalChunks: 1 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: { chunkText: 'Hello', chunkLength: 5, totalLength: 5, totalChunks: 1 }"}}
[info] >  Raw chunk received: { {"user":"Raw chunk received: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Raw chunk received: {"}}
[info] >    candidates: [ { content: [Object], index: 0 } ], {"user":"  candidates: [ { content: [Object], index: 0 } ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   candidates: [ { content: [Object], index: 0 } ],"}}
[info] >    modelVersion: 'gemini-1.5-flash-002' {"user":"  modelVersion: 'gemini-1.5-flash-002'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   modelVersion: 'gemini-1.5-flash-002'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  Extracted chunk text: !  Is there something specific you'd like to talk about concerning your relationships {"user":"Extracted chunk text: !  Is there something specific you'd like to talk about concerning your relationships","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Extracted chunk text: !  Is there something specific you'd like to talk about concerning your relationships"}}
[info] >  📦 Sending chunk: { {"user":"📦 Sending chunk: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: {"}}
[info] >    chunkText: "!  Is there something specific you'd like to talk about concerning your relationships", {"user":"  chunkText: \"!  Is there something specific you'd like to talk about concerning your relationships\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunkText: \"!  Is there something specific you'd like to talk about concerning your relationships\","}}
[info] >    chunkLength: 85, {"user":"  chunkLength: 85,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunkLength: 85,"}}
[info] >    totalLength: 90, {"user":"  totalLength: 90,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalLength: 90,"}}
[info] >    totalChunks: 2 {"user":"  totalChunks: 2","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalChunks: 2"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  Raw chunk received: { {"user":"Raw chunk received: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Raw chunk received: {"}}
[info] >    candidates: [ { content: [Object], finishReason: 'STOP', index: 0 } ], {"user":"  candidates: [ { content: [Object], finishReason: 'STOP', index: 0 } ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   candidates: [ { content: [Object], finishReason: 'STOP', index: 0 } ],"}}
[info] >    usageMetadata: { {"user":"  usageMetadata: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   usageMetadata: {"}}
[info] >      promptTokenCount: 149, {"user":"    promptTokenCount: 149,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     promptTokenCount: 149,"}}
[info] >      candidatesTokenCount: 29, {"user":"    candidatesTokenCount: 29,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     candidatesTokenCount: 29,"}}
[info] >      totalTokenCount: 178 {"user":"    totalTokenCount: 178","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     totalTokenCount: 178"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    modelVersion: 'gemini-1.5-flash-002' {"user":"  modelVersion: 'gemini-1.5-flash-002'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   modelVersion: 'gemini-1.5-flash-002'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  Extracted chunk text: ? I'm here to listen and offer support. {"user":"Extracted chunk text: ? I'm here to listen and offer support.","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Extracted chunk text: ? I'm here to listen and offer support."}}
[info] >   {"user":"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m "}}
[info] >  📦 Sending chunk: { {"user":"📦 Sending chunk: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: {"}}
[info] >    chunkText: "? I'm here to listen and offer support.\n", {"user":"  chunkText: \"? I'm here to listen and offer support.\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunkText: \"? I'm here to listen and offer support.\\n\","}}
[info] >    chunkLength: 40, {"user":"  chunkLength: 40,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunkLength: 40,"}}
[info] >    totalLength: 130, {"user":"  totalLength: 130,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalLength: 130,"}}
[info] >    totalChunks: 3 {"user":"  totalChunks: 3","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalChunks: 3"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Stream complete: { {"user":"✅ Stream complete: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Stream complete: {"}}
[info] >    totalChunks: 3, {"user":"  totalChunks: 3,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalChunks: 3,"}}
[info] >    finalLength: 130, {"user":"  finalLength: 130,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   finalLength: 130,"}}
[info] >    timestamp: '2024-11-12T22:44:32.776Z' {"user":"  timestamp: '2024-11-12T22:44:32.776Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:44:32.776Z'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:44:32.780Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 1403.4129ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 1403.4129ms"}}
[debug] [2024-11-12T22:44:32.781Z] [worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: IDLE"}}
[debug] [2024-11-12T22:44:32.781Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:44:32.781Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:44:32.781Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  📤 Sending final response: { {"user":"📤 Sending final response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending final response: {"}}
[info] >    message: "Hello!  Is there something specific you'd like to talk about concerning your relationships? I'm here to listen and offer support.\n", {"user":"  message: \"Hello!  Is there something specific you'd like to talk about concerning your relationships? I'm here to listen and offer support.\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: \"Hello!  Is there something specific you'd like to talk about concerning your relationships? I'm here to listen and offer support.\\n\","}}
[info] >    userMessage: 'hello', {"user":"  userMessage: 'hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hello',"}}
[info] >    timestamp: '2024-11-12T22:44:32.776Z', {"user":"  timestamp: '2024-11-12T22:44:32.776Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:44:32.776Z',"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat', {"user":"  chatId: 'default-chat',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat',"}}
[info] >    chunks: [ {"user":"  chunks: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunks: ["}}
[info] >      'Hello', {"user":"    'Hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'Hello',"}}
[info] >      "!  Is there something specific you'd like to talk about concerning your relationships", {"user":"    \"!  Is there something specific you'd like to talk about concerning your relationships\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"!  Is there something specific you'd like to talk about concerning your relationships\","}}
[info] >      "? I'm here to listen and offer support.\n" {"user":"? I'm here to listen and offer support.\n","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"? I'm here to listen and offer support.\\n\""}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:44:36.200Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:44:36.200Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:44:36.200Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:44:36.200Z"],"workRunningCount":1}
[debug] [2024-11-12T22:44:36.200Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:44:36.201Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:44:36.201Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:44:36.201Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:44:36.202Z] [worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'hello', chatId: 'default-chat' } {"user":"  data: { message: 'hello', chatId: 'default-chat' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'hello', chatId: 'default-chat' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 5, {"user":"  messageLength: 5,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 5,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[info] >  ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {"error":{"code":429,"message":"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","status":"RESOURCE_EXHAUSTED"}} {"user":"ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {\"error\":{\"code\":429,\"message\":\"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.\",\"status\":\"RESOURCE_EXHAUSTED\"}}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {\"error\":{\"code\":429,\"message\":\"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.\",\"status\":\"RESOURCE_EXHAUSTED\"}}"}}
[info] >      at throwErrorIfNotOK (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:27) {"user":"    at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:27)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:27)"}}
[info] >      at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >      at async generateContentStream (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\generate_content.js:99:5) { {"user":"    at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {"}}
[info] >    stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff. {"user":"  stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff."}}
[info] >        at throwErrorIfNotOK (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:66) {"user":"      at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)"}}
[info] >        at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >        at async generateContentStream (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\generate_content.js:99:5) { {"user":"      at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {"}}
[info] >      code: 429, {"user":"    code: 429,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 429,"}}
[info] >      status: 'RESOURCE_EXHAUSTED', {"user":"    status: 'RESOURCE_EXHAUSTED',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     status: 'RESOURCE_EXHAUSTED',"}}
[info] >      errorDetails: undefined {"user":"    errorDetails: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     errorDetails: undefined"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff. {"user":"  [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff."}}
[info] >        at throwErrorIfNotOK (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:66) {"user":"      at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)"}}
[info] >        at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >        at async generateContentStream (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\generate_content.js:99:5) { {"user":"      at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {"}}
[info] >      code: 429, {"user":"    code: 429,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 429,"}}
[info] >      status: 'RESOURCE_EXHAUSTED', {"user":"    status: 'RESOURCE_EXHAUSTED',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     status: 'RESOURCE_EXHAUSTED',"}}
[info] >      errorDetails: undefined {"user":"    errorDetails: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     errorDetails: undefined"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:44:36.410Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 207.9339ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 207.9339ms"}}
[debug] [2024-11-12T22:44:36.411Z] [worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: IDLE"}}
[debug] [2024-11-12T22:44:36.411Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:44:36.411Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:44:36.411Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  💥 Chat processing error: ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {"error":{"code":429,"message":"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","status":"RESOURCE_EXHAUSTED"}} {"user":"💥 Chat processing error: ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {\"error\":{\"code\":429,\"message\":\"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.\",\"status\":\"RESOURCE_EXHAUSTED\"}}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💥 Chat processing error: ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {\"error\":{\"code\":429,\"message\":\"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.\",\"status\":\"RESOURCE_EXHAUSTED\"}}"}}
[info] >      at throwErrorIfNotOK (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:27) {"user":"    at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:27)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:27)"}}
[info] >      at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >      at async generateContentStream (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\generate_content.js:99:5) { {"user":"    at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {"}}
[info] >    stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff. {"user":"  stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff."}}
[info] >        at throwErrorIfNotOK (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:66) {"user":"      at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)"}}
[info] >        at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >        at async generateContentStream (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\generate_content.js:99:5) { {"user":"      at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {"}}
[info] >      code: 429, {"user":"    code: 429,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 429,"}}
[info] >      status: 'RESOURCE_EXHAUSTED', {"user":"    status: 'RESOURCE_EXHAUSTED',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     status: 'RESOURCE_EXHAUSTED',"}}
[info] >      errorDetails: undefined {"user":"    errorDetails: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     errorDetails: undefined"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff. {"user":"  [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff."}}
[info] >        at throwErrorIfNotOK (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:66) {"user":"      at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)"}}
[info] >        at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >        at async generateContentStream (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\generate_content.js:99:5) { {"user":"      at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {"}}
[info] >      code: 429, {"user":"    code: 429,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 429,"}}
[info] >      status: 'RESOURCE_EXHAUSTED', {"user":"    status: 'RESOURCE_EXHAUSTED',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     status: 'RESOURCE_EXHAUSTED',"}}
[info] >      errorDetails: undefined {"user":"    errorDetails: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     errorDetails: undefined"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:45:05.212Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:45:05.212Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:45:05.213Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:45:05.212Z"],"workRunningCount":1}
[debug] [2024-11-12T22:45:05.213Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:45:05.216Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:45:05.216Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:45:05.216Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:45:05.217Z] [worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: BUSY"}}
[debug] [2024-11-12T22:45:05.220Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 3.0569ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 3.0569ms"}}
[debug] [2024-11-12T22:45:05.221Z] [worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: IDLE"}}
[debug] [2024-11-12T22:45:05.222Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:45:05.222Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:45:05.222Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:45:05.223Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:45:05.223Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:45:05.223Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:45:05.223Z"],"workRunningCount":1}
[debug] [2024-11-12T22:45:05.223Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:45:05.226Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:45:05.226Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:45:05.226Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:45:05.227Z] [worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'helllo', chatId: 'default-chat' } {"user":"  data: { message: 'helllo', chatId: 'default-chat' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'helllo', chatId: 'default-chat' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 6, {"user":"  messageLength: 6,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 6,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: helllo {"user":"💬 Sending message to Gemini: helllo","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: helllo"}}
[info] >  ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {"error":{"code":429,"message":"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","status":"RESOURCE_EXHAUSTED"}} {"user":"ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {\"error\":{\"code\":429,\"message\":\"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.\",\"status\":\"RESOURCE_EXHAUSTED\"}}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {\"error\":{\"code\":429,\"message\":\"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.\",\"status\":\"RESOURCE_EXHAUSTED\"}}"}}
[info] >      at throwErrorIfNotOK (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:27) {"user":"    at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:27)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:27)"}}
[info] >      at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >      at async generateContentStream (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\generate_content.js:99:5) { {"user":"    at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {"}}
[info] >    stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff. {"user":"  stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff."}}
[info] >        at throwErrorIfNotOK (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:66) {"user":"      at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)"}}
[info] >        at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >        at async generateContentStream (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\generate_content.js:99:5) { {"user":"      at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {"}}
[info] >      code: 429, {"user":"    code: 429,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 429,"}}
[info] >      status: 'RESOURCE_EXHAUSTED', {"user":"    status: 'RESOURCE_EXHAUSTED',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     status: 'RESOURCE_EXHAUSTED',"}}
[info] >      errorDetails: undefined {"user":"    errorDetails: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     errorDetails: undefined"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff. {"user":"  [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff."}}
[info] >        at throwErrorIfNotOK (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:66) {"user":"      at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)"}}
[info] >        at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >        at async generateContentStream (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\generate_content.js:99:5) { {"user":"      at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {"}}
[info] >      code: 429, {"user":"    code: 429,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 429,"}}
[info] >      status: 'RESOURCE_EXHAUSTED', {"user":"    status: 'RESOURCE_EXHAUSTED',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     status: 'RESOURCE_EXHAUSTED',"}}
[info] >      errorDetails: undefined {"user":"    errorDetails: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     errorDetails: undefined"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:45:05.533Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 305.8422ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 305.8422ms"}}
[debug] [2024-11-12T22:45:05.534Z] [worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: IDLE"}}
[debug] [2024-11-12T22:45:05.535Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:45:05.535Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:45:05.535Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  💥 Chat processing error: ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {"error":{"code":429,"message":"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","status":"RESOURCE_EXHAUSTED"}} {"user":"💥 Chat processing error: ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {\"error\":{\"code\":429,\"message\":\"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.\",\"status\":\"RESOURCE_EXHAUSTED\"}}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💥 Chat processing error: ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {\"error\":{\"code\":429,\"message\":\"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.\",\"status\":\"RESOURCE_EXHAUSTED\"}}"}}
[info] >      at throwErrorIfNotOK (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:27) {"user":"    at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:27)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:27)"}}
[info] >      at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >      at async generateContentStream (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\generate_content.js:99:5) { {"user":"    at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {"}}
[info] >    stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff. {"user":"  stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff."}}
[info] >        at throwErrorIfNotOK (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:66) {"user":"      at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)"}}
[info] >        at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >        at async generateContentStream (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\generate_content.js:99:5) { {"user":"      at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {"}}
[info] >      code: 429, {"user":"    code: 429,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 429,"}}
[info] >      status: 'RESOURCE_EXHAUSTED', {"user":"    status: 'RESOURCE_EXHAUSTED',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     status: 'RESOURCE_EXHAUSTED',"}}
[info] >      errorDetails: undefined {"user":"    errorDetails: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     errorDetails: undefined"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff. {"user":"  [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff."}}
[info] >        at throwErrorIfNotOK (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:66) {"user":"      at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at throwErrorIfNotOK (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)"}}
[info] >        at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >        at async generateContentStream (C:\Users\Rob\Apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\generate_content.js:99:5) { {"user":"      at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async generateContentStream (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:99:5) {"}}
[info] >      code: 429, {"user":"    code: 429,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 429,"}}
[info] >      status: 'RESOURCE_EXHAUSTED', {"user":"    status: 'RESOURCE_EXHAUSTED',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     status: 'RESOURCE_EXHAUSTED',"}}
[info] >      errorDetails: undefined {"user":"    errorDetails: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     errorDetails: undefined"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:46:22.045Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-12T22:46:23.053Z] Validating nodejs source
[debug] [2024-11-12T22:46:24.110Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:46:24.110Z] Building nodejs source
[debug] [2024-11-12T22:46:24.110Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:46:24.112Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:46:24.121Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8731

[debug] [2024-11-12T22:46:24.840Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:46:28.860Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:46:28.860Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:46:28.861Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-12T22:46:28.861Z] [worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: FINISHING"}}
[debug] [2024-11-12T22:46:28.874Z] [worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: exited"}}
[debug] [2024-11-12T22:46:28.874Z] [worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3118ed41-246e-4fb8-a63e-53a9b108383b]: FINISHED"}}
[debug] [2024-11-12T22:47:26.040Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-12T22:47:26.040Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-12T22:47:27.054Z] Validating nodejs source
[debug] [2024-11-12T22:47:27.997Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:47:27.997Z] Building nodejs source
[debug] [2024-11-12T22:47:27.997Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:47:27.998Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:47:28.007Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8696

[debug] [2024-11-12T22:47:28.639Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:47:32.672Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:47:32.672Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:50:42.986Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-12T22:50:44.001Z] Validating nodejs source
[debug] [2024-11-12T22:50:45.059Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:50:45.059Z] Building nodejs source
[debug] [2024-11-12T22:50:45.059Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:50:45.061Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:50:45.074Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8648

[debug] [2024-11-12T22:50:45.728Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:50:49.757Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:50:49.758Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:51:09.606Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-12T22:51:09.607Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-12T22:51:10.609Z] Validating nodejs source
[debug] [2024-11-12T22:51:11.564Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:51:11.564Z] Building nodejs source
[debug] [2024-11-12T22:51:11.564Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:51:11.565Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:51:11.573Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8509

[debug] [2024-11-12T22:51:12.191Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:51:16.213Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:51:16.214Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:51:44.813Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:51:44.813Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:51:44.813Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:51:44.813Z"],"workRunningCount":1}
[debug] [2024-11-12T22:51:44.813Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:51:44.816Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:51:44.817Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:51:44.817Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-12T22:51:44.829Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-12T22:51:44.829Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-12T22:51:46.476Z] [runtime-status] [31768] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [31768] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:51:46.477Z] [runtime-status] [31768] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [31768] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:51:46.478Z] [runtime-status] [31768] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [31768] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-12T22:51:46.478Z] [runtime-status] [31768] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [31768] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-12T22:51:46.479Z] [runtime-status] [31768] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [31768] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:51:46.783Z] [runtime-status] [31768] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [31768] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-12T22:51:46.783Z] [runtime-status] [31768] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [31768] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-12T22:51:46.784Z] [runtime-status] [31768] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [31768] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:51:46.788Z] [runtime-status] [31768] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [31768] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:51:46.790Z] [runtime-status] [31768] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [31768] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:51:46.791Z] [runtime-status] [31768] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [31768] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2024-11-12T22:51:46.882Z] [runtime-status] [31768] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [31768] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-12T22:51:46.883Z] [runtime-status] [31768] Listening to port: \\?\pipe\fire_emu_28781998acde2ddb {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [31768] Listening to port: \\\\?\\pipe\\fire_emu_28781998acde2ddb"}}
[debug] [2024-11-12T22:51:46.926Z] [worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: IDLE"}}
[debug] [2024-11-12T22:51:46.926Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:51:46.927Z] [worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: BUSY"}}
[debug] [2024-11-12T22:51:46.931Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 3.9447ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 3.9447ms"}}
[debug] [2024-11-12T22:51:46.932Z] [worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: IDLE"}}
[debug] [2024-11-12T22:51:46.932Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:51:46.932Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:51:46.932Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:51:46.933Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:51:46.933Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:51:46.933Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:51:46.933Z"],"workRunningCount":1}
[debug] [2024-11-12T22:51:46.933Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:51:46.934Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:51:46.935Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:51:46.935Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:51:46.935Z] [worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'hello', chatId: 'default-chat' } {"user":"  data: { message: 'hello', chatId: 'default-chat' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'hello', chatId: 'default-chat' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 5, {"user":"  messageLength: 5,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 5,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: default-chat {"user":"🆕 Creating new chat session: default-chat","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: default-chat"}}
[info] >  📝 Chat session created: { chatId: 'default-chat', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'default-chat', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'default-chat', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  🔄 Starting stream processing {"user":"🔄 Starting stream processing","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔄 Starting stream processing"}}
[info] >  Raw chunk received: { {"user":"Raw chunk received: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Raw chunk received: {"}}
[info] >    candidates: [ { content: [Object], index: 0 } ], {"user":"  candidates: [ { content: [Object], index: 0 } ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   candidates: [ { content: [Object], index: 0 } ],"}}
[info] >    modelVersion: 'gemini-1.5-flash-002' {"user":"  modelVersion: 'gemini-1.5-flash-002'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   modelVersion: 'gemini-1.5-flash-002'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  Extracted chunk text: Hello {"user":"Extracted chunk text: Hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Extracted chunk text: Hello"}}
[info] >  📦 Sending chunk: { chunkText: 'Hello', chunkLength: 5, totalLength: 5, totalChunks: 1 } {"user":"📦 Sending chunk: { chunkText: 'Hello', chunkLength: 5, totalLength: 5, totalChunks: 1 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: { chunkText: 'Hello', chunkLength: 5, totalLength: 5, totalChunks: 1 }"}}
[debug] [2024-11-12T22:51:48.552Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 1616.534ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 1616.534ms"}}
[debug] [2024-11-12T22:51:48.553Z] [worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: IDLE"}}
[debug] [2024-11-12T22:51:48.553Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:51:48.553Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:51:48.553Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:52:22.546Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:52:22.546Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:52:22.546Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:52:22.546Z"],"workRunningCount":1}
[debug] [2024-11-12T22:52:22.546Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:52:22.549Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:52:22.549Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:52:22.549Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:52:22.550Z] [worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: BUSY"}}
[debug] [2024-11-12T22:52:22.554Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4.3178ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4.3178ms"}}
[debug] [2024-11-12T22:52:22.555Z] [worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: IDLE"}}
[debug] [2024-11-12T22:52:22.555Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:52:22.555Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:52:22.555Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:52:22.556Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:52:22.556Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:52:22.556Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:52:22.556Z"],"workRunningCount":1}
[debug] [2024-11-12T22:52:22.557Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:52:22.559Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:52:22.560Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:52:22.560Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:52:22.560Z] [worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'hi gemini', chatId: 'default-chat' } {"user":"  data: { message: 'hi gemini', chatId: 'default-chat' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'hi gemini', chatId: 'default-chat' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 9, {"user":"  messageLength: 9,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 9,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: hi gemini {"user":"💬 Sending message to Gemini: hi gemini","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hi gemini"}}
[info] >  🔄 Starting stream processing {"user":"🔄 Starting stream processing","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔄 Starting stream processing"}}
[debug] [2024-11-12T22:52:23.284Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 724.2106ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 724.2106ms"}}
[debug] [2024-11-12T22:52:23.285Z] [worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: IDLE"}}
[debug] [2024-11-12T22:52:23.285Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:52:23.286Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:52:23.286Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  Raw chunk received: { {"user":"Raw chunk received: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Raw chunk received: {"}}
[info] >    candidates: [ { content: [Object], index: 0 } ], {"user":"  candidates: [ { content: [Object], index: 0 } ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   candidates: [ { content: [Object], index: 0 } ],"}}
[info] >    modelVersion: 'gemini-1.5-flash-002' {"user":"  modelVersion: 'gemini-1.5-flash-002'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   modelVersion: 'gemini-1.5-flash-002'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  Extracted chunk text: Hi {"user":"Extracted chunk text: Hi","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Extracted chunk text: Hi"}}
[info] >  📦 Sending chunk: { chunkText: 'Hi', chunkLength: 2, totalLength: 2, totalChunks: 1 } {"user":"📦 Sending chunk: { chunkText: 'Hi', chunkLength: 2, totalLength: 2, totalChunks: 1 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: { chunkText: 'Hi', chunkLength: 2, totalLength: 2, totalChunks: 1 }"}}
[debug] [2024-11-12T22:52:37.926Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:52:37.926Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:52:37.926Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:52:37.926Z"],"workRunningCount":1}
[debug] [2024-11-12T22:52:37.926Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:52:37.929Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:52:37.929Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:52:37.929Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:52:37.930Z] [worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: BUSY"}}
[debug] [2024-11-12T22:52:37.933Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2.8626ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2.8626ms"}}
[debug] [2024-11-12T22:52:37.934Z] [worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: IDLE"}}
[debug] [2024-11-12T22:52:37.934Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:52:37.934Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:52:37.934Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:52:37.936Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:52:37.936Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:52:37.936Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:52:37.936Z"],"workRunningCount":1}
[debug] [2024-11-12T22:52:37.936Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:52:37.939Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:52:37.939Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:52:37.939Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:52:37.940Z] [worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'say more to me', chatId: 'default-chat' } {"user":"  data: { message: 'say more to me', chatId: 'default-chat' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'say more to me', chatId: 'default-chat' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 14, {"user":"  messageLength: 14,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 14,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: say more to me {"user":"💬 Sending message to Gemini: say more to me","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: say more to me"}}
[info] >  🔄 Starting stream processing {"user":"🔄 Starting stream processing","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔄 Starting stream processing"}}
[debug] [2024-11-12T22:52:38.637Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 697.3405ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 697.3405ms"}}
[debug] [2024-11-12T22:52:38.638Z] [worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: IDLE"}}
[debug] [2024-11-12T22:52:38.638Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:52:38.638Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:52:38.639Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  Raw chunk received: { {"user":"Raw chunk received: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Raw chunk received: {"}}
[info] >    candidates: [ { content: [Object], index: 0 } ], {"user":"  candidates: [ { content: [Object], index: 0 } ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   candidates: [ { content: [Object], index: 0 } ],"}}
[info] >    modelVersion: 'gemini-1.5-flash-002' {"user":"  modelVersion: 'gemini-1.5-flash-002'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   modelVersion: 'gemini-1.5-flash-002'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  Extracted chunk text: Okay {"user":"Extracted chunk text: Okay","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Extracted chunk text: Okay"}}
[info] >  📦 Sending chunk: { chunkText: 'Okay', chunkLength: 4, totalLength: 4, totalChunks: 1 } {"user":"📦 Sending chunk: { chunkText: 'Okay', chunkLength: 4, totalLength: 4, totalChunks: 1 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: { chunkText: 'Okay', chunkLength: 4, totalLength: 4, totalChunks: 1 }"}}
[debug] [2024-11-12T22:52:53.571Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:52:53.571Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:52:53.571Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:52:53.571Z"],"workRunningCount":1}
[debug] [2024-11-12T22:52:53.571Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:52:53.574Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:52:53.574Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:52:53.574Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:52:53.574Z] [worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: BUSY"}}
[debug] [2024-11-12T22:52:53.577Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 3.0187ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 3.0187ms"}}
[debug] [2024-11-12T22:52:53.578Z] [worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: IDLE"}}
[debug] [2024-11-12T22:52:53.579Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:52:53.579Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:52:53.579Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:52:53.579Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:52:53.579Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:52:53.580Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:52:53.579Z"],"workRunningCount":1}
[debug] [2024-11-12T22:52:53.580Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:52:53.582Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:52:53.582Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:52:53.582Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:52:53.583Z] [worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'understand my emotions', chatId: 'default-chat' } {"user":"  data: { message: 'understand my emotions', chatId: 'default-chat' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'understand my emotions', chatId: 'default-chat' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 22, {"user":"  messageLength: 22,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 22,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: understand my emotions {"user":"💬 Sending message to Gemini: understand my emotions","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: understand my emotions"}}
[info] >  🔄 Starting stream processing {"user":"🔄 Starting stream processing","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔄 Starting stream processing"}}
[debug] [2024-11-12T22:52:54.434Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 852.0734ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 852.0734ms"}}
[debug] [2024-11-12T22:52:54.436Z] [worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: IDLE"}}
[debug] [2024-11-12T22:52:54.436Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:52:54.436Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:52:54.436Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  Raw chunk received: { {"user":"Raw chunk received: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Raw chunk received: {"}}
[info] >    candidates: [ { content: [Object], index: 0 } ], {"user":"  candidates: [ { content: [Object], index: 0 } ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   candidates: [ { content: [Object], index: 0 } ],"}}
[info] >    modelVersion: 'gemini-1.5-flash-002' {"user":"  modelVersion: 'gemini-1.5-flash-002'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   modelVersion: 'gemini-1.5-flash-002'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  Extracted chunk text: Understanding {"user":"Extracted chunk text: Understanding","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Extracted chunk text: Understanding"}}
[info] >  📦 Sending chunk: { {"user":"📦 Sending chunk: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: {"}}
[info] >    chunkText: 'Understanding', {"user":"  chunkText: 'Understanding',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunkText: 'Understanding',"}}
[info] >    chunkLength: 13, {"user":"  chunkLength: 13,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chunkLength: 13,"}}
[info] >    totalLength: 13, {"user":"  totalLength: 13,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalLength: 13,"}}
[info] >    totalChunks: 1 {"user":"  totalChunks: 1","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   totalChunks: 1"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:54:10.410Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-12T22:54:11.445Z] Validating nodejs source
[debug] [2024-11-12T22:54:12.444Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:54:12.444Z] Building nodejs source
[debug] [2024-11-12T22:54:12.444Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:54:12.446Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:54:12.455Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8111

[debug] [2024-11-12T22:54:13.154Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:54:17.188Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:54:17.189Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:54:17.190Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-12T22:54:17.190Z] [worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: FINISHING"}}
[debug] [2024-11-12T22:54:17.203Z] [worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: exited"}}
[debug] [2024-11-12T22:54:17.203Z] [worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-a115ff27-fb86-4ba2-a552-2a288e1f2ea8]: FINISHED"}}
[debug] [2024-11-12T22:54:45.318Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-12T22:54:45.319Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-12T22:54:46.327Z] Validating nodejs source
[debug] [2024-11-12T22:54:47.265Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:54:47.265Z] Building nodejs source
[debug] [2024-11-12T22:54:47.265Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:54:47.266Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:54:47.274Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8384

[debug] [2024-11-12T22:54:47.907Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:54:51.933Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:54:51.934Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:54:56.024Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:54:56.024Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:54:56.025Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:54:56.024Z"],"workRunningCount":1}
[debug] [2024-11-12T22:54:56.025Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:54:56.027Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:54:56.027Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:54:56.027Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-12T22:54:56.038Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-12T22:54:56.038Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-12T22:54:57.624Z] [runtime-status] [28656] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28656] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:54:57.625Z] [runtime-status] [28656] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28656] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:54:57.626Z] [runtime-status] [28656] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28656] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-12T22:54:57.626Z] [runtime-status] [28656] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28656] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-12T22:54:57.627Z] [runtime-status] [28656] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28656] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:54:57.982Z] [runtime-status] [28656] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28656] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-12T22:54:57.983Z] [runtime-status] [28656] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28656] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-12T22:54:57.983Z] [runtime-status] [28656] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28656] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:54:57.989Z] [runtime-status] [28656] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28656] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:54:57.992Z] [runtime-status] [28656] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28656] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:54:57.992Z] [runtime-status] [28656] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28656] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2024-11-12T22:54:58.094Z] [runtime-status] [28656] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28656] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-12T22:54:58.095Z] [runtime-status] [28656] Listening to port: \\?\pipe\fire_emu_71f44aea661e50b1 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [28656] Listening to port: \\\\?\\pipe\\fire_emu_71f44aea661e50b1"}}
[debug] [2024-11-12T22:54:58.134Z] [worker-us-central1-processChat-4252f928-aba5-40aa-9244-d2c58b24f462]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4252f928-aba5-40aa-9244-d2c58b24f462]: IDLE"}}
[debug] [2024-11-12T22:54:58.135Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:54:58.136Z] [worker-us-central1-processChat-4252f928-aba5-40aa-9244-d2c58b24f462]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4252f928-aba5-40aa-9244-d2c58b24f462]: BUSY"}}
[debug] [2024-11-12T22:54:58.140Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4.6007ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4.6007ms"}}
[debug] [2024-11-12T22:54:58.141Z] [worker-us-central1-processChat-4252f928-aba5-40aa-9244-d2c58b24f462]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4252f928-aba5-40aa-9244-d2c58b24f462]: IDLE"}}
[debug] [2024-11-12T22:54:58.141Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:54:58.141Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:54:58.141Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:54:58.143Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:54:58.143Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:54:58.143Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:54:58.143Z"],"workRunningCount":1}
[debug] [2024-11-12T22:54:58.143Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:54:58.144Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:54:58.144Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:54:58.144Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:54:58.145Z] [worker-us-central1-processChat-4252f928-aba5-40aa-9244-d2c58b24f462]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4252f928-aba5-40aa-9244-d2c58b24f462]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'hello', chatId: 'default-chat' } {"user":"  data: { message: 'hello', chatId: 'default-chat' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'hello', chatId: 'default-chat' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 5, {"user":"  messageLength: 5,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 5,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: default-chat {"user":"🆕 Creating new chat session: default-chat","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: default-chat"}}
[info] >  📝 Chat session created: { chatId: 'default-chat', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'default-chat', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'default-chat', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  🔄 Starting stream processing {"user":"🔄 Starting stream processing","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔄 Starting stream processing"}}
[info] >  Raw chunk received: { {"user":"Raw chunk received: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Raw chunk received: {"}}
[info] >    candidates: [ { content: [Object], index: 0 } ], {"user":"  candidates: [ { content: [Object], index: 0 } ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   candidates: [ { content: [Object], index: 0 } ],"}}
[info] >    modelVersion: 'gemini-1.5-flash-002' {"user":"  modelVersion: 'gemini-1.5-flash-002'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   modelVersion: 'gemini-1.5-flash-002'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  Extracted chunk text: Hello {"user":"Extracted chunk text: Hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Extracted chunk text: Hello"}}
[info] >  📦 Sending chunk: { chunkText: 'Hello', chunkLength: 5, totalLength: 5, totalChunks: 1 } {"user":"📦 Sending chunk: { chunkText: 'Hello', chunkLength: 5, totalLength: 5, totalChunks: 1 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: { chunkText: 'Hello', chunkLength: 5, totalLength: 5, totalChunks: 1 }"}}
[debug] [2024-11-12T22:54:59.605Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 1460.6321ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 1460.6321ms"}}
[debug] [2024-11-12T22:54:59.606Z] [worker-us-central1-processChat-4252f928-aba5-40aa-9244-d2c58b24f462]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4252f928-aba5-40aa-9244-d2c58b24f462]: IDLE"}}
[debug] [2024-11-12T22:54:59.607Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:54:59.607Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:54:59.607Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:56:36.449Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-12T22:56:37.451Z] Validating nodejs source
[debug] [2024-11-12T22:56:38.520Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:56:38.520Z] Building nodejs source
[debug] [2024-11-12T22:56:38.520Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:56:38.521Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:56:38.532Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8779

[debug] [2024-11-12T22:56:39.177Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:56:43.207Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:56:43.208Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:56:43.209Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-12T22:56:43.209Z] [worker-us-central1-processChat-4252f928-aba5-40aa-9244-d2c58b24f462]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4252f928-aba5-40aa-9244-d2c58b24f462]: FINISHING"}}
[debug] [2024-11-12T22:56:43.221Z] [worker-us-central1-processChat-4252f928-aba5-40aa-9244-d2c58b24f462]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4252f928-aba5-40aa-9244-d2c58b24f462]: exited"}}
[debug] [2024-11-12T22:56:43.221Z] [worker-us-central1-processChat-4252f928-aba5-40aa-9244-d2c58b24f462]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4252f928-aba5-40aa-9244-d2c58b24f462]: FINISHED"}}
[debug] [2024-11-12T22:56:57.914Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-12T22:56:57.915Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-12T22:56:58.921Z] Validating nodejs source
[debug] [2024-11-12T22:56:59.962Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:56:59.962Z] Building nodejs source
[debug] [2024-11-12T22:56:59.962Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:56:59.964Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:56:59.974Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8600

[error] C:\Users\Rob\Apps\not-alone\functions\lib\index.js:128
                            yield;
                            ^^^^^

SyntaxError: Unexpected strict mode reserved word
    at wrapSafe (node:internal/modules/cjs/loader:1378:20)
    at Module._compile (node:internal/modules/cjs/loader:1428:41)
    at Module._extensions..js (node:internal/modules/cjs/loader:1548:10)
    at Module.load (node:internal/modules/cjs/loader:1288:32)
    at Module._load (node:internal/modules/cjs/loader:1104:12)
    at Module.require (node:internal/modules/cjs/loader:1311:19)
    at require (node:internal/modules/helpers:179:18)
    at loadModule (C:\Users\Rob\Apps\not-alone\functions\node_modules\firebase-functions\lib\runtime\loader.js:40:16)
    at loadStack (C:\Users\Rob\Apps\not-alone\functions\node_modules\firebase-functions\lib\runtime\loader.js:157:23)
    at C:\Users\Rob\Apps\not-alone\functions\node_modules\firebase-functions\lib\bin\firebase-functions.js:56:56

[debug] [2024-11-12T22:57:00.262Z] Got response code 400; body Failed to generate manifest from function source: SyntaxError: Unexpected strict mode reserved word
[error] !!  functions: Failed to load function definition from source: FirebaseError: Functions codebase could not be analyzed successfully. It may have a syntax or runtime error {"metadata":{"emulator":{"name":"functions"},"message":"Failed to load function definition from source: FirebaseError: Functions codebase could not be analyzed successfully. It may have a syntax or runtime error"}}
[debug] [2024-11-12T22:57:24.133Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-12T22:57:25.145Z] Validating nodejs source
[debug] [2024-11-12T22:57:26.045Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:57:26.046Z] Building nodejs source
[debug] [2024-11-12T22:57:26.046Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:57:26.047Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:57:26.059Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8425

[error] C:\Users\Rob\Apps\not-alone\functions\lib\index.js:128
                            yield;
                            ^^^^^

SyntaxError: Unexpected strict mode reserved word
    at wrapSafe (node:internal/modules/cjs/loader:1378:20)
    at Module._compile (node:internal/modules/cjs/loader:1428:41)
    at Module._extensions..js (node:internal/modules/cjs/loader:1548:10)
    at Module.load (node:internal/modules/cjs/loader:1288:32)
    at Module._load (node:internal/modules/cjs/loader:1104:12)
    at Module.require (node:internal/modules/cjs/loader:1311:19)
    at require (node:internal/modules/helpers:179:18)
    at loadModule (C:\Users\Rob\Apps\not-alone\functions\node_modules\firebase-functions\lib\runtime\loader.js:40:16)
    at loadStack (C:\Users\Rob\Apps\not-alone\functions\node_modules\firebase-functions\lib\runtime\loader.js:157:23)
    at C:\Users\Rob\Apps\not-alone\functions\node_modules\firebase-functions\lib\bin\firebase-functions.js:56:56

[debug] [2024-11-12T22:57:26.316Z] Got response code 400; body Failed to generate manifest from function source: SyntaxError: Unexpected strict mode reserved word
[error] !!  functions: Failed to load function definition from source: FirebaseError: Functions codebase could not be analyzed successfully. It may have a syntax or runtime error {"metadata":{"emulator":{"name":"functions"},"message":"Failed to load function definition from source: FirebaseError: Functions codebase could not be analyzed successfully. It may have a syntax or runtime error"}}
[debug] [2024-11-12T22:57:33.997Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-12T22:57:33.997Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-12T22:57:35.006Z] Validating nodejs source
[debug] [2024-11-12T22:57:35.945Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:57:35.945Z] Building nodejs source
[debug] [2024-11-12T22:57:35.945Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:57:35.946Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:57:35.955Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8792

[debug] [2024-11-12T22:57:36.599Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:57:40.621Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:57:40.622Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:57:46.635Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:57:46.635Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:57:46.635Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:57:46.635Z"],"workRunningCount":1}
[debug] [2024-11-12T22:57:46.635Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:57:46.637Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:57:46.638Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:57:46.638Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-12T22:57:46.650Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-12T22:57:46.650Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-12T22:57:48.282Z] [runtime-status] [35552] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35552] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:57:48.284Z] [runtime-status] [35552] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35552] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:57:48.284Z] [runtime-status] [35552] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35552] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-12T22:57:48.285Z] [runtime-status] [35552] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35552] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-12T22:57:48.285Z] [runtime-status] [35552] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35552] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:57:48.629Z] [runtime-status] [35552] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35552] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-12T22:57:48.630Z] [runtime-status] [35552] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35552] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-12T22:57:48.631Z] [runtime-status] [35552] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35552] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:57:48.638Z] [runtime-status] [35552] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35552] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:57:48.642Z] [runtime-status] [35552] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35552] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:57:48.642Z] [runtime-status] [35552] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35552] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2024-11-12T22:57:48.738Z] [runtime-status] [35552] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35552] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-12T22:57:48.739Z] [runtime-status] [35552] Listening to port: \\?\pipe\fire_emu_082ce17ce1a3eb03 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35552] Listening to port: \\\\?\\pipe\\fire_emu_082ce17ce1a3eb03"}}
[debug] [2024-11-12T22:57:48.750Z] [worker-us-central1-processChat-e3b0a56f-9ddf-4639-8358-75ae4a01df26]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e3b0a56f-9ddf-4639-8358-75ae4a01df26]: IDLE"}}
[debug] [2024-11-12T22:57:48.751Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:57:48.752Z] [worker-us-central1-processChat-e3b0a56f-9ddf-4639-8358-75ae4a01df26]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e3b0a56f-9ddf-4639-8358-75ae4a01df26]: BUSY"}}
[debug] [2024-11-12T22:57:48.757Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 5.8049ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 5.8049ms"}}
[debug] [2024-11-12T22:57:48.758Z] [worker-us-central1-processChat-e3b0a56f-9ddf-4639-8358-75ae4a01df26]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e3b0a56f-9ddf-4639-8358-75ae4a01df26]: IDLE"}}
[debug] [2024-11-12T22:57:48.758Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:57:48.759Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:57:48.759Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:57:48.761Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:57:48.761Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:57:48.761Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:57:48.761Z"],"workRunningCount":1}
[debug] [2024-11-12T22:57:48.761Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:57:48.762Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:57:48.762Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:57:48.762Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:57:48.763Z] [worker-us-central1-processChat-e3b0a56f-9ddf-4639-8358-75ae4a01df26]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e3b0a56f-9ddf-4639-8358-75ae4a01df26]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'hi', chatId: 'default-chat' } {"user":"  data: { message: 'hi', chatId: 'default-chat' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'hi', chatId: 'default-chat' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 2, {"user":"  messageLength: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 2,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: default-chat {"user":"🆕 Creating new chat session: default-chat","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: default-chat"}}
[info] >  📝 Chat session created: { chatId: 'default-chat', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'default-chat', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'default-chat', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hi {"user":"💬 Sending message to Gemini: hi","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hi"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  🔄 Starting stream processing {"user":"🔄 Starting stream processing","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔄 Starting stream processing"}}
[info] >  Raw chunk received: { {"user":"Raw chunk received: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Raw chunk received: {"}}
[info] >    candidates: [ { content: [Object], index: 0 } ], {"user":"  candidates: [ { content: [Object], index: 0 } ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   candidates: [ { content: [Object], index: 0 } ],"}}
[info] >    modelVersion: 'gemini-1.5-flash-002' {"user":"  modelVersion: 'gemini-1.5-flash-002'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   modelVersion: 'gemini-1.5-flash-002'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  Extracted chunk text: Hi {"user":"Extracted chunk text: Hi","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Extracted chunk text: Hi"}}
[info] >  📦 Sending chunk: { chunkText: 'Hi', chunkLength: 2, totalLength: 2, totalChunks: 1 } {"user":"📦 Sending chunk: { chunkText: 'Hi', chunkLength: 2, totalLength: 2, totalChunks: 1 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📦 Sending chunk: { chunkText: 'Hi', chunkLength: 2, totalLength: 2, totalChunks: 1 }"}}
[debug] [2024-11-12T22:57:50.345Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 1581.5457000000001ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 1581.5457000000001ms"}}
[debug] [2024-11-12T22:57:50.345Z] [worker-us-central1-processChat-e3b0a56f-9ddf-4639-8358-75ae4a01df26]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e3b0a56f-9ddf-4639-8358-75ae4a01df26]: IDLE"}}
[debug] [2024-11-12T22:57:50.346Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:57:50.346Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:57:50.346Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:58:52.620Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-12T22:58:53.634Z] Validating nodejs source
[debug] [2024-11-12T22:58:54.648Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:58:54.648Z] Building nodejs source
[debug] [2024-11-12T22:58:54.648Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:58:54.649Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:58:54.658Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8871

[debug] [2024-11-12T22:58:55.317Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:58:59.344Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:58:59.344Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:58:59.346Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-12T22:58:59.346Z] [worker-us-central1-processChat-e3b0a56f-9ddf-4639-8358-75ae4a01df26]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e3b0a56f-9ddf-4639-8358-75ae4a01df26]: FINISHING"}}
[debug] [2024-11-12T22:58:59.365Z] [worker-us-central1-processChat-e3b0a56f-9ddf-4639-8358-75ae4a01df26]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e3b0a56f-9ddf-4639-8358-75ae4a01df26]: exited"}}
[debug] [2024-11-12T22:58:59.365Z] [worker-us-central1-processChat-e3b0a56f-9ddf-4639-8358-75ae4a01df26]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e3b0a56f-9ddf-4639-8358-75ae4a01df26]: FINISHED"}}
[debug] [2024-11-12T22:59:03.863Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-12T22:59:03.864Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-12T22:59:04.870Z] Validating nodejs source
[debug] [2024-11-12T22:59:05.848Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T22:59:05.848Z] Building nodejs source
[debug] [2024-11-12T22:59:05.848Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T22:59:05.849Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T22:59:05.857Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8497

[debug] [2024-11-12T22:59:06.575Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T22:59:10.606Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T22:59:10.607Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T22:59:11.625Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:59:11.625Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:59:11.625Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:59:11.625Z"],"workRunningCount":1}
[debug] [2024-11-12T22:59:11.626Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:59:11.628Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:59:11.628Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:59:11.628Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-12T22:59:11.636Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-12T22:59:11.636Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-12T22:59:13.288Z] [runtime-status] [27340] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27340] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:59:13.290Z] [runtime-status] [27340] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27340] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:59:13.290Z] [runtime-status] [27340] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27340] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-12T22:59:13.291Z] [runtime-status] [27340] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27340] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-12T22:59:13.292Z] [runtime-status] [27340] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27340] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:59:13.610Z] [runtime-status] [27340] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27340] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-12T22:59:13.611Z] [runtime-status] [27340] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27340] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-12T22:59:13.611Z] [runtime-status] [27340] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27340] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:59:13.617Z] [runtime-status] [27340] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27340] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T22:59:13.620Z] [runtime-status] [27340] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27340] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T22:59:13.620Z] [runtime-status] [27340] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27340] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2024-11-12T22:59:13.723Z] [runtime-status] [27340] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27340] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-12T22:59:13.724Z] [runtime-status] [27340] Listening to port: \\?\pipe\fire_emu_39a87d98198ba5cd {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27340] Listening to port: \\\\?\\pipe\\fire_emu_39a87d98198ba5cd"}}
[debug] [2024-11-12T22:59:13.738Z] [worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: IDLE"}}
[debug] [2024-11-12T22:59:13.738Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:59:13.739Z] [worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: BUSY"}}
[debug] [2024-11-12T22:59:13.744Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 5.434ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 5.434ms"}}
[debug] [2024-11-12T22:59:13.745Z] [worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: IDLE"}}
[debug] [2024-11-12T22:59:13.745Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:59:13.745Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:59:13.746Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:59:13.747Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:59:13.747Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T22:59:13.747Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T22:59:13.747Z"],"workRunningCount":1}
[debug] [2024-11-12T22:59:13.747Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T22:59:13.748Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T22:59:13.748Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T22:59:13.749Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T22:59:13.749Z] [worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'hi', chatId: 'default-chat' } {"user":"  data: { message: 'hi', chatId: 'default-chat' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'hi', chatId: 'default-chat' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 2, {"user":"  messageLength: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 2,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: default-chat {"user":"🆕 Creating new chat session: default-chat","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: default-chat"}}
[info] >  📝 Chat session created: { chatId: 'default-chat', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'default-chat', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'default-chat', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hi {"user":"💬 Sending message to Gemini: hi","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hi"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  ✅ Response received: { responseLength: 155, timestamp: '2024-11-12T22:59:15.994Z' } {"user":"✅ Response received: { responseLength: 155, timestamp: '2024-11-12T22:59:15.994Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 155, timestamp: '2024-11-12T22:59:15.994Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: 'Hi there!  How can I help you today?  Are you looking to discuss a specific relationship, or do you have general questions about relationships in general?\n', {"user":"  message: 'Hi there!  How can I help you today?  Are you looking to discuss a specific relationship, or do you have general questions about relationships in general?\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Hi there!  How can I help you today?  Are you looking to discuss a specific relationship, or do you have general questions about relationships in general?\\n',"}}
[info] >    userMessage: 'hi', {"user":"  userMessage: 'hi',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hi',"}}
[info] >    timestamp: '2024-11-12T22:59:15.994Z', {"user":"  timestamp: '2024-11-12T22:59:15.994Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T22:59:15.994Z',"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T22:59:16.002Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2252.2006ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2252.2006ms"}}
[debug] [2024-11-12T22:59:16.002Z] [worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: IDLE"}}
[debug] [2024-11-12T22:59:16.003Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T22:59:16.003Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T22:59:16.003Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T23:01:18.862Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T23:01:18.862Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T23:01:18.862Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T23:01:18.862Z"],"workRunningCount":1}
[debug] [2024-11-12T23:01:18.862Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T23:01:18.864Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T23:01:18.864Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T23:01:18.864Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T23:01:18.865Z] [worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: BUSY"}}
[debug] [2024-11-12T23:01:18.868Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 3.2568ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 3.2568ms"}}
[debug] [2024-11-12T23:01:18.869Z] [worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: IDLE"}}
[debug] [2024-11-12T23:01:18.869Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T23:01:18.869Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T23:01:18.869Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T23:01:18.870Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T23:01:18.870Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T23:01:18.870Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T23:01:18.870Z"],"workRunningCount":1}
[debug] [2024-11-12T23:01:18.870Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T23:01:18.873Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T23:01:18.873Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T23:01:18.874Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T23:01:18.874Z] [worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'hello', chatId: 'default-chat' } {"user":"  data: { message: 'hello', chatId: 'default-chat' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'hello', chatId: 'default-chat' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 5, {"user":"  messageLength: 5,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 5,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[info] >  ✅ Response received: { responseLength: 30, timestamp: '2024-11-12T23:01:20.216Z' } {"user":"✅ Response received: { responseLength: 30, timestamp: '2024-11-12T23:01:20.216Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 30, timestamp: '2024-11-12T23:01:20.216Z' }"}}
[debug] [2024-11-12T23:01:20.218Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 1343.9564ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 1343.9564ms"}}
[debug] [2024-11-12T23:01:20.219Z] [worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: IDLE"}}
[debug] [2024-11-12T23:01:20.219Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T23:01:20.219Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T23:01:20.219Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: 'Hello!  How can I assist you?\n', {"user":"  message: 'Hello!  How can I assist you?\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Hello!  How can I assist you?\\n',"}}
[info] >    userMessage: 'hello', {"user":"  userMessage: 'hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hello',"}}
[info] >    timestamp: '2024-11-12T23:01:20.216Z', {"user":"  timestamp: '2024-11-12T23:01:20.216Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T23:01:20.216Z',"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T23:04:03.069Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T23:04:03.069Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T23:04:03.070Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T23:04:03.069Z"],"workRunningCount":1}
[debug] [2024-11-12T23:04:03.070Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T23:04:03.075Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T23:04:03.075Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T23:04:03.075Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T23:04:03.076Z] [worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: BUSY"}}
[debug] [2024-11-12T23:04:03.079Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2.8297ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2.8297ms"}}
[debug] [2024-11-12T23:04:03.080Z] [worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: IDLE"}}
[debug] [2024-11-12T23:04:03.080Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T23:04:03.080Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T23:04:03.080Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T23:04:03.081Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T23:04:03.081Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T23:04:03.081Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T23:04:03.081Z"],"workRunningCount":1}
[debug] [2024-11-12T23:04:03.081Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T23:04:03.083Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T23:04:03.083Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T23:04:03.083Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T23:04:03.084Z] [worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'helo', chatId: 'default-chat' } {"user":"  data: { message: 'helo', chatId: 'default-chat' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'helo', chatId: 'default-chat' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 4, {"user":"  messageLength: 4,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 4,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: helo {"user":"💬 Sending message to Gemini: helo","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: helo"}}
[info] >  ✅ Response received: { responseLength: 35, timestamp: '2024-11-12T23:04:04.369Z' } {"user":"✅ Response received: { responseLength: 35, timestamp: '2024-11-12T23:04:04.369Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 35, timestamp: '2024-11-12T23:04:04.369Z' }"}}
[debug] [2024-11-12T23:04:04.371Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 1286.7733ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 1286.7733ms"}}
[debug] [2024-11-12T23:04:04.371Z] [worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: IDLE"}}
[debug] [2024-11-12T23:04:04.371Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T23:04:04.371Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T23:04:04.371Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: 'Hello! How can I assist you today?\n', {"user":"  message: 'Hello! How can I assist you today?\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Hello! How can I assist you today?\\n',"}}
[info] >    userMessage: 'helo', {"user":"  userMessage: 'helo',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'helo',"}}
[info] >    timestamp: '2024-11-12T23:04:04.369Z', {"user":"  timestamp: '2024-11-12T23:04:04.369Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T23:04:04.369Z',"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'default-chat' {"user":"  chatId: 'default-chat'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'default-chat'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T23:08:23.806Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-12T23:08:24.822Z] Validating nodejs source
[debug] [2024-11-12T23:08:25.897Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T23:08:25.897Z] Building nodejs source
[debug] [2024-11-12T23:08:25.897Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T23:08:25.899Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T23:08:25.910Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8220

[debug] [2024-11-12T23:08:26.597Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T23:08:30.634Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T23:08:30.635Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T23:08:30.636Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-12T23:08:30.636Z] [worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: FINISHING"}}
[debug] [2024-11-12T23:08:30.649Z] [worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: exited"}}
[debug] [2024-11-12T23:08:30.650Z] [worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1ee9f079-babb-4962-b5b7-d6363d64a93b]: FINISHED"}}
[debug] [2024-11-12T23:10:45.081Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-12T23:10:45.131Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-12T23:10:45.182Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-12T23:10:46.195Z] Validating nodejs source
[debug] [2024-11-12T23:10:47.139Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T23:10:47.139Z] Building nodejs source
[debug] [2024-11-12T23:10:47.139Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T23:10:47.140Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T23:10:47.149Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8366

[debug] [2024-11-12T23:10:47.854Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T23:10:51.876Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T23:10:51.877Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T23:11:30.154Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-12T23:11:30.154Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-12T23:11:31.164Z] Validating nodejs source
[debug] [2024-11-12T23:11:32.265Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-12T23:11:32.265Z] Building nodejs source
[debug] [2024-11-12T23:11:32.265Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-12T23:11:32.266Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-12T23:11:32.275Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8770

[debug] [2024-11-12T23:11:32.946Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-12T23:11:36.973Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-12T23:11:36.974Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-12T23:11:40.109Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T23:11:40.109Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T23:11:40.109Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T23:11:40.109Z"],"workRunningCount":1}
[debug] [2024-11-12T23:11:40.109Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T23:11:40.111Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T23:11:40.111Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T23:11:40.111Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-12T23:11:40.119Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-12T23:11:40.119Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-12T23:11:41.867Z] [runtime-status] [23200] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23200] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T23:11:41.869Z] [runtime-status] [23200] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23200] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T23:11:41.869Z] [runtime-status] [23200] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23200] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-12T23:11:41.870Z] [runtime-status] [23200] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23200] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-12T23:11:41.871Z] [runtime-status] [23200] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23200] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T23:11:42.205Z] [runtime-status] [23200] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23200] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-12T23:11:42.205Z] [runtime-status] [23200] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23200] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-12T23:11:42.206Z] [runtime-status] [23200] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23200] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T23:11:42.211Z] [runtime-status] [23200] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23200] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-12T23:11:42.213Z] [runtime-status] [23200] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23200] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-12T23:11:42.213Z] [runtime-status] [23200] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23200] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2024-11-12T23:11:42.306Z] [runtime-status] [23200] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23200] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-12T23:11:42.307Z] [runtime-status] [23200] Listening to port: \\?\pipe\fire_emu_45d81e176276be5a {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23200] Listening to port: \\\\?\\pipe\\fire_emu_45d81e176276be5a"}}
[debug] [2024-11-12T23:11:42.318Z] [worker-us-central1-processChat-17b37ea3-e996-4d0e-8268-e32633460e4f]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-17b37ea3-e996-4d0e-8268-e32633460e4f]: IDLE"}}
[debug] [2024-11-12T23:11:42.318Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T23:11:42.319Z] [worker-us-central1-processChat-17b37ea3-e996-4d0e-8268-e32633460e4f]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-17b37ea3-e996-4d0e-8268-e32633460e4f]: BUSY"}}
[debug] [2024-11-12T23:11:42.324Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 5.1895ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 5.1895ms"}}
[debug] [2024-11-12T23:11:42.325Z] [worker-us-central1-processChat-17b37ea3-e996-4d0e-8268-e32633460e4f]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-17b37ea3-e996-4d0e-8268-e32633460e4f]: IDLE"}}
[debug] [2024-11-12T23:11:42.325Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T23:11:42.325Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T23:11:42.326Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T23:11:42.327Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T23:11:42.327Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-12T23:11:42.327Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-12T23:11:42.327Z"],"workRunningCount":1}
[debug] [2024-11-12T23:11:42.327Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-12T23:11:42.328Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-12T23:11:42.328Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-12T23:11:42.328Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-12T23:11:42.329Z] [worker-us-central1-processChat-17b37ea3-e996-4d0e-8268-e32633460e4f]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-17b37ea3-e996-4d0e-8268-e32633460e4f]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello' } } {"user":"🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello' } }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello' } }"}}
[info] >  📝 Using chat ID: undefined {"user":"📝 Using chat ID: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: undefined"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 5, {"user":"  messageLength: 5,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 5,"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: undefined {"user":"  chatId: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: undefined"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: chat-1731453102350-wfzjndy2d {"user":"🆕 Creating new chat session: chat-1731453102350-wfzjndy2d","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: chat-1731453102350-wfzjndy2d"}}
[info] >  📝 Chat session created: { chatId: 'chat-1731453102350-wfzjndy2d', sessionExists: false } {"user":"📝 Chat session created: { chatId: 'chat-1731453102350-wfzjndy2d', sessionExists: false }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'chat-1731453102350-wfzjndy2d', sessionExists: false }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  ✅ Response received: { responseLength: 175, timestamp: '2024-11-12T23:11:44.744Z' } {"user":"✅ Response received: { responseLength: 175, timestamp: '2024-11-12T23:11:44.744Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 175, timestamp: '2024-11-12T23:11:44.744Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: "Hello!  How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in general relationship advice?  Let me know what's on your mind.\n", {"user":"  message: \"Hello!  How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in general relationship advice?  Let me know what's on your mind.\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: \"Hello!  How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in general relationship advice?  Let me know what's on your mind.\\n\","}}
[info] >    userMessage: 'hello', {"user":"  userMessage: 'hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hello',"}}
[info] >    timestamp: '2024-11-12T23:11:44.744Z', {"user":"  timestamp: '2024-11-12T23:11:44.744Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-12T23:11:44.744Z',"}}
[info] >    userId: '34b2XQAnQgS78q5A6Qeek4Tashl4', {"user":"  userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: '34b2XQAnQgS78q5A6Qeek4Tashl4',"}}
[info] >    chatId: 'chat-1731453102350-wfzjndy2d' {"user":"  chatId: 'chat-1731453102350-wfzjndy2d'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731453102350-wfzjndy2d'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-12T23:11:44.750Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2420.7666ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2420.7666ms"}}
[debug] [2024-11-12T23:11:44.750Z] [worker-us-central1-processChat-17b37ea3-e996-4d0e-8268-e32633460e4f]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-17b37ea3-e996-4d0e-8268-e32633460e4f]: IDLE"}}
[debug] [2024-11-12T23:11:44.750Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-12T23:11:44.750Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-12T23:11:44.751Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
