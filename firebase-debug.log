[debug] [2024-11-13T05:08:57.626Z] ----------------------------------------------------------------------
[debug] [2024-11-13T05:08:57.630Z] Command:       C:\Program Files\nodejs\node.exe C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\bin\firebase.js emulators:start
[debug] [2024-11-13T05:08:57.630Z] CLI Version:   13.24.2
[debug] [2024-11-13T05:08:57.631Z] Platform:      win32
[debug] [2024-11-13T05:08:57.631Z] Node Version:  v20.18.0
[debug] [2024-11-13T05:08:57.631Z] Time:          Wed Nov 13 2024 16:08:57 GMT+1100 (Australian Eastern Daylight Time)
[debug] [2024-11-13T05:08:57.631Z] ----------------------------------------------------------------------
[debug] 
[debug] [2024-11-13T05:08:57.800Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2024-11-13T05:08:57.800Z] > authorizing via signed-in user (lisakhun58@gmail.com)
[debug] [2024-11-13T05:08:57.931Z] java version "21.0.5" 2024-10-15 LTS

[debug] [2024-11-13T05:08:57.932Z] Java(TM) SE Runtime Environment (build 21.0.5+9-LTS-239)
Java HotSpot(TM) 64-Bit Server VM (build 21.0.5+9-LTS-239, mixed mode, sharing)

[debug] [2024-11-13T05:08:57.964Z] Parsed Java major version: 21
[info] i  emulators: Starting emulators: auth, functions, firestore, extensions {"metadata":{"emulator":{"name":"hub"},"message":"Starting emulators: auth, functions, firestore, extensions"}}
[debug] [2024-11-13T05:08:57.967Z] Checked if tokens are valid: true, expires at: 1731476372002
[debug] [2024-11-13T05:08:57.968Z] Checked if tokens are valid: true, expires at: 1731476372002
[debug] [2024-11-13T05:08:57.969Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc [none]
[debug] [2024-11-13T05:08:58.752Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc 200
[debug] [2024-11-13T05:08:58.752Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc {"projectId":"notalone-de4fc","projectNumber":"784029337452","displayName":"NotAlone","name":"projects/notalone-de4fc","resources":{"hostingSite":"notalone-de4fc"},"state":"ACTIVE","etag":"1_570ddbb0-4c2c-4e94-b3b3-0005c847d3e1"}
[debug] [2024-11-13T05:08:58.770Z] [logging] Logging Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-13T05:08:58.771Z] [auth] Authentication Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-13T05:08:58.771Z] [firestore] Firestore Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-13T05:08:58.771Z] [firestore.websocket] websocket server for firestore only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-13T05:08:58.771Z] assigned listening specs for emulators {"user":{"hub":[{"address":"127.0.0.1","family":"IPv4","port":4400},{"address":"::1","family":"IPv6","port":4400}],"ui":[{"address":"127.0.0.1","family":"IPv4","port":4000},{"address":"::1","family":"IPv6","port":4000}],"logging":[{"address":"127.0.0.1","family":"IPv4","port":4500}],"auth":[{"address":"127.0.0.1","family":"IPv4","port":9099}],"firestore":[{"address":"127.0.0.1","family":"IPv4","port":8080}],"firestore.websocket":[{"address":"127.0.0.1","family":"IPv4","port":9150}]},"metadata":{"message":"assigned listening specs for emulators"}}
[debug] [2024-11-13T05:08:58.777Z] [hub] writing locator at C:\Users\Rob\AppData\Local\Temp\hub-notalone-de4fc.json
[debug] [2024-11-13T05:08:58.787Z] [Extensions] Started Extensions emulator, this is a noop.
[debug] [2024-11-13T05:08:58.793Z] [functions] Functions Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-13T05:08:58.793Z] [eventarc] Eventarc Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-13T05:08:58.793Z] [tasks] Cloud Tasks Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-13T05:08:58.793Z] late-assigned ports for functions and eventarc emulators {"user":{"hub":[{"address":"127.0.0.1","family":"IPv4","port":4400},{"address":"::1","family":"IPv6","port":4400}],"ui":[{"address":"127.0.0.1","family":"IPv4","port":4000},{"address":"::1","family":"IPv6","port":4000}],"logging":[{"address":"127.0.0.1","family":"IPv4","port":4500}],"auth":[{"address":"127.0.0.1","family":"IPv4","port":9099}],"firestore":[{"address":"127.0.0.1","family":"IPv4","port":8080}],"firestore.websocket":[{"address":"127.0.0.1","family":"IPv4","port":9150}],"functions":[{"address":"127.0.0.1","family":"IPv4","port":5001}],"eventarc":[{"address":"127.0.0.1","family":"IPv4","port":9299}],"tasks":[{"address":"127.0.0.1","family":"IPv4","port":9499}]},"metadata":{"message":"late-assigned ports for functions and eventarc emulators"}}
[warn] !  functions: The following emulators are not running, calls to these services from the Functions emulator will affect production: database, hosting, pubsub, storage, dataconnect {"metadata":{"emulator":{"name":"functions"},"message":"The following emulators are not running, calls to these services from the Functions emulator will affect production: \u001b[1mdatabase, hosting, pubsub, storage, dataconnect\u001b[22m"}}
[debug] [2024-11-13T05:08:58.798Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T05:08:58.801Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[debug] [2024-11-13T05:08:58.801Z] Checked if tokens are valid: true, expires at: 1731476372002
[debug] [2024-11-13T05:08:58.802Z] Checked if tokens are valid: true, expires at: 1731476372002
[debug] [2024-11-13T05:08:58.802Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc/adminSdkConfig [none]
[debug] [2024-11-13T05:08:59.220Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc/adminSdkConfig 200
[debug] [2024-11-13T05:08:59.220Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc/adminSdkConfig {"projectId":"notalone-de4fc","storageBucket":"notalone-de4fc.firebasestorage.app"}
[debug] [2024-11-13T05:08:59.242Z] Ignoring unsupported arg: auto_download {"metadata":{"emulator":{"name":"firestore"},"message":"Ignoring unsupported arg: auto_download"}}
[debug] [2024-11-13T05:08:59.242Z] Ignoring unsupported arg: single_project_mode_error {"metadata":{"emulator":{"name":"firestore"},"message":"Ignoring unsupported arg: single_project_mode_error"}}
[debug] [2024-11-13T05:08:59.242Z] Starting Firestore Emulator with command {"binary":"java","args":["-Dgoogle.cloud_firestore.debug_log_level=FINE","-Duser.language=en","-jar","C:\\Users\\Rob\\.cache\\firebase\\emulators\\cloud-firestore-emulator-v1.19.8.jar","--host","127.0.0.1","--port",8080,"--websocket_port",9150,"--project_id","notalone-de4fc","--rules","C:\\Users\\Rob\\apps\\not-alone\\firestore.rules","--single_project_mode",true,"--functions_emulator","127.0.0.1:5001"],"optionalArgs":["port","webchannel_port","host","rules","websocket_port","functions_emulator","seed_from_export","project_id","single_project_mode"],"joinArgs":false,"shell":false,"port":8080} {"metadata":{"emulator":{"name":"firestore"},"message":"Starting Firestore Emulator with command {\"binary\":\"java\",\"args\":[\"-Dgoogle.cloud_firestore.debug_log_level=FINE\",\"-Duser.language=en\",\"-jar\",\"C:\\\\Users\\\\Rob\\\\.cache\\\\firebase\\\\emulators\\\\cloud-firestore-emulator-v1.19.8.jar\",\"--host\",\"127.0.0.1\",\"--port\",8080,\"--websocket_port\",9150,\"--project_id\",\"notalone-de4fc\",\"--rules\",\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\firestore.rules\",\"--single_project_mode\",true,\"--functions_emulator\",\"127.0.0.1:5001\"],\"optionalArgs\":[\"port\",\"webchannel_port\",\"host\",\"rules\",\"websocket_port\",\"functions_emulator\",\"seed_from_export\",\"project_id\",\"single_project_mode\"],\"joinArgs\":false,\"shell\":false,\"port\":8080}"}}
[info] i  firestore: Firestore Emulator logging to firestore-debug.log {"metadata":{"emulator":{"name":"firestore"},"message":"Firestore Emulator logging to \u001b[1mfirestore-debug.log\u001b[22m"}}
[info] +  firestore: Firestore Emulator UI websocket is running on 9150. {"metadata":{"emulator":{"name":"firestore"},"message":"Firestore Emulator UI websocket is running on 9150."}}
[debug] [2024-11-13T05:09:10.118Z] Ignoring unsupported arg: auto_download {"metadata":{"emulator":{"name":"ui"},"message":"Ignoring unsupported arg: auto_download"}}
[debug] [2024-11-13T05:09:10.119Z] Ignoring unsupported arg: port {"metadata":{"emulator":{"name":"ui"},"message":"Ignoring unsupported arg: port"}}
[debug] [2024-11-13T05:09:10.119Z] Starting Emulator UI with command {"binary":"node","args":["C:\\Users\\Rob\\.cache\\firebase\\emulators\\ui-v1.14.0\\server\\server.mjs"],"optionalArgs":[],"joinArgs":false,"shell":false,"port":4000} {"metadata":{"emulator":{"name":"ui"},"message":"Starting Emulator UI with command {\"binary\":\"node\",\"args\":[\"C:\\\\Users\\\\Rob\\\\.cache\\\\firebase\\\\emulators\\\\ui-v1.14.0\\\\server\\\\server.mjs\"],\"optionalArgs\":[],\"joinArgs\":false,\"shell\":false,\"port\":4000}"}}
[info] i  ui: Emulator UI logging to ui-debug.log {"metadata":{"emulator":{"name":"ui"},"message":"Emulator UI logging to \u001b[1mui-debug.log\u001b[22m"}}
[debug] [2024-11-13T05:09:10.308Z] Web / API server started at 127.0.0.1:4000
 {"metadata":{"emulator":{"name":"ui"},"message":"Web / API server started at 127.0.0.1:4000\n"}}
[debug] [2024-11-13T05:09:10.309Z] Web / API server started at ::1:4000
 {"metadata":{"emulator":{"name":"ui"},"message":"Web / API server started at ::1:4000\n"}}
[debug] [2024-11-13T05:09:10.346Z] [Extensions] Connecting Extensions emulator, this is a noop.
[info] i  functions: Watching "C:\Users\Rob\apps\not-alone\functions" for Cloud Functions... {"metadata":{"emulator":{"name":"functions"},"message":"Watching \"C:\\Users\\Rob\\apps\\not-alone\\functions\" for Cloud Functions..."}}
[debug] [2024-11-13T05:09:10.354Z] Validating nodejs source
[debug] [2024-11-13T05:09:11.371Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T05:09:11.371Z] Building nodejs source
[debug] [2024-11-13T05:09:11.372Z] Failed to find version of module node: reached end of search path C:\Users\Rob\apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T05:09:11.376Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T05:09:11.386Z] Found firebase-functions binary at 'C:\Users\Rob\apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8420

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T05:09:12.129Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T05:09:16.170Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T05:09:16.171Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[info] +  functions[us-central1-saveChatHistory]: http function initialized (http://127.0.0.1:5001/notalone-de4fc/us-central1/saveChatHistory). {"metadata":{"emulator":{"name":"functions"},"message":"\u001b[1mhttp\u001b[22m function initialized (http://127.0.0.1:5001/notalone-de4fc/us-central1/saveChatHistory)."}}
[info] +  functions[us-central1-processChat]: http function initialized (http://127.0.0.1:5001/notalone-de4fc/us-central1/processChat). {"metadata":{"emulator":{"name":"functions"},"message":"\u001b[1mhttp\u001b[22m function initialized (http://127.0.0.1:5001/notalone-de4fc/us-central1/processChat)."}}
[debug] [2024-11-13T05:09:16.180Z] Could not find VSCode notification endpoint: FetchError: request to http://localhost:40001/vscode/notify failed, reason: . If you are not running the Firebase Data Connect VSCode extension, this is expected and not an issue.
[info] 
┌─────────────────────────────────────────────────────────────┐
│ ✔  All emulators ready! It is now safe to connect your app. │
│ i  View Emulator UI at http://127.0.0.1:4000/               │
└─────────────────────────────────────────────────────────────┘

┌────────────────┬────────────────┬──────────────────────────────────┐
│ Emulator       │ Host:Port      │ View in Emulator UI              │
├────────────────┼────────────────┼──────────────────────────────────┤
│ Authentication │ 127.0.0.1:9099 │ http://127.0.0.1:4000/auth       │
├────────────────┼────────────────┼──────────────────────────────────┤
│ Functions      │ 127.0.0.1:5001 │ http://127.0.0.1:4000/functions  │
├────────────────┼────────────────┼──────────────────────────────────┤
│ Firestore      │ 127.0.0.1:8080 │ http://127.0.0.1:4000/firestore  │
├────────────────┼────────────────┼──────────────────────────────────┤
│ Extensions     │ 127.0.0.1:5001 │ http://127.0.0.1:4000/extensions │
└────────────────┴────────────────┴──────────────────────────────────┘
  Emulator Hub running at 127.0.0.1:4400
  Other reserved ports: 4500, 9150
┌─────────────────────────┬───────────────┬─────────────────────┐
│ Extension Instance Name │ Extension Ref │ View in Emulator UI │
└─────────────────────────┴───────────────┴─────────────────────┘
Issues? Report them at https://github.com/firebase/firebase-tools/issues and attach the *-debug.log files.
 
[debug] [2024-11-13T05:11:15.858Z] File C:\Users\Rob\apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T05:11:16.871Z] Validating nodejs source
[debug] [2024-11-13T05:11:17.971Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T05:11:17.972Z] Building nodejs source
[debug] [2024-11-13T05:11:17.972Z] Failed to find version of module node: reached end of search path C:\Users\Rob\apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T05:11:17.974Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T05:11:17.993Z] Found firebase-functions binary at 'C:\Users\Rob\apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8190

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T05:11:18.825Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T05:11:22.866Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T05:11:22.867Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T05:11:51.925Z] File C:\Users\Rob\apps\not-alone\functions\lib\chatHistory.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\chatHistory.js.map changed, reloading triggers"}}
[debug] [2024-11-13T05:11:51.929Z] File C:\Users\Rob\apps\not-alone\functions\lib\chatHistory.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\chatHistory.js changed, reloading triggers"}}
[debug] [2024-11-13T05:11:51.936Z] File C:\Users\Rob\apps\not-alone\functions\lib\getChatHistory.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\getChatHistory.js.map changed, reloading triggers"}}
[debug] [2024-11-13T05:11:51.940Z] File C:\Users\Rob\apps\not-alone\functions\lib\getChatHistory.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\getChatHistory.js changed, reloading triggers"}}
[debug] [2024-11-13T05:11:51.969Z] File C:\Users\Rob\apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-13T05:11:51.969Z] File C:\Users\Rob\apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-13T05:11:52.971Z] Validating nodejs source
[debug] [2024-11-13T05:11:54.147Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T05:11:54.147Z] Building nodejs source
[debug] [2024-11-13T05:11:54.147Z] Failed to find version of module node: reached end of search path C:\Users\Rob\apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T05:11:54.149Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T05:11:54.163Z] Found firebase-functions binary at 'C:\Users\Rob\apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8570

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T05:11:55.003Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"getChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"getChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T05:11:59.044Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T05:11:59.045Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, getChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, getChatHistory, processChat."}}
[info] +  functions[us-central1-getChatHistory]: http function initialized (http://127.0.0.1:5001/notalone-de4fc/us-central1/getChatHistory). {"metadata":{"emulator":{"name":"functions"},"message":"\u001b[1mhttp\u001b[22m function initialized (http://127.0.0.1:5001/notalone-de4fc/us-central1/getChatHistory)."}}
[debug] [2024-11-13T05:12:24.698Z] >>> [apiv2][query] POST http://127.0.0.1:5001/functions/projects/notalone-de4fc/trigger_multicast [none]
[debug] [2024-11-13T05:12:24.698Z] >>> [apiv2][body] POST http://127.0.0.1:5001/functions/projects/notalone-de4fc/trigger_multicast {"eventId":"7edb3b34-4a0a-4f1c-88f2-9624542ff229","eventType":"providers/firebase.auth/eventTypes/user.create","resource":{"name":"projects/notalone-de4fc","service":"firebaseauth.googleapis.com"},"params":{},"timestamp":"2024-11-13T05:12:24.697Z","data":{"uid":"UQsdkgUmkfZuAT8HgeMGAb3WnFEN","email":"otter.algae.549@example.com","emailVerified":true,"displayName":"Otter Algae","metadata":{"creationTime":"2024-11-13T05:12:24.696Z","lastSignInTime":"2024-11-13T05:12:24.696Z"},"customClaims":{},"providerData":[{"providerId":"google.com","rawId":"6764898242392933410461502419344114955263","federatedId":"6764898242392933410461502419344114955263","displayName":"Otter Algae","email":"otter.algae.549@example.com","screenName":"algae_otter"}]}}
[debug] [2024-11-13T05:12:24.708Z] <<< [apiv2][status] POST http://127.0.0.1:5001/functions/projects/notalone-de4fc/trigger_multicast 200
[debug] [2024-11-13T05:12:24.708Z] <<< [apiv2][body] POST http://127.0.0.1:5001/functions/projects/notalone-de4fc/trigger_multicast {"status":"multicast_acknowledged"}
[debug] [2024-11-13T05:12:30.442Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:12:30.442Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:12:30.442Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:12:30.442Z"],"workRunningCount":1}
[debug] [2024-11-13T05:12:30.443Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T05:12:30.446Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T05:12:30.447Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T05:12:30.460Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-13T05:12:30.461Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-13T05:12:32.213Z] [runtime-status] [24728] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [24728] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T05:12:32.215Z] [runtime-status] [24728] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [24728] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T05:12:32.215Z] [runtime-status] [24728] Found local functions config: C:\Users\Rob\apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [24728] Found local functions config: C:\\Users\\Rob\\apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T05:12:32.215Z] [runtime-status] [24728] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [24728] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T05:12:32.216Z] [runtime-status] [24728] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [24728] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T05:12:32.602Z] [runtime-status] [24728] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [24728] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T05:12:32.602Z] [runtime-status] [24728] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [24728] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T05:12:32.603Z] [runtime-status] [24728] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [24728] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T05:12:32.608Z] [runtime-status] [24728] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [24728] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T05:12:32.611Z] [runtime-status] [24728] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [24728] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T05:12:32.611Z] [runtime-status] [24728] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [24728] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T05:12:32.720Z] [runtime-status] [24728] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [24728] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T05:12:32.735Z] [runtime-status] [24728] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [24728] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T05:12:32.736Z] [runtime-status] [24728] Listening to port: \\?\pipe\fire_emu_501709e23be845e3 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [24728] Listening to port: \\\\?\\pipe\\fire_emu_501709e23be845e3"}}
[debug] [2024-11-13T05:12:32.769Z] [worker-us-central1-processChat-e582b43e-7a5d-4de1-92ef-2c1ad0bdc9da]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e582b43e-7a5d-4de1-92ef-2c1ad0bdc9da]: IDLE"}}
[debug] [2024-11-13T05:12:32.770Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T05:12:32.770Z] [worker-us-central1-processChat-e582b43e-7a5d-4de1-92ef-2c1ad0bdc9da]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e582b43e-7a5d-4de1-92ef-2c1ad0bdc9da]: BUSY"}}
[debug] [2024-11-13T05:12:32.775Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4.969ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4.969ms"}}
[debug] [2024-11-13T05:12:32.776Z] [worker-us-central1-processChat-e582b43e-7a5d-4de1-92ef-2c1ad0bdc9da]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e582b43e-7a5d-4de1-92ef-2c1ad0bdc9da]: IDLE"}}
[debug] [2024-11-13T05:12:32.776Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T05:12:32.777Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T05:12:32.777Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:12:32.779Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:12:32.779Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:12:32.779Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:12:32.779Z"],"workRunningCount":1}
[debug] [2024-11-13T05:12:32.779Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T05:12:32.780Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T05:12:32.780Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T05:12:32.780Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T05:12:32.780Z] [worker-us-central1-processChat-e582b43e-7a5d-4de1-92ef-2c1ad0bdc9da]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e582b43e-7a5d-4de1-92ef-2c1ad0bdc9da]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hey jude' } } {"user":"🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hey jude' } }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hey jude' } }"}}
[info] >  📝 Using chat ID: undefined {"user":"📝 Using chat ID: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: undefined"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 8, {"user":"  messageLength: 8,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 8,"}}
[info] >    userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"  userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >    chatId: undefined {"user":"  chatId: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: undefined"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: chat-1731474752798-i86t0jvme {"user":"🆕 Creating new chat session: chat-1731474752798-i86t0jvme","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: chat-1731474752798-i86t0jvme"}}
[info] >  📝 Chat session created: { chatId: 'chat-1731474752798-i86t0jvme', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'chat-1731474752798-i86t0jvme', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'chat-1731474752798-i86t0jvme', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hey jude {"user":"💬 Sending message to Gemini: hey jude","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hey jude"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  📚 Current Chat History: { {"user":"📚 Current Chat History: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📚 Current Chat History: {"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme', {"user":"  chatId: 'chat-1731474752798-i86t0jvme',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme',"}}
[info] >    historyLength: 6, {"user":"  historyLength: 6,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   historyLength: 6,"}}
[info] >    lastMessages: [ {"user":"  lastMessages: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   lastMessages: ["}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'assistant', parts: [Array] }, {"user":"    { role: 'assistant', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'assistant', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] } {"user":"    { role: 'model', parts: [Array] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Response received: { responseLength: 82, timestamp: '2024-11-13T05:12:34.747Z' } {"user":"✅ Response received: { responseLength: 82, timestamp: '2024-11-13T05:12:34.747Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 82, timestamp: '2024-11-13T05:12:34.747Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: '"Hey Jude" is a song by the Beatles.  Is there anything else I can help you with?\n', {"user":"  message: '\"Hey Jude\" is a song by the Beatles.  Is there anything else I can help you with?\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: '\"Hey Jude\" is a song by the Beatles.  Is there anything else I can help you with?\\n',"}}
[info] >    userMessage: 'hey jude', {"user":"  userMessage: 'hey jude',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hey jude',"}}
[info] >    timestamp: '2024-11-13T05:12:34.747Z', {"user":"  timestamp: '2024-11-13T05:12:34.747Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T05:12:34.747Z',"}}
[info] >    userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"  userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme' {"user":"  chatId: 'chat-1731474752798-i86t0jvme'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Attempting to save chat history with DETAILED logging: { {"user":"🔍 Attempting to save chat history with DETAILED logging: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Attempting to save chat history with DETAILED logging: {"}}
[info] >    userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"  userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme', {"user":"  chatId: 'chat-1731474752798-i86t0jvme',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme',"}}
[info] >    messageCount: 2, {"user":"  messageCount: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageCount: 2,"}}
[info] >    timestamp: '2024-11-13T05:12:34.748Z', {"user":"  timestamp: '2024-11-13T05:12:34.748Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T05:12:34.748Z',"}}
[info] >    clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' } {"user":"  clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔧 Firebase Client Configuration: { {"user":"🔧 Firebase Client Configuration: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Firebase Client Configuration: {"}}
[info] >    projectId: 'notalone-de4fc', {"user":"  projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   projectId: 'notalone-de4fc',"}}
[info] >    apiKey: 'local-api-key', {"user":"  apiKey: 'local-api-key',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   apiKey: 'local-api-key',"}}
[info] >    authDomain: undefined, {"user":"  authDomain: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   authDomain: undefined,"}}
[info] >    emulatorHost: 'localhost', {"user":"  emulatorHost: 'localhost',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorHost: 'localhost',"}}
[info] >    emulatorPort: 5001 {"user":"  emulatorPort: 5001","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorPort: 5001"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Firebase Functions Object Keys: [ {"user":"🔍 Firebase Functions Object Keys: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Object Keys: ["}}
[info] >    'app', {"user":"  'app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'app',"}}
[info] >    'emulatorOrigin', {"user":"  'emulatorOrigin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'emulatorOrigin',"}}
[info] >    'contextProvider', {"user":"  'contextProvider',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'contextProvider',"}}
[info] >    'deleteService', {"user":"  'deleteService',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'deleteService',"}}
[info] >    'cancelAllRequests', {"user":"  'cancelAllRequests',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'cancelAllRequests',"}}
[info] >    'customDomain', {"user":"  'customDomain',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'customDomain',"}}
[info] >    'region' {"user":"  'region'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'region'"}}
[info] >  ] {"user":"]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ]"}}
[info] >  🔍 Firebase Functions Instance: FunctionsService { {"user":"🔍 Firebase Functions Instance: FunctionsService {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Instance: FunctionsService {"}}
[info] >    app: FirebaseAppImpl { {"user":"  app: FirebaseAppImpl {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   app: FirebaseAppImpl {"}}
[info] >      _isDeleted: false, {"user":"    _isDeleted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _isDeleted: false,"}}
[info] >      _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }, {"user":"    _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },"}}
[info] >      _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false }, {"user":"    _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },"}}
[info] >      _name: '[DEFAULT]', {"user":"    _name: '[DEFAULT]',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _name: '[DEFAULT]',"}}
[info] >      _automaticDataCollectionEnabled: false, {"user":"    _automaticDataCollectionEnabled: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _automaticDataCollectionEnabled: false,"}}
[info] >      _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] } {"user":"    _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    emulatorOrigin: 'http://localhost:5001', {"user":"  emulatorOrigin: 'http://localhost:5001',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorOrigin: 'http://localhost:5001',"}}
[info] >    contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null }, {"user":"  contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },"}}
[info] >    deleteService: [Function (anonymous)], {"user":"  deleteService: [Function (anonymous)],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   deleteService: [Function (anonymous)],"}}
[info] >    cancelAllRequests: Promise { <pending> }, {"user":"  cancelAllRequests: Promise { <pending> },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   cancelAllRequests: Promise { <pending> },"}}
[info] >    customDomain: null, {"user":"  customDomain: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   customDomain: null,"}}
[info] >    region: 'us-central1' {"user":"  region: 'us-central1'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   region: 'us-central1'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' } {"user":"🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[info] >  🔍 Save Chat History Function Details: { {"user":"🔍 Save Chat History Function Details: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Save Chat History Function Details: {"}}
[info] >    functionExists: true, {"user":"  functionExists: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionExists: true,"}}
[info] >    functionType: 'function', {"user":"  functionType: 'function',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionType: 'function',"}}
[info] >    functionName: 'saveChatHistory' {"user":"  functionName: 'saveChatHistory'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionName: 'saveChatHistory'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📤 Chat History Payload: { {"user":"📤 Chat History Payload: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Chat History Payload: {"}}
[info] >    "userId": "UQsdkgUmkfZuAT8HgeMGAb3WnFEN", {"user":"  \"userId\": \"UQsdkgUmkfZuAT8HgeMGAb3WnFEN\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"userId\": \"UQsdkgUmkfZuAT8HgeMGAb3WnFEN\","}}
[info] >    "chatId": "chat-1731474752798-i86t0jvme", {"user":"  \"chatId\": \"chat-1731474752798-i86t0jvme\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"chatId\": \"chat-1731474752798-i86t0jvme\","}}
[info] >    "messages": [ {"user":"  \"messages\": [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"messages\": ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "user", {"user":"      \"role\": \"user\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"user\","}}
[info] >        "content": "hey jude", {"user":"      \"content\": \"hey jude\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"hey jude\","}}
[info] >        "timestamp": "2024-11-13T05:12:34.750Z" {"user":"      \"timestamp\": \"2024-11-13T05:12:34.750Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T05:12:34.750Z\""}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "model", {"user":"      \"role\": \"model\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"model\","}}
[info] >        "content": "\"Hey Jude\" is a song by the Beatles.  Is there anything else I can help you with?\n", {"user":"      \"content\": \"\\\"Hey Jude\\\" is a song by the Beatles.  Is there anything else I can help you with?\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"\\\"Hey Jude\\\" is a song by the Beatles.  Is there anything else I can help you with?\\n\","}}
[info] >        "timestamp": "2024-11-13T05:12:34.750Z" {"user":"      \"timestamp\": \"2024-11-13T05:12:34.750Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T05:12:34.750Z\""}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    "timestamp": "2024-11-13T05:12:34.750Z", {"user":"  \"timestamp\": \"2024-11-13T05:12:34.750Z\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"timestamp\": \"2024-11-13T05:12:34.750Z\","}}
[info] >    "authDetails": { {"user":"  \"authDetails\": {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"authDetails\": {"}}
[info] >      "uid": "UQsdkgUmkfZuAT8HgeMGAb3WnFEN", {"user":"    \"uid\": \"UQsdkgUmkfZuAT8HgeMGAb3WnFEN\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"uid\": \"UQsdkgUmkfZuAT8HgeMGAb3WnFEN\","}}
[info] >      "token": "Present" {"user":"    \"token\": \"Present\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"token\": \"Present\""}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T05:12:34.800Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T05:12:34.800Z"],"queueLength":1,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:12:32.779Z"],"workRunningCount":1}
[debug] [2024-11-13T05:12:34.800Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:12:32.779Z","/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T05:12:34.800Z"],"workRunningCount":2}
[debug] [2024-11-13T05:12:34.800Z] Accepted request POST /notalone-de4fc/us-central1/saveChatHistory --> us-central1-saveChatHistory
[debug] [2024-11-13T05:12:34.801Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T05:12:34.801Z] [functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/"}}
[debug] [2024-11-13T05:12:34.809Z] [worker-pool] addWorker(us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-saveChatHistory)"}}
[debug] [2024-11-13T05:12:34.809Z] [worker-pool] Adding worker with key us-central1-saveChatHistory, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-saveChatHistory, total=1"}}
[debug] [2024-11-13T05:12:36.431Z] [runtime-status] [3840] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3840] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T05:12:36.433Z] [runtime-status] [3840] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3840] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T05:12:36.433Z] [runtime-status] [3840] Found local functions config: C:\Users\Rob\apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3840] Found local functions config: C:\\Users\\Rob\\apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T05:12:36.434Z] [runtime-status] [3840] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3840] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T05:12:36.435Z] [runtime-status] [3840] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3840] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T05:12:36.766Z] [runtime-status] [3840] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3840] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T05:12:36.766Z] [runtime-status] [3840] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3840] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T05:12:36.767Z] [runtime-status] [3840] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3840] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T05:12:36.772Z] [runtime-status] [3840] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3840] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T05:12:36.775Z] [runtime-status] [3840] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3840] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T05:12:36.775Z] [runtime-status] [3840] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3840] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T05:12:36.889Z] [runtime-status] [3840] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3840] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T05:12:36.901Z] [runtime-status] [3840] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3840] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T05:12:36.902Z] [runtime-status] [3840] Listening to port: \\?\pipe\fire_emu_d43494ad62e323e9 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3840] Listening to port: \\\\?\\pipe\\fire_emu_d43494ad62e323e9"}}
[debug] [2024-11-13T05:12:36.913Z] [worker-us-central1-saveChatHistory-ba787b8f-fd1d-4459-89d6-8a409a11af22]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-ba787b8f-fd1d-4459-89d6-8a409a11af22]: IDLE"}}
[debug] [2024-11-13T05:12:36.914Z] [worker-pool] submitRequest(triggerId=us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-saveChatHistory)"}}
[info] i  functions: Beginning execution of "us-central1-saveChatHistory" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Beginning execution of \"us-central1-saveChatHistory\""}}
[debug] [2024-11-13T05:12:36.914Z] [worker-us-central1-saveChatHistory-ba787b8f-fd1d-4459-89d6-8a409a11af22]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-ba787b8f-fd1d-4459-89d6-8a409a11af22]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"MISSING\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🔍 Saving Chat History { {"user":"🔍 Saving Chat History {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Saving Chat History {"}}
[info] >    request: { {"user":"  request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   request: {"}}
[info] >      rawRequest: IncomingMessage { {"user":"    rawRequest: IncomingMessage {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     rawRequest: IncomingMessage {"}}
[info] >        _events: [Object], {"user":"      _events: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _events: [Object],"}}
[info] >        _readableState: [ReadableState], {"user":"      _readableState: [ReadableState],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _readableState: [ReadableState],"}}
[info] >        _maxListeners: undefined, {"user":"      _maxListeners: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _maxListeners: undefined,"}}
[info] >        socket: [Socket], {"user":"      socket: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       socket: [Socket],"}}
[info] >        httpVersionMajor: 1, {"user":"      httpVersionMajor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMajor: 1,"}}
[info] >        httpVersionMinor: 1, {"user":"      httpVersionMinor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMinor: 1,"}}
[info] >        httpVersion: '1.1', {"user":"      httpVersion: '1.1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersion: '1.1',"}}
[info] >        complete: true, {"user":"      complete: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       complete: true,"}}
[info] >        rawHeaders: [Array], {"user":"      rawHeaders: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawHeaders: [Array],"}}
[info] >        rawTrailers: [], {"user":"      rawTrailers: [],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawTrailers: [],"}}
[info] >        joinDuplicateHeaders: null, {"user":"      joinDuplicateHeaders: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       joinDuplicateHeaders: null,"}}
[info] >        aborted: false, {"user":"      aborted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       aborted: false,"}}
[info] >        upgrade: false, {"user":"      upgrade: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       upgrade: false,"}}
[info] >        url: '/', {"user":"      url: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       url: '/',"}}
[info] >        method: 'POST', {"user":"      method: 'POST',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       method: 'POST',"}}
[info] >        statusCode: null, {"user":"      statusCode: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusCode: null,"}}
[info] >        statusMessage: null, {"user":"      statusMessage: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusMessage: null,"}}
[info] >        client: [Socket], {"user":"      client: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       client: [Socket],"}}
[info] >        _consuming: true, {"user":"      _consuming: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _consuming: true,"}}
[info] >        _dumped: false, {"user":"      _dumped: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _dumped: false,"}}
[info] >        next: [Function: next], {"user":"      next: [Function: next],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       next: [Function: next],"}}
[info] >        baseUrl: '', {"user":"      baseUrl: '',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       baseUrl: '',"}}
[info] >        originalUrl: '/', {"user":"      originalUrl: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       originalUrl: '/',"}}
[info] >        _parsedUrl: [Url], {"user":"      _parsedUrl: [Url],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _parsedUrl: [Url],"}}
[info] >        params: [Object], {"user":"      params: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       params: [Object],"}}
[info] >        query: {}, {"user":"      query: {},","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       query: {},"}}
[info] >        res: [ServerResponse], {"user":"      res: [ServerResponse],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       res: [ServerResponse],"}}
[info] >        body: [Object], {"user":"      body: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       body: [Object],"}}
[info] >        _body: true, {"user":"      _body: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _body: true,"}}
[info] >        length: undefined, {"user":"      length: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       length: undefined,"}}
[info] >        _eventsCount: 0, {"user":"      _eventsCount: 0,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _eventsCount: 0,"}}
[info] >        rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 55 51 73 64 6b 67 55 6d 6b 66 5a 75 41 54 38 48 67 65 4d 47 41 62 33 57 6e 46 45 4e 22 2c 22 ... 322 more bytes>, {"user":"      rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 55 51 73 64 6b 67 55 6d 6b 66 5a 75 41 54 38 48 67 65 4d 47 41 62 33 57 6e 46 45 4e 22 2c 22 ... 322 more bytes>,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 55 51 73 64 6b 67 55 6d 6b 66 5a 75 41 54 38 48 67 65 4d 47 41 62 33 57 6e 46 45 4e 22 2c 22 ... 322 more bytes>,"}}
[info] >        route: [Route], {"user":"      route: [Route],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       route: [Route],"}}
[info] >        [Symbol(shapeMode)]: true, {"user":"      [Symbol(shapeMode)]: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(shapeMode)]: true,"}}
[info] >        [Symbol(kCapture)]: false, {"user":"      [Symbol(kCapture)]: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kCapture)]: false,"}}
[info] >        [Symbol(kHeaders)]: [Object], {"user":"      [Symbol(kHeaders)]: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeaders)]: [Object],"}}
[info] >        [Symbol(kHeadersCount)]: 18, {"user":"      [Symbol(kHeadersCount)]: 18,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeadersCount)]: 18,"}}
[info] >        [Symbol(kTrailers)]: null, {"user":"      [Symbol(kTrailers)]: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailers)]: null,"}}
[info] >        [Symbol(kTrailersCount)]: 0 {"user":"      [Symbol(kTrailersCount)]: 0","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailersCount)]: 0"}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      data: { {"user":"    data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     data: {"}}
[info] >        userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"      userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >        chatId: 'chat-1731474752798-i86t0jvme', {"user":"      chatId: 'chat-1731474752798-i86t0jvme',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       chatId: 'chat-1731474752798-i86t0jvme',"}}
[info] >        messages: [Array], {"user":"      messages: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       messages: [Array],"}}
[info] >        timestamp: '2024-11-13T05:12:34.750Z' {"user":"      timestamp: '2024-11-13T05:12:34.750Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       timestamp: '2024-11-13T05:12:34.750Z'"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Extracted Data: { {"user":"🔍 Extracted Data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Extracted Data: {"}}
[info] >    userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"  userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme', {"user":"  chatId: 'chat-1731474752798-i86t0jvme',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme',"}}
[info] >    messagesCount: 2 {"user":"  messagesCount: 2","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   messagesCount: 2"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Chat history saved/updated: chat-1731474752798-i86t0jvme { totalMessageCount: 2, newMessagesAdded: 2 } {"user":"✅ Chat history saved/updated: chat-1731474752798-i86t0jvme { totalMessageCount: 2, newMessagesAdded: 2 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Chat history saved/updated: chat-1731474752798-i86t0jvme { totalMessageCount: 2, newMessagesAdded: 2 }"}}
[debug] [2024-11-13T05:12:37.435Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-saveChatHistory" in 520.5806ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finished \"us-central1-saveChatHistory\" in 520.5806ms"}}
[debug] [2024-11-13T05:12:37.436Z] [worker-us-central1-saveChatHistory-ba787b8f-fd1d-4459-89d6-8a409a11af22]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-ba787b8f-fd1d-4459-89d6-8a409a11af22]: IDLE"}}
[debug] [2024-11-13T05:12:37.436Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T05:12:37.436Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T05:12:37.436Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:12:32.779Z"],"workRunningCount":1}
[info] >  ✅ Chat history save result: { {"user":"✅ Chat history save result: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Chat history save result: {"}}
[info] >    data: { success: true, message: 'Chat history saved', totalMessages: 2 } {"user":"  data: { success: true, message: 'Chat history saved', totalMessages: 2 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { success: true, message: 'Chat history saved', totalMessages: 2 }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T05:12:37.441Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4661.1011ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4661.1011ms"}}
[debug] [2024-11-13T05:12:37.442Z] [worker-us-central1-processChat-e582b43e-7a5d-4de1-92ef-2c1ad0bdc9da]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e582b43e-7a5d-4de1-92ef-2c1ad0bdc9da]: IDLE"}}
[debug] [2024-11-13T05:12:37.442Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T05:12:37.443Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T05:12:37.443Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:16:36.433Z] File C:\Users\Rob\apps\not-alone\functions\src\getChatHistory.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\src\\getChatHistory.ts changed, reloading triggers"}}
[debug] [2024-11-13T05:16:37.447Z] Validating nodejs source
[debug] [2024-11-13T05:16:38.305Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T05:16:38.305Z] Building nodejs source
[debug] [2024-11-13T05:16:38.305Z] Failed to find version of module node: reached end of search path C:\Users\Rob\apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T05:16:38.307Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T05:16:38.321Z] Found firebase-functions binary at 'C:\Users\Rob\apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8874

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T05:16:38.978Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"getChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"getChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T05:16:43.009Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T05:16:43.010Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, getChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, getChatHistory, processChat."}}
[debug] [2024-11-13T05:16:43.012Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-13T05:16:43.012Z] [worker-us-central1-processChat-e582b43e-7a5d-4de1-92ef-2c1ad0bdc9da]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e582b43e-7a5d-4de1-92ef-2c1ad0bdc9da]: FINISHING"}}
[debug] [2024-11-13T05:16:43.012Z] [worker-pool] Shutting down IDLE worker (us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-saveChatHistory)"}}
[debug] [2024-11-13T05:16:43.012Z] [worker-us-central1-saveChatHistory-ba787b8f-fd1d-4459-89d6-8a409a11af22]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-ba787b8f-fd1d-4459-89d6-8a409a11af22]: FINISHING"}}
[debug] [2024-11-13T05:16:43.025Z] [worker-us-central1-saveChatHistory-ba787b8f-fd1d-4459-89d6-8a409a11af22]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-ba787b8f-fd1d-4459-89d6-8a409a11af22]: exited"}}
[debug] [2024-11-13T05:16:43.025Z] [worker-us-central1-saveChatHistory-ba787b8f-fd1d-4459-89d6-8a409a11af22]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-ba787b8f-fd1d-4459-89d6-8a409a11af22]: FINISHED"}}
[debug] [2024-11-13T05:16:43.025Z] [worker-us-central1-processChat-e582b43e-7a5d-4de1-92ef-2c1ad0bdc9da]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e582b43e-7a5d-4de1-92ef-2c1ad0bdc9da]: exited"}}
[debug] [2024-11-13T05:16:43.025Z] [worker-us-central1-processChat-e582b43e-7a5d-4de1-92ef-2c1ad0bdc9da]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-e582b43e-7a5d-4de1-92ef-2c1ad0bdc9da]: FINISHED"}}
[debug] [2024-11-13T05:18:45.179Z] File C:\Users\Rob\apps\not-alone\functions\src\getChatHistory.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\src\\getChatHistory.ts changed, reloading triggers"}}
[debug] [2024-11-13T05:18:46.193Z] Validating nodejs source
[debug] [2024-11-13T05:18:47.046Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T05:18:47.047Z] Building nodejs source
[debug] [2024-11-13T05:18:47.047Z] Failed to find version of module node: reached end of search path C:\Users\Rob\apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T05:18:47.048Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T05:18:47.057Z] Found firebase-functions binary at 'C:\Users\Rob\apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8737

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T05:18:47.695Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"getChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"getChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T05:18:51.722Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T05:18:51.723Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, getChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, getChatHistory, processChat."}}
[debug] [2024-11-13T05:20:58.588Z] File C:\Users\Rob\apps\not-alone\functions\src\getChatHistory.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\src\\getChatHistory.ts changed, reloading triggers"}}
[debug] [2024-11-13T05:20:59.596Z] Validating nodejs source
[debug] [2024-11-13T05:21:00.429Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T05:21:00.429Z] Building nodejs source
[debug] [2024-11-13T05:21:00.429Z] Failed to find version of module node: reached end of search path C:\Users\Rob\apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T05:21:00.430Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T05:21:00.441Z] Found firebase-functions binary at 'C:\Users\Rob\apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8825

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T05:21:01.114Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"getChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"getChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T05:21:05.136Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T05:21:05.137Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, getChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, getChatHistory, processChat."}}
[debug] [2024-11-13T05:22:21.041Z] File C:\Users\Rob\apps\not-alone\functions\lib\chatHistory.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\chatHistory.js.map changed, reloading triggers"}}
[debug] [2024-11-13T05:22:21.043Z] File C:\Users\Rob\apps\not-alone\functions\lib\chatHistory.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\chatHistory.js changed, reloading triggers"}}
[debug] [2024-11-13T05:22:21.053Z] File C:\Users\Rob\apps\not-alone\functions\lib\getChatHistory.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\getChatHistory.js.map changed, reloading triggers"}}
[debug] [2024-11-13T05:22:21.054Z] File C:\Users\Rob\apps\not-alone\functions\lib\getChatHistory.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\getChatHistory.js changed, reloading triggers"}}
[debug] [2024-11-13T05:22:21.079Z] File C:\Users\Rob\apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-13T05:22:21.079Z] File C:\Users\Rob\apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-13T05:22:22.081Z] Validating nodejs source
[debug] [2024-11-13T05:22:22.962Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T05:22:22.963Z] Building nodejs source
[debug] [2024-11-13T05:22:22.963Z] Failed to find version of module node: reached end of search path C:\Users\Rob\apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T05:22:22.964Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T05:22:22.974Z] Found firebase-functions binary at 'C:\Users\Rob\apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8853

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T05:22:23.611Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"getChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"getChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T05:22:27.647Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T05:22:27.648Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, getChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, getChatHistory, processChat."}}
[debug] [2024-11-13T05:22:38.457Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:22:38.457Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:22:38.457Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:22:38.457Z"],"workRunningCount":1}
[debug] [2024-11-13T05:22:38.458Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T05:22:38.460Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T05:22:38.461Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T05:22:38.461Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-13T05:22:38.461Z] [worker-pool] Cleaned up workers for us-central1-saveChatHistory: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-saveChatHistory: 1 --> 0"}}
[debug] [2024-11-13T05:22:38.467Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-13T05:22:38.468Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-13T05:22:40.056Z] [runtime-status] [33632] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33632] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T05:22:40.058Z] [runtime-status] [33632] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33632] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T05:22:40.058Z] [runtime-status] [33632] Found local functions config: C:\Users\Rob\apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33632] Found local functions config: C:\\Users\\Rob\\apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T05:22:40.059Z] [runtime-status] [33632] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33632] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T05:22:40.060Z] [runtime-status] [33632] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33632] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T05:22:40.393Z] [runtime-status] [33632] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33632] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T05:22:40.393Z] [runtime-status] [33632] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33632] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T05:22:40.394Z] [runtime-status] [33632] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33632] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T05:22:40.399Z] [runtime-status] [33632] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33632] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T05:22:40.402Z] [runtime-status] [33632] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33632] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T05:22:40.402Z] [runtime-status] [33632] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33632] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T05:22:40.513Z] [runtime-status] [33632] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33632] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T05:22:40.524Z] [runtime-status] [33632] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33632] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T05:22:40.525Z] [runtime-status] [33632] Listening to port: \\?\pipe\fire_emu_b59768412a66b601 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [33632] Listening to port: \\\\?\\pipe\\fire_emu_b59768412a66b601"}}
[debug] [2024-11-13T05:22:40.567Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE"}}
[debug] [2024-11-13T05:22:40.567Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T05:22:40.567Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY"}}
[debug] [2024-11-13T05:22:40.571Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4.4005ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4.4005ms"}}
[debug] [2024-11-13T05:22:40.572Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE"}}
[debug] [2024-11-13T05:22:40.572Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T05:22:40.573Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T05:22:40.573Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:22:40.574Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:22:40.574Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:22:40.575Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:22:40.574Z"],"workRunningCount":1}
[debug] [2024-11-13T05:22:40.575Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T05:22:40.576Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T05:22:40.576Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T05:22:40.576Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T05:22:40.577Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'hello', chatId: 'chat-1731474752798-i86t0jvme' } {"user":"  data: { message: 'hello', chatId: 'chat-1731474752798-i86t0jvme' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'hello', chatId: 'chat-1731474752798-i86t0jvme' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📝 Using chat ID: chat-1731474752798-i86t0jvme {"user":"📝 Using chat ID: chat-1731474752798-i86t0jvme","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: chat-1731474752798-i86t0jvme"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 5, {"user":"  messageLength: 5,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 5,"}}
[info] >    userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"  userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme' {"user":"  chatId: 'chat-1731474752798-i86t0jvme'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: chat-1731474752798-i86t0jvme {"user":"🆕 Creating new chat session: chat-1731474752798-i86t0jvme","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: chat-1731474752798-i86t0jvme"}}
[info] >  📝 Chat session created: { chatId: 'chat-1731474752798-i86t0jvme', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'chat-1731474752798-i86t0jvme', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'chat-1731474752798-i86t0jvme', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  📚 Current Chat History: { {"user":"📚 Current Chat History: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📚 Current Chat History: {"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme', {"user":"  chatId: 'chat-1731474752798-i86t0jvme',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme',"}}
[info] >    historyLength: 6, {"user":"  historyLength: 6,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   historyLength: 6,"}}
[info] >    lastMessages: [ {"user":"  lastMessages: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   lastMessages: ["}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'assistant', parts: [Array] }, {"user":"    { role: 'assistant', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'assistant', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] } {"user":"    { role: 'model', parts: [Array] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Response received: { responseLength: 154, timestamp: '2024-11-13T05:22:42.838Z' } {"user":"✅ Response received: { responseLength: 154, timestamp: '2024-11-13T05:22:42.838Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 154, timestamp: '2024-11-13T05:22:42.838Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: "Hello there!  How can I help you today?  I'm ready to offer support and guidance with your relationship questions.  Just let me know what's on your mind.\n", {"user":"  message: \"Hello there!  How can I help you today?  I'm ready to offer support and guidance with your relationship questions.  Just let me know what's on your mind.\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: \"Hello there!  How can I help you today?  I'm ready to offer support and guidance with your relationship questions.  Just let me know what's on your mind.\\n\","}}
[info] >    userMessage: 'hello', {"user":"  userMessage: 'hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hello',"}}
[info] >    timestamp: '2024-11-13T05:22:42.838Z', {"user":"  timestamp: '2024-11-13T05:22:42.838Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T05:22:42.838Z',"}}
[info] >    userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"  userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme' {"user":"  chatId: 'chat-1731474752798-i86t0jvme'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Attempting to save chat history with DETAILED logging: { {"user":"🔍 Attempting to save chat history with DETAILED logging: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Attempting to save chat history with DETAILED logging: {"}}
[info] >    userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"  userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme', {"user":"  chatId: 'chat-1731474752798-i86t0jvme',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme',"}}
[info] >    messageCount: 2, {"user":"  messageCount: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageCount: 2,"}}
[info] >    timestamp: '2024-11-13T05:22:42.838Z', {"user":"  timestamp: '2024-11-13T05:22:42.838Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T05:22:42.838Z',"}}
[info] >    clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' } {"user":"  clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔧 Firebase Client Configuration: { {"user":"🔧 Firebase Client Configuration: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Firebase Client Configuration: {"}}
[info] >    projectId: 'notalone-de4fc', {"user":"  projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   projectId: 'notalone-de4fc',"}}
[info] >    apiKey: 'local-api-key', {"user":"  apiKey: 'local-api-key',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   apiKey: 'local-api-key',"}}
[info] >    authDomain: undefined, {"user":"  authDomain: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   authDomain: undefined,"}}
[info] >    emulatorHost: 'localhost', {"user":"  emulatorHost: 'localhost',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorHost: 'localhost',"}}
[info] >    emulatorPort: 5001 {"user":"  emulatorPort: 5001","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorPort: 5001"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Firebase Functions Object Keys: [ {"user":"🔍 Firebase Functions Object Keys: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Object Keys: ["}}
[info] >    'app', {"user":"  'app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'app',"}}
[info] >    'emulatorOrigin', {"user":"  'emulatorOrigin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'emulatorOrigin',"}}
[info] >    'contextProvider', {"user":"  'contextProvider',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'contextProvider',"}}
[info] >    'deleteService', {"user":"  'deleteService',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'deleteService',"}}
[info] >    'cancelAllRequests', {"user":"  'cancelAllRequests',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'cancelAllRequests',"}}
[info] >    'customDomain', {"user":"  'customDomain',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'customDomain',"}}
[info] >    'region' {"user":"  'region'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'region'"}}
[info] >  ] {"user":"]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ]"}}
[info] >  🔍 Firebase Functions Instance: FunctionsService { {"user":"🔍 Firebase Functions Instance: FunctionsService {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Instance: FunctionsService {"}}
[info] >    app: FirebaseAppImpl { {"user":"  app: FirebaseAppImpl {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   app: FirebaseAppImpl {"}}
[info] >      _isDeleted: false, {"user":"    _isDeleted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _isDeleted: false,"}}
[info] >      _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }, {"user":"    _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },"}}
[info] >      _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false }, {"user":"    _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },"}}
[info] >      _name: '[DEFAULT]', {"user":"    _name: '[DEFAULT]',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _name: '[DEFAULT]',"}}
[info] >      _automaticDataCollectionEnabled: false, {"user":"    _automaticDataCollectionEnabled: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _automaticDataCollectionEnabled: false,"}}
[info] >      _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] } {"user":"    _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    emulatorOrigin: 'http://localhost:5001', {"user":"  emulatorOrigin: 'http://localhost:5001',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorOrigin: 'http://localhost:5001',"}}
[info] >    contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null }, {"user":"  contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },"}}
[info] >    deleteService: [Function (anonymous)], {"user":"  deleteService: [Function (anonymous)],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   deleteService: [Function (anonymous)],"}}
[info] >    cancelAllRequests: Promise { <pending> }, {"user":"  cancelAllRequests: Promise { <pending> },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   cancelAllRequests: Promise { <pending> },"}}
[info] >    customDomain: null, {"user":"  customDomain: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   customDomain: null,"}}
[info] >    region: 'us-central1' {"user":"  region: 'us-central1'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   region: 'us-central1'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' } {"user":"🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[info] >  🔍 Save Chat History Function Details: { {"user":"🔍 Save Chat History Function Details: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Save Chat History Function Details: {"}}
[info] >    functionExists: true, {"user":"  functionExists: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionExists: true,"}}
[info] >    functionType: 'function', {"user":"  functionType: 'function',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionType: 'function',"}}
[info] >    functionName: 'saveChatHistory' {"user":"  functionName: 'saveChatHistory'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionName: 'saveChatHistory'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📤 Chat History Payload: { {"user":"📤 Chat History Payload: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Chat History Payload: {"}}
[info] >    "userId": "UQsdkgUmkfZuAT8HgeMGAb3WnFEN", {"user":"  \"userId\": \"UQsdkgUmkfZuAT8HgeMGAb3WnFEN\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"userId\": \"UQsdkgUmkfZuAT8HgeMGAb3WnFEN\","}}
[info] >    "chatId": "chat-1731474752798-i86t0jvme", {"user":"  \"chatId\": \"chat-1731474752798-i86t0jvme\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"chatId\": \"chat-1731474752798-i86t0jvme\","}}
[info] >    "messages": [ {"user":"  \"messages\": [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"messages\": ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "user", {"user":"      \"role\": \"user\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"user\","}}
[info] >        "content": "hello", {"user":"      \"content\": \"hello\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"hello\","}}
[info] >        "timestamp": "2024-11-13T05:22:42.840Z" {"user":"      \"timestamp\": \"2024-11-13T05:22:42.840Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T05:22:42.840Z\""}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "model", {"user":"      \"role\": \"model\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"model\","}}
[info] >        "content": "Hello there!  How can I help you today?  I'm ready to offer support and guidance with your relationship questions.  Just let me know what's on your mind.\n", {"user":"      \"content\": \"Hello there!  How can I help you today?  I'm ready to offer support and guidance with your relationship questions.  Just let me know what's on your mind.\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"Hello there!  How can I help you today?  I'm ready to offer support and guidance with your relationship questions.  Just let me know what's on your mind.\\n\","}}
[info] >        "timestamp": "2024-11-13T05:22:42.840Z" {"user":"      \"timestamp\": \"2024-11-13T05:22:42.840Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T05:22:42.840Z\""}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    "timestamp": "2024-11-13T05:22:42.840Z", {"user":"  \"timestamp\": \"2024-11-13T05:22:42.840Z\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"timestamp\": \"2024-11-13T05:22:42.840Z\","}}
[info] >    "authDetails": { {"user":"  \"authDetails\": {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"authDetails\": {"}}
[info] >      "uid": "UQsdkgUmkfZuAT8HgeMGAb3WnFEN", {"user":"    \"uid\": \"UQsdkgUmkfZuAT8HgeMGAb3WnFEN\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"uid\": \"UQsdkgUmkfZuAT8HgeMGAb3WnFEN\","}}
[info] >      "token": "Present" {"user":"    \"token\": \"Present\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"token\": \"Present\""}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T05:22:42.880Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T05:22:42.880Z"],"queueLength":1,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:22:40.574Z"],"workRunningCount":1}
[debug] [2024-11-13T05:22:42.880Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:22:40.574Z","/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T05:22:42.880Z"],"workRunningCount":2}
[debug] [2024-11-13T05:22:42.880Z] Accepted request POST /notalone-de4fc/us-central1/saveChatHistory --> us-central1-saveChatHistory
[debug] [2024-11-13T05:22:42.881Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T05:22:42.881Z] [functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/"}}
[debug] [2024-11-13T05:22:42.888Z] [worker-pool] addWorker(us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-saveChatHistory)"}}
[debug] [2024-11-13T05:22:42.888Z] [worker-pool] Adding worker with key us-central1-saveChatHistory, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-saveChatHistory, total=1"}}
[debug] [2024-11-13T05:22:44.485Z] [runtime-status] [31244] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31244] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T05:22:44.487Z] [runtime-status] [31244] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31244] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T05:22:44.487Z] [runtime-status] [31244] Found local functions config: C:\Users\Rob\apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31244] Found local functions config: C:\\Users\\Rob\\apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T05:22:44.487Z] [runtime-status] [31244] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31244] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T05:22:44.488Z] [runtime-status] [31244] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31244] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T05:22:44.848Z] [runtime-status] [31244] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31244] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T05:22:44.848Z] [runtime-status] [31244] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31244] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T05:22:44.849Z] [runtime-status] [31244] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31244] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T05:22:44.854Z] [runtime-status] [31244] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31244] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T05:22:44.856Z] [runtime-status] [31244] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31244] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T05:22:44.856Z] [runtime-status] [31244] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31244] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T05:22:44.965Z] [runtime-status] [31244] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31244] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T05:22:44.977Z] [runtime-status] [31244] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31244] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T05:22:44.978Z] [runtime-status] [31244] Listening to port: \\?\pipe\fire_emu_c77a3a1069284a4b {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31244] Listening to port: \\\\?\\pipe\\fire_emu_c77a3a1069284a4b"}}
[debug] [2024-11-13T05:22:44.988Z] [worker-us-central1-saveChatHistory-997f5476-7042-4212-9776-1b85802491a8]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-997f5476-7042-4212-9776-1b85802491a8]: IDLE"}}
[debug] [2024-11-13T05:22:44.989Z] [worker-pool] submitRequest(triggerId=us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-saveChatHistory)"}}
[info] i  functions: Beginning execution of "us-central1-saveChatHistory" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Beginning execution of \"us-central1-saveChatHistory\""}}
[debug] [2024-11-13T05:22:44.989Z] [worker-us-central1-saveChatHistory-997f5476-7042-4212-9776-1b85802491a8]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-997f5476-7042-4212-9776-1b85802491a8]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"MISSING\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🔍 Saving Chat History { {"user":"🔍 Saving Chat History {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Saving Chat History {"}}
[info] >    request: { {"user":"  request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   request: {"}}
[info] >      rawRequest: IncomingMessage { {"user":"    rawRequest: IncomingMessage {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     rawRequest: IncomingMessage {"}}
[info] >        _events: [Object], {"user":"      _events: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _events: [Object],"}}
[info] >        _readableState: [ReadableState], {"user":"      _readableState: [ReadableState],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _readableState: [ReadableState],"}}
[info] >        _maxListeners: undefined, {"user":"      _maxListeners: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _maxListeners: undefined,"}}
[info] >        socket: [Socket], {"user":"      socket: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       socket: [Socket],"}}
[info] >        httpVersionMajor: 1, {"user":"      httpVersionMajor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMajor: 1,"}}
[info] >        httpVersionMinor: 1, {"user":"      httpVersionMinor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMinor: 1,"}}
[info] >        httpVersion: '1.1', {"user":"      httpVersion: '1.1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersion: '1.1',"}}
[info] >        complete: true, {"user":"      complete: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       complete: true,"}}
[info] >        rawHeaders: [Array], {"user":"      rawHeaders: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawHeaders: [Array],"}}
[info] >        rawTrailers: [], {"user":"      rawTrailers: [],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawTrailers: [],"}}
[info] >        joinDuplicateHeaders: null, {"user":"      joinDuplicateHeaders: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       joinDuplicateHeaders: null,"}}
[info] >        aborted: false, {"user":"      aborted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       aborted: false,"}}
[info] >        upgrade: false, {"user":"      upgrade: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       upgrade: false,"}}
[info] >        url: '/', {"user":"      url: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       url: '/',"}}
[info] >        method: 'POST', {"user":"      method: 'POST',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       method: 'POST',"}}
[info] >        statusCode: null, {"user":"      statusCode: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusCode: null,"}}
[info] >        statusMessage: null, {"user":"      statusMessage: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusMessage: null,"}}
[info] >        client: [Socket], {"user":"      client: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       client: [Socket],"}}
[info] >        _consuming: true, {"user":"      _consuming: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _consuming: true,"}}
[info] >        _dumped: false, {"user":"      _dumped: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _dumped: false,"}}
[info] >        next: [Function: next], {"user":"      next: [Function: next],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       next: [Function: next],"}}
[info] >        baseUrl: '', {"user":"      baseUrl: '',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       baseUrl: '',"}}
[info] >        originalUrl: '/', {"user":"      originalUrl: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       originalUrl: '/',"}}
[info] >        _parsedUrl: [Url], {"user":"      _parsedUrl: [Url],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _parsedUrl: [Url],"}}
[info] >        params: [Object], {"user":"      params: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       params: [Object],"}}
[info] >        query: {}, {"user":"      query: {},","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       query: {},"}}
[info] >        res: [ServerResponse], {"user":"      res: [ServerResponse],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       res: [ServerResponse],"}}
[info] >        body: [Object], {"user":"      body: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       body: [Object],"}}
[info] >        _body: true, {"user":"      _body: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _body: true,"}}
[info] >        length: undefined, {"user":"      length: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       length: undefined,"}}
[info] >        _eventsCount: 0, {"user":"      _eventsCount: 0,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _eventsCount: 0,"}}
[info] >        rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 55 51 73 64 6b 67 55 6d 6b 66 5a 75 41 54 38 48 67 65 4d 47 41 62 33 57 6e 46 45 4e 22 2c 22 ... 389 more bytes>, {"user":"      rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 55 51 73 64 6b 67 55 6d 6b 66 5a 75 41 54 38 48 67 65 4d 47 41 62 33 57 6e 46 45 4e 22 2c 22 ... 389 more bytes>,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 55 51 73 64 6b 67 55 6d 6b 66 5a 75 41 54 38 48 67 65 4d 47 41 62 33 57 6e 46 45 4e 22 2c 22 ... 389 more bytes>,"}}
[info] >        route: [Route], {"user":"      route: [Route],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       route: [Route],"}}
[info] >        [Symbol(shapeMode)]: true, {"user":"      [Symbol(shapeMode)]: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(shapeMode)]: true,"}}
[info] >        [Symbol(kCapture)]: false, {"user":"      [Symbol(kCapture)]: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kCapture)]: false,"}}
[info] >        [Symbol(kHeaders)]: [Object], {"user":"      [Symbol(kHeaders)]: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeaders)]: [Object],"}}
[info] >        [Symbol(kHeadersCount)]: 18, {"user":"      [Symbol(kHeadersCount)]: 18,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeadersCount)]: 18,"}}
[info] >        [Symbol(kTrailers)]: null, {"user":"      [Symbol(kTrailers)]: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailers)]: null,"}}
[info] >        [Symbol(kTrailersCount)]: 0 {"user":"      [Symbol(kTrailersCount)]: 0","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailersCount)]: 0"}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      data: { {"user":"    data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     data: {"}}
[info] >        userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"      userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >        chatId: 'chat-1731474752798-i86t0jvme', {"user":"      chatId: 'chat-1731474752798-i86t0jvme',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       chatId: 'chat-1731474752798-i86t0jvme',"}}
[info] >        messages: [Array], {"user":"      messages: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       messages: [Array],"}}
[info] >        timestamp: '2024-11-13T05:22:42.840Z' {"user":"      timestamp: '2024-11-13T05:22:42.840Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       timestamp: '2024-11-13T05:22:42.840Z'"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Extracted Data: { {"user":"🔍 Extracted Data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Extracted Data: {"}}
[info] >    userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"  userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme', {"user":"  chatId: 'chat-1731474752798-i86t0jvme',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme',"}}
[info] >    messagesCount: 2 {"user":"  messagesCount: 2","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   messagesCount: 2"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Chat history saved/updated: chat-1731474752798-i86t0jvme { totalMessageCount: 4, newMessagesAdded: 2 } {"user":"✅ Chat history saved/updated: chat-1731474752798-i86t0jvme { totalMessageCount: 4, newMessagesAdded: 2 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Chat history saved/updated: chat-1731474752798-i86t0jvme { totalMessageCount: 4, newMessagesAdded: 2 }"}}
[debug] [2024-11-13T05:22:45.406Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-saveChatHistory" in 416.604ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finished \"us-central1-saveChatHistory\" in 416.604ms"}}
[debug] [2024-11-13T05:22:45.406Z] [worker-us-central1-saveChatHistory-997f5476-7042-4212-9776-1b85802491a8]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-997f5476-7042-4212-9776-1b85802491a8]: IDLE"}}
[debug] [2024-11-13T05:22:45.407Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T05:22:45.407Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T05:22:45.407Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:22:40.574Z"],"workRunningCount":1}
[info] >  ✅ Chat history save result: { {"user":"✅ Chat history save result: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Chat history save result: {"}}
[info] >    data: { success: true, message: 'Chat history saved', totalMessages: 4 } {"user":"  data: { success: true, message: 'Chat history saved', totalMessages: 4 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { success: true, message: 'Chat history saved', totalMessages: 4 }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T05:22:45.414Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4837.3178ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4837.3178ms"}}
[debug] [2024-11-13T05:22:45.415Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE"}}
[debug] [2024-11-13T05:22:45.416Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T05:22:45.416Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T05:22:45.416Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:22:51.742Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:22:51.742Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:22:51.743Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:22:51.742Z"],"workRunningCount":1}
[debug] [2024-11-13T05:22:51.743Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T05:22:51.746Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T05:22:51.746Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T05:22:51.746Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T05:22:51.747Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY"}}
[debug] [2024-11-13T05:22:51.750Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4.1312ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4.1312ms"}}
[debug] [2024-11-13T05:22:51.751Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE"}}
[debug] [2024-11-13T05:22:51.751Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T05:22:51.752Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T05:22:51.752Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:22:51.754Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:22:51.754Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:22:51.754Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:22:51.754Z"],"workRunningCount":1}
[debug] [2024-11-13T05:22:51.754Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T05:22:51.756Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T05:22:51.757Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T05:22:51.757Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T05:22:51.757Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { {"user":"  data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: {"}}
[info] >      message: 'dont know what for', {"user":"    message: 'dont know what for',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     message: 'dont know what for',"}}
[info] >      chatId: 'chat-1731474752798-i86t0jvme' {"user":"    chatId: 'chat-1731474752798-i86t0jvme'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     chatId: 'chat-1731474752798-i86t0jvme'"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📝 Using chat ID: chat-1731474752798-i86t0jvme {"user":"📝 Using chat ID: chat-1731474752798-i86t0jvme","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: chat-1731474752798-i86t0jvme"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 18, {"user":"  messageLength: 18,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 18,"}}
[info] >    userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"  userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme' {"user":"  chatId: 'chat-1731474752798-i86t0jvme'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: dont know what for {"user":"💬 Sending message to Gemini: dont know what for","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: dont know what for"}}
[info] >  📚 Current Chat History: { {"user":"📚 Current Chat History: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📚 Current Chat History: {"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme', {"user":"  chatId: 'chat-1731474752798-i86t0jvme',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme',"}}
[info] >    historyLength: 8, {"user":"  historyLength: 8,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   historyLength: 8,"}}
[info] >    lastMessages: [ {"user":"  lastMessages: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   lastMessages: ["}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] }, {"user":"    { role: 'model', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] } {"user":"    { role: 'model', parts: [Array] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Response received: { responseLength: 806, timestamp: '2024-11-13T05:22:56.077Z' } {"user":"✅ Response received: { responseLength: 806, timestamp: '2024-11-13T05:22:56.077Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 806, timestamp: '2024-11-13T05:22:56.077Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: "I understand.  It can be difficult to know where to start when talking about relationships.  To help me understand how I can be of assistance, could you tell me a little more about what's happening in your relationships right now, or what kind of issues you're facing?  Even something small can be a good starting point.  For example, are you feeling:\n" + {"user":"  message: \"I understand.  It can be difficult to know where to start when talking about relationships.  To help me understand how I can be of assistance, could you tell me a little more about what's happening in your relationships right now, or what kind of issues you're facing?  Even something small can be a good starting point.  For example, are you feeling:\\n\" +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: \"I understand.  It can be difficult to know where to start when talking about relationships.  To help me understand how I can be of assistance, could you tell me a little more about what's happening in your relationships right now, or what kind of issues you're facing?  Even something small can be a good starting point.  For example, are you feeling:\\n\" +"}}
[info] >      '\n' + {"user":"    '\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '\\n' +"}}
[info] >      '* **Happy and fulfilled?** If so, what contributes to that feeling?\n' + {"user":"    '* **Happy and fulfilled?** If so, what contributes to that feeling?\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '* **Happy and fulfilled?** If so, what contributes to that feeling?\\n' +"}}
[info] >      '* **Frustrated or unhappy?** What specifically is causing those feelings?\n' + {"user":"    '* **Frustrated or unhappy?** What specifically is causing those feelings?\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '* **Frustrated or unhappy?** What specifically is causing those feelings?\\n' +"}}
[info] >      '* **Confused or uncertain about the future of a relationship?** What are your concerns?\n' + {"user":"    '* **Confused or uncertain about the future of a relationship?** What are your concerns?\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '* **Confused or uncertain about the future of a relationship?** What are your concerns?\\n' +"}}
[info] >      '* **Wanting to improve communication or intimacy?**  Where are you feeling the disconnect?\n' + {"user":"    '* **Wanting to improve communication or intimacy?**  Where are you feeling the disconnect?\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '* **Wanting to improve communication or intimacy?**  Where are you feeling the disconnect?\\n' +"}}
[info] >      '\n' + {"user":"    '\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '\\n' +"}}
[info] >      "There's no pressure to share anything you're not comfortable with.  Just a little information will help me guide our conversation.\n", {"user":"    \"There's no pressure to share anything you're not comfortable with.  Just a little information will help me guide our conversation.\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"There's no pressure to share anything you're not comfortable with.  Just a little information will help me guide our conversation.\\n\","}}
[info] >    userMessage: 'dont know what for', {"user":"  userMessage: 'dont know what for',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'dont know what for',"}}
[info] >    timestamp: '2024-11-13T05:22:56.077Z', {"user":"  timestamp: '2024-11-13T05:22:56.077Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T05:22:56.077Z',"}}
[info] >    userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"  userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme' {"user":"  chatId: 'chat-1731474752798-i86t0jvme'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Attempting to save chat history with DETAILED logging: { {"user":"🔍 Attempting to save chat history with DETAILED logging: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Attempting to save chat history with DETAILED logging: {"}}
[info] >    userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"  userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme', {"user":"  chatId: 'chat-1731474752798-i86t0jvme',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme',"}}
[info] >    messageCount: 2, {"user":"  messageCount: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageCount: 2,"}}
[info] >    timestamp: '2024-11-13T05:22:56.077Z', {"user":"  timestamp: '2024-11-13T05:22:56.077Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T05:22:56.077Z',"}}
[info] >    clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' } {"user":"  clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔧 Firebase Client Configuration: { {"user":"🔧 Firebase Client Configuration: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Firebase Client Configuration: {"}}
[info] >    projectId: 'notalone-de4fc', {"user":"  projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   projectId: 'notalone-de4fc',"}}
[info] >    apiKey: 'local-api-key', {"user":"  apiKey: 'local-api-key',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   apiKey: 'local-api-key',"}}
[info] >    authDomain: undefined, {"user":"  authDomain: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   authDomain: undefined,"}}
[info] >    emulatorHost: 'localhost', {"user":"  emulatorHost: 'localhost',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorHost: 'localhost',"}}
[info] >    emulatorPort: 5001 {"user":"  emulatorPort: 5001","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorPort: 5001"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Firebase Functions Object Keys: [ {"user":"🔍 Firebase Functions Object Keys: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Object Keys: ["}}
[info] >    'app', {"user":"  'app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'app',"}}
[info] >    'emulatorOrigin', {"user":"  'emulatorOrigin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'emulatorOrigin',"}}
[info] >    'contextProvider', {"user":"  'contextProvider',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'contextProvider',"}}
[info] >    'deleteService', {"user":"  'deleteService',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'deleteService',"}}
[info] >    'cancelAllRequests', {"user":"  'cancelAllRequests',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'cancelAllRequests',"}}
[info] >    'customDomain', {"user":"  'customDomain',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'customDomain',"}}
[info] >    'region' {"user":"  'region'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'region'"}}
[info] >  ] {"user":"]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ]"}}
[info] >  🔍 Firebase Functions Instance: FunctionsService { {"user":"🔍 Firebase Functions Instance: FunctionsService {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Instance: FunctionsService {"}}
[info] >    app: FirebaseAppImpl { {"user":"  app: FirebaseAppImpl {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   app: FirebaseAppImpl {"}}
[info] >      _isDeleted: false, {"user":"    _isDeleted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _isDeleted: false,"}}
[info] >      _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }, {"user":"    _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },"}}
[info] >      _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false }, {"user":"    _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },"}}
[info] >      _name: '[DEFAULT]', {"user":"    _name: '[DEFAULT]',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _name: '[DEFAULT]',"}}
[info] >      _automaticDataCollectionEnabled: false, {"user":"    _automaticDataCollectionEnabled: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _automaticDataCollectionEnabled: false,"}}
[info] >      _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] } {"user":"    _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    emulatorOrigin: 'http://localhost:5001', {"user":"  emulatorOrigin: 'http://localhost:5001',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorOrigin: 'http://localhost:5001',"}}
[info] >    contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null }, {"user":"  contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },"}}
[info] >    deleteService: [Function (anonymous)], {"user":"  deleteService: [Function (anonymous)],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   deleteService: [Function (anonymous)],"}}
[info] >    cancelAllRequests: Promise { <pending> }, {"user":"  cancelAllRequests: Promise { <pending> },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   cancelAllRequests: Promise { <pending> },"}}
[info] >    customDomain: null, {"user":"  customDomain: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   customDomain: null,"}}
[info] >    region: 'us-central1' {"user":"  region: 'us-central1'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   region: 'us-central1'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' } {"user":"🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[info] >  🔍 Save Chat History Function Details: { {"user":"🔍 Save Chat History Function Details: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Save Chat History Function Details: {"}}
[info] >    functionExists: true, {"user":"  functionExists: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionExists: true,"}}
[info] >    functionType: 'function', {"user":"  functionType: 'function',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionType: 'function',"}}
[info] >    functionName: 'saveChatHistory' {"user":"  functionName: 'saveChatHistory'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionName: 'saveChatHistory'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📤 Chat History Payload: { {"user":"📤 Chat History Payload: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Chat History Payload: {"}}
[info] >    "userId": "UQsdkgUmkfZuAT8HgeMGAb3WnFEN", {"user":"  \"userId\": \"UQsdkgUmkfZuAT8HgeMGAb3WnFEN\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"userId\": \"UQsdkgUmkfZuAT8HgeMGAb3WnFEN\","}}
[info] >    "chatId": "chat-1731474752798-i86t0jvme", {"user":"  \"chatId\": \"chat-1731474752798-i86t0jvme\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"chatId\": \"chat-1731474752798-i86t0jvme\","}}
[info] >    "messages": [ {"user":"  \"messages\": [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"messages\": ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "user", {"user":"      \"role\": \"user\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"user\","}}
[info] >        "content": "dont know what for", {"user":"      \"content\": \"dont know what for\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"dont know what for\","}}
[info] >        "timestamp": "2024-11-13T05:22:56.078Z" {"user":"      \"timestamp\": \"2024-11-13T05:22:56.078Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T05:22:56.078Z\""}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "model", {"user":"      \"role\": \"model\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"model\","}}
[info] >        "content": "I understand.  It can be difficult to know where to start when talking about relationships.  To help me understand how I can be of assistance, could you tell me a little more about what's happening in your relationships right now, or what kind of issues you're facing?  Even something small can be a good starting point.  For example, are you feeling:\n\n* **Happy and fulfilled?** If so, what contributes to that feeling?\n* **Frustrated or unhappy?** What specifically is causing those feelings?\n* **Confused or uncertain about the future of a relationship?** What are your concerns?\n* **Wanting to improve communication or intimacy?**  Where are you feeling the disconnect?\n\nThere's no pressure to share anything you're not comfortable with.  Just a little information will help me guide our conversation.\n", {"user":"      \"content\": \"I understand.  It can be difficult to know where to start when talking about relationships.  To help me understand how I can be of assistance, could you tell me a little more about what's happening in your relationships right now, or what kind of issues you're facing?  Even something small can be a good starting point.  For example, are you feeling:\\n\\n* **Happy and fulfilled?** If so, what contributes to that feeling?\\n* **Frustrated or unhappy?** What specifically is causing those feelings?\\n* **Confused or uncertain about the future of a relationship?** What are your concerns?\\n* **Wanting to improve communication or intimacy?**  Where are you feeling the disconnect?\\n\\nThere's no pressure to share anything you're not comfortable with.  Just a little information will help me guide our conversation.\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"I understand.  It can be difficult to know where to start when talking about relationships.  To help me understand how I can be of assistance, could you tell me a little more about what's happening in your relationships right now, or what kind of issues you're facing?  Even something small can be a good starting point.  For example, are you feeling:\\n\\n* **Happy and fulfilled?** If so, what contributes to that feeling?\\n* **Frustrated or unhappy?** What specifically is causing those feelings?\\n* **Confused or uncertain about the future of a relationship?** What are your concerns?\\n* **Wanting to improve communication or intimacy?**  Where are you feeling the disconnect?\\n\\nThere's no pressure to share anything you're not comfortable with.  Just a little information will help me guide our conversation.\\n\","}}
[info] >        "timestamp": "2024-11-13T05:22:56.078Z" {"user":"      \"timestamp\": \"2024-11-13T05:22:56.078Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T05:22:56.078Z\""}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    "timestamp": "2024-11-13T05:22:56.078Z", {"user":"  \"timestamp\": \"2024-11-13T05:22:56.078Z\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"timestamp\": \"2024-11-13T05:22:56.078Z\","}}
[info] >    "authDetails": { {"user":"  \"authDetails\": {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"authDetails\": {"}}
[info] >      "uid": "UQsdkgUmkfZuAT8HgeMGAb3WnFEN", {"user":"    \"uid\": \"UQsdkgUmkfZuAT8HgeMGAb3WnFEN\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"uid\": \"UQsdkgUmkfZuAT8HgeMGAb3WnFEN\","}}
[info] >      "token": "Present" {"user":"    \"token\": \"Present\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"token\": \"Present\""}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T05:22:56.124Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T05:22:56.124Z"],"queueLength":1,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:22:51.754Z"],"workRunningCount":1}
[debug] [2024-11-13T05:22:56.124Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:22:51.754Z","/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T05:22:56.124Z"],"workRunningCount":2}
[debug] [2024-11-13T05:22:56.124Z] Accepted request POST /notalone-de4fc/us-central1/saveChatHistory --> us-central1-saveChatHistory
[debug] [2024-11-13T05:22:56.125Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T05:22:56.125Z] [functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/"}}
[debug] [2024-11-13T05:22:56.125Z] [worker-pool] submitRequest(triggerId=us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-saveChatHistory)"}}
[info] i  functions: Beginning execution of "us-central1-saveChatHistory" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Beginning execution of \"us-central1-saveChatHistory\""}}
[debug] [2024-11-13T05:22:56.126Z] [worker-us-central1-saveChatHistory-997f5476-7042-4212-9776-1b85802491a8]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-997f5476-7042-4212-9776-1b85802491a8]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"MISSING\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🔍 Saving Chat History { {"user":"🔍 Saving Chat History {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Saving Chat History {"}}
[info] >    request: { {"user":"  request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   request: {"}}
[info] >      rawRequest: IncomingMessage { {"user":"    rawRequest: IncomingMessage {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     rawRequest: IncomingMessage {"}}
[info] >        _events: [Object], {"user":"      _events: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _events: [Object],"}}
[info] >        _readableState: [ReadableState], {"user":"      _readableState: [ReadableState],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _readableState: [ReadableState],"}}
[info] >        _maxListeners: undefined, {"user":"      _maxListeners: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _maxListeners: undefined,"}}
[info] >        socket: [Socket], {"user":"      socket: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       socket: [Socket],"}}
[info] >        httpVersionMajor: 1, {"user":"      httpVersionMajor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMajor: 1,"}}
[info] >        httpVersionMinor: 1, {"user":"      httpVersionMinor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMinor: 1,"}}
[info] >        httpVersion: '1.1', {"user":"      httpVersion: '1.1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersion: '1.1',"}}
[info] >        complete: true, {"user":"      complete: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       complete: true,"}}
[info] >        rawHeaders: [Array], {"user":"      rawHeaders: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawHeaders: [Array],"}}
[info] >        rawTrailers: [], {"user":"      rawTrailers: [],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawTrailers: [],"}}
[info] >        joinDuplicateHeaders: null, {"user":"      joinDuplicateHeaders: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       joinDuplicateHeaders: null,"}}
[info] >        aborted: false, {"user":"      aborted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       aborted: false,"}}
[info] >        upgrade: false, {"user":"      upgrade: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       upgrade: false,"}}
[info] >        url: '/', {"user":"      url: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       url: '/',"}}
[info] >        method: 'POST', {"user":"      method: 'POST',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       method: 'POST',"}}
[info] >        statusCode: null, {"user":"      statusCode: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusCode: null,"}}
[info] >        statusMessage: null, {"user":"      statusMessage: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusMessage: null,"}}
[info] >        client: [Socket], {"user":"      client: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       client: [Socket],"}}
[info] >        _consuming: true, {"user":"      _consuming: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _consuming: true,"}}
[info] >        _dumped: false, {"user":"      _dumped: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _dumped: false,"}}
[info] >        next: [Function: next], {"user":"      next: [Function: next],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       next: [Function: next],"}}
[info] >        baseUrl: '', {"user":"      baseUrl: '',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       baseUrl: '',"}}
[info] >        originalUrl: '/', {"user":"      originalUrl: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       originalUrl: '/',"}}
[info] >        _parsedUrl: [Url], {"user":"      _parsedUrl: [Url],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _parsedUrl: [Url],"}}
[info] >        params: [Object], {"user":"      params: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       params: [Object],"}}
[info] >        query: {}, {"user":"      query: {},","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       query: {},"}}
[info] >        res: [ServerResponse], {"user":"      res: [ServerResponse],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       res: [ServerResponse],"}}
[info] >        body: [Object], {"user":"      body: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       body: [Object],"}}
[info] >        _body: true, {"user":"      _body: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _body: true,"}}
[info] >        length: undefined, {"user":"      length: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       length: undefined,"}}
[info] >        _eventsCount: 0, {"user":"      _eventsCount: 0,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _eventsCount: 0,"}}
[info] >        rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 55 51 73 64 6b 67 55 6d 6b 66 5a 75 41 54 38 48 67 65 4d 47 41 62 33 57 6e 46 45 4e 22 2c 22 ... 1061 more bytes>, {"user":"      rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 55 51 73 64 6b 67 55 6d 6b 66 5a 75 41 54 38 48 67 65 4d 47 41 62 33 57 6e 46 45 4e 22 2c 22 ... 1061 more bytes>,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 55 51 73 64 6b 67 55 6d 6b 66 5a 75 41 54 38 48 67 65 4d 47 41 62 33 57 6e 46 45 4e 22 2c 22 ... 1061 more bytes>,"}}
[info] >        route: [Route], {"user":"      route: [Route],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       route: [Route],"}}
[info] >        [Symbol(shapeMode)]: true, {"user":"      [Symbol(shapeMode)]: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(shapeMode)]: true,"}}
[info] >        [Symbol(kCapture)]: false, {"user":"      [Symbol(kCapture)]: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kCapture)]: false,"}}
[info] >        [Symbol(kHeaders)]: [Object], {"user":"      [Symbol(kHeaders)]: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeaders)]: [Object],"}}
[info] >        [Symbol(kHeadersCount)]: 18, {"user":"      [Symbol(kHeadersCount)]: 18,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeadersCount)]: 18,"}}
[info] >        [Symbol(kTrailers)]: null, {"user":"      [Symbol(kTrailers)]: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailers)]: null,"}}
[info] >        [Symbol(kTrailersCount)]: 0 {"user":"      [Symbol(kTrailersCount)]: 0","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailersCount)]: 0"}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      data: { {"user":"    data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     data: {"}}
[info] >        userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"      userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >        chatId: 'chat-1731474752798-i86t0jvme', {"user":"      chatId: 'chat-1731474752798-i86t0jvme',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       chatId: 'chat-1731474752798-i86t0jvme',"}}
[info] >        messages: [Array], {"user":"      messages: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       messages: [Array],"}}
[info] >        timestamp: '2024-11-13T05:22:56.078Z' {"user":"      timestamp: '2024-11-13T05:22:56.078Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       timestamp: '2024-11-13T05:22:56.078Z'"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Extracted Data: { {"user":"🔍 Extracted Data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Extracted Data: {"}}
[info] >    userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"  userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme', {"user":"  chatId: 'chat-1731474752798-i86t0jvme',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme',"}}
[info] >    messagesCount: 2 {"user":"  messagesCount: 2","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   messagesCount: 2"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Chat history saved/updated: chat-1731474752798-i86t0jvme { totalMessageCount: 6, newMessagesAdded: 2 } {"user":"✅ Chat history saved/updated: chat-1731474752798-i86t0jvme { totalMessageCount: 6, newMessagesAdded: 2 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Chat history saved/updated: chat-1731474752798-i86t0jvme { totalMessageCount: 6, newMessagesAdded: 2 }"}}
[debug] [2024-11-13T05:22:56.171Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-saveChatHistory" in 44.9041ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finished \"us-central1-saveChatHistory\" in 44.9041ms"}}
[debug] [2024-11-13T05:22:56.171Z] [worker-us-central1-saveChatHistory-997f5476-7042-4212-9776-1b85802491a8]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-997f5476-7042-4212-9776-1b85802491a8]: IDLE"}}
[debug] [2024-11-13T05:22:56.171Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T05:22:56.172Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T05:22:56.172Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:22:51.754Z"],"workRunningCount":1}
[info] >  ✅ Chat history save result: { {"user":"✅ Chat history save result: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Chat history save result: {"}}
[info] >    data: { success: true, message: 'Chat history saved', totalMessages: 6 } {"user":"  data: { success: true, message: 'Chat history saved', totalMessages: 6 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { success: true, message: 'Chat history saved', totalMessages: 6 }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T05:22:56.175Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4417.8248ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4417.8248ms"}}
[debug] [2024-11-13T05:22:56.179Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE"}}
[debug] [2024-11-13T05:22:56.179Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T05:22:56.179Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T05:22:56.179Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:23:03.603Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:23:03.603Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:23:03.604Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:23:03.603Z"],"workRunningCount":1}
[debug] [2024-11-13T05:23:03.604Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T05:23:03.606Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T05:23:03.606Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T05:23:03.606Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T05:23:03.606Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY"}}
[debug] [2024-11-13T05:23:03.609Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2.9445ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2.9445ms"}}
[debug] [2024-11-13T05:23:03.610Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE"}}
[debug] [2024-11-13T05:23:03.610Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T05:23:03.610Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T05:23:03.610Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:23:03.613Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:23:03.613Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:23:03.614Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:23:03.613Z"],"workRunningCount":1}
[debug] [2024-11-13T05:23:03.614Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T05:23:03.616Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T05:23:03.616Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T05:23:03.616Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T05:23:03.616Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { {"user":"  data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: {"}}
[info] >      message: 'sing a sad song and make it better', {"user":"    message: 'sing a sad song and make it better',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     message: 'sing a sad song and make it better',"}}
[info] >      chatId: 'chat-1731474752798-i86t0jvme' {"user":"    chatId: 'chat-1731474752798-i86t0jvme'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     chatId: 'chat-1731474752798-i86t0jvme'"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📝 Using chat ID: chat-1731474752798-i86t0jvme {"user":"📝 Using chat ID: chat-1731474752798-i86t0jvme","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: chat-1731474752798-i86t0jvme"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 34, {"user":"  messageLength: 34,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 34,"}}
[info] >    userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"  userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme' {"user":"  chatId: 'chat-1731474752798-i86t0jvme'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: sing a sad song and make it better {"user":"💬 Sending message to Gemini: sing a sad song and make it better","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: sing a sad song and make it better"}}
[info] >  📚 Current Chat History: { {"user":"📚 Current Chat History: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📚 Current Chat History: {"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme', {"user":"  chatId: 'chat-1731474752798-i86t0jvme',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme',"}}
[info] >    historyLength: 10, {"user":"  historyLength: 10,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   historyLength: 10,"}}
[info] >    lastMessages: [ {"user":"  lastMessages: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   lastMessages: ["}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] }, {"user":"    { role: 'model', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] } {"user":"    { role: 'model', parts: [Array] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Response received: { responseLength: 1512, timestamp: '2024-11-13T05:23:12.538Z' } {"user":"✅ Response received: { responseLength: 1512, timestamp: '2024-11-13T05:23:12.538Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 1512, timestamp: '2024-11-13T05:23:12.538Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: "(This is a request for a song, not just any song.  Let's assume it starts sad and gets better):\n" + {"user":"  message: \"(This is a request for a song, not just any song.  Let's assume it starts sad and gets better):\\n\" +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: \"(This is a request for a song, not just any song.  Let's assume it starts sad and gets better):\\n\" +"}}
[info] >      '\n' + {"user":"    '\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '\\n' +"}}
[info] >      '(Verse 1)\n' + {"user":"    '(Verse 1)\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '(Verse 1)\\n' +"}}
[info] >      'The rain falls down, a mournful sigh,\n' + {"user":"    'The rain falls down, a mournful sigh,\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'The rain falls down, a mournful sigh,\\n' +"}}
[info] >      'The wind it howls, a lonely cry.\n' + {"user":"    'The wind it howls, a lonely cry.\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'The wind it howls, a lonely cry.\\n' +"}}
[info] >      'The world is gray, the shadows long,\n' + {"user":"    'The world is gray, the shadows long,\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'The world is gray, the shadows long,\\n' +"}}
[info] >      'My heart feels weak, where once was strong.\n' + {"user":"    'My heart feels weak, where once was strong.\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'My heart feels weak, where once was strong.\\n' +"}}
[info] >      '\n' + {"user":"    '\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '\\n' +"}}
[info] >      '(Chorus)\n' + {"user":"    '(Chorus)\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '(Chorus)\\n' +"}}
[info] >      'Oh, lonely rain, wash sorrow away,\n' + {"user":"    'Oh, lonely rain, wash sorrow away,\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'Oh, lonely rain, wash sorrow away,\\n' +"}}
[info] >      'Let sunshine through, to light the day.\n' + {"user":"    'Let sunshine through, to light the day.\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'Let sunshine through, to light the day.\\n' +"}}
[info] >      'This weary heart, needs solace now,\n' + {"user":"    'This weary heart, needs solace now,\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'This weary heart, needs solace now,\\n' +"}}
[info] >      'Let hope shine through,  this weary heart, needs solace now. (This is a request for a song, not just any song.  This is a request for a song, not just any song.):\n' + {"user":"    'Let hope shine through,  this weary heart, needs solace now. (This is a request for a song, not just any song.  This is a request for a song, not just any song.):\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'Let hope shine through,  this weary heart, needs solace now. (This is a request for a song, not just any song.  This is a request for a song, not just any song.):\\n' +"}}
[info] >      '\n' + {"user":"    '\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '\\n' +"}}
[info] >      '(Verse 1)\n' + {"user":"    '(Verse 1)\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '(Verse 1)\\n' +"}}
[info] >      'The rain falls down, a mournful sigh,\n' + {"user":"    'The rain falls down, a mournful sigh,\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'The rain falls down, a mournful sigh,\\n' +"}}
[info] >      'The wind it howls, a lonely cry.\n' + {"user":"    'The wind it howls, a lonely cry.\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'The wind it howls, a lonely cry.\\n' +"}}
[info] >      'The world is gray, the shadows long,\n' + {"user":"    'The world is gray, the shadows long,\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'The world is gray, the shadows long,\\n' +"}}
[info] >      'My heart feels weak, where once was strong.\n' + {"user":"    'My heart feels weak, where once was strong.\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'My heart feels weak, where once was strong.\\n' +"}}
[info] >      '\n' + {"user":"    '\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '\\n' +"}}
[info] >      '(Chorus)\n' + {"user":"    '(Chorus)\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '(Chorus)\\n' +"}}
[info] >      'Oh, lonely rain, wash sorrow away,\n' + {"user":"    'Oh, lonely rain, wash sorrow away,\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'Oh, lonely rain, wash sorrow away,\\n' +"}}
[info] >      'Let sunshine through, to light the day.\n' + {"user":"    'Let sunshine through, to light the day.\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'Let sunshine through, to light the day.\\n' +"}}
[info] >      'This weary heart, needs solace now,\n' + {"user":"    'This weary heart, needs solace now,\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'This weary heart, needs solace now,\\n' +"}}
[info] >      'Let hope shine through, to light the day.\n' + {"user":"    'Let hope shine through, to light the day.\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'Let hope shine through, to light the day.\\n' +"}}
[info] >      '\n' + {"user":"    '\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '\\n' +"}}
[info] >      '(Bridge)\n' + {"user":"    '(Bridge)\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '(Bridge)\\n' +"}}
[info] >      'But through the storm, a glimmer bright,\n' + {"user":"    'But through the storm, a glimmer bright,\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'But through the storm, a glimmer bright,\\n' +"}}
[info] >      'A hopeful ray, a guiding light.\n' + {"user":"    'A hopeful ray, a guiding light.\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'A hopeful ray, a guiding light.\\n' +"}}
[info] >      'The clouds may gather, shadows creep,\n' + {"user":"    'The clouds may gather, shadows creep,\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'The clouds may gather, shadows creep,\\n' +"}}
[info] >      'But still, I sing, to soothe the deep.\n' + {"user":"    'But still, I sing, to soothe the deep.\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'But still, I sing, to soothe the deep.\\n' +"}}
[info] >      '\n' + {"user":"    '\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '\\n' +"}}
[info] >      '(Verse 2)\n' + {"user":"    '(Verse 2)\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '(Verse 2)\\n' +"}}
[info] >      'The tears may fall, like gentle rain,\n' + {"user":"    'The tears may fall, like gentle rain,\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'The tears may fall, like gentle rain,\\n' +"}}
[info] >      'Washing the pain, easing the strain.\n' + {"user":"    'Washing the pain, easing the strain.\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'Washing the pain, easing the strain.\\n' +"}}
[info] >      'The heart may ache, the spirit low,\n' + {"user":"    'The heart may ache, the spirit low,\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'The heart may ache, the spirit low,\\n' +"}}
[info] >      "But still, I'll rise, and let it show.\n" + {"user":"    \"But still, I'll rise, and let it show.\\n\" +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"But still, I'll rise, and let it show.\\n\" +"}}
[info] >      '\n' + {"user":"    '\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '\\n' +"}}
[info] >      '(Chorus)\n' + {"user":"    '(Chorus)\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '(Chorus)\\n' +"}}
[info] >      'Oh, lonely rain, wash sorrow away,\n' + {"user":"    'Oh, lonely rain, wash sorrow away,\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'Oh, lonely rain, wash sorrow away,\\n' +"}}
[info] >      'Let sunshine through, to light the day.\n' + {"user":"    'Let sunshine through, to light the day.\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'Let sunshine through, to light the day.\\n' +"}}
[info] >      'This weary heart, needs solace now,\n' + {"user":"    'This weary heart, needs solace now,\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'This weary heart, needs solace now,\\n' +"}}
[info] >      'Let hope shine through, to light the day.\n' + {"user":"    'Let hope shine through, to light the day.\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'Let hope shine through, to light the day.\\n' +"}}
[info] >      '\n' + {"user":"    '\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '\\n' +"}}
[info] >      '(Outro)\n' + {"user":"    '(Outro)\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '(Outro)\\n' +"}}
[info] >      'The sun breaks through, the storm is past,\n' + {"user":"    'The sun breaks through, the storm is past,\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'The sun breaks through, the storm is past,\\n' +"}}
[info] >      'The sadness fades, the shadows cast,\n' + {"user":"    'The sadness fades, the shadows cast,\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'The sadness fades, the shadows cast,\\n' +"}}
[info] >      'Away are gone, the tears are dried,\n' + {"user":"    'Away are gone, the tears are dried,\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'Away are gone, the tears are dried,\\n' +"}}
[info] >      'A brighter day, with hope inside.\n', {"user":"    'A brighter day, with hope inside.\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'A brighter day, with hope inside.\\n',"}}
[info] >    userMessage: 'sing a sad song and make it better', {"user":"  userMessage: 'sing a sad song and make it better',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'sing a sad song and make it better',"}}
[info] >    timestamp: '2024-11-13T05:23:12.538Z', {"user":"  timestamp: '2024-11-13T05:23:12.538Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T05:23:12.538Z',"}}
[info] >    userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"  userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme' {"user":"  chatId: 'chat-1731474752798-i86t0jvme'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Attempting to save chat history with DETAILED logging: { {"user":"🔍 Attempting to save chat history with DETAILED logging: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Attempting to save chat history with DETAILED logging: {"}}
[info] >    userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"  userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme', {"user":"  chatId: 'chat-1731474752798-i86t0jvme',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme',"}}
[info] >    messageCount: 2, {"user":"  messageCount: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageCount: 2,"}}
[info] >    timestamp: '2024-11-13T05:23:12.538Z', {"user":"  timestamp: '2024-11-13T05:23:12.538Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T05:23:12.538Z',"}}
[info] >    clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' } {"user":"  clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔧 Firebase Client Configuration: { {"user":"🔧 Firebase Client Configuration: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Firebase Client Configuration: {"}}
[info] >    projectId: 'notalone-de4fc', {"user":"  projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   projectId: 'notalone-de4fc',"}}
[info] >    apiKey: 'local-api-key', {"user":"  apiKey: 'local-api-key',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   apiKey: 'local-api-key',"}}
[info] >    authDomain: undefined, {"user":"  authDomain: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   authDomain: undefined,"}}
[info] >    emulatorHost: 'localhost', {"user":"  emulatorHost: 'localhost',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorHost: 'localhost',"}}
[info] >    emulatorPort: 5001 {"user":"  emulatorPort: 5001","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorPort: 5001"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Firebase Functions Object Keys: [ {"user":"🔍 Firebase Functions Object Keys: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Object Keys: ["}}
[info] >    'app', {"user":"  'app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'app',"}}
[info] >    'emulatorOrigin', {"user":"  'emulatorOrigin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'emulatorOrigin',"}}
[info] >    'contextProvider', {"user":"  'contextProvider',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'contextProvider',"}}
[info] >    'deleteService', {"user":"  'deleteService',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'deleteService',"}}
[info] >    'cancelAllRequests', {"user":"  'cancelAllRequests',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'cancelAllRequests',"}}
[info] >    'customDomain', {"user":"  'customDomain',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'customDomain',"}}
[info] >    'region' {"user":"  'region'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'region'"}}
[info] >  ] {"user":"]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ]"}}
[info] >  🔍 Firebase Functions Instance: FunctionsService { {"user":"🔍 Firebase Functions Instance: FunctionsService {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Instance: FunctionsService {"}}
[info] >    app: FirebaseAppImpl { {"user":"  app: FirebaseAppImpl {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   app: FirebaseAppImpl {"}}
[info] >      _isDeleted: false, {"user":"    _isDeleted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _isDeleted: false,"}}
[info] >      _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }, {"user":"    _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },"}}
[info] >      _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false }, {"user":"    _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },"}}
[info] >      _name: '[DEFAULT]', {"user":"    _name: '[DEFAULT]',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _name: '[DEFAULT]',"}}
[info] >      _automaticDataCollectionEnabled: false, {"user":"    _automaticDataCollectionEnabled: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _automaticDataCollectionEnabled: false,"}}
[info] >      _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] } {"user":"    _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    emulatorOrigin: 'http://localhost:5001', {"user":"  emulatorOrigin: 'http://localhost:5001',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorOrigin: 'http://localhost:5001',"}}
[info] >    contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null }, {"user":"  contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },"}}
[info] >    deleteService: [Function (anonymous)], {"user":"  deleteService: [Function (anonymous)],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   deleteService: [Function (anonymous)],"}}
[info] >    cancelAllRequests: Promise { <pending> }, {"user":"  cancelAllRequests: Promise { <pending> },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   cancelAllRequests: Promise { <pending> },"}}
[info] >    customDomain: null, {"user":"  customDomain: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   customDomain: null,"}}
[info] >    region: 'us-central1' {"user":"  region: 'us-central1'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   region: 'us-central1'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' } {"user":"🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[info] >  🔍 Save Chat History Function Details: { {"user":"🔍 Save Chat History Function Details: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Save Chat History Function Details: {"}}
[info] >    functionExists: true, {"user":"  functionExists: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionExists: true,"}}
[info] >    functionType: 'function', {"user":"  functionType: 'function',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionType: 'function',"}}
[info] >    functionName: 'saveChatHistory' {"user":"  functionName: 'saveChatHistory'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionName: 'saveChatHistory'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📤 Chat History Payload: { {"user":"📤 Chat History Payload: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Chat History Payload: {"}}
[info] >    "userId": "UQsdkgUmkfZuAT8HgeMGAb3WnFEN", {"user":"  \"userId\": \"UQsdkgUmkfZuAT8HgeMGAb3WnFEN\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"userId\": \"UQsdkgUmkfZuAT8HgeMGAb3WnFEN\","}}
[info] >    "chatId": "chat-1731474752798-i86t0jvme", {"user":"  \"chatId\": \"chat-1731474752798-i86t0jvme\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"chatId\": \"chat-1731474752798-i86t0jvme\","}}
[info] >    "messages": [ {"user":"  \"messages\": [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"messages\": ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "user", {"user":"      \"role\": \"user\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"user\","}}
[info] >        "content": "sing a sad song and make it better", {"user":"      \"content\": \"sing a sad song and make it better\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"sing a sad song and make it better\","}}
[info] >        "timestamp": "2024-11-13T05:23:12.539Z" {"user":"      \"timestamp\": \"2024-11-13T05:23:12.539Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T05:23:12.539Z\""}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "model", {"user":"      \"role\": \"model\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"model\","}}
[info] >        "content": "(This is a request for a song, not just any song.  Let's assume it starts sad and gets better):\n\n(Verse 1)\nThe rain falls down, a mournful sigh,\nThe wind it howls, a lonely cry.\nThe world is gray, the shadows long,\nMy heart feels weak, where once was strong.\n\n(Chorus)\nOh, lonely rain, wash sorrow away,\nLet sunshine through, to light the day.\nThis weary heart, needs solace now,\nLet hope shine through,  this weary heart, needs solace now. (This is a request for a song, not just any song.  This is a request for a song, not just any song.):\n\n(Verse 1)\nThe rain falls down, a mournful sigh,\nThe wind it howls, a lonely cry.\nThe world is gray, the shadows long,\nMy heart feels weak, where once was strong.\n\n(Chorus)\nOh, lonely rain, wash sorrow away,\nLet sunshine through, to light the day.\nThis weary heart, needs solace now,\nLet hope shine through, to light the day.\n\n(Bridge)\nBut through the storm, a glimmer bright,\nA hopeful ray, a guiding light.\nThe clouds may gather, shadows creep,\nBut still, I sing, to soothe the deep.\n\n(Verse 2)\nThe tears may fall, like gentle rain,\nWashing the pain, easing the strain.\nThe heart may ache, the spirit low,\nBut still, I'll rise, and let it show.\n\n(Chorus)\nOh, lonely rain, wash sorrow away,\nLet sunshine through, to light the day.\nThis weary heart, needs solace now,\nLet hope shine through, to light the day.\n\n(Outro)\nThe sun breaks through, the storm is past,\nThe sadness fades, the shadows cast,\nAway are gone, the tears are dried,\nA brighter day, with hope inside.\n", {"user":"      \"content\": \"(This is a request for a song, not just any song.  Let's assume it starts sad and gets better):\\n\\n(Verse 1)\\nThe rain falls down, a mournful sigh,\\nThe wind it howls, a lonely cry.\\nThe world is gray, the shadows long,\\nMy heart feels weak, where once was strong.\\n\\n(Chorus)\\nOh, lonely rain, wash sorrow away,\\nLet sunshine through, to light the day.\\nThis weary heart, needs solace now,\\nLet hope shine through,  this weary heart, needs solace now. (This is a request for a song, not just any song.  This is a request for a song, not just any song.):\\n\\n(Verse 1)\\nThe rain falls down, a mournful sigh,\\nThe wind it howls, a lonely cry.\\nThe world is gray, the shadows long,\\nMy heart feels weak, where once was strong.\\n\\n(Chorus)\\nOh, lonely rain, wash sorrow away,\\nLet sunshine through, to light the day.\\nThis weary heart, needs solace now,\\nLet hope shine through, to light the day.\\n\\n(Bridge)\\nBut through the storm, a glimmer bright,\\nA hopeful ray, a guiding light.\\nThe clouds may gather, shadows creep,\\nBut still, I sing, to soothe the deep.\\n\\n(Verse 2)\\nThe tears may fall, like gentle rain,\\nWashing the pain, easing the strain.\\nThe heart may ache, the spirit low,\\nBut still, I'll rise, and let it show.\\n\\n(Chorus)\\nOh, lonely rain, wash sorrow away,\\nLet sunshine through, to light the day.\\nThis weary heart, needs solace now,\\nLet hope shine through, to light the day.\\n\\n(Outro)\\nThe sun breaks through, the storm is past,\\nThe sadness fades, the shadows cast,\\nAway are gone, the tears are dried,\\nA brighter day, with hope inside.\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"(This is a request for a song, not just any song.  Let's assume it starts sad and gets better):\\n\\n(Verse 1)\\nThe rain falls down, a mournful sigh,\\nThe wind it howls, a lonely cry.\\nThe world is gray, the shadows long,\\nMy heart feels weak, where once was strong.\\n\\n(Chorus)\\nOh, lonely rain, wash sorrow away,\\nLet sunshine through, to light the day.\\nThis weary heart, needs solace now,\\nLet hope shine through,  this weary heart, needs solace now. (This is a request for a song, not just any song.  This is a request for a song, not just any song.):\\n\\n(Verse 1)\\nThe rain falls down, a mournful sigh,\\nThe wind it howls, a lonely cry.\\nThe world is gray, the shadows long,\\nMy heart feels weak, where once was strong.\\n\\n(Chorus)\\nOh, lonely rain, wash sorrow away,\\nLet sunshine through, to light the day.\\nThis weary heart, needs solace now,\\nLet hope shine through, to light the day.\\n\\n(Bridge)\\nBut through the storm, a glimmer bright,\\nA hopeful ray, a guiding light.\\nThe clouds may gather, shadows creep,\\nBut still, I sing, to soothe the deep.\\n\\n(Verse 2)\\nThe tears may fall, like gentle rain,\\nWashing the pain, easing the strain.\\nThe heart may ache, the spirit low,\\nBut still, I'll rise, and let it show.\\n\\n(Chorus)\\nOh, lonely rain, wash sorrow away,\\nLet sunshine through, to light the day.\\nThis weary heart, needs solace now,\\nLet hope shine through, to light the day.\\n\\n(Outro)\\nThe sun breaks through, the storm is past,\\nThe sadness fades, the shadows cast,\\nAway are gone, the tears are dried,\\nA brighter day, with hope inside.\\n\","}}
[info] >        "timestamp": "2024-11-13T05:23:12.539Z" {"user":"      \"timestamp\": \"2024-11-13T05:23:12.539Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T05:23:12.539Z\""}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    "timestamp": "2024-11-13T05:23:12.539Z", {"user":"  \"timestamp\": \"2024-11-13T05:23:12.539Z\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"timestamp\": \"2024-11-13T05:23:12.539Z\","}}
[info] >    "authDetails": { {"user":"  \"authDetails\": {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"authDetails\": {"}}
[info] >      "uid": "UQsdkgUmkfZuAT8HgeMGAb3WnFEN", {"user":"    \"uid\": \"UQsdkgUmkfZuAT8HgeMGAb3WnFEN\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"uid\": \"UQsdkgUmkfZuAT8HgeMGAb3WnFEN\","}}
[info] >      "token": "Present" {"user":"    \"token\": \"Present\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"token\": \"Present\""}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T05:23:12.605Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T05:23:12.605Z"],"queueLength":1,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:23:03.613Z"],"workRunningCount":1}
[debug] [2024-11-13T05:23:12.605Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:23:03.613Z","/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T05:23:12.605Z"],"workRunningCount":2}
[debug] [2024-11-13T05:23:12.605Z] Accepted request POST /notalone-de4fc/us-central1/saveChatHistory --> us-central1-saveChatHistory
[debug] [2024-11-13T05:23:12.607Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T05:23:12.608Z] [functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/"}}
[debug] [2024-11-13T05:23:12.608Z] [worker-pool] submitRequest(triggerId=us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-saveChatHistory)"}}
[info] i  functions: Beginning execution of "us-central1-saveChatHistory" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Beginning execution of \"us-central1-saveChatHistory\""}}
[debug] [2024-11-13T05:23:12.608Z] [worker-us-central1-saveChatHistory-997f5476-7042-4212-9776-1b85802491a8]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-997f5476-7042-4212-9776-1b85802491a8]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"MISSING\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🔍 Saving Chat History { {"user":"🔍 Saving Chat History {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Saving Chat History {"}}
[info] >    request: { {"user":"  request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   request: {"}}
[info] >      rawRequest: IncomingMessage { {"user":"    rawRequest: IncomingMessage {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     rawRequest: IncomingMessage {"}}
[info] >        _events: [Object], {"user":"      _events: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _events: [Object],"}}
[info] >        _readableState: [ReadableState], {"user":"      _readableState: [ReadableState],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _readableState: [ReadableState],"}}
[info] >        _maxListeners: undefined, {"user":"      _maxListeners: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _maxListeners: undefined,"}}
[info] >        socket: [Socket], {"user":"      socket: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       socket: [Socket],"}}
[info] >        httpVersionMajor: 1, {"user":"      httpVersionMajor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMajor: 1,"}}
[info] >        httpVersionMinor: 1, {"user":"      httpVersionMinor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMinor: 1,"}}
[info] >        httpVersion: '1.1', {"user":"      httpVersion: '1.1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersion: '1.1',"}}
[info] >        complete: true, {"user":"      complete: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       complete: true,"}}
[info] >        rawHeaders: [Array], {"user":"      rawHeaders: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawHeaders: [Array],"}}
[info] >        rawTrailers: [], {"user":"      rawTrailers: [],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawTrailers: [],"}}
[info] >        joinDuplicateHeaders: null, {"user":"      joinDuplicateHeaders: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       joinDuplicateHeaders: null,"}}
[info] >        aborted: false, {"user":"      aborted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       aborted: false,"}}
[info] >        upgrade: false, {"user":"      upgrade: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       upgrade: false,"}}
[info] >        url: '/', {"user":"      url: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       url: '/',"}}
[info] >        method: 'POST', {"user":"      method: 'POST',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       method: 'POST',"}}
[info] >        statusCode: null, {"user":"      statusCode: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusCode: null,"}}
[info] >        statusMessage: null, {"user":"      statusMessage: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusMessage: null,"}}
[info] >        client: [Socket], {"user":"      client: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       client: [Socket],"}}
[info] >        _consuming: true, {"user":"      _consuming: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _consuming: true,"}}
[info] >        _dumped: false, {"user":"      _dumped: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _dumped: false,"}}
[info] >        next: [Function: next], {"user":"      next: [Function: next],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       next: [Function: next],"}}
[info] >        baseUrl: '', {"user":"      baseUrl: '',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       baseUrl: '',"}}
[info] >        originalUrl: '/', {"user":"      originalUrl: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       originalUrl: '/',"}}
[info] >        _parsedUrl: [Url], {"user":"      _parsedUrl: [Url],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _parsedUrl: [Url],"}}
[info] >        params: [Object], {"user":"      params: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       params: [Object],"}}
[info] >        query: {}, {"user":"      query: {},","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       query: {},"}}
[info] >        res: [ServerResponse], {"user":"      res: [ServerResponse],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       res: [ServerResponse],"}}
[info] >        body: [Object], {"user":"      body: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       body: [Object],"}}
[info] >        _body: true, {"user":"      _body: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _body: true,"}}
[info] >        length: undefined, {"user":"      length: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       length: undefined,"}}
[info] >        _eventsCount: 0, {"user":"      _eventsCount: 0,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _eventsCount: 0,"}}
[info] >        rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 55 51 73 64 6b 67 55 6d 6b 66 5a 75 41 54 38 48 67 65 4d 47 41 62 33 57 6e 46 45 4e 22 2c 22 ... 1824 more bytes>, {"user":"      rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 55 51 73 64 6b 67 55 6d 6b 66 5a 75 41 54 38 48 67 65 4d 47 41 62 33 57 6e 46 45 4e 22 2c 22 ... 1824 more bytes>,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 55 51 73 64 6b 67 55 6d 6b 66 5a 75 41 54 38 48 67 65 4d 47 41 62 33 57 6e 46 45 4e 22 2c 22 ... 1824 more bytes>,"}}
[info] >        route: [Route], {"user":"      route: [Route],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       route: [Route],"}}
[info] >        [Symbol(shapeMode)]: true, {"user":"      [Symbol(shapeMode)]: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(shapeMode)]: true,"}}
[info] >        [Symbol(kCapture)]: false, {"user":"      [Symbol(kCapture)]: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kCapture)]: false,"}}
[info] >        [Symbol(kHeaders)]: [Object], {"user":"      [Symbol(kHeaders)]: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeaders)]: [Object],"}}
[info] >        [Symbol(kHeadersCount)]: 18, {"user":"      [Symbol(kHeadersCount)]: 18,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeadersCount)]: 18,"}}
[info] >        [Symbol(kTrailers)]: null, {"user":"      [Symbol(kTrailers)]: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailers)]: null,"}}
[info] >        [Symbol(kTrailersCount)]: 0 {"user":"      [Symbol(kTrailersCount)]: 0","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailersCount)]: 0"}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      data: { {"user":"    data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     data: {"}}
[info] >        userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"      userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >        chatId: 'chat-1731474752798-i86t0jvme', {"user":"      chatId: 'chat-1731474752798-i86t0jvme',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       chatId: 'chat-1731474752798-i86t0jvme',"}}
[info] >        messages: [Array], {"user":"      messages: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       messages: [Array],"}}
[info] >        timestamp: '2024-11-13T05:23:12.539Z' {"user":"      timestamp: '2024-11-13T05:23:12.539Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       timestamp: '2024-11-13T05:23:12.539Z'"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T05:23:12.652Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-saveChatHistory" in 43.9845ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finished \"us-central1-saveChatHistory\" in 43.9845ms"}}
[debug] [2024-11-13T05:23:12.653Z] [worker-us-central1-saveChatHistory-997f5476-7042-4212-9776-1b85802491a8]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-997f5476-7042-4212-9776-1b85802491a8]: IDLE"}}
[debug] [2024-11-13T05:23:12.653Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T05:23:12.654Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T05:23:12.654Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:23:03.613Z"],"workRunningCount":1}
[info] >  🔍 Extracted Data: { {"user":"🔍 Extracted Data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Extracted Data: {"}}
[info] >    userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"  userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme', {"user":"  chatId: 'chat-1731474752798-i86t0jvme',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme',"}}
[info] >    messagesCount: 2 {"user":"  messagesCount: 2","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   messagesCount: 2"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Chat history saved/updated: chat-1731474752798-i86t0jvme { totalMessageCount: 8, newMessagesAdded: 2 } {"user":"✅ Chat history saved/updated: chat-1731474752798-i86t0jvme { totalMessageCount: 8, newMessagesAdded: 2 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Chat history saved/updated: chat-1731474752798-i86t0jvme { totalMessageCount: 8, newMessagesAdded: 2 }"}}
[info] >  ✅ Chat history save result: { {"user":"✅ Chat history save result: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Chat history save result: {"}}
[info] >    data: { success: true, message: 'Chat history saved', totalMessages: 8 } {"user":"  data: { success: true, message: 'Chat history saved', totalMessages: 8 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { success: true, message: 'Chat history saved', totalMessages: 8 }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T05:23:12.659Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 9042.3988ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 9042.3988ms"}}
[debug] [2024-11-13T05:23:12.659Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE"}}
[debug] [2024-11-13T05:23:12.659Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T05:23:12.659Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T05:23:12.660Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:23:26.774Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:23:26.774Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:23:26.775Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:23:26.774Z"],"workRunningCount":1}
[debug] [2024-11-13T05:23:26.775Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T05:23:26.778Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T05:23:26.778Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T05:23:26.778Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T05:23:26.779Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY"}}
[debug] [2024-11-13T05:23:26.782Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4.971ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4.971ms"}}
[debug] [2024-11-13T05:23:26.785Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE"}}
[debug] [2024-11-13T05:23:26.785Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T05:23:26.785Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T05:23:26.785Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:23:26.786Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:23:26.786Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:23:26.786Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:23:26.786Z"],"workRunningCount":1}
[debug] [2024-11-13T05:23:26.786Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T05:23:26.789Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T05:23:26.789Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T05:23:26.789Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T05:23:26.790Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { {"user":"  data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: {"}}
[info] >      message: 'remember to  let her under your skin', {"user":"    message: 'remember to  let her under your skin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     message: 'remember to  let her under your skin',"}}
[info] >      chatId: 'chat-1731474752798-i86t0jvme' {"user":"    chatId: 'chat-1731474752798-i86t0jvme'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     chatId: 'chat-1731474752798-i86t0jvme'"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📝 Using chat ID: chat-1731474752798-i86t0jvme {"user":"📝 Using chat ID: chat-1731474752798-i86t0jvme","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: chat-1731474752798-i86t0jvme"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 36, {"user":"  messageLength: 36,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 36,"}}
[info] >    userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"  userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme' {"user":"  chatId: 'chat-1731474752798-i86t0jvme'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: remember to  let her under your skin {"user":"💬 Sending message to Gemini: remember to  let her under your skin","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: remember to  let her under your skin"}}
[info] >  💥 Chat processing error: ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {"error":{"code":429,"message":"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","status":"RESOURCE_EXHAUSTED"}} {"user":"💥 Chat processing error: ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {\"error\":{\"code\":429,\"message\":\"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.\",\"status\":\"RESOURCE_EXHAUSTED\"}}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💥 Chat processing error: ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {\"error\":{\"code\":429,\"message\":\"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.\",\"status\":\"RESOURCE_EXHAUSTED\"}}"}}
[info] >      at throwErrorIfNotOK (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:27) {"user":"    at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:27)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:27)"}}
[info] >      at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >      ... 6 lines matching cause stack trace ... {"user":"    ... 6 lines matching cause stack trace ...","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     ... 6 lines matching cause stack trace ..."}}
[info] >      at async C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:694:21 { {"user":"    at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {"}}
[info] >    stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff. {"user":"  stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff."}}
[info] >        at throwErrorIfNotOK (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:66) {"user":"      at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)"}}
[info] >        at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >        at async generateContent (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\generate_content.js:58:5) {"user":"      at async generateContent (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:58:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async generateContent (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:58:5)"}}
[info] >        at async ChatSessionPreview.sendMessage (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\models\chat_session.js:241:39) {"user":"      at async ChatSessionPreview.sendMessage (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\models\\chat_session.js:241:39)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async ChatSessionPreview.sendMessage (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\models\\chat_session.js:241:39)"}}
[info] >        at async C:\Users\Rob\apps\not-alone\functions\lib\index.js:145:24 {"user":"      at async C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js:145:24","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js:145:24"}}
[info] >        at async C:\Users\Rob\apps\not-alone\functions\node_modules\firebase-functions\lib\common\providers\https.js:467:26 {"user":"      at async C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26"}}
[info] >        at async runFunction (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:506:9) {"user":"      at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)"}}
[info] >        at async runHTTPS (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:531:5) {"user":"      at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)"}}
[info] >        at async C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:694:21 { {"user":"      at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {"}}
[info] >      code: 429, {"user":"    code: 429,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 429,"}}
[info] >      status: 'RESOURCE_EXHAUSTED', {"user":"    status: 'RESOURCE_EXHAUSTED',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     status: 'RESOURCE_EXHAUSTED',"}}
[info] >      errorDetails: undefined {"user":"    errorDetails: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     errorDetails: undefined"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff. {"user":"  [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff."}}
[info] >        at throwErrorIfNotOK (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:66) {"user":"      at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)"}}
[info] >        at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >        at async generateContent (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\generate_content.js:58:5) {"user":"      at async generateContent (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:58:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async generateContent (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:58:5)"}}
[info] >        at async ChatSessionPreview.sendMessage (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\models\chat_session.js:241:39) {"user":"      at async ChatSessionPreview.sendMessage (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\models\\chat_session.js:241:39)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async ChatSessionPreview.sendMessage (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\models\\chat_session.js:241:39)"}}
[info] >        at async C:\Users\Rob\apps\not-alone\functions\lib\index.js:145:24 {"user":"      at async C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js:145:24","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js:145:24"}}
[info] >        at async C:\Users\Rob\apps\not-alone\functions\node_modules\firebase-functions\lib\common\providers\https.js:467:26 {"user":"      at async C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26"}}
[info] >        at async runFunction (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:506:9) {"user":"      at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)"}}
[info] >        at async runHTTPS (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:531:5) {"user":"      at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)"}}
[info] >        at async C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:694:21 { {"user":"      at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {"}}
[info] >      code: 429, {"user":"    code: 429,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 429,"}}
[info] >      status: 'RESOURCE_EXHAUSTED', {"user":"    status: 'RESOURCE_EXHAUSTED',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     status: 'RESOURCE_EXHAUSTED',"}}
[info] >      errorDetails: undefined {"user":"    errorDetails: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     errorDetails: undefined"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T05:23:27.066Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 276.3384ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 276.3384ms"}}
[debug] [2024-11-13T05:23:27.066Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE"}}
[debug] [2024-11-13T05:23:27.067Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T05:23:27.067Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T05:23:27.067Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:23:32.085Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:23:32.085Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:23:32.085Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:23:32.085Z"],"workRunningCount":1}
[debug] [2024-11-13T05:23:32.085Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T05:23:32.087Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T05:23:32.087Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T05:23:32.087Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T05:23:32.087Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY"}}
[debug] [2024-11-13T05:23:32.090Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2.4066ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2.4066ms"}}
[debug] [2024-11-13T05:23:32.090Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE"}}
[debug] [2024-11-13T05:23:32.090Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T05:23:32.090Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T05:23:32.090Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:23:32.091Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:23:32.091Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:23:32.091Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:23:32.091Z"],"workRunningCount":1}
[debug] [2024-11-13T05:23:32.091Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T05:23:32.093Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T05:23:32.093Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T05:23:32.093Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T05:23:32.094Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { {"user":"  data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: {"}}
[info] >      message: 'remember to  let her under your skin', {"user":"    message: 'remember to  let her under your skin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     message: 'remember to  let her under your skin',"}}
[info] >      chatId: 'chat-1731474752798-i86t0jvme' {"user":"    chatId: 'chat-1731474752798-i86t0jvme'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     chatId: 'chat-1731474752798-i86t0jvme'"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📝 Using chat ID: chat-1731474752798-i86t0jvme {"user":"📝 Using chat ID: chat-1731474752798-i86t0jvme","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: chat-1731474752798-i86t0jvme"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 36, {"user":"  messageLength: 36,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 36,"}}
[info] >    userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"  userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme' {"user":"  chatId: 'chat-1731474752798-i86t0jvme'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: remember to  let her under your skin {"user":"💬 Sending message to Gemini: remember to  let her under your skin","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: remember to  let her under your skin"}}
[info] >  💥 Chat processing error: ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {"error":{"code":429,"message":"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","status":"RESOURCE_EXHAUSTED"}} {"user":"💥 Chat processing error: ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {\"error\":{\"code\":429,\"message\":\"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.\",\"status\":\"RESOURCE_EXHAUSTED\"}}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💥 Chat processing error: ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {\"error\":{\"code\":429,\"message\":\"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.\",\"status\":\"RESOURCE_EXHAUSTED\"}}"}}
[info] >      at throwErrorIfNotOK (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:27) {"user":"    at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:27)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:27)"}}
[info] >      at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >      ... 6 lines matching cause stack trace ... {"user":"    ... 6 lines matching cause stack trace ...","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     ... 6 lines matching cause stack trace ..."}}
[info] >      at async C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:694:21 { {"user":"    at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {"}}
[info] >    stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff. {"user":"  stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff."}}
[info] >        at throwErrorIfNotOK (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:66) {"user":"      at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)"}}
[info] >        at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >        at async generateContent (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\generate_content.js:58:5) {"user":"      at async generateContent (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:58:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async generateContent (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:58:5)"}}
[info] >        at async ChatSessionPreview.sendMessage (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\models\chat_session.js:241:39) {"user":"      at async ChatSessionPreview.sendMessage (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\models\\chat_session.js:241:39)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async ChatSessionPreview.sendMessage (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\models\\chat_session.js:241:39)"}}
[info] >        at async C:\Users\Rob\apps\not-alone\functions\lib\index.js:145:24 {"user":"      at async C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js:145:24","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js:145:24"}}
[info] >        at async C:\Users\Rob\apps\not-alone\functions\node_modules\firebase-functions\lib\common\providers\https.js:467:26 {"user":"      at async C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26"}}
[info] >        at async runFunction (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:506:9) {"user":"      at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)"}}
[info] >        at async runHTTPS (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:531:5) {"user":"      at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)"}}
[info] >        at async C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:694:21 { {"user":"      at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {"}}
[info] >      code: 429, {"user":"    code: 429,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 429,"}}
[info] >      status: 'RESOURCE_EXHAUSTED', {"user":"    status: 'RESOURCE_EXHAUSTED',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     status: 'RESOURCE_EXHAUSTED',"}}
[info] >      errorDetails: undefined {"user":"    errorDetails: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     errorDetails: undefined"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff. {"user":"  [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff."}}
[info] >        at throwErrorIfNotOK (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:66) {"user":"      at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)"}}
[info] >        at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >        at async generateContent (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\generate_content.js:58:5) {"user":"      at async generateContent (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:58:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async generateContent (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:58:5)"}}
[info] >        at async ChatSessionPreview.sendMessage (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\models\chat_session.js:241:39) {"user":"      at async ChatSessionPreview.sendMessage (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\models\\chat_session.js:241:39)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async ChatSessionPreview.sendMessage (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\models\\chat_session.js:241:39)"}}
[info] >        at async C:\Users\Rob\apps\not-alone\functions\lib\index.js:145:24 {"user":"      at async C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js:145:24","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js:145:24"}}
[info] >        at async C:\Users\Rob\apps\not-alone\functions\node_modules\firebase-functions\lib\common\providers\https.js:467:26 {"user":"      at async C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26"}}
[info] >        at async runFunction (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:506:9) {"user":"      at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)"}}
[info] >        at async runHTTPS (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:531:5) {"user":"      at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)"}}
[info] >        at async C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:694:21 { {"user":"      at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {"}}
[info] >      code: 429, {"user":"    code: 429,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 429,"}}
[info] >      status: 'RESOURCE_EXHAUSTED', {"user":"    status: 'RESOURCE_EXHAUSTED',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     status: 'RESOURCE_EXHAUSTED',"}}
[info] >      errorDetails: undefined {"user":"    errorDetails: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     errorDetails: undefined"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T05:23:32.283Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 189.901ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 189.901ms"}}
[debug] [2024-11-13T05:23:32.284Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE"}}
[debug] [2024-11-13T05:23:32.284Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T05:23:32.284Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T05:23:32.284Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:23:37.292Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:23:37.292Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:23:37.292Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:23:37.292Z"],"workRunningCount":1}
[debug] [2024-11-13T05:23:37.292Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T05:23:37.293Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T05:23:37.293Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T05:23:37.293Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T05:23:37.294Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY"}}
[debug] [2024-11-13T05:23:37.296Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2.3597ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2.3597ms"}}
[debug] [2024-11-13T05:23:37.296Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE"}}
[debug] [2024-11-13T05:23:37.296Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T05:23:37.296Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T05:23:37.296Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:23:37.297Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:23:37.297Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T05:23:37.297Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:23:37.297Z"],"workRunningCount":1}
[debug] [2024-11-13T05:23:37.297Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T05:23:37.298Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T05:23:37.298Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T05:23:37.298Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T05:23:37.298Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { {"user":"  data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: {"}}
[info] >      message: 'remember to  let her under your skin', {"user":"    message: 'remember to  let her under your skin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     message: 'remember to  let her under your skin',"}}
[info] >      chatId: 'chat-1731474752798-i86t0jvme' {"user":"    chatId: 'chat-1731474752798-i86t0jvme'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     chatId: 'chat-1731474752798-i86t0jvme'"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📝 Using chat ID: chat-1731474752798-i86t0jvme {"user":"📝 Using chat ID: chat-1731474752798-i86t0jvme","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: chat-1731474752798-i86t0jvme"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 36, {"user":"  messageLength: 36,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 36,"}}
[info] >    userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"  userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme' {"user":"  chatId: 'chat-1731474752798-i86t0jvme'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: remember to  let her under your skin {"user":"💬 Sending message to Gemini: remember to  let her under your skin","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: remember to  let her under your skin"}}
[info] >  📚 Current Chat History: { {"user":"📚 Current Chat History: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📚 Current Chat History: {"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme', {"user":"  chatId: 'chat-1731474752798-i86t0jvme',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme',"}}
[info] >    historyLength: 14, {"user":"  historyLength: 14,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   historyLength: 14,"}}
[info] >    lastMessages: [ {"user":"  lastMessages: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   lastMessages: ["}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] } {"user":"    { role: 'model', parts: [Array] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Response received: { responseLength: 1510, timestamp: '2024-11-13T05:23:54.539Z' } {"user":"✅ Response received: { responseLength: 1510, timestamp: '2024-11-13T05:23:54.539Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 1510, timestamp: '2024-11-13T05:23:54.539Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: `That's a very evocative phrase, "let her under your skin."  It suggests a deep, intimate connection that goes beyond surface-level interactions.  It implies a level of vulnerability and acceptance where you allow someone to truly know you, flaws and all.  It also suggests a reciprocal relationship where you, in turn, are also known deeply by her.\n` + {"user":"  message: `That's a very evocative phrase, \"let her under your skin.\"  It suggests a deep, intimate connection that goes beyond surface-level interactions.  It implies a level of vulnerability and acceptance where you allow someone to truly know you, flaws and all.  It also suggests a reciprocal relationship where you, in turn, are also known deeply by her.\\n` +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: `That's a very evocative phrase, \"let her under your skin.\"  It suggests a deep, intimate connection that goes beyond surface-level interactions.  It implies a level of vulnerability and acceptance where you allow someone to truly know you, flaws and all.  It also suggests a reciprocal relationship where you, in turn, are also known deeply by her.\\n` +"}}
[info] >      '\n' + {"user":"    '\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '\\n' +"}}
[info] >      `However, it's crucial to remember that "letting someone under your skin" should be a *mutual* and *respectful* process. It's not about being overtaken or losing your sense of self, but about a conscious decision to share your vulnerabilities with someone you trust and who respects your boundaries.  It involves:\n` + {"user":"    `However, it's crucial to remember that \"letting someone under your skin\" should be a *mutual* and *respectful* process. It's not about being overtaken or losing your sense of self, but about a conscious decision to share your vulnerabilities with someone you trust and who respects your boundaries.  It involves:\\n` +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     `However, it's crucial to remember that \"letting someone under your skin\" should be a *mutual* and *respectful* process. It's not about being overtaken or losing your sense of self, but about a conscious decision to share your vulnerabilities with someone you trust and who respects your boundaries.  It involves:\\n` +"}}
[info] >      '\n' + {"user":"    '\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '\\n' +"}}
[info] >      '* **Trust:**  You need to trust the person enough to be vulnerable with them.\n' + {"user":"    '* **Trust:**  You need to trust the person enough to be vulnerable with them.\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '* **Trust:**  You need to trust the person enough to be vulnerable with them.\\n' +"}}
[info] >      "* **Respect:**  Both individuals must respect each other's boundaries and emotional needs.\n" + {"user":"    \"* **Respect:**  Both individuals must respect each other's boundaries and emotional needs.\\n\" +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"* **Respect:**  Both individuals must respect each other's boundaries and emotional needs.\\n\" +"}}
[info] >      '* **Reciprocity:**  The connection should be a two-way street; both individuals should be willing to be vulnerable and open with each other.\n' + {"user":"    '* **Reciprocity:**  The connection should be a two-way street; both individuals should be willing to be vulnerable and open with each other.\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '* **Reciprocity:**  The connection should be a two-way street; both individuals should be willing to be vulnerable and open with each other.\\n' +"}}
[info] >      `* **Healthy Boundaries:** While intimacy is important, maintaining healthy boundaries is crucial for a healthy relationship.  Letting someone "under your skin" doesn't mean losing yourself in the relationship.\n` + {"user":"    `* **Healthy Boundaries:** While intimacy is important, maintaining healthy boundaries is crucial for a healthy relationship.  Letting someone \"under your skin\" doesn't mean losing yourself in the relationship.\\n` +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     `* **Healthy Boundaries:** While intimacy is important, maintaining healthy boundaries is crucial for a healthy relationship.  Letting someone \"under your skin\" doesn't mean losing yourself in the relationship.\\n` +"}}
[info] >      '\n' + {"user":"    '\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '\\n' +"}}
[info] >      "If you're thinking about this phrase in the context of a specific relationship,  consider whether the relationship is healthy and balanced, and whether you both feel safe and comfortable enough to share your vulnerabilities.  If you're unsure, exploring those feelings with a trusted friend or therapist could be beneficial.\n", {"user":"    \"If you're thinking about this phrase in the context of a specific relationship,  consider whether the relationship is healthy and balanced, and whether you both feel safe and comfortable enough to share your vulnerabilities.  If you're unsure, exploring those feelings with a trusted friend or therapist could be beneficial.\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"If you're thinking about this phrase in the context of a specific relationship,  consider whether the relationship is healthy and balanced, and whether you both feel safe and comfortable enough to share your vulnerabilities.  If you're unsure, exploring those feelings with a trusted friend or therapist could be beneficial.\\n\","}}
[info] >    userMessage: 'remember to  let her under your skin', {"user":"  userMessage: 'remember to  let her under your skin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'remember to  let her under your skin',"}}
[info] >    timestamp: '2024-11-13T05:23:54.539Z', {"user":"  timestamp: '2024-11-13T05:23:54.539Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T05:23:54.539Z',"}}
[info] >    userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"  userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme' {"user":"  chatId: 'chat-1731474752798-i86t0jvme'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Attempting to save chat history with DETAILED logging: { {"user":"🔍 Attempting to save chat history with DETAILED logging: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Attempting to save chat history with DETAILED logging: {"}}
[info] >    userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"  userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme', {"user":"  chatId: 'chat-1731474752798-i86t0jvme',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme',"}}
[info] >    messageCount: 2, {"user":"  messageCount: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageCount: 2,"}}
[info] >    timestamp: '2024-11-13T05:23:54.539Z', {"user":"  timestamp: '2024-11-13T05:23:54.539Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T05:23:54.539Z',"}}
[info] >    clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' } {"user":"  clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔧 Firebase Client Configuration: { {"user":"🔧 Firebase Client Configuration: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Firebase Client Configuration: {"}}
[info] >    projectId: 'notalone-de4fc', {"user":"  projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   projectId: 'notalone-de4fc',"}}
[info] >    apiKey: 'local-api-key', {"user":"  apiKey: 'local-api-key',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   apiKey: 'local-api-key',"}}
[info] >    authDomain: undefined, {"user":"  authDomain: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   authDomain: undefined,"}}
[info] >    emulatorHost: 'localhost', {"user":"  emulatorHost: 'localhost',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorHost: 'localhost',"}}
[info] >    emulatorPort: 5001 {"user":"  emulatorPort: 5001","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorPort: 5001"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Firebase Functions Object Keys: [ {"user":"🔍 Firebase Functions Object Keys: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Object Keys: ["}}
[info] >    'app', {"user":"  'app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'app',"}}
[info] >    'emulatorOrigin', {"user":"  'emulatorOrigin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'emulatorOrigin',"}}
[info] >    'contextProvider', {"user":"  'contextProvider',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'contextProvider',"}}
[info] >    'deleteService', {"user":"  'deleteService',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'deleteService',"}}
[info] >    'cancelAllRequests', {"user":"  'cancelAllRequests',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'cancelAllRequests',"}}
[info] >    'customDomain', {"user":"  'customDomain',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'customDomain',"}}
[info] >    'region' {"user":"  'region'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'region'"}}
[info] >  ] {"user":"]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ]"}}
[info] >  🔍 Firebase Functions Instance: FunctionsService { {"user":"🔍 Firebase Functions Instance: FunctionsService {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Instance: FunctionsService {"}}
[info] >    app: FirebaseAppImpl { {"user":"  app: FirebaseAppImpl {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   app: FirebaseAppImpl {"}}
[info] >      _isDeleted: false, {"user":"    _isDeleted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _isDeleted: false,"}}
[info] >      _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }, {"user":"    _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },"}}
[info] >      _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false }, {"user":"    _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },"}}
[info] >      _name: '[DEFAULT]', {"user":"    _name: '[DEFAULT]',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _name: '[DEFAULT]',"}}
[info] >      _automaticDataCollectionEnabled: false, {"user":"    _automaticDataCollectionEnabled: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _automaticDataCollectionEnabled: false,"}}
[info] >      _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] } {"user":"    _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    emulatorOrigin: 'http://localhost:5001', {"user":"  emulatorOrigin: 'http://localhost:5001',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorOrigin: 'http://localhost:5001',"}}
[info] >    contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null }, {"user":"  contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },"}}
[info] >    deleteService: [Function (anonymous)], {"user":"  deleteService: [Function (anonymous)],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   deleteService: [Function (anonymous)],"}}
[info] >    cancelAllRequests: Promise { <pending> }, {"user":"  cancelAllRequests: Promise { <pending> },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   cancelAllRequests: Promise { <pending> },"}}
[info] >    customDomain: null, {"user":"  customDomain: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   customDomain: null,"}}
[info] >    region: 'us-central1' {"user":"  region: 'us-central1'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   region: 'us-central1'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' } {"user":"🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[info] >  🔍 Save Chat History Function Details: { {"user":"🔍 Save Chat History Function Details: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Save Chat History Function Details: {"}}
[info] >    functionExists: true, {"user":"  functionExists: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionExists: true,"}}
[info] >    functionType: 'function', {"user":"  functionType: 'function',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionType: 'function',"}}
[info] >    functionName: 'saveChatHistory' {"user":"  functionName: 'saveChatHistory'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionName: 'saveChatHistory'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📤 Chat History Payload: { {"user":"📤 Chat History Payload: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Chat History Payload: {"}}
[info] >    "userId": "UQsdkgUmkfZuAT8HgeMGAb3WnFEN", {"user":"  \"userId\": \"UQsdkgUmkfZuAT8HgeMGAb3WnFEN\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"userId\": \"UQsdkgUmkfZuAT8HgeMGAb3WnFEN\","}}
[info] >    "chatId": "chat-1731474752798-i86t0jvme", {"user":"  \"chatId\": \"chat-1731474752798-i86t0jvme\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"chatId\": \"chat-1731474752798-i86t0jvme\","}}
[info] >    "messages": [ {"user":"  \"messages\": [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"messages\": ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "user", {"user":"      \"role\": \"user\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"user\","}}
[info] >        "content": "remember to  let her under your skin", {"user":"      \"content\": \"remember to  let her under your skin\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"remember to  let her under your skin\","}}
[info] >        "timestamp": "2024-11-13T05:23:54.540Z" {"user":"      \"timestamp\": \"2024-11-13T05:23:54.540Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T05:23:54.540Z\""}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "model", {"user":"      \"role\": \"model\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"model\","}}
[info] >        "content": "That's a very evocative phrase, \"let her under your skin.\"  It suggests a deep, intimate connection that goes beyond surface-level interactions.  It implies a level of vulnerability and acceptance where you allow someone to truly know you, flaws and all.  It also suggests a reciprocal relationship where you, in turn, are also known deeply by her.\n\nHowever, it's crucial to remember that \"letting someone under your skin\" should be a *mutual* and *respectful* process. It's not about being overtaken or losing your sense of self, but about a conscious decision to share your vulnerabilities with someone you trust and who respects your boundaries.  It involves:\n\n* **Trust:**  You need to trust the person enough to be vulnerable with them.\n* **Respect:**  Both individuals must respect each other's boundaries and emotional needs.\n* **Reciprocity:**  The connection should be a two-way street; both individuals should be willing to be vulnerable and open with each other.\n* **Healthy Boundaries:** While intimacy is important, maintaining healthy boundaries is crucial for a healthy relationship.  Letting someone \"under your skin\" doesn't mean losing yourself in the relationship.\n\nIf you're thinking about this phrase in the context of a specific relationship,  consider whether the relationship is healthy and balanced, and whether you both feel safe and comfortable enough to share your vulnerabilities.  If you're unsure, exploring those feelings with a trusted friend or therapist could be beneficial.\n", {"user":"      \"content\": \"That's a very evocative phrase, \\\"let her under your skin.\\\"  It suggests a deep, intimate connection that goes beyond surface-level interactions.  It implies a level of vulnerability and acceptance where you allow someone to truly know you, flaws and all.  It also suggests a reciprocal relationship where you, in turn, are also known deeply by her.\\n\\nHowever, it's crucial to remember that \\\"letting someone under your skin\\\" should be a *mutual* and *respectful* process. It's not about being overtaken or losing your sense of self, but about a conscious decision to share your vulnerabilities with someone you trust and who respects your boundaries.  It involves:\\n\\n* **Trust:**  You need to trust the person enough to be vulnerable with them.\\n* **Respect:**  Both individuals must respect each other's boundaries and emotional needs.\\n* **Reciprocity:**  The connection should be a two-way street; both individuals should be willing to be vulnerable and open with each other.\\n* **Healthy Boundaries:** While intimacy is important, maintaining healthy boundaries is crucial for a healthy relationship.  Letting someone \\\"under your skin\\\" doesn't mean losing yourself in the relationship.\\n\\nIf you're thinking about this phrase in the context of a specific relationship,  consider whether the relationship is healthy and balanced, and whether you both feel safe and comfortable enough to share your vulnerabilities.  If you're unsure, exploring those feelings with a trusted friend or therapist could be beneficial.\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"That's a very evocative phrase, \\\"let her under your skin.\\\"  It suggests a deep, intimate connection that goes beyond surface-level interactions.  It implies a level of vulnerability and acceptance where you allow someone to truly know you, flaws and all.  It also suggests a reciprocal relationship where you, in turn, are also known deeply by her.\\n\\nHowever, it's crucial to remember that \\\"letting someone under your skin\\\" should be a *mutual* and *respectful* process. It's not about being overtaken or losing your sense of self, but about a conscious decision to share your vulnerabilities with someone you trust and who respects your boundaries.  It involves:\\n\\n* **Trust:**  You need to trust the person enough to be vulnerable with them.\\n* **Respect:**  Both individuals must respect each other's boundaries and emotional needs.\\n* **Reciprocity:**  The connection should be a two-way street; both individuals should be willing to be vulnerable and open with each other.\\n* **Healthy Boundaries:** While intimacy is important, maintaining healthy boundaries is crucial for a healthy relationship.  Letting someone \\\"under your skin\\\" doesn't mean losing yourself in the relationship.\\n\\nIf you're thinking about this phrase in the context of a specific relationship,  consider whether the relationship is healthy and balanced, and whether you both feel safe and comfortable enough to share your vulnerabilities.  If you're unsure, exploring those feelings with a trusted friend or therapist could be beneficial.\\n\","}}
[info] >        "timestamp": "2024-11-13T05:23:54.540Z" {"user":"      \"timestamp\": \"2024-11-13T05:23:54.540Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T05:23:54.540Z\""}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    "timestamp": "2024-11-13T05:23:54.540Z", {"user":"  \"timestamp\": \"2024-11-13T05:23:54.540Z\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"timestamp\": \"2024-11-13T05:23:54.540Z\","}}
[info] >    "authDetails": { {"user":"  \"authDetails\": {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"authDetails\": {"}}
[info] >      "uid": "UQsdkgUmkfZuAT8HgeMGAb3WnFEN", {"user":"    \"uid\": \"UQsdkgUmkfZuAT8HgeMGAb3WnFEN\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"uid\": \"UQsdkgUmkfZuAT8HgeMGAb3WnFEN\","}}
[info] >      "token": "Present" {"user":"    \"token\": \"Present\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"token\": \"Present\""}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T05:23:54.588Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T05:23:54.588Z"],"queueLength":1,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:23:37.297Z"],"workRunningCount":1}
[debug] [2024-11-13T05:23:54.588Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:23:37.297Z","/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T05:23:54.588Z"],"workRunningCount":2}
[debug] [2024-11-13T05:23:54.588Z] Accepted request POST /notalone-de4fc/us-central1/saveChatHistory --> us-central1-saveChatHistory
[debug] [2024-11-13T05:23:54.590Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T05:23:54.590Z] [functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/"}}
[debug] [2024-11-13T05:23:54.590Z] [worker-pool] submitRequest(triggerId=us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-saveChatHistory)"}}
[info] i  functions: Beginning execution of "us-central1-saveChatHistory" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Beginning execution of \"us-central1-saveChatHistory\""}}
[debug] [2024-11-13T05:23:54.591Z] [worker-us-central1-saveChatHistory-997f5476-7042-4212-9776-1b85802491a8]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-997f5476-7042-4212-9776-1b85802491a8]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"MISSING\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🔍 Saving Chat History { {"user":"🔍 Saving Chat History {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Saving Chat History {"}}
[info] >    request: { {"user":"  request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   request: {"}}
[info] >      rawRequest: IncomingMessage { {"user":"    rawRequest: IncomingMessage {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     rawRequest: IncomingMessage {"}}
[info] >        _events: [Object], {"user":"      _events: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _events: [Object],"}}
[info] >        _readableState: [ReadableState], {"user":"      _readableState: [ReadableState],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _readableState: [ReadableState],"}}
[info] >        _maxListeners: undefined, {"user":"      _maxListeners: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _maxListeners: undefined,"}}
[info] >        socket: [Socket], {"user":"      socket: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       socket: [Socket],"}}
[info] >        httpVersionMajor: 1, {"user":"      httpVersionMajor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMajor: 1,"}}
[info] >        httpVersionMinor: 1, {"user":"      httpVersionMinor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMinor: 1,"}}
[info] >        httpVersion: '1.1', {"user":"      httpVersion: '1.1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersion: '1.1',"}}
[info] >        complete: true, {"user":"      complete: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       complete: true,"}}
[info] >        rawHeaders: [Array], {"user":"      rawHeaders: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawHeaders: [Array],"}}
[info] >        rawTrailers: [], {"user":"      rawTrailers: [],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawTrailers: [],"}}
[info] >        joinDuplicateHeaders: null, {"user":"      joinDuplicateHeaders: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       joinDuplicateHeaders: null,"}}
[info] >        aborted: false, {"user":"      aborted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       aborted: false,"}}
[info] >        upgrade: false, {"user":"      upgrade: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       upgrade: false,"}}
[info] >        url: '/', {"user":"      url: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       url: '/',"}}
[info] >        method: 'POST', {"user":"      method: 'POST',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       method: 'POST',"}}
[info] >        statusCode: null, {"user":"      statusCode: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusCode: null,"}}
[info] >        statusMessage: null, {"user":"      statusMessage: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusMessage: null,"}}
[info] >        client: [Socket], {"user":"      client: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       client: [Socket],"}}
[info] >        _consuming: true, {"user":"      _consuming: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _consuming: true,"}}
[info] >        _dumped: false, {"user":"      _dumped: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _dumped: false,"}}
[info] >        next: [Function: next], {"user":"      next: [Function: next],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       next: [Function: next],"}}
[info] >        baseUrl: '', {"user":"      baseUrl: '',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       baseUrl: '',"}}
[info] >        originalUrl: '/', {"user":"      originalUrl: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       originalUrl: '/',"}}
[info] >        _parsedUrl: [Url], {"user":"      _parsedUrl: [Url],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _parsedUrl: [Url],"}}
[info] >        params: [Object], {"user":"      params: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       params: [Object],"}}
[info] >        query: {}, {"user":"      query: {},","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       query: {},"}}
[info] >        res: [ServerResponse], {"user":"      res: [ServerResponse],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       res: [ServerResponse],"}}
[info] >        body: [Object], {"user":"      body: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       body: [Object],"}}
[info] >        _body: true, {"user":"      _body: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _body: true,"}}
[info] >        length: undefined, {"user":"      length: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       length: undefined,"}}
[info] >        _eventsCount: 0, {"user":"      _eventsCount: 0,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _eventsCount: 0,"}}
[info] >        rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 55 51 73 64 6b 67 55 6d 6b 66 5a 75 41 54 38 48 67 65 4d 47 41 62 33 57 6e 46 45 4e 22 2c 22 ... 1791 more bytes>, {"user":"      rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 55 51 73 64 6b 67 55 6d 6b 66 5a 75 41 54 38 48 67 65 4d 47 41 62 33 57 6e 46 45 4e 22 2c 22 ... 1791 more bytes>,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 55 51 73 64 6b 67 55 6d 6b 66 5a 75 41 54 38 48 67 65 4d 47 41 62 33 57 6e 46 45 4e 22 2c 22 ... 1791 more bytes>,"}}
[info] >        route: [Route], {"user":"      route: [Route],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       route: [Route],"}}
[info] >        [Symbol(shapeMode)]: true, {"user":"      [Symbol(shapeMode)]: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(shapeMode)]: true,"}}
[info] >        [Symbol(kCapture)]: false, {"user":"      [Symbol(kCapture)]: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kCapture)]: false,"}}
[info] >        [Symbol(kHeaders)]: [Object], {"user":"      [Symbol(kHeaders)]: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeaders)]: [Object],"}}
[info] >        [Symbol(kHeadersCount)]: 18, {"user":"      [Symbol(kHeadersCount)]: 18,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeadersCount)]: 18,"}}
[info] >        [Symbol(kTrailers)]: null, {"user":"      [Symbol(kTrailers)]: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailers)]: null,"}}
[info] >        [Symbol(kTrailersCount)]: 0 {"user":"      [Symbol(kTrailersCount)]: 0","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailersCount)]: 0"}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      data: { {"user":"    data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     data: {"}}
[info] >        userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"      userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >        chatId: 'chat-1731474752798-i86t0jvme', {"user":"      chatId: 'chat-1731474752798-i86t0jvme',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       chatId: 'chat-1731474752798-i86t0jvme',"}}
[info] >        messages: [Array], {"user":"      messages: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       messages: [Array],"}}
[info] >        timestamp: '2024-11-13T05:23:54.540Z' {"user":"      timestamp: '2024-11-13T05:23:54.540Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       timestamp: '2024-11-13T05:23:54.540Z'"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Extracted Data: { {"user":"🔍 Extracted Data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Extracted Data: {"}}
[info] >    userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN', {"user":"  userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'UQsdkgUmkfZuAT8HgeMGAb3WnFEN',"}}
[info] >    chatId: 'chat-1731474752798-i86t0jvme', {"user":"  chatId: 'chat-1731474752798-i86t0jvme',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731474752798-i86t0jvme',"}}
[info] >    messagesCount: 2 {"user":"  messagesCount: 2","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   messagesCount: 2"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T05:23:54.628Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-saveChatHistory" in 37.2943ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finished \"us-central1-saveChatHistory\" in 37.2943ms"}}
[debug] [2024-11-13T05:23:54.629Z] [worker-us-central1-saveChatHistory-997f5476-7042-4212-9776-1b85802491a8]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-997f5476-7042-4212-9776-1b85802491a8]: IDLE"}}
[debug] [2024-11-13T05:23:54.629Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T05:23:54.629Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T05:23:54.629Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T05:23:37.297Z"],"workRunningCount":1}
[info] >  ✅ Chat history saved/updated: chat-1731474752798-i86t0jvme { totalMessageCount: 10, newMessagesAdded: 2 } {"user":"✅ Chat history saved/updated: chat-1731474752798-i86t0jvme { totalMessageCount: 10, newMessagesAdded: 2 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Chat history saved/updated: chat-1731474752798-i86t0jvme { totalMessageCount: 10, newMessagesAdded: 2 }"}}
[info] >  ✅ Chat history save result: { {"user":"✅ Chat history save result: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Chat history save result: {"}}
[info] >    data: { success: true, message: 'Chat history saved', totalMessages: 10 } {"user":"  data: { success: true, message: 'Chat history saved', totalMessages: 10 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { success: true, message: 'Chat history saved', totalMessages: 10 }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T05:23:54.636Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 17337.6486ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 17337.6486ms"}}
[debug] [2024-11-13T05:23:54.637Z] [worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-1c0d7693-6241-42da-a347-6d4f3768234b]: IDLE"}}
[debug] [2024-11-13T05:23:54.637Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T05:23:54.637Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T05:23:54.637Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
