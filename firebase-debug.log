[debug] [2024-11-13T00:30:08.171Z] ----------------------------------------------------------------------
[debug] [2024-11-13T00:30:08.174Z] Command:       C:\Program Files\nodejs\node.exe C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\bin\firebase.js emulators:start
[debug] [2024-11-13T00:30:08.175Z] CLI Version:   13.24.2
[debug] [2024-11-13T00:30:08.175Z] Platform:      win32
[debug] [2024-11-13T00:30:08.175Z] Node Version:  v20.18.0
[debug] [2024-11-13T00:30:08.175Z] Time:          Wed Nov 13 2024 11:30:08 GMT+1100 (Australian Eastern Daylight Time)
[debug] [2024-11-13T00:30:08.175Z] ----------------------------------------------------------------------
[debug] 
[debug] [2024-11-13T00:30:08.310Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2024-11-13T00:30:08.310Z] > authorizing via signed-in user (lisakhun58@gmail.com)
[debug] [2024-11-13T00:30:08.433Z] java version "21.0.5" 2024-10-15 LTS

[debug] [2024-11-13T00:30:08.434Z] Java(TM) SE Runtime Environment (build 21.0.5+9-LTS-239)
Java HotSpot(TM) 64-Bit Server VM (build 21.0.5+9-LTS-239, mixed mode, sharing)

[debug] [2024-11-13T00:30:08.461Z] Parsed Java major version: 21
[info] i  emulators: Starting emulators: auth, functions, firestore, extensions {"metadata":{"emulator":{"name":"hub"},"message":"Starting emulators: auth, functions, firestore, extensions"}}
[debug] [2024-11-13T00:30:08.464Z] Checked if tokens are valid: true, expires at: 1731460685622
[debug] [2024-11-13T00:30:08.465Z] Checked if tokens are valid: true, expires at: 1731460685622
[debug] [2024-11-13T00:30:08.466Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc [none]
[debug] [2024-11-13T00:30:09.448Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc 200
[debug] [2024-11-13T00:30:09.449Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc {"projectId":"notalone-de4fc","projectNumber":"784029337452","displayName":"NotAlone","name":"projects/notalone-de4fc","resources":{"hostingSite":"notalone-de4fc"},"state":"ACTIVE","etag":"1_570ddbb0-4c2c-4e94-b3b3-0005c847d3e1"}
[debug] [2024-11-13T00:30:09.468Z] [logging] Logging Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-13T00:30:09.468Z] [auth] Authentication Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-13T00:30:09.468Z] [firestore] Firestore Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-13T00:30:09.468Z] [firestore.websocket] websocket server for firestore only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-13T00:30:09.468Z] assigned listening specs for emulators {"user":{"hub":[{"address":"127.0.0.1","family":"IPv4","port":4400},{"address":"::1","family":"IPv6","port":4400}],"ui":[{"address":"127.0.0.1","family":"IPv4","port":4000},{"address":"::1","family":"IPv6","port":4000}],"logging":[{"address":"127.0.0.1","family":"IPv4","port":4500}],"auth":[{"address":"127.0.0.1","family":"IPv4","port":9099}],"firestore":[{"address":"127.0.0.1","family":"IPv4","port":8080}],"firestore.websocket":[{"address":"127.0.0.1","family":"IPv4","port":9150}]},"metadata":{"message":"assigned listening specs for emulators"}}
[debug] [2024-11-13T00:30:09.476Z] [hub] writing locator at C:\Users\Rob\AppData\Local\Temp\hub-notalone-de4fc.json
[debug] [2024-11-13T00:30:09.485Z] [Extensions] Started Extensions emulator, this is a noop.
[debug] [2024-11-13T00:30:09.494Z] [functions] Functions Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-13T00:30:09.494Z] [eventarc] Eventarc Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-13T00:30:09.494Z] [tasks] Cloud Tasks Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-13T00:30:09.494Z] late-assigned ports for functions and eventarc emulators {"user":{"hub":[{"address":"127.0.0.1","family":"IPv4","port":4400},{"address":"::1","family":"IPv6","port":4400}],"ui":[{"address":"127.0.0.1","family":"IPv4","port":4000},{"address":"::1","family":"IPv6","port":4000}],"logging":[{"address":"127.0.0.1","family":"IPv4","port":4500}],"auth":[{"address":"127.0.0.1","family":"IPv4","port":9099}],"firestore":[{"address":"127.0.0.1","family":"IPv4","port":8080}],"firestore.websocket":[{"address":"127.0.0.1","family":"IPv4","port":9150}],"functions":[{"address":"127.0.0.1","family":"IPv4","port":5001}],"eventarc":[{"address":"127.0.0.1","family":"IPv4","port":9299}],"tasks":[{"address":"127.0.0.1","family":"IPv4","port":9499}]},"metadata":{"message":"late-assigned ports for functions and eventarc emulators"}}
[warn] !  functions: The following emulators are not running, calls to these services from the Functions emulator will affect production: database, hosting, pubsub, storage, dataconnect {"metadata":{"emulator":{"name":"functions"},"message":"The following emulators are not running, calls to these services from the Functions emulator will affect production: \u001b[1mdatabase, hosting, pubsub, storage, dataconnect\u001b[22m"}}
[debug] [2024-11-13T00:30:09.499Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T00:30:09.501Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[debug] [2024-11-13T00:30:09.501Z] Checked if tokens are valid: true, expires at: 1731460685622
[debug] [2024-11-13T00:30:09.501Z] Checked if tokens are valid: true, expires at: 1731460685622
[debug] [2024-11-13T00:30:09.502Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc/adminSdkConfig [none]
[debug] [2024-11-13T00:30:10.188Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc/adminSdkConfig 200
[debug] [2024-11-13T00:30:10.188Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc/adminSdkConfig {"projectId":"notalone-de4fc","storageBucket":"notalone-de4fc.firebasestorage.app"}
[debug] [2024-11-13T00:30:10.207Z] Ignoring unsupported arg: auto_download {"metadata":{"emulator":{"name":"firestore"},"message":"Ignoring unsupported arg: auto_download"}}
[debug] [2024-11-13T00:30:10.207Z] Ignoring unsupported arg: single_project_mode_error {"metadata":{"emulator":{"name":"firestore"},"message":"Ignoring unsupported arg: single_project_mode_error"}}
[debug] [2024-11-13T00:30:10.207Z] Starting Firestore Emulator with command {"binary":"java","args":["-Dgoogle.cloud_firestore.debug_log_level=FINE","-Duser.language=en","-jar","C:\\Users\\Rob\\.cache\\firebase\\emulators\\cloud-firestore-emulator-v1.19.8.jar","--host","127.0.0.1","--port",8080,"--websocket_port",9150,"--project_id","notalone-de4fc","--rules","C:\\Users\\Rob\\Apps\\not-alone\\firestore.rules","--single_project_mode",true,"--functions_emulator","127.0.0.1:5001"],"optionalArgs":["port","webchannel_port","host","rules","websocket_port","functions_emulator","seed_from_export","project_id","single_project_mode"],"joinArgs":false,"shell":false,"port":8080} {"metadata":{"emulator":{"name":"firestore"},"message":"Starting Firestore Emulator with command {\"binary\":\"java\",\"args\":[\"-Dgoogle.cloud_firestore.debug_log_level=FINE\",\"-Duser.language=en\",\"-jar\",\"C:\\\\Users\\\\Rob\\\\.cache\\\\firebase\\\\emulators\\\\cloud-firestore-emulator-v1.19.8.jar\",\"--host\",\"127.0.0.1\",\"--port\",8080,\"--websocket_port\",9150,\"--project_id\",\"notalone-de4fc\",\"--rules\",\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\firestore.rules\",\"--single_project_mode\",true,\"--functions_emulator\",\"127.0.0.1:5001\"],\"optionalArgs\":[\"port\",\"webchannel_port\",\"host\",\"rules\",\"websocket_port\",\"functions_emulator\",\"seed_from_export\",\"project_id\",\"single_project_mode\"],\"joinArgs\":false,\"shell\":false,\"port\":8080}"}}
[info] i  firestore: Firestore Emulator logging to firestore-debug.log {"metadata":{"emulator":{"name":"firestore"},"message":"Firestore Emulator logging to \u001b[1mfirestore-debug.log\u001b[22m"}}
[info] +  firestore: Firestore Emulator UI websocket is running on 9150. {"metadata":{"emulator":{"name":"firestore"},"message":"Firestore Emulator UI websocket is running on 9150."}}
[debug] [2024-11-13T00:30:19.338Z] Ignoring unsupported arg: auto_download {"metadata":{"emulator":{"name":"ui"},"message":"Ignoring unsupported arg: auto_download"}}
[debug] [2024-11-13T00:30:19.338Z] Ignoring unsupported arg: port {"metadata":{"emulator":{"name":"ui"},"message":"Ignoring unsupported arg: port"}}
[debug] [2024-11-13T00:30:19.338Z] Starting Emulator UI with command {"binary":"node","args":["C:\\Users\\Rob\\.cache\\firebase\\emulators\\ui-v1.14.0\\server\\server.mjs"],"optionalArgs":[],"joinArgs":false,"shell":false,"port":4000} {"metadata":{"emulator":{"name":"ui"},"message":"Starting Emulator UI with command {\"binary\":\"node\",\"args\":[\"C:\\\\Users\\\\Rob\\\\.cache\\\\firebase\\\\emulators\\\\ui-v1.14.0\\\\server\\\\server.mjs\"],\"optionalArgs\":[],\"joinArgs\":false,\"shell\":false,\"port\":4000}"}}
[info] i  ui: Emulator UI logging to ui-debug.log {"metadata":{"emulator":{"name":"ui"},"message":"Emulator UI logging to \u001b[1mui-debug.log\u001b[22m"}}
[debug] [2024-11-13T00:30:19.493Z] Web / API server started at 127.0.0.1:4000
 {"metadata":{"emulator":{"name":"ui"},"message":"Web / API server started at 127.0.0.1:4000\n"}}
[debug] [2024-11-13T00:30:19.494Z] Web / API server started at ::1:4000
 {"metadata":{"emulator":{"name":"ui"},"message":"Web / API server started at ::1:4000\n"}}
[debug] [2024-11-13T00:30:19.556Z] [Extensions] Connecting Extensions emulator, this is a noop.
[info] i  functions: Watching "C:\Users\Rob\Apps\not-alone\functions" for Cloud Functions... {"metadata":{"emulator":{"name":"functions"},"message":"Watching \"C:\\Users\\Rob\\Apps\\not-alone\\functions\" for Cloud Functions..."}}
[debug] [2024-11-13T00:30:19.563Z] Validating nodejs source
[debug] [2024-11-13T00:30:20.541Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T00:30:20.541Z] Building nodejs source
[debug] [2024-11-13T00:30:20.542Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T00:30:20.544Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T00:30:20.555Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8169

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T00:30:21.263Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T00:30:25.295Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T00:30:25.296Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[info] +  functions[us-central1-processChat]: http function initialized (http://127.0.0.1:5001/notalone-de4fc/us-central1/processChat). {"metadata":{"emulator":{"name":"functions"},"message":"\u001b[1mhttp\u001b[22m function initialized (http://127.0.0.1:5001/notalone-de4fc/us-central1/processChat)."}}
[debug] [2024-11-13T00:30:25.303Z] Could not find VSCode notification endpoint: FetchError: request to http://localhost:40001/vscode/notify failed, reason: . If you are not running the Firebase Data Connect VSCode extension, this is expected and not an issue.
[info] 
┌─────────────────────────────────────────────────────────────┐
│ ✔  All emulators ready! It is now safe to connect your app. │
│ i  View Emulator UI at http://127.0.0.1:4000/               │
└─────────────────────────────────────────────────────────────┘

┌────────────────┬────────────────┬──────────────────────────────────┐
│ Emulator       │ Host:Port      │ View in Emulator UI              │
├────────────────┼────────────────┼──────────────────────────────────┤
│ Authentication │ 127.0.0.1:9099 │ http://127.0.0.1:4000/auth       │
├────────────────┼────────────────┼──────────────────────────────────┤
│ Functions      │ 127.0.0.1:5001 │ http://127.0.0.1:4000/functions  │
├────────────────┼────────────────┼──────────────────────────────────┤
│ Firestore      │ 127.0.0.1:8080 │ http://127.0.0.1:4000/firestore  │
├────────────────┼────────────────┼──────────────────────────────────┤
│ Extensions     │ 127.0.0.1:5001 │ http://127.0.0.1:4000/extensions │
└────────────────┴────────────────┴──────────────────────────────────┘
  Emulator Hub running at 127.0.0.1:4400
  Other reserved ports: 4500, 9150
┌─────────────────────────┬───────────────┬─────────────────────┐
│ Extension Instance Name │ Extension Ref │ View in Emulator UI │
└─────────────────────────┴───────────────┴─────────────────────┘
Issues? Report them at https://github.com/firebase/firebase-tools/issues and attach the *-debug.log files.
 
[debug] [2024-11-13T00:30:57.335Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:30:57.335Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T00:30:57.335Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:30:57.335Z"],"workRunningCount":1}
[debug] [2024-11-13T00:30:57.336Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T00:30:57.338Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T00:30:57.338Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T00:30:57.351Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-13T00:30:57.352Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-13T00:30:58.817Z] [runtime-status] [26064] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26064] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T00:30:58.818Z] [runtime-status] [26064] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26064] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T00:30:58.819Z] [runtime-status] [26064] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26064] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T00:30:58.819Z] [runtime-status] [26064] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26064] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T00:30:58.821Z] [runtime-status] [26064] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26064] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T00:30:59.153Z] [runtime-status] [26064] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26064] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T00:30:59.153Z] [runtime-status] [26064] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26064] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T00:30:59.154Z] [runtime-status] [26064] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26064] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T00:30:59.159Z] [runtime-status] [26064] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26064] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T00:30:59.161Z] [runtime-status] [26064] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26064] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T00:30:59.162Z] [runtime-status] [26064] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26064] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2024-11-13T00:30:59.261Z] [runtime-status] [26064] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26064] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T00:30:59.271Z] [runtime-status] [26064] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26064] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T00:30:59.272Z] [runtime-status] [26064] Listening to port: \\?\pipe\fire_emu_6df1bb2b03f73aaf {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26064] Listening to port: \\\\?\\pipe\\fire_emu_6df1bb2b03f73aaf"}}
[debug] [2024-11-13T00:30:59.320Z] [worker-us-central1-processChat-4c499c79-c3eb-4a8d-8be9-5824c48c38a6]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4c499c79-c3eb-4a8d-8be9-5824c48c38a6]: IDLE"}}
[debug] [2024-11-13T00:30:59.321Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T00:30:59.322Z] [worker-us-central1-processChat-4c499c79-c3eb-4a8d-8be9-5824c48c38a6]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4c499c79-c3eb-4a8d-8be9-5824c48c38a6]: BUSY"}}
[debug] [2024-11-13T00:30:59.326Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4.6122ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4.6122ms"}}
[debug] [2024-11-13T00:30:59.327Z] [worker-us-central1-processChat-4c499c79-c3eb-4a8d-8be9-5824c48c38a6]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4c499c79-c3eb-4a8d-8be9-5824c48c38a6]: IDLE"}}
[debug] [2024-11-13T00:30:59.328Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T00:30:59.328Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T00:30:59.328Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T00:30:59.329Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:30:59.329Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T00:30:59.329Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:30:59.329Z"],"workRunningCount":1}
[debug] [2024-11-13T00:30:59.329Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T00:30:59.330Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T00:30:59.330Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T00:30:59.330Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T00:30:59.331Z] [worker-us-central1-processChat-4c499c79-c3eb-4a8d-8be9-5824c48c38a6]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4c499c79-c3eb-4a8d-8be9-5824c48c38a6]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi' } } {"user":"🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi' } }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi' } }"}}
[info] >  📝 Using chat ID: undefined {"user":"📝 Using chat ID: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: undefined"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 2, {"user":"  messageLength: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 2,"}}
[info] >    userId: 'AYPwKTp9F44hLMkwXJG7xDPvaBhy', {"user":"  userId: 'AYPwKTp9F44hLMkwXJG7xDPvaBhy',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'AYPwKTp9F44hLMkwXJG7xDPvaBhy',"}}
[info] >    chatId: undefined {"user":"  chatId: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: undefined"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: chat-1731457859350-7lca6r1vz {"user":"🆕 Creating new chat session: chat-1731457859350-7lca6r1vz","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: chat-1731457859350-7lca6r1vz"}}
[info] >  📝 Chat session created: { chatId: 'chat-1731457859350-7lca6r1vz', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'chat-1731457859350-7lca6r1vz', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'chat-1731457859350-7lca6r1vz', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hi {"user":"💬 Sending message to Gemini: hi","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hi"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  📚 Current Chat History: { {"user":"📚 Current Chat History: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📚 Current Chat History: {"}}
[info] >    chatId: 'chat-1731457859350-7lca6r1vz', {"user":"  chatId: 'chat-1731457859350-7lca6r1vz',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731457859350-7lca6r1vz',"}}
[info] >    historyLength: 6, {"user":"  historyLength: 6,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   historyLength: 6,"}}
[info] >    lastMessages: [ {"user":"  lastMessages: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   lastMessages: ["}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'assistant', parts: [Array] }, {"user":"    { role: 'assistant', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'assistant', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] } {"user":"    { role: 'model', parts: [Array] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Response received: { responseLength: 172, timestamp: '2024-11-13T00:31:01.728Z' } {"user":"✅ Response received: { responseLength: 172, timestamp: '2024-11-13T00:31:01.728Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 172, timestamp: '2024-11-13T00:31:01.728Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: 'Hi there!  How can I help you today?  Are you looking for advice on a specific relationship, or are you interested in learning more about relationship dynamics in general?\n', {"user":"  message: 'Hi there!  How can I help you today?  Are you looking for advice on a specific relationship, or are you interested in learning more about relationship dynamics in general?\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Hi there!  How can I help you today?  Are you looking for advice on a specific relationship, or are you interested in learning more about relationship dynamics in general?\\n',"}}
[info] >    userMessage: 'hi', {"user":"  userMessage: 'hi',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hi',"}}
[info] >    timestamp: '2024-11-13T00:31:01.728Z', {"user":"  timestamp: '2024-11-13T00:31:01.728Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T00:31:01.728Z',"}}
[info] >    userId: 'AYPwKTp9F44hLMkwXJG7xDPvaBhy', {"user":"  userId: 'AYPwKTp9F44hLMkwXJG7xDPvaBhy',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'AYPwKTp9F44hLMkwXJG7xDPvaBhy',"}}
[info] >    chatId: 'chat-1731457859350-7lca6r1vz' {"user":"  chatId: 'chat-1731457859350-7lca6r1vz'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731457859350-7lca6r1vz'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ❌ Failed to save chat history: [FunctionsError [FirebaseError]: not-found] { {"user":"❌ Failed to save chat history: [FunctionsError [FirebaseError]: not-found] {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ Failed to save chat history: [FunctionsError [FirebaseError]: not-found] {"}}
[info] >    code: 'functions/not-found', {"user":"  code: 'functions/not-found',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   code: 'functions/not-found',"}}
[info] >    customData: undefined, {"user":"  customData: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   customData: undefined,"}}
[info] >    details: undefined {"user":"  details: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   details: undefined"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T00:31:02.148Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2817.6928ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2817.6928ms"}}
[debug] [2024-11-13T00:31:02.150Z] [worker-us-central1-processChat-4c499c79-c3eb-4a8d-8be9-5824c48c38a6]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4c499c79-c3eb-4a8d-8be9-5824c48c38a6]: IDLE"}}
[debug] [2024-11-13T00:31:02.150Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T00:31:02.150Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T00:31:02.150Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T00:32:16.749Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T00:32:17.762Z] Validating nodejs source
[debug] [2024-11-13T00:32:18.763Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T00:32:18.764Z] Building nodejs source
[debug] [2024-11-13T00:32:18.764Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T00:32:18.766Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T00:32:18.779Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8522

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T00:32:19.442Z] Got response from /__/functions.yaml {"endpoints":{"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T00:32:23.479Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T00:32:23.480Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: processChat."}}
[debug] [2024-11-13T00:32:23.482Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-13T00:32:23.482Z] [worker-us-central1-processChat-4c499c79-c3eb-4a8d-8be9-5824c48c38a6]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4c499c79-c3eb-4a8d-8be9-5824c48c38a6]: FINISHING"}}
[debug] [2024-11-13T00:32:23.494Z] [worker-us-central1-processChat-4c499c79-c3eb-4a8d-8be9-5824c48c38a6]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4c499c79-c3eb-4a8d-8be9-5824c48c38a6]: exited"}}
[debug] [2024-11-13T00:32:23.495Z] [worker-us-central1-processChat-4c499c79-c3eb-4a8d-8be9-5824c48c38a6]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4c499c79-c3eb-4a8d-8be9-5824c48c38a6]: FINISHED"}}
[debug] [2024-11-13T00:32:27.092Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js.map changed, reloading triggers"}}
[debug] [2024-11-13T00:32:27.094Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js changed, reloading triggers"}}
[debug] [2024-11-13T00:32:27.114Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-13T00:32:27.115Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-13T00:32:28.118Z] Validating nodejs source
[debug] [2024-11-13T00:32:29.042Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T00:32:29.042Z] Building nodejs source
[debug] [2024-11-13T00:32:29.042Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T00:32:29.043Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T00:32:29.052Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8379

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T00:32:29.743Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T00:32:33.776Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T00:32:33.777Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[info] +  functions[us-central1-saveChatHistory]: http function initialized (http://127.0.0.1:5001/notalone-de4fc/us-central1/saveChatHistory). {"metadata":{"emulator":{"name":"functions"},"message":"\u001b[1mhttp\u001b[22m function initialized (http://127.0.0.1:5001/notalone-de4fc/us-central1/saveChatHistory)."}}
[debug] [2024-11-13T00:32:39.937Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:32:39.937Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T00:32:39.937Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:32:39.937Z"],"workRunningCount":1}
[debug] [2024-11-13T00:32:39.937Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T00:32:39.940Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T00:32:39.940Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T00:32:39.940Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-13T00:32:39.951Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-13T00:32:39.952Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-13T00:32:41.728Z] [runtime-status] [26136] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26136] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T00:32:41.730Z] [runtime-status] [26136] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26136] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T00:32:41.730Z] [runtime-status] [26136] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26136] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T00:32:41.730Z] [runtime-status] [26136] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26136] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T00:32:41.732Z] [runtime-status] [26136] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26136] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T00:32:42.109Z] [runtime-status] [26136] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26136] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T00:32:42.109Z] [runtime-status] [26136] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26136] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T00:32:42.110Z] [runtime-status] [26136] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26136] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T00:32:42.115Z] [runtime-status] [26136] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26136] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T00:32:42.118Z] [runtime-status] [26136] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26136] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T00:32:42.118Z] [runtime-status] [26136] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26136] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2024-11-13T00:32:42.225Z] [runtime-status] [26136] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26136] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T00:32:42.236Z] [runtime-status] [26136] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26136] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T00:32:42.237Z] [runtime-status] [26136] Listening to port: \\?\pipe\fire_emu_2424ffa8897f406d {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26136] Listening to port: \\\\?\\pipe\\fire_emu_2424ffa8897f406d"}}
[debug] [2024-11-13T00:32:42.271Z] [worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: IDLE"}}
[debug] [2024-11-13T00:32:42.271Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T00:32:42.272Z] [worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: BUSY"}}
[debug] [2024-11-13T00:32:42.276Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4.3915ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4.3915ms"}}
[debug] [2024-11-13T00:32:42.277Z] [worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: IDLE"}}
[debug] [2024-11-13T00:32:42.277Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T00:32:42.278Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T00:32:42.278Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T00:32:42.279Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:32:42.279Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T00:32:42.279Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:32:42.279Z"],"workRunningCount":1}
[debug] [2024-11-13T00:32:42.279Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T00:32:42.280Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T00:32:42.281Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T00:32:42.281Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T00:32:42.281Z] [worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'hi', chatId: 'chat-1731457859350-7lca6r1vz' } {"user":"  data: { message: 'hi', chatId: 'chat-1731457859350-7lca6r1vz' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'hi', chatId: 'chat-1731457859350-7lca6r1vz' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📝 Using chat ID: chat-1731457859350-7lca6r1vz {"user":"📝 Using chat ID: chat-1731457859350-7lca6r1vz","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: chat-1731457859350-7lca6r1vz"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 2, {"user":"  messageLength: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 2,"}}
[info] >    userId: 'AYPwKTp9F44hLMkwXJG7xDPvaBhy', {"user":"  userId: 'AYPwKTp9F44hLMkwXJG7xDPvaBhy',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'AYPwKTp9F44hLMkwXJG7xDPvaBhy',"}}
[info] >    chatId: 'chat-1731457859350-7lca6r1vz' {"user":"  chatId: 'chat-1731457859350-7lca6r1vz'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731457859350-7lca6r1vz'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: chat-1731457859350-7lca6r1vz {"user":"🆕 Creating new chat session: chat-1731457859350-7lca6r1vz","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: chat-1731457859350-7lca6r1vz"}}
[info] >  📝 Chat session created: { chatId: 'chat-1731457859350-7lca6r1vz', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'chat-1731457859350-7lca6r1vz', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'chat-1731457859350-7lca6r1vz', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hi {"user":"💬 Sending message to Gemini: hi","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hi"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  📚 Current Chat History: { {"user":"📚 Current Chat History: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📚 Current Chat History: {"}}
[info] >    chatId: 'chat-1731457859350-7lca6r1vz', {"user":"  chatId: 'chat-1731457859350-7lca6r1vz',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731457859350-7lca6r1vz',"}}
[info] >    historyLength: 6, {"user":"  historyLength: 6,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   historyLength: 6,"}}
[info] >    lastMessages: [ {"user":"  lastMessages: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   lastMessages: ["}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'assistant', parts: [Array] }, {"user":"    { role: 'assistant', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'assistant', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] } {"user":"    { role: 'model', parts: [Array] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Response received: { responseLength: 161, timestamp: '2024-11-13T00:32:44.416Z' } {"user":"✅ Response received: { responseLength: 161, timestamp: '2024-11-13T00:32:44.416Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 161, timestamp: '2024-11-13T00:32:44.416Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: 'Hi there! How can I help you today?  Are you looking for advice on a specific relationship issue, or would you like to explore relationship dynamics in general?\n', {"user":"  message: 'Hi there! How can I help you today?  Are you looking for advice on a specific relationship issue, or would you like to explore relationship dynamics in general?\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Hi there! How can I help you today?  Are you looking for advice on a specific relationship issue, or would you like to explore relationship dynamics in general?\\n',"}}
[info] >    userMessage: 'hi', {"user":"  userMessage: 'hi',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hi',"}}
[info] >    timestamp: '2024-11-13T00:32:44.417Z', {"user":"  timestamp: '2024-11-13T00:32:44.417Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T00:32:44.417Z',"}}
[info] >    userId: 'AYPwKTp9F44hLMkwXJG7xDPvaBhy', {"user":"  userId: 'AYPwKTp9F44hLMkwXJG7xDPvaBhy',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'AYPwKTp9F44hLMkwXJG7xDPvaBhy',"}}
[info] >    chatId: 'chat-1731457859350-7lca6r1vz' {"user":"  chatId: 'chat-1731457859350-7lca6r1vz'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731457859350-7lca6r1vz'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ❌ Failed to save chat history: [FunctionsError [FirebaseError]: not-found] { {"user":"❌ Failed to save chat history: [FunctionsError [FirebaseError]: not-found] {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ Failed to save chat history: [FunctionsError [FirebaseError]: not-found] {"}}
[info] >    code: 'functions/not-found', {"user":"  code: 'functions/not-found',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   code: 'functions/not-found',"}}
[info] >    customData: undefined, {"user":"  customData: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   customData: undefined,"}}
[info] >    details: undefined {"user":"  details: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   details: undefined"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T00:32:44.834Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2552.233ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2552.233ms"}}
[debug] [2024-11-13T00:32:44.834Z] [worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: IDLE"}}
[debug] [2024-11-13T00:32:44.834Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T00:32:44.834Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T00:32:44.834Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T00:33:49.138Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:33:49.138Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T00:33:49.138Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:33:49.138Z"],"workRunningCount":1}
[debug] [2024-11-13T00:33:49.139Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T00:33:49.141Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T00:33:49.141Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T00:33:49.141Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T00:33:49.142Z] [worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: BUSY"}}
[debug] [2024-11-13T00:33:49.145Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 3.0549ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 3.0549ms"}}
[debug] [2024-11-13T00:33:49.146Z] [worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: IDLE"}}
[debug] [2024-11-13T00:33:49.146Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T00:33:49.146Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T00:33:49.146Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T00:33:49.147Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:33:49.147Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T00:33:49.147Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:33:49.147Z"],"workRunningCount":1}
[debug] [2024-11-13T00:33:49.147Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T00:33:49.149Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T00:33:49.150Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T00:33:49.150Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T00:33:49.150Z] [worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'why u no save', chatId: 'chat-1731457859350-7lca6r1vz' } {"user":"  data: { message: 'why u no save', chatId: 'chat-1731457859350-7lca6r1vz' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'why u no save', chatId: 'chat-1731457859350-7lca6r1vz' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📝 Using chat ID: chat-1731457859350-7lca6r1vz {"user":"📝 Using chat ID: chat-1731457859350-7lca6r1vz","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: chat-1731457859350-7lca6r1vz"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 13, {"user":"  messageLength: 13,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 13,"}}
[info] >    userId: 'AYPwKTp9F44hLMkwXJG7xDPvaBhy', {"user":"  userId: 'AYPwKTp9F44hLMkwXJG7xDPvaBhy',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'AYPwKTp9F44hLMkwXJG7xDPvaBhy',"}}
[info] >    chatId: 'chat-1731457859350-7lca6r1vz' {"user":"  chatId: 'chat-1731457859350-7lca6r1vz'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731457859350-7lca6r1vz'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: why u no save {"user":"💬 Sending message to Gemini: why u no save","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: why u no save"}}
[info] >  📚 Current Chat History: { {"user":"📚 Current Chat History: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📚 Current Chat History: {"}}
[info] >    chatId: 'chat-1731457859350-7lca6r1vz', {"user":"  chatId: 'chat-1731457859350-7lca6r1vz',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731457859350-7lca6r1vz',"}}
[info] >    historyLength: 8, {"user":"  historyLength: 8,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   historyLength: 8,"}}
[info] >    lastMessages: [ {"user":"  lastMessages: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   lastMessages: ["}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] }, {"user":"    { role: 'model', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] } {"user":"    { role: 'model', parts: [Array] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Response received: { responseLength: 343, timestamp: '2024-11-13T00:33:51.557Z' } {"user":"✅ Response received: { responseLength: 343, timestamp: '2024-11-13T00:33:51.557Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 343, timestamp: '2024-11-13T00:33:51.557Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: "As a large language model, I don't have memory of past conversations. Each interaction with me starts fresh.  Think of it like a new email – I don't retain information from previous emails unless you specifically provide it within the current conversation.  Is there something specific you'd like to discuss or a problem you'd like help with?\n", {"user":"  message: \"As a large language model, I don't have memory of past conversations. Each interaction with me starts fresh.  Think of it like a new email – I don't retain information from previous emails unless you specifically provide it within the current conversation.  Is there something specific you'd like to discuss or a problem you'd like help with?\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: \"As a large language model, I don't have memory of past conversations. Each interaction with me starts fresh.  Think of it like a new email – I don't retain information from previous emails unless you specifically provide it within the current conversation.  Is there something specific you'd like to discuss or a problem you'd like help with?\\n\","}}
[info] >    userMessage: 'why u no save', {"user":"  userMessage: 'why u no save',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'why u no save',"}}
[info] >    timestamp: '2024-11-13T00:33:51.557Z', {"user":"  timestamp: '2024-11-13T00:33:51.557Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T00:33:51.557Z',"}}
[info] >    userId: 'AYPwKTp9F44hLMkwXJG7xDPvaBhy', {"user":"  userId: 'AYPwKTp9F44hLMkwXJG7xDPvaBhy',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'AYPwKTp9F44hLMkwXJG7xDPvaBhy',"}}
[info] >    chatId: 'chat-1731457859350-7lca6r1vz' {"user":"  chatId: 'chat-1731457859350-7lca6r1vz'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731457859350-7lca6r1vz'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ❌ Failed to save chat history: [FunctionsError [FirebaseError]: not-found] { {"user":"❌ Failed to save chat history: [FunctionsError [FirebaseError]: not-found] {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ Failed to save chat history: [FunctionsError [FirebaseError]: not-found] {"}}
[info] >    code: 'functions/not-found', {"user":"  code: 'functions/not-found',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   code: 'functions/not-found',"}}
[info] >    customData: undefined, {"user":"  customData: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   customData: undefined,"}}
[info] >    details: undefined {"user":"  details: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   details: undefined"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T00:33:52.011Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2861.1522ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2861.1522ms"}}
[debug] [2024-11-13T00:33:52.013Z] [worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: IDLE"}}
[debug] [2024-11-13T00:33:52.013Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T00:33:52.013Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T00:33:52.013Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T00:35:35.599Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T00:35:35.600Z] File C:\Users\Rob\Apps\not-alone\functions\src\chatHistory.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\chatHistory.ts changed, reloading triggers"}}
[debug] [2024-11-13T00:35:36.610Z] Validating nodejs source
[debug] [2024-11-13T00:35:37.671Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T00:35:37.672Z] Building nodejs source
[debug] [2024-11-13T00:35:37.672Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T00:35:37.673Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T00:35:37.682Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8339

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T00:35:38.351Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T00:35:42.384Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T00:35:42.385Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T00:35:42.386Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-13T00:35:42.386Z] [worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: FINISHING"}}
[debug] [2024-11-13T00:35:42.399Z] [worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: exited"}}
[debug] [2024-11-13T00:35:42.399Z] [worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-9e5166bc-c25d-45bf-8c44-9cbfe97ee355]: FINISHED"}}
[debug] [2024-11-13T00:36:33.162Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T00:36:34.174Z] Validating nodejs source
[debug] [2024-11-13T00:36:35.180Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T00:36:35.180Z] Building nodejs source
[debug] [2024-11-13T00:36:35.180Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T00:36:35.182Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T00:36:35.191Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8279

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T00:36:35.832Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T00:36:39.853Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T00:36:39.854Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T00:38:31.101Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T00:38:32.104Z] Validating nodejs source
[debug] [2024-11-13T00:38:33.739Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T00:38:33.739Z] Building nodejs source
[debug] [2024-11-13T00:38:33.739Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T00:38:33.741Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T00:38:33.748Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8765

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T00:38:34.395Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T00:38:38.427Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T00:38:38.428Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T00:41:04.866Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js.map changed, reloading triggers"}}
[debug] [2024-11-13T00:41:04.869Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js changed, reloading triggers"}}
[debug] [2024-11-13T00:41:04.889Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-13T00:41:04.891Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-13T00:41:05.906Z] Validating nodejs source
[debug] [2024-11-13T00:41:06.876Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T00:41:06.876Z] Building nodejs source
[debug] [2024-11-13T00:41:06.876Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T00:41:06.877Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T00:41:06.885Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8304

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T00:41:07.550Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T00:41:11.586Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T00:41:11.588Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T00:41:25.811Z] >>> [apiv2][query] POST http://127.0.0.1:5001/functions/projects/notalone-de4fc/trigger_multicast [none]
[debug] [2024-11-13T00:41:25.811Z] >>> [apiv2][body] POST http://127.0.0.1:5001/functions/projects/notalone-de4fc/trigger_multicast {"eventId":"adadd91d-c933-4862-bf87-ad146e28a74b","eventType":"providers/firebase.auth/eventTypes/user.create","resource":{"name":"projects/notalone-de4fc","service":"firebaseauth.googleapis.com"},"params":{},"timestamp":"2024-11-13T00:41:25.810Z","data":{"uid":"xDxECJtJiNdgFeQ9L95cAi5LBwzM","email":"mountain.algae.277@example.com","emailVerified":true,"displayName":"Mountain Algae","metadata":{"creationTime":"2024-11-13T00:41:25.809Z","lastSignInTime":"2024-11-13T00:41:25.809Z"},"customClaims":{},"providerData":[{"providerId":"google.com","rawId":"3233290813696225126940450806299556869390","federatedId":"3233290813696225126940450806299556869390","displayName":"Mountain Algae","email":"mountain.algae.277@example.com","screenName":"algae_mountain"}]}}
[debug] [2024-11-13T00:41:25.820Z] <<< [apiv2][status] POST http://127.0.0.1:5001/functions/projects/notalone-de4fc/trigger_multicast 200
[debug] [2024-11-13T00:41:25.820Z] <<< [apiv2][body] POST http://127.0.0.1:5001/functions/projects/notalone-de4fc/trigger_multicast {"status":"multicast_acknowledged"}
[debug] [2024-11-13T00:41:28.007Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:41:28.007Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T00:41:28.007Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:41:28.007Z"],"workRunningCount":1}
[debug] [2024-11-13T00:41:28.007Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T00:41:28.011Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T00:41:28.012Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T00:41:28.012Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-13T00:41:28.023Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-13T00:41:28.023Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-13T00:41:29.690Z] [runtime-status] [26436] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26436] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T00:41:29.693Z] [runtime-status] [26436] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26436] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T00:41:29.693Z] [runtime-status] [26436] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26436] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T00:41:29.694Z] [runtime-status] [26436] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26436] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T00:41:29.695Z] [runtime-status] [26436] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26436] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T00:41:30.040Z] [runtime-status] [26436] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26436] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T00:41:30.040Z] [runtime-status] [26436] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26436] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T00:41:30.041Z] [runtime-status] [26436] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26436] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T00:41:30.046Z] [runtime-status] [26436] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26436] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T00:41:30.050Z] [runtime-status] [26436] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26436] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T00:41:30.050Z] [runtime-status] [26436] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26436] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T00:41:30.184Z] [runtime-status] [26436] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26436] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T00:41:30.200Z] [runtime-status] [26436] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26436] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T00:41:30.201Z] [runtime-status] [26436] Listening to port: \\?\pipe\fire_emu_a73fa92c13d67eb2 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [26436] Listening to port: \\\\?\\pipe\\fire_emu_a73fa92c13d67eb2"}}
[debug] [2024-11-13T00:41:30.227Z] [worker-us-central1-processChat-9b2284fa-c181-4a41-9f28-43f2216f5ee8]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-9b2284fa-c181-4a41-9f28-43f2216f5ee8]: IDLE"}}
[debug] [2024-11-13T00:41:30.227Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T00:41:30.228Z] [worker-us-central1-processChat-9b2284fa-c181-4a41-9f28-43f2216f5ee8]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-9b2284fa-c181-4a41-9f28-43f2216f5ee8]: BUSY"}}
[debug] [2024-11-13T00:41:30.251Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 23.1701ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 23.1701ms"}}
[debug] [2024-11-13T00:41:30.252Z] [worker-us-central1-processChat-9b2284fa-c181-4a41-9f28-43f2216f5ee8]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-9b2284fa-c181-4a41-9f28-43f2216f5ee8]: IDLE"}}
[debug] [2024-11-13T00:41:30.253Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T00:41:30.253Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T00:41:30.253Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T00:41:30.253Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:41:30.253Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T00:41:30.254Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:41:30.253Z"],"workRunningCount":1}
[debug] [2024-11-13T00:41:30.254Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T00:41:30.255Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T00:41:30.255Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T00:41:30.255Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T00:41:30.256Z] [worker-us-central1-processChat-9b2284fa-c181-4a41-9f28-43f2216f5ee8]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-9b2284fa-c181-4a41-9f28-43f2216f5ee8]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { auth: 'Authenticated', data: { message: 'bonjour' } } {"user":"🚀 Incoming request: { auth: 'Authenticated', data: { message: 'bonjour' } }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: { auth: 'Authenticated', data: { message: 'bonjour' } }"}}
[info] >  📝 Using chat ID: undefined {"user":"📝 Using chat ID: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: undefined"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 7, {"user":"  messageLength: 7,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 7,"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: undefined {"user":"  chatId: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: undefined"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: chat-1731458490284-vaehrjmol {"user":"🆕 Creating new chat session: chat-1731458490284-vaehrjmol","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: chat-1731458490284-vaehrjmol"}}
[info] >  📝 Chat session created: { chatId: 'chat-1731458490284-vaehrjmol', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'chat-1731458490284-vaehrjmol', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'chat-1731458490284-vaehrjmol', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: bonjour {"user":"💬 Sending message to Gemini: bonjour","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: bonjour"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  📚 Current Chat History: { {"user":"📚 Current Chat History: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📚 Current Chat History: {"}}
[info] >    chatId: 'chat-1731458490284-vaehrjmol', {"user":"  chatId: 'chat-1731458490284-vaehrjmol',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731458490284-vaehrjmol',"}}
[info] >    historyLength: 6, {"user":"  historyLength: 6,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   historyLength: 6,"}}
[info] >    lastMessages: [ {"user":"  lastMessages: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   lastMessages: ["}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'assistant', parts: [Array] }, {"user":"    { role: 'assistant', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'assistant', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] } {"user":"    { role: 'model', parts: [Array] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Response received: { responseLength: 36, timestamp: '2024-11-13T00:41:32.151Z' } {"user":"✅ Response received: { responseLength: 36, timestamp: '2024-11-13T00:41:32.151Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 36, timestamp: '2024-11-13T00:41:32.151Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: 'Bonjour!  How can I help you today?\n', {"user":"  message: 'Bonjour!  How can I help you today?\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Bonjour!  How can I help you today?\\n',"}}
[info] >    userMessage: 'bonjour', {"user":"  userMessage: 'bonjour',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'bonjour',"}}
[info] >    timestamp: '2024-11-13T00:41:32.151Z', {"user":"  timestamp: '2024-11-13T00:41:32.151Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T00:41:32.151Z',"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731458490284-vaehrjmol' {"user":"  chatId: 'chat-1731458490284-vaehrjmol'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731458490284-vaehrjmol'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Attempting to save chat history with: { {"user":"🔍 Attempting to save chat history with: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Attempting to save chat history with: {"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731458490284-vaehrjmol', {"user":"  chatId: 'chat-1731458490284-vaehrjmol',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731458490284-vaehrjmol',"}}
[info] >    messageCount: 2, {"user":"  messageCount: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageCount: 2,"}}
[info] >    timestamp: '2024-11-13T00:41:32.152Z' {"user":"  timestamp: '2024-11-13T00:41:32.152Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T00:41:32.152Z'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Available Firebase Functions: [ {"user":"🔍 Available Firebase Functions: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Available Firebase Functions: ["}}
[info] >    'app', {"user":"  'app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'app',"}}
[info] >    'emulatorOrigin', {"user":"  'emulatorOrigin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'emulatorOrigin',"}}
[info] >    'contextProvider', {"user":"  'contextProvider',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'contextProvider',"}}
[info] >    'deleteService', {"user":"  'deleteService',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'deleteService',"}}
[info] >    'cancelAllRequests', {"user":"  'cancelAllRequests',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'cancelAllRequests',"}}
[info] >    'customDomain', {"user":"  'customDomain',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'customDomain',"}}
[info] >    'region' {"user":"  'region'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'region'"}}
[info] >  ] {"user":"]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ]"}}
[info] >  🔍 Save Chat History Function: true {"user":"🔍 Save Chat History Function: true","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Save Chat History Function: true"}}
[debug] [2024-11-13T00:41:32.180Z] Functions emulator received unknown request at path /demo-project/us-central1/saveChatHistory
[info] >  ❌ Detailed save chat history error: { {"user":"❌ Detailed save chat history error: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ Detailed save chat history error: {"}}
[info] >    errorName: 'FirebaseError', {"user":"  errorName: 'FirebaseError',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorName: 'FirebaseError',"}}
[info] >    errorCode: 'functions/not-found', {"user":"  errorCode: 'functions/not-found',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorCode: 'functions/not-found',"}}
[info] >    errorMessage: 'not-found', {"user":"  errorMessage: 'not-found',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorMessage: 'not-found',"}}
[info] >    fullError: [FunctionsError [FirebaseError]: not-found] { {"user":"  fullError: [FunctionsError [FirebaseError]: not-found] {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   fullError: [FunctionsError [FirebaseError]: not-found] {"}}
[info] >      code: 'functions/not-found', {"user":"    code: 'functions/not-found',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 'functions/not-found',"}}
[info] >      customData: undefined, {"user":"    customData: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     customData: undefined,"}}
[info] >      details: undefined {"user":"    details: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     details: undefined"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T00:41:32.196Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 1940.0321ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 1940.0321ms"}}
[debug] [2024-11-13T00:41:32.198Z] [worker-us-central1-processChat-9b2284fa-c181-4a41-9f28-43f2216f5ee8]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-9b2284fa-c181-4a41-9f28-43f2216f5ee8]: IDLE"}}
[debug] [2024-11-13T00:41:32.198Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T00:41:32.198Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T00:41:32.198Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T00:43:45.481Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T00:43:45.481Z] File C:\Users\Rob\Apps\not-alone\functions\src\chatHistory.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\chatHistory.ts changed, reloading triggers"}}
[debug] [2024-11-13T00:43:46.496Z] Validating nodejs source
[debug] [2024-11-13T00:43:48.291Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T00:43:48.291Z] Building nodejs source
[debug] [2024-11-13T00:43:48.291Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T00:43:48.292Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T00:43:48.301Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8119

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T00:43:48.971Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T00:43:53.010Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T00:43:53.011Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T00:43:53.012Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-13T00:43:53.012Z] [worker-us-central1-processChat-9b2284fa-c181-4a41-9f28-43f2216f5ee8]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-9b2284fa-c181-4a41-9f28-43f2216f5ee8]: FINISHING"}}
[debug] [2024-11-13T00:43:53.024Z] [worker-us-central1-processChat-9b2284fa-c181-4a41-9f28-43f2216f5ee8]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-9b2284fa-c181-4a41-9f28-43f2216f5ee8]: exited"}}
[debug] [2024-11-13T00:43:53.024Z] [worker-us-central1-processChat-9b2284fa-c181-4a41-9f28-43f2216f5ee8]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-9b2284fa-c181-4a41-9f28-43f2216f5ee8]: FINISHED"}}
[debug] [2024-11-13T00:46:01.601Z] File C:\Users\Rob\Apps\not-alone\functions\src\chatHistory.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\chatHistory.ts changed, reloading triggers"}}
[debug] [2024-11-13T00:46:01.604Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T00:46:02.609Z] Validating nodejs source
[debug] [2024-11-13T00:46:03.547Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T00:46:03.547Z] Building nodejs source
[debug] [2024-11-13T00:46:03.547Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T00:46:03.548Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T00:46:03.558Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8504

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T00:46:04.194Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T00:46:08.219Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T00:46:08.219Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T00:47:16.243Z] File C:\Users\Rob\Apps\not-alone\functions\src\chatHistory.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\chatHistory.ts changed, reloading triggers"}}
[debug] [2024-11-13T00:47:16.267Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T00:47:17.275Z] Validating nodejs source
[debug] [2024-11-13T00:47:18.350Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T00:47:18.350Z] Building nodejs source
[debug] [2024-11-13T00:47:18.350Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T00:47:18.352Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T00:47:18.371Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8258

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T00:47:19.266Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T00:47:23.303Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T00:47:23.303Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T00:48:11.122Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T00:48:12.125Z] Validating nodejs source
[debug] [2024-11-13T00:48:13.052Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T00:48:13.052Z] Building nodejs source
[debug] [2024-11-13T00:48:13.052Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T00:48:13.053Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T00:48:13.063Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8292

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T00:48:13.796Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T00:48:17.821Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T00:48:17.822Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T00:49:24.558Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T00:49:25.561Z] Validating nodejs source
[debug] [2024-11-13T00:49:26.516Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T00:49:26.516Z] Building nodejs source
[debug] [2024-11-13T00:49:26.516Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T00:49:26.518Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T00:49:26.526Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8553

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T00:49:27.180Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T00:49:31.211Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T00:49:31.211Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T00:52:50.372Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T00:52:51.376Z] Validating nodejs source
[debug] [2024-11-13T00:52:52.367Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T00:52:52.368Z] Building nodejs source
[debug] [2024-11-13T00:52:52.368Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T00:52:52.369Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T00:52:52.379Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8755

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T00:52:53.034Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T00:52:57.068Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T00:52:57.069Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T00:53:28.760Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T00:53:29.773Z] Validating nodejs source
[debug] [2024-11-13T00:53:30.715Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T00:53:30.715Z] Building nodejs source
[debug] [2024-11-13T00:53:30.715Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T00:53:30.716Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T00:53:30.724Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8417

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T00:53:31.436Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T00:53:35.470Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T00:53:35.471Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T00:54:06.174Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T00:54:07.190Z] Validating nodejs source
[debug] [2024-11-13T00:54:08.214Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T00:54:08.215Z] Building nodejs source
[debug] [2024-11-13T00:54:08.215Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T00:54:08.217Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T00:54:08.227Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8092

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T00:54:09.169Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T00:54:13.206Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T00:54:13.207Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T00:54:14.969Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T00:54:15.970Z] Validating nodejs source
[debug] [2024-11-13T00:54:16.989Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T00:54:16.989Z] Building nodejs source
[debug] [2024-11-13T00:54:16.989Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T00:54:16.991Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T00:54:17.000Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8051

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T00:54:17.747Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T00:54:21.784Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T00:54:21.785Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T00:54:47.626Z] File C:\Users\Rob\Apps\not-alone\functions\src\chatHistory.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\chatHistory.ts changed, reloading triggers"}}
[debug] [2024-11-13T00:54:48.627Z] Validating nodejs source
[debug] [2024-11-13T00:54:50.264Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T00:54:50.265Z] Building nodejs source
[debug] [2024-11-13T00:54:50.265Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T00:54:50.265Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T00:54:50.273Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8921

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T00:54:50.912Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T00:54:54.949Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T00:54:54.950Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T00:54:57.341Z] File C:\Users\Rob\Apps\not-alone\functions\src\chatHistory.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\chatHistory.ts changed, reloading triggers"}}
[debug] [2024-11-13T00:54:58.354Z] Validating nodejs source
[debug] [2024-11-13T00:54:59.392Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T00:54:59.392Z] Building nodejs source
[debug] [2024-11-13T00:54:59.392Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T00:54:59.394Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T00:54:59.405Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8559

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T00:55:00.372Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T00:55:04.395Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T00:55:04.395Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T00:55:26.952Z] File C:\Users\Rob\Apps\not-alone\functions\src\chatHistory.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\chatHistory.ts changed, reloading triggers"}}
[debug] [2024-11-13T00:55:27.965Z] Validating nodejs source
[debug] [2024-11-13T00:55:28.901Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T00:55:28.901Z] Building nodejs source
[debug] [2024-11-13T00:55:28.901Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T00:55:28.902Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T00:55:28.910Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8973

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T00:55:29.538Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T00:55:33.562Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T00:55:33.562Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T00:55:45.656Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js.map changed, reloading triggers"}}
[debug] [2024-11-13T00:55:45.657Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js changed, reloading triggers"}}
[debug] [2024-11-13T00:55:45.681Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-13T00:55:45.682Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-13T00:55:46.695Z] Validating nodejs source
[debug] [2024-11-13T00:55:47.676Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T00:55:47.676Z] Building nodejs source
[debug] [2024-11-13T00:55:47.676Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T00:55:47.678Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T00:55:47.687Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8470

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T00:55:48.404Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T00:55:52.430Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T00:55:52.431Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T00:55:55.443Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:55:55.443Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T00:55:55.444Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:55:55.443Z"],"workRunningCount":1}
[debug] [2024-11-13T00:55:55.444Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T00:55:55.446Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T00:55:55.446Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T00:55:55.446Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-13T00:55:55.455Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-13T00:55:55.455Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-13T00:55:56.989Z] [runtime-status] [10544] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [10544] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T00:55:56.991Z] [runtime-status] [10544] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [10544] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T00:55:56.992Z] [runtime-status] [10544] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [10544] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T00:55:56.992Z] [runtime-status] [10544] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [10544] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T00:55:56.992Z] [runtime-status] [10544] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [10544] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T00:55:57.304Z] [runtime-status] [10544] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [10544] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T00:55:57.305Z] [runtime-status] [10544] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [10544] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T00:55:57.305Z] [runtime-status] [10544] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [10544] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T00:55:57.310Z] [runtime-status] [10544] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [10544] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T00:55:57.313Z] [runtime-status] [10544] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [10544] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T00:55:57.313Z] [runtime-status] [10544] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [10544] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T00:55:57.419Z] [runtime-status] [10544] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [10544] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T00:55:57.428Z] [runtime-status] [10544] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [10544] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T00:55:57.429Z] [runtime-status] [10544] Listening to port: \\?\pipe\fire_emu_63875a2e8f9618cb {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [10544] Listening to port: \\\\?\\pipe\\fire_emu_63875a2e8f9618cb"}}
[debug] [2024-11-13T00:55:57.522Z] [worker-us-central1-processChat-7539fe4d-ba5b-4f8d-8f8d-168d4be6b8af]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-7539fe4d-ba5b-4f8d-8f8d-168d4be6b8af]: IDLE"}}
[debug] [2024-11-13T00:55:57.523Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T00:55:57.523Z] [worker-us-central1-processChat-7539fe4d-ba5b-4f8d-8f8d-168d4be6b8af]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-7539fe4d-ba5b-4f8d-8f8d-168d4be6b8af]: BUSY"}}
[debug] [2024-11-13T00:55:57.526Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 3.4685ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 3.4685ms"}}
[debug] [2024-11-13T00:55:57.527Z] [worker-us-central1-processChat-7539fe4d-ba5b-4f8d-8f8d-168d4be6b8af]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-7539fe4d-ba5b-4f8d-8f8d-168d4be6b8af]: IDLE"}}
[debug] [2024-11-13T00:55:57.527Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T00:55:57.527Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T00:55:57.527Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T00:55:57.528Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:55:57.528Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T00:55:57.528Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:55:57.528Z"],"workRunningCount":1}
[debug] [2024-11-13T00:55:57.528Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T00:55:57.528Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T00:55:57.529Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T00:55:57.529Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T00:55:57.529Z] [worker-us-central1-processChat-7539fe4d-ba5b-4f8d-8f8d-168d4be6b8af]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-7539fe4d-ba5b-4f8d-8f8d-168d4be6b8af]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'hello', chatId: 'chat-1731458490284-vaehrjmol' } {"user":"  data: { message: 'hello', chatId: 'chat-1731458490284-vaehrjmol' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'hello', chatId: 'chat-1731458490284-vaehrjmol' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📝 Using chat ID: chat-1731458490284-vaehrjmol {"user":"📝 Using chat ID: chat-1731458490284-vaehrjmol","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: chat-1731458490284-vaehrjmol"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 5, {"user":"  messageLength: 5,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 5,"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731458490284-vaehrjmol' {"user":"  chatId: 'chat-1731458490284-vaehrjmol'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731458490284-vaehrjmol'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: chat-1731458490284-vaehrjmol {"user":"🆕 Creating new chat session: chat-1731458490284-vaehrjmol","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: chat-1731458490284-vaehrjmol"}}
[info] >  📝 Chat session created: { chatId: 'chat-1731458490284-vaehrjmol', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'chat-1731458490284-vaehrjmol', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'chat-1731458490284-vaehrjmol', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  📚 Current Chat History: { {"user":"📚 Current Chat History: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📚 Current Chat History: {"}}
[info] >    chatId: 'chat-1731458490284-vaehrjmol', {"user":"  chatId: 'chat-1731458490284-vaehrjmol',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731458490284-vaehrjmol',"}}
[info] >    historyLength: 6, {"user":"  historyLength: 6,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   historyLength: 6,"}}
[info] >    lastMessages: [ {"user":"  lastMessages: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   lastMessages: ["}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'assistant', parts: [Array] }, {"user":"    { role: 'assistant', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'assistant', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] } {"user":"    { role: 'model', parts: [Array] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Response received: { responseLength: 171, timestamp: '2024-11-13T00:55:59.858Z' } {"user":"✅ Response received: { responseLength: 171, timestamp: '2024-11-13T00:55:59.858Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 171, timestamp: '2024-11-13T00:55:59.858Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: 'Hello there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\n', {"user":"  message: 'Hello there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Hello there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\\n',"}}
[info] >    userMessage: 'hello', {"user":"  userMessage: 'hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hello',"}}
[info] >    timestamp: '2024-11-13T00:55:59.858Z', {"user":"  timestamp: '2024-11-13T00:55:59.858Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T00:55:59.858Z',"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731458490284-vaehrjmol' {"user":"  chatId: 'chat-1731458490284-vaehrjmol'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731458490284-vaehrjmol'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Attempting to save chat history with DETAILED logging: { {"user":"🔍 Attempting to save chat history with DETAILED logging: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Attempting to save chat history with DETAILED logging: {"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731458490284-vaehrjmol', {"user":"  chatId: 'chat-1731458490284-vaehrjmol',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731458490284-vaehrjmol',"}}
[info] >    messageCount: 2, {"user":"  messageCount: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageCount: 2,"}}
[info] >    timestamp: '2024-11-13T00:55:59.858Z', {"user":"  timestamp: '2024-11-13T00:55:59.858Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T00:55:59.858Z',"}}
[info] >    clientAppConfig: { projectId: 'demo-project', apiKey: 'local-api-key' } {"user":"  clientAppConfig: { projectId: 'demo-project', apiKey: 'local-api-key' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   clientAppConfig: { projectId: 'demo-project', apiKey: 'local-api-key' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔧 Firebase Client Configuration: { {"user":"🔧 Firebase Client Configuration: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Firebase Client Configuration: {"}}
[info] >    projectId: 'demo-project', {"user":"  projectId: 'demo-project',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   projectId: 'demo-project',"}}
[info] >    apiKey: 'local-api-key', {"user":"  apiKey: 'local-api-key',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   apiKey: 'local-api-key',"}}
[info] >    authDomain: undefined, {"user":"  authDomain: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   authDomain: undefined,"}}
[info] >    emulatorHost: 'localhost', {"user":"  emulatorHost: 'localhost',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorHost: 'localhost',"}}
[info] >    emulatorPort: 5001 {"user":"  emulatorPort: 5001","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorPort: 5001"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Firebase Functions Object Keys: [ {"user":"🔍 Firebase Functions Object Keys: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Object Keys: ["}}
[info] >    'app', {"user":"  'app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'app',"}}
[info] >    'emulatorOrigin', {"user":"  'emulatorOrigin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'emulatorOrigin',"}}
[info] >    'contextProvider', {"user":"  'contextProvider',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'contextProvider',"}}
[info] >    'deleteService', {"user":"  'deleteService',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'deleteService',"}}
[info] >    'cancelAllRequests', {"user":"  'cancelAllRequests',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'cancelAllRequests',"}}
[info] >    'customDomain', {"user":"  'customDomain',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'customDomain',"}}
[info] >    'region' {"user":"  'region'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'region'"}}
[info] >  ] {"user":"]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ]"}}
[info] >  🔍 Firebase Functions Instance: FunctionsService { {"user":"🔍 Firebase Functions Instance: FunctionsService {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Instance: FunctionsService {"}}
[info] >    app: FirebaseAppImpl { {"user":"  app: FirebaseAppImpl {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   app: FirebaseAppImpl {"}}
[info] >      _isDeleted: false, {"user":"    _isDeleted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _isDeleted: false,"}}
[info] >      _options: { projectId: 'demo-project', apiKey: 'local-api-key' }, {"user":"    _options: { projectId: 'demo-project', apiKey: 'local-api-key' },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _options: { projectId: 'demo-project', apiKey: 'local-api-key' },"}}
[info] >      _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false }, {"user":"    _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },"}}
[info] >      _name: '[DEFAULT]', {"user":"    _name: '[DEFAULT]',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _name: '[DEFAULT]',"}}
[info] >      _automaticDataCollectionEnabled: false, {"user":"    _automaticDataCollectionEnabled: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _automaticDataCollectionEnabled: false,"}}
[info] >      _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] } {"user":"    _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    emulatorOrigin: 'http://localhost:5001', {"user":"  emulatorOrigin: 'http://localhost:5001',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorOrigin: 'http://localhost:5001',"}}
[info] >    contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null }, {"user":"  contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },"}}
[info] >    deleteService: [Function (anonymous)], {"user":"  deleteService: [Function (anonymous)],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   deleteService: [Function (anonymous)],"}}
[info] >    cancelAllRequests: Promise { <pending> }, {"user":"  cancelAllRequests: Promise { <pending> },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   cancelAllRequests: Promise { <pending> },"}}
[info] >    customDomain: null, {"user":"  customDomain: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   customDomain: null,"}}
[info] >    region: 'us-central1' {"user":"  region: 'us-central1'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   region: 'us-central1'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Save Chat History Function Details: { functionExists: true, functionType: 'function' } {"user":"🔍 Save Chat History Function Details: { functionExists: true, functionType: 'function' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Save Chat History Function Details: { functionExists: true, functionType: 'function' }"}}
[info] >  📤 Chat History Payload: { {"user":"📤 Chat History Payload: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Chat History Payload: {"}}
[info] >    "userId": "xDxECJtJiNdgFeQ9L95cAi5LBwzM", {"user":"  \"userId\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"userId\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\","}}
[info] >    "chatId": "chat-1731458490284-vaehrjmol", {"user":"  \"chatId\": \"chat-1731458490284-vaehrjmol\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"chatId\": \"chat-1731458490284-vaehrjmol\","}}
[info] >    "messages": [ {"user":"  \"messages\": [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"messages\": ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "user", {"user":"      \"role\": \"user\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"user\","}}
[info] >        "content": "hello", {"user":"      \"content\": \"hello\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"hello\","}}
[info] >        "timestamp": "2024-11-13T00:55:59.860Z" {"user":"      \"timestamp\": \"2024-11-13T00:55:59.860Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T00:55:59.860Z\""}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "model", {"user":"      \"role\": \"model\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"model\","}}
[info] >        "content": "Hello there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\n", {"user":"      \"content\": \"Hello there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"Hello there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\\n\","}}
[info] >        "timestamp": "2024-11-13T00:55:59.860Z" {"user":"      \"timestamp\": \"2024-11-13T00:55:59.860Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T00:55:59.860Z\""}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    "timestamp": "2024-11-13T00:55:59.860Z" {"user":"  \"timestamp\": \"2024-11-13T00:55:59.860Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"timestamp\": \"2024-11-13T00:55:59.860Z\""}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T00:55:59.900Z] Functions emulator received unknown request at path /demo-project/us-central1/saveChatHistory
[info] >  ❌ COMPREHENSIVE Save Chat History Error: { {"user":"❌ COMPREHENSIVE Save Chat History Error: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ COMPREHENSIVE Save Chat History Error: {"}}
[info] >    errorType: 'object', {"user":"  errorType: 'object',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorType: 'object',"}}
[info] >    errorInstance: true, {"user":"  errorInstance: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorInstance: true,"}}
[info] >    fullErrorObject: [FunctionsError [FirebaseError]: not-found] { {"user":"  fullErrorObject: [FunctionsError [FirebaseError]: not-found] {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   fullErrorObject: [FunctionsError [FirebaseError]: not-found] {"}}
[info] >      code: 'functions/not-found', {"user":"    code: 'functions/not-found',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 'functions/not-found',"}}
[info] >      customData: undefined, {"user":"    customData: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     customData: undefined,"}}
[info] >      details: undefined {"user":"    details: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     details: undefined"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    stringRepresentation: 'FirebaseError: not-found' {"user":"  stringRepresentation: 'FirebaseError: not-found'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   stringRepresentation: 'FirebaseError: not-found'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T00:55:59.909Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2380.2159ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2380.2159ms"}}
[debug] [2024-11-13T00:55:59.910Z] [worker-us-central1-processChat-7539fe4d-ba5b-4f8d-8f8d-168d4be6b8af]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-7539fe4d-ba5b-4f8d-8f8d-168d4be6b8af]: IDLE"}}
[debug] [2024-11-13T00:55:59.910Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T00:55:59.910Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T00:55:59.910Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  ❌ Detailed Error Breakdown: { {"user":"❌ Detailed Error Breakdown: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ Detailed Error Breakdown: {"}}
[info] >    errorName: 'FirebaseError', {"user":"  errorName: 'FirebaseError',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorName: 'FirebaseError',"}}
[info] >    errorCode: 'functions/not-found', {"user":"  errorCode: 'functions/not-found',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorCode: 'functions/not-found',"}}
[info] >    errorMessage: 'not-found', {"user":"  errorMessage: 'not-found',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorMessage: 'not-found',"}}
[info] >    errorStack: 'FirebaseError: not-found' {"user":"  errorStack: 'FirebaseError: not-found'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorStack: 'FirebaseError: not-found'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T00:58:22.546Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T00:58:23.556Z] Validating nodejs source
[debug] [2024-11-13T00:58:24.516Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T00:58:24.516Z] Building nodejs source
[debug] [2024-11-13T00:58:24.516Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T00:58:24.518Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T00:58:24.530Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8827

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T00:58:25.207Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T00:58:29.238Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T00:58:29.239Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T00:58:29.240Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-13T00:58:29.240Z] [worker-us-central1-processChat-7539fe4d-ba5b-4f8d-8f8d-168d4be6b8af]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-7539fe4d-ba5b-4f8d-8f8d-168d4be6b8af]: FINISHING"}}
[debug] [2024-11-13T00:58:29.253Z] [worker-us-central1-processChat-7539fe4d-ba5b-4f8d-8f8d-168d4be6b8af]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-7539fe4d-ba5b-4f8d-8f8d-168d4be6b8af]: exited"}}
[debug] [2024-11-13T00:58:29.253Z] [worker-us-central1-processChat-7539fe4d-ba5b-4f8d-8f8d-168d4be6b8af]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-7539fe4d-ba5b-4f8d-8f8d-168d4be6b8af]: FINISHED"}}
[debug] [2024-11-13T00:59:13.477Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js.map changed, reloading triggers"}}
[debug] [2024-11-13T00:59:13.478Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js changed, reloading triggers"}}
[debug] [2024-11-13T00:59:13.503Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-13T00:59:13.504Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-13T00:59:14.516Z] Validating nodejs source
[debug] [2024-11-13T00:59:15.498Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T00:59:15.498Z] Building nodejs source
[debug] [2024-11-13T00:59:15.498Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T00:59:15.500Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T00:59:15.508Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8833

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T00:59:16.152Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T00:59:20.180Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T00:59:20.181Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T00:59:23.924Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:59:23.924Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T00:59:23.925Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:59:23.924Z"],"workRunningCount":1}
[debug] [2024-11-13T00:59:23.925Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T00:59:23.927Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T00:59:23.927Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T00:59:23.927Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-13T00:59:23.935Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-13T00:59:23.936Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-13T00:59:25.460Z] [runtime-status] [34744] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [34744] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T00:59:25.461Z] [runtime-status] [34744] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [34744] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T00:59:25.462Z] [runtime-status] [34744] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [34744] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T00:59:25.462Z] [runtime-status] [34744] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [34744] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T00:59:25.463Z] [runtime-status] [34744] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [34744] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T00:59:25.764Z] [runtime-status] [34744] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [34744] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T00:59:25.764Z] [runtime-status] [34744] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [34744] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T00:59:25.764Z] [runtime-status] [34744] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [34744] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T00:59:25.770Z] [runtime-status] [34744] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [34744] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T00:59:25.772Z] [runtime-status] [34744] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [34744] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T00:59:25.773Z] [runtime-status] [34744] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [34744] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T00:59:25.880Z] [runtime-status] [34744] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [34744] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T00:59:25.891Z] [runtime-status] [34744] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [34744] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T00:59:25.892Z] [runtime-status] [34744] Listening to port: \\?\pipe\fire_emu_2711cdedae4a2b99 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [34744] Listening to port: \\\\?\\pipe\\fire_emu_2711cdedae4a2b99"}}
[debug] [2024-11-13T00:59:25.931Z] [worker-us-central1-processChat-18ed06bb-e390-4221-89df-17474326cb87]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-18ed06bb-e390-4221-89df-17474326cb87]: IDLE"}}
[debug] [2024-11-13T00:59:25.931Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T00:59:25.932Z] [worker-us-central1-processChat-18ed06bb-e390-4221-89df-17474326cb87]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-18ed06bb-e390-4221-89df-17474326cb87]: BUSY"}}
[debug] [2024-11-13T00:59:25.937Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4.7856ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4.7856ms"}}
[debug] [2024-11-13T00:59:25.938Z] [worker-us-central1-processChat-18ed06bb-e390-4221-89df-17474326cb87]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-18ed06bb-e390-4221-89df-17474326cb87]: IDLE"}}
[debug] [2024-11-13T00:59:25.938Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T00:59:25.938Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T00:59:25.938Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T00:59:25.939Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:59:25.939Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T00:59:25.939Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T00:59:25.939Z"],"workRunningCount":1}
[debug] [2024-11-13T00:59:25.940Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T00:59:25.941Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T00:59:25.941Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T00:59:25.941Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T00:59:25.942Z] [worker-us-central1-processChat-18ed06bb-e390-4221-89df-17474326cb87]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-18ed06bb-e390-4221-89df-17474326cb87]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello' } } {"user":"🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello' } }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello' } }"}}
[info] >  📝 Using chat ID: undefined {"user":"📝 Using chat ID: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: undefined"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 5, {"user":"  messageLength: 5,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 5,"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: undefined {"user":"  chatId: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: undefined"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: chat-1731459565964-a39jbmh2i {"user":"🆕 Creating new chat session: chat-1731459565964-a39jbmh2i","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: chat-1731459565964-a39jbmh2i"}}
[info] >  📝 Chat session created: { chatId: 'chat-1731459565964-a39jbmh2i', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'chat-1731459565964-a39jbmh2i', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'chat-1731459565964-a39jbmh2i', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  📚 Current Chat History: { {"user":"📚 Current Chat History: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📚 Current Chat History: {"}}
[info] >    chatId: 'chat-1731459565964-a39jbmh2i', {"user":"  chatId: 'chat-1731459565964-a39jbmh2i',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731459565964-a39jbmh2i',"}}
[info] >    historyLength: 6, {"user":"  historyLength: 6,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   historyLength: 6,"}}
[info] >    lastMessages: [ {"user":"  lastMessages: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   lastMessages: ["}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'assistant', parts: [Array] }, {"user":"    { role: 'assistant', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'assistant', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] } {"user":"    { role: 'model', parts: [Array] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ❌ COMPREHENSIVE Save Chat History Error (Enhanced): { {"user":"❌ COMPREHENSIVE Save Chat History Error (Enhanced): {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ COMPREHENSIVE Save Chat History Error (Enhanced): {"}}
[info] >    errorType: 'object', {"user":"  errorType: 'object',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorType: 'object',"}}
[info] >    errorInstance: true, {"user":"  errorInstance: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorInstance: true,"}}
[info] >    fullErrorObject: FirebaseError: Firebase: Firebase App named '[DEFAULT]' already exists with different options or config (app/duplicate-app). {"user":"  fullErrorObject: FirebaseError: Firebase: Firebase App named '[DEFAULT]' already exists with different options or config (app/duplicate-app).","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   fullErrorObject: FirebaseError: Firebase: Firebase App named '[DEFAULT]' already exists with different options or config (app/duplicate-app)."}}
[info] >        at initializeApp (C:\Users\Rob\Apps\not-alone\functions\node_modules\@firebase\app\dist\index.cjs.js:570:33) {"user":"      at initializeApp (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@firebase\\app\\dist\\index.cjs.js:570:33)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at initializeApp (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@firebase\\app\\dist\\index.cjs.js:570:33)"}}
[info] >        at C:\Users\Rob\Apps\not-alone\functions\lib\index.js:186:59 {"user":"      at C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js:186:59","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js:186:59"}}
[info] >        at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >        at async C:\Users\Rob\Apps\not-alone\functions\node_modules\firebase-functions\lib\common\providers\https.js:467:26 {"user":"      at async C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26"}}
[info] >        at async runFunction (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:506:9) {"user":"      at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)"}}
[info] >        at async runHTTPS (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:531:5) {"user":"      at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)"}}
[info] >        at async C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:694:21 { {"user":"      at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {"}}
[info] >      code: 'app/duplicate-app', {"user":"    code: 'app/duplicate-app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 'app/duplicate-app',"}}
[info] >      customData: { appName: '[DEFAULT]' } {"user":"    customData: { appName: '[DEFAULT]' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     customData: { appName: '[DEFAULT]' }"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    stringRepresentation: "FirebaseError: Firebase: Firebase App named '[DEFAULT]' already exists with different options or config (app/duplicate-app).", {"user":"  stringRepresentation: \"FirebaseError: Firebase: Firebase App named '[DEFAULT]' already exists with different options or config (app/duplicate-app).\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   stringRepresentation: \"FirebaseError: Firebase: Firebase App named '[DEFAULT]' already exists with different options or config (app/duplicate-app).\","}}
[info] >    adminAppConfig: { {"user":"  adminAppConfig: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   adminAppConfig: {"}}
[info] >      storageBucket: 'notalone-de4fc.firebasestorage.app', {"user":"    storageBucket: 'notalone-de4fc.firebasestorage.app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     storageBucket: 'notalone-de4fc.firebasestorage.app',"}}
[info] >      projectId: 'notalone-de4fc', {"user":"    projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     projectId: 'notalone-de4fc',"}}
[info] >      credential: RefreshTokenCredential { {"user":"    credential: RefreshTokenCredential {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     credential: RefreshTokenCredential {"}}
[info] >        httpAgent: undefined, {"user":"      httpAgent: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpAgent: undefined,"}}
[info] >        implicit: true, {"user":"      implicit: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       implicit: true,"}}
[info] >        refreshToken: [RefreshToken], {"user":"      refreshToken: [RefreshToken],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       refreshToken: [RefreshToken],"}}
[info] >        httpClient: [HttpClient] {"user":"      httpClient: [HttpClient]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpClient: [HttpClient]"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ❌ Detailed Error Breakdown (Enhanced): { {"user":"❌ Detailed Error Breakdown (Enhanced): {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ Detailed Error Breakdown (Enhanced): {"}}
[info] >    errorName: 'FirebaseError', {"user":"  errorName: 'FirebaseError',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorName: 'FirebaseError',"}}
[info] >    errorCode: 'app/duplicate-app', {"user":"  errorCode: 'app/duplicate-app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorCode: 'app/duplicate-app',"}}
[info] >    errorMessage: "Firebase: Firebase App named '[DEFAULT]' already exists with different options or config (app/duplicate-app).", {"user":"  errorMessage: \"Firebase: Firebase App named '[DEFAULT]' already exists with different options or config (app/duplicate-app).\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorMessage: \"Firebase: Firebase App named '[DEFAULT]' already exists with different options or config (app/duplicate-app).\","}}
[info] >    errorStack: "FirebaseError: Firebase: Firebase App named '[DEFAULT]' already exists with different options or config (app/duplicate-app).\n" + {"user":"  errorStack: \"FirebaseError: Firebase: Firebase App named '[DEFAULT]' already exists with different options or config (app/duplicate-app).\\n\" +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorStack: \"FirebaseError: Firebase: Firebase App named '[DEFAULT]' already exists with different options or config (app/duplicate-app).\\n\" +"}}
[info] >      '    at initializeApp (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\@firebase\\app\\dist\\index.cjs.js:570:33)\n' + {"user":"    '    at initializeApp (C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\@firebase\\\\app\\\\dist\\\\index.cjs.js:570:33)\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '    at initializeApp (C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\@firebase\\\\app\\\\dist\\\\index.cjs.js:570:33)\\n' +"}}
[info] >      '    at C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js:186:59\n' + {"user":"    '    at C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\lib\\\\index.js:186:59\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '    at C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\lib\\\\index.js:186:59\\n' +"}}
[info] >      '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' + {"user":"    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\\n' +"}}
[info] >      '    at async C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26\n' + {"user":"    '    at async C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\common\\\\providers\\\\https.js:467:26\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '    at async C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\common\\\\providers\\\\https.js:467:26\\n' +"}}
[info] >      '    at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)\n' + {"user":"    '    at async runFunction (C:\\\\Users\\\\Rob\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\firebase-tools\\\\lib\\\\emulator\\\\functionsEmulatorRuntime.js:506:9)\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '    at async runFunction (C:\\\\Users\\\\Rob\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\firebase-tools\\\\lib\\\\emulator\\\\functionsEmulatorRuntime.js:506:9)\\n' +"}}
[info] >      '    at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)\n' + {"user":"    '    at async runHTTPS (C:\\\\Users\\\\Rob\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\firebase-tools\\\\lib\\\\emulator\\\\functionsEmulatorRuntime.js:531:5)\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '    at async runHTTPS (C:\\\\Users\\\\Rob\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\firebase-tools\\\\lib\\\\emulator\\\\functionsEmulatorRuntime.js:531:5)\\n' +"}}
[info] >      '    at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21' {"user":"    '    at async C:\\\\Users\\\\Rob\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\firebase-tools\\\\lib\\\\emulator\\\\functionsEmulatorRuntime.js:694:21'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '    at async C:\\\\Users\\\\Rob\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\firebase-tools\\\\lib\\\\emulator\\\\functionsEmulatorRuntime.js:694:21'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T00:59:28.198Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2256.8427ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2256.8427ms"}}
[debug] [2024-11-13T00:59:28.200Z] [worker-us-central1-processChat-18ed06bb-e390-4221-89df-17474326cb87]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-18ed06bb-e390-4221-89df-17474326cb87]: IDLE"}}
[debug] [2024-11-13T00:59:28.200Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T00:59:28.200Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T00:59:28.200Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  ✅ Response received: { responseLength: 171, timestamp: '2024-11-13T00:59:28.152Z' } {"user":"✅ Response received: { responseLength: 171, timestamp: '2024-11-13T00:59:28.152Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 171, timestamp: '2024-11-13T00:59:28.152Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: 'Hello there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\n', {"user":"  message: 'Hello there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Hello there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\\n',"}}
[info] >    userMessage: 'hello', {"user":"  userMessage: 'hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hello',"}}
[info] >    timestamp: '2024-11-13T00:59:28.153Z', {"user":"  timestamp: '2024-11-13T00:59:28.153Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T00:59:28.153Z',"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731459565964-a39jbmh2i' {"user":"  chatId: 'chat-1731459565964-a39jbmh2i'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731459565964-a39jbmh2i'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Attempting to save chat history with DETAILED logging: { {"user":"🔍 Attempting to save chat history with DETAILED logging: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Attempting to save chat history with DETAILED logging: {"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731459565964-a39jbmh2i', {"user":"  chatId: 'chat-1731459565964-a39jbmh2i',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731459565964-a39jbmh2i',"}}
[info] >    messageCount: 2, {"user":"  messageCount: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageCount: 2,"}}
[info] >    timestamp: '2024-11-13T00:59:28.153Z', {"user":"  timestamp: '2024-11-13T00:59:28.153Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T00:59:28.153Z',"}}
[info] >    clientAppConfig: { projectId: 'demo-project', apiKey: 'local-api-key' } {"user":"  clientAppConfig: { projectId: 'demo-project', apiKey: 'local-api-key' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   clientAppConfig: { projectId: 'demo-project', apiKey: 'local-api-key' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔧 Firebase Client Configuration: { {"user":"🔧 Firebase Client Configuration: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Firebase Client Configuration: {"}}
[info] >    projectId: 'demo-project', {"user":"  projectId: 'demo-project',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   projectId: 'demo-project',"}}
[info] >    apiKey: 'local-api-key', {"user":"  apiKey: 'local-api-key',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   apiKey: 'local-api-key',"}}
[info] >    authDomain: undefined, {"user":"  authDomain: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   authDomain: undefined,"}}
[info] >    emulatorHost: 'localhost', {"user":"  emulatorHost: 'localhost',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorHost: 'localhost',"}}
[info] >    emulatorPort: 5001 {"user":"  emulatorPort: 5001","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorPort: 5001"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Firebase Functions Object Keys: [ {"user":"🔍 Firebase Functions Object Keys: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Object Keys: ["}}
[info] >    'app', {"user":"  'app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'app',"}}
[info] >    'emulatorOrigin', {"user":"  'emulatorOrigin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'emulatorOrigin',"}}
[info] >    'contextProvider', {"user":"  'contextProvider',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'contextProvider',"}}
[info] >    'deleteService', {"user":"  'deleteService',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'deleteService',"}}
[info] >    'cancelAllRequests', {"user":"  'cancelAllRequests',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'cancelAllRequests',"}}
[info] >    'customDomain', {"user":"  'customDomain',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'customDomain',"}}
[info] >    'region' {"user":"  'region'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'region'"}}
[info] >  ] {"user":"]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ]"}}
[info] >  🔍 Firebase Functions Instance: FunctionsService { {"user":"🔍 Firebase Functions Instance: FunctionsService {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Instance: FunctionsService {"}}
[info] >    app: FirebaseAppImpl { {"user":"  app: FirebaseAppImpl {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   app: FirebaseAppImpl {"}}
[info] >      _isDeleted: false, {"user":"    _isDeleted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _isDeleted: false,"}}
[info] >      _options: { projectId: 'demo-project', apiKey: 'local-api-key' }, {"user":"    _options: { projectId: 'demo-project', apiKey: 'local-api-key' },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _options: { projectId: 'demo-project', apiKey: 'local-api-key' },"}}
[info] >      _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false }, {"user":"    _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },"}}
[info] >      _name: '[DEFAULT]', {"user":"    _name: '[DEFAULT]',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _name: '[DEFAULT]',"}}
[info] >      _automaticDataCollectionEnabled: false, {"user":"    _automaticDataCollectionEnabled: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _automaticDataCollectionEnabled: false,"}}
[info] >      _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] } {"user":"    _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    emulatorOrigin: 'http://localhost:5001', {"user":"  emulatorOrigin: 'http://localhost:5001',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorOrigin: 'http://localhost:5001',"}}
[info] >    contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null }, {"user":"  contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },"}}
[info] >    deleteService: [Function (anonymous)], {"user":"  deleteService: [Function (anonymous)],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   deleteService: [Function (anonymous)],"}}
[info] >    cancelAllRequests: Promise { <pending> }, {"user":"  cancelAllRequests: Promise { <pending> },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   cancelAllRequests: Promise { <pending> },"}}
[info] >    customDomain: null, {"user":"  customDomain: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   customDomain: null,"}}
[info] >    region: 'us-central1' {"user":"  region: 'us-central1'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   region: 'us-central1'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' } {"user":"🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }"}}
[debug] [2024-11-13T01:00:37.988Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T01:00:38.998Z] Validating nodejs source
[debug] [2024-11-13T01:00:39.941Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:00:39.941Z] Building nodejs source
[debug] [2024-11-13T01:00:39.941Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:00:39.942Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:00:39.951Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8381

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:00:40.613Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:00:44.645Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:00:44.646Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:00:44.647Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-13T01:00:44.647Z] [worker-us-central1-processChat-18ed06bb-e390-4221-89df-17474326cb87]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-18ed06bb-e390-4221-89df-17474326cb87]: FINISHING"}}
[debug] [2024-11-13T01:00:44.659Z] [worker-us-central1-processChat-18ed06bb-e390-4221-89df-17474326cb87]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-18ed06bb-e390-4221-89df-17474326cb87]: exited"}}
[debug] [2024-11-13T01:00:44.660Z] [worker-us-central1-processChat-18ed06bb-e390-4221-89df-17474326cb87]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-18ed06bb-e390-4221-89df-17474326cb87]: FINISHED"}}
[debug] [2024-11-13T01:01:09.180Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:01:09.182Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js changed, reloading triggers"}}
[debug] [2024-11-13T01:01:09.204Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:01:09.205Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-13T01:01:10.221Z] Validating nodejs source
[debug] [2024-11-13T01:01:11.289Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:01:11.289Z] Building nodejs source
[debug] [2024-11-13T01:01:11.289Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:01:11.290Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:01:11.298Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8052

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:01:12.098Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:01:16.123Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:01:16.124Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:01:50.380Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:01:50.383Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js changed, reloading triggers"}}
[debug] [2024-11-13T01:01:50.405Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:01:50.406Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-13T01:01:51.407Z] Validating nodejs source
[debug] [2024-11-13T01:01:52.405Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:01:52.406Z] Building nodejs source
[debug] [2024-11-13T01:01:52.406Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:01:52.407Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:01:52.415Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8699

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:01:53.097Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:01:57.127Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:01:57.127Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:03:26.972Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T01:03:26.999Z] File C:\Users\Rob\Apps\not-alone\functions\src\chatHistory.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\chatHistory.ts changed, reloading triggers"}}
[debug] [2024-11-13T01:03:28.014Z] Validating nodejs source
[debug] [2024-11-13T01:03:29.001Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:03:29.001Z] Building nodejs source
[debug] [2024-11-13T01:03:29.001Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:03:29.003Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:03:29.016Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8392

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:03:29.662Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:03:33.687Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:03:33.688Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:04:05.330Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T01:04:06.342Z] Validating nodejs source
[debug] [2024-11-13T01:04:07.385Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:04:07.385Z] Building nodejs source
[debug] [2024-11-13T01:04:07.385Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:04:07.386Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:04:07.395Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8849

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:04:08.099Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:04:12.123Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:04:12.124Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:04:13.565Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:04:13.567Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js changed, reloading triggers"}}
[debug] [2024-11-13T01:04:13.590Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:04:13.591Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-13T01:04:14.601Z] Validating nodejs source
[debug] [2024-11-13T01:04:15.598Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:04:15.598Z] Building nodejs source
[debug] [2024-11-13T01:04:15.598Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:04:15.599Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:04:15.608Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8974

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:04:16.256Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:04:20.293Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:04:20.294Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:04:23.104Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:04:23.104Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:04:23.105Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:04:23.104Z"],"workRunningCount":1}
[debug] [2024-11-13T01:04:23.105Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T01:04:23.109Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:04:23.109Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T01:04:23.109Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-13T01:04:23.123Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-13T01:04:23.123Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-13T01:04:24.766Z] [runtime-status] [27680] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27680] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:04:24.767Z] [runtime-status] [27680] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27680] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:04:24.768Z] [runtime-status] [27680] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27680] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T01:04:24.768Z] [runtime-status] [27680] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27680] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T01:04:24.769Z] [runtime-status] [27680] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27680] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:04:25.089Z] [runtime-status] [27680] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27680] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T01:04:25.090Z] [runtime-status] [27680] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27680] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T01:04:25.090Z] [runtime-status] [27680] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27680] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:04:25.096Z] [runtime-status] [27680] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27680] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:04:25.099Z] [runtime-status] [27680] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27680] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:04:25.099Z] [runtime-status] [27680] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27680] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T01:04:25.209Z] [runtime-status] [27680] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27680] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T01:04:25.219Z] [runtime-status] [27680] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27680] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T01:04:25.220Z] [runtime-status] [27680] Listening to port: \\?\pipe\fire_emu_e3845665444eee2e {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [27680] Listening to port: \\\\?\\pipe\\fire_emu_e3845665444eee2e"}}
[debug] [2024-11-13T01:04:25.314Z] [worker-us-central1-processChat-df2acf2e-cebf-4d0b-aff0-cc628efd4455]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-df2acf2e-cebf-4d0b-aff0-cc628efd4455]: IDLE"}}
[debug] [2024-11-13T01:04:25.315Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T01:04:25.315Z] [worker-us-central1-processChat-df2acf2e-cebf-4d0b-aff0-cc628efd4455]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-df2acf2e-cebf-4d0b-aff0-cc628efd4455]: BUSY"}}
[debug] [2024-11-13T01:04:25.319Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 3.9105ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 3.9105ms"}}
[debug] [2024-11-13T01:04:25.320Z] [worker-us-central1-processChat-df2acf2e-cebf-4d0b-aff0-cc628efd4455]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-df2acf2e-cebf-4d0b-aff0-cc628efd4455]: IDLE"}}
[debug] [2024-11-13T01:04:25.320Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:04:25.320Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:04:25.320Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:04:25.321Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:04:25.321Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:04:25.321Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:04:25.321Z"],"workRunningCount":1}
[debug] [2024-11-13T01:04:25.321Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T01:04:25.322Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:04:25.322Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T01:04:25.322Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T01:04:25.323Z] [worker-us-central1-processChat-df2acf2e-cebf-4d0b-aff0-cc628efd4455]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-df2acf2e-cebf-4d0b-aff0-cc628efd4455]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi' } } {"user":"🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi' } }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi' } }"}}
[info] >  📝 Using chat ID: undefined {"user":"📝 Using chat ID: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: undefined"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 2, {"user":"  messageLength: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 2,"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: undefined {"user":"  chatId: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: undefined"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: chat-1731459865343-6idv7y8cg {"user":"🆕 Creating new chat session: chat-1731459865343-6idv7y8cg","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: chat-1731459865343-6idv7y8cg"}}
[info] >  📝 Chat session created: { chatId: 'chat-1731459865343-6idv7y8cg', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'chat-1731459865343-6idv7y8cg', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'chat-1731459865343-6idv7y8cg', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hi {"user":"💬 Sending message to Gemini: hi","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hi"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  📚 Current Chat History: { {"user":"📚 Current Chat History: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📚 Current Chat History: {"}}
[info] >    chatId: 'chat-1731459865343-6idv7y8cg', {"user":"  chatId: 'chat-1731459865343-6idv7y8cg',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731459865343-6idv7y8cg',"}}
[info] >    historyLength: 6, {"user":"  historyLength: 6,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   historyLength: 6,"}}
[info] >    lastMessages: [ {"user":"  lastMessages: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   lastMessages: ["}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'assistant', parts: [Array] }, {"user":"    { role: 'assistant', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'assistant', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] } {"user":"    { role: 'model', parts: [Array] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Response received: { responseLength: 154, timestamp: '2024-11-13T01:04:27.591Z' } {"user":"✅ Response received: { responseLength: 154, timestamp: '2024-11-13T01:04:27.591Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 154, timestamp: '2024-11-13T01:04:27.591Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: "Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you looking for general relationship advice?  Let's talk!\n", {"user":"  message: \"Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you looking for general relationship advice?  Let's talk!\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: \"Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you looking for general relationship advice?  Let's talk!\\n\","}}
[info] >    userMessage: 'hi', {"user":"  userMessage: 'hi',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hi',"}}
[info] >    timestamp: '2024-11-13T01:04:27.591Z', {"user":"  timestamp: '2024-11-13T01:04:27.591Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T01:04:27.591Z',"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731459865343-6idv7y8cg' {"user":"  chatId: 'chat-1731459865343-6idv7y8cg'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731459865343-6idv7y8cg'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Attempting to save chat history with DETAILED logging: { {"user":"🔍 Attempting to save chat history with DETAILED logging: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Attempting to save chat history with DETAILED logging: {"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731459865343-6idv7y8cg', {"user":"  chatId: 'chat-1731459865343-6idv7y8cg',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731459865343-6idv7y8cg',"}}
[info] >    messageCount: 2, {"user":"  messageCount: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageCount: 2,"}}
[info] >    timestamp: '2024-11-13T01:04:27.592Z', {"user":"  timestamp: '2024-11-13T01:04:27.592Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T01:04:27.592Z',"}}
[info] >    clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' } {"user":"  clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔧 Firebase Client Configuration: { {"user":"🔧 Firebase Client Configuration: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Firebase Client Configuration: {"}}
[info] >    projectId: 'notalone-de4fc', {"user":"  projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   projectId: 'notalone-de4fc',"}}
[info] >    apiKey: 'local-api-key', {"user":"  apiKey: 'local-api-key',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   apiKey: 'local-api-key',"}}
[info] >    authDomain: undefined, {"user":"  authDomain: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   authDomain: undefined,"}}
[info] >    emulatorHost: 'localhost', {"user":"  emulatorHost: 'localhost',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorHost: 'localhost',"}}
[info] >    emulatorPort: 5001 {"user":"  emulatorPort: 5001","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorPort: 5001"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Firebase Functions Object Keys: [ {"user":"🔍 Firebase Functions Object Keys: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Object Keys: ["}}
[info] >    'app', {"user":"  'app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'app',"}}
[info] >    'emulatorOrigin', {"user":"  'emulatorOrigin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'emulatorOrigin',"}}
[info] >    'contextProvider', {"user":"  'contextProvider',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'contextProvider',"}}
[info] >    'deleteService', {"user":"  'deleteService',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'deleteService',"}}
[info] >    'cancelAllRequests', {"user":"  'cancelAllRequests',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'cancelAllRequests',"}}
[info] >    'customDomain', {"user":"  'customDomain',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'customDomain',"}}
[info] >    'region' {"user":"  'region'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'region'"}}
[info] >  ] {"user":"]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ]"}}
[info] >  🔍 Firebase Functions Instance: FunctionsService { {"user":"🔍 Firebase Functions Instance: FunctionsService {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Instance: FunctionsService {"}}
[info] >    app: FirebaseAppImpl { {"user":"  app: FirebaseAppImpl {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   app: FirebaseAppImpl {"}}
[info] >      _isDeleted: false, {"user":"    _isDeleted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _isDeleted: false,"}}
[info] >      _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }, {"user":"    _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },"}}
[info] >      _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false }, {"user":"    _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },"}}
[info] >      _name: '[DEFAULT]', {"user":"    _name: '[DEFAULT]',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _name: '[DEFAULT]',"}}
[info] >      _automaticDataCollectionEnabled: false, {"user":"    _automaticDataCollectionEnabled: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _automaticDataCollectionEnabled: false,"}}
[info] >      _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] } {"user":"    _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    emulatorOrigin: 'http://localhost:5001', {"user":"  emulatorOrigin: 'http://localhost:5001',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorOrigin: 'http://localhost:5001',"}}
[info] >    contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null }, {"user":"  contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },"}}
[info] >    deleteService: [Function (anonymous)], {"user":"  deleteService: [Function (anonymous)],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   deleteService: [Function (anonymous)],"}}
[info] >    cancelAllRequests: Promise { <pending> }, {"user":"  cancelAllRequests: Promise { <pending> },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   cancelAllRequests: Promise { <pending> },"}}
[info] >    customDomain: null, {"user":"  customDomain: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   customDomain: null,"}}
[info] >    region: 'us-central1' {"user":"  region: 'us-central1'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   region: 'us-central1'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' } {"user":"🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }"}}
[info] >  🔧 Deleting existing Firebase client apps {"user":"🔧 Deleting existing Firebase client apps","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Deleting existing Firebase client apps"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[info] >  🔍 Save Chat History Function Details: { {"user":"🔍 Save Chat History Function Details: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Save Chat History Function Details: {"}}
[info] >    functionExists: true, {"user":"  functionExists: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionExists: true,"}}
[info] >    functionType: 'function', {"user":"  functionType: 'function',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionType: 'function',"}}
[info] >    functionName: 'saveChatHistory' {"user":"  functionName: 'saveChatHistory'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionName: 'saveChatHistory'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📤 Chat History Payload: { {"user":"📤 Chat History Payload: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Chat History Payload: {"}}
[info] >    "userId": "xDxECJtJiNdgFeQ9L95cAi5LBwzM", {"user":"  \"userId\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"userId\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\","}}
[info] >    "chatId": "chat-1731459865343-6idv7y8cg", {"user":"  \"chatId\": \"chat-1731459865343-6idv7y8cg\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"chatId\": \"chat-1731459865343-6idv7y8cg\","}}
[info] >    "messages": [ {"user":"  \"messages\": [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"messages\": ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "user", {"user":"      \"role\": \"user\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"user\","}}
[info] >        "content": "hi", {"user":"      \"content\": \"hi\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"hi\","}}
[info] >        "timestamp": "2024-11-13T01:04:27.595Z" {"user":"      \"timestamp\": \"2024-11-13T01:04:27.595Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T01:04:27.595Z\""}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "model", {"user":"      \"role\": \"model\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"model\","}}
[info] >        "content": "Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you looking for general relationship advice?  Let's talk!\n", {"user":"      \"content\": \"Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you looking for general relationship advice?  Let's talk!\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you looking for general relationship advice?  Let's talk!\\n\","}}
[info] >        "timestamp": "2024-11-13T01:04:27.595Z" {"user":"      \"timestamp\": \"2024-11-13T01:04:27.595Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T01:04:27.595Z\""}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    "timestamp": "2024-11-13T01:04:27.595Z" {"user":"  \"timestamp\": \"2024-11-13T01:04:27.595Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"timestamp\": \"2024-11-13T01:04:27.595Z\""}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ❌ COMPREHENSIVE Save Chat History Error (Enhanced): { {"user":"❌ COMPREHENSIVE Save Chat History Error (Enhanced): {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ COMPREHENSIVE Save Chat History Error (Enhanced): {"}}
[info] >    errorType: 'object', {"user":"  errorType: 'object',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorType: 'object',"}}
[info] >    errorInstance: true, {"user":"  errorInstance: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorInstance: true,"}}
[info] >    fullErrorObject: [FunctionsError [FirebaseError]: Firebase Functions instance was deleted.] { {"user":"  fullErrorObject: [FunctionsError [FirebaseError]: Firebase Functions instance was deleted.] {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   fullErrorObject: [FunctionsError [FirebaseError]: Firebase Functions instance was deleted.] {"}}
[info] >      code: 'functions/cancelled', {"user":"    code: 'functions/cancelled',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 'functions/cancelled',"}}
[info] >      customData: undefined, {"user":"    customData: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     customData: undefined,"}}
[info] >      details: undefined {"user":"    details: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     details: undefined"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    stringRepresentation: 'FirebaseError: Firebase Functions instance was deleted.', {"user":"  stringRepresentation: 'FirebaseError: Firebase Functions instance was deleted.',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   stringRepresentation: 'FirebaseError: Firebase Functions instance was deleted.',"}}
[info] >    adminAppConfig: { {"user":"  adminAppConfig: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   adminAppConfig: {"}}
[info] >      storageBucket: 'notalone-de4fc.firebasestorage.app', {"user":"    storageBucket: 'notalone-de4fc.firebasestorage.app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     storageBucket: 'notalone-de4fc.firebasestorage.app',"}}
[info] >      projectId: 'notalone-de4fc', {"user":"    projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     projectId: 'notalone-de4fc',"}}
[info] >      credential: RefreshTokenCredential { {"user":"    credential: RefreshTokenCredential {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     credential: RefreshTokenCredential {"}}
[info] >        httpAgent: undefined, {"user":"      httpAgent: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpAgent: undefined,"}}
[info] >        implicit: true, {"user":"      implicit: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       implicit: true,"}}
[info] >        refreshToken: [RefreshToken], {"user":"      refreshToken: [RefreshToken],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       refreshToken: [RefreshToken],"}}
[info] >        httpClient: [HttpClient] {"user":"      httpClient: [HttpClient]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpClient: [HttpClient]"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ❌ Detailed Error Breakdown (Enhanced): { {"user":"❌ Detailed Error Breakdown (Enhanced): {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ Detailed Error Breakdown (Enhanced): {"}}
[info] >    errorName: 'FirebaseError', {"user":"  errorName: 'FirebaseError',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorName: 'FirebaseError',"}}
[info] >    errorCode: 'functions/cancelled', {"user":"  errorCode: 'functions/cancelled',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorCode: 'functions/cancelled',"}}
[info] >    errorMessage: 'Firebase Functions instance was deleted.', {"user":"  errorMessage: 'Firebase Functions instance was deleted.',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorMessage: 'Firebase Functions instance was deleted.',"}}
[info] >    errorStack: 'FirebaseError: Firebase Functions instance was deleted.' {"user":"  errorStack: 'FirebaseError: Firebase Functions instance was deleted.'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorStack: 'FirebaseError: Firebase Functions instance was deleted.'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T01:04:27.654Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2331.71ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2331.71ms"}}
[debug] [2024-11-13T01:04:27.656Z] [worker-us-central1-processChat-df2acf2e-cebf-4d0b-aff0-cc628efd4455]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-df2acf2e-cebf-4d0b-aff0-cc628efd4455]: IDLE"}}
[debug] [2024-11-13T01:04:27.656Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:04:27.656Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:04:27.656Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:04:27.657Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T01:04:27.657Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:04:27.657Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T01:04:27.657Z"],"workRunningCount":1}
[debug] [2024-11-13T01:04:27.658Z] Accepted request POST /notalone-de4fc/us-central1/saveChatHistory --> us-central1-saveChatHistory
[debug] [2024-11-13T01:04:27.659Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:04:27.659Z] [functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/"}}
[debug] [2024-11-13T01:04:27.671Z] [worker-pool] addWorker(us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-saveChatHistory)"}}
[debug] [2024-11-13T01:04:27.671Z] [worker-pool] Adding worker with key us-central1-saveChatHistory, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-saveChatHistory, total=1"}}
[debug] [2024-11-13T01:04:29.256Z] [runtime-status] [30020] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [30020] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:04:29.258Z] [runtime-status] [30020] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [30020] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:04:29.258Z] [runtime-status] [30020] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [30020] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T01:04:29.259Z] [runtime-status] [30020] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [30020] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T01:04:29.260Z] [runtime-status] [30020] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [30020] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:04:29.571Z] [runtime-status] [30020] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [30020] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T01:04:29.572Z] [runtime-status] [30020] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [30020] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T01:04:29.572Z] [runtime-status] [30020] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [30020] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:04:29.577Z] [runtime-status] [30020] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [30020] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:04:29.580Z] [runtime-status] [30020] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [30020] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:04:29.580Z] [runtime-status] [30020] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [30020] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T01:04:29.689Z] [runtime-status] [30020] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [30020] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T01:04:29.699Z] [runtime-status] [30020] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [30020] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T01:04:29.700Z] [runtime-status] [30020] Listening to port: \\?\pipe\fire_emu_b448bbbad75932a1 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [30020] Listening to port: \\\\?\\pipe\\fire_emu_b448bbbad75932a1"}}
[debug] [2024-11-13T01:04:29.755Z] [worker-us-central1-saveChatHistory-e4871d55-be8a-47b3-9c5f-f11003be8e3a]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-e4871d55-be8a-47b3-9c5f-f11003be8e3a]: IDLE"}}
[debug] [2024-11-13T01:04:29.755Z] [worker-pool] submitRequest(triggerId=us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-saveChatHistory)"}}
[info] i  functions: Beginning execution of "us-central1-saveChatHistory" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Beginning execution of \"us-central1-saveChatHistory\""}}
[debug] [2024-11-13T01:04:29.755Z] [worker-us-central1-saveChatHistory-e4871d55-be8a-47b3-9c5f-f11003be8e3a]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-e4871d55-be8a-47b3-9c5f-f11003be8e3a]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"MISSING\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  {"severity":"ERROR","message":"Unhandled error TypeError: Converting circular structure to JSON\n    --> starting at object with constructor 'Socket'\n    |     property 'parser' -> object with constructor 'HTTPParser'\n    --- property 'socket' closes the circle\n    at JSON.stringify (<anonymous>)\n    at C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js:44:27\n    at C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\onInit.js:33:16\n    at fixedLen (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\providers\\https.js:135:62)\n    at C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:32\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)\n    at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)\n    at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21"} {"user":{"severity":"ERROR","message":"Unhandled error TypeError: Converting circular structure to JSON\n    --> starting at object with constructor 'Socket'\n    |     property 'parser' -> object with constructor 'HTTPParser'\n    --- property 'socket' closes the circle\n    at JSON.stringify (<anonymous>)\n    at C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js:44:27\n    at C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\onInit.js:33:16\n    at fixedLen (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\providers\\https.js:135:62)\n    at C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:32\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)\n    at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)\n    at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"severity\":\"ERROR\",\"message\":\"Unhandled error TypeError: Converting circular structure to JSON\\n    --> starting at object with constructor 'Socket'\\n    |     property 'parser' -> object with constructor 'HTTPParser'\\n    --- property 'socket' closes the circle\\n    at JSON.stringify (<anonymous>)\\n    at C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\lib\\\\chatHistory.js:44:27\\n    at C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\common\\\\onInit.js:33:16\\n    at fixedLen (C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\providers\\\\https.js:135:62)\\n    at C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\common\\\\providers\\\\https.js:467:32\\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\\n    at async runFunction (C:\\\\Users\\\\Rob\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\firebase-tools\\\\lib\\\\emulator\\\\functionsEmulatorRuntime.js:506:9)\\n    at async runHTTPS (C:\\\\Users\\\\Rob\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\firebase-tools\\\\lib\\\\emulator\\\\functionsEmulatorRuntime.js:531:5)\\n    at async C:\\\\Users\\\\Rob\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\firebase-tools\\\\lib\\\\emulator\\\\functionsEmulatorRuntime.js:694:21\"}"}}
[debug] [2024-11-13T01:04:29.776Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-saveChatHistory" in 21.0091ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finished \"us-central1-saveChatHistory\" in 21.0091ms"}}
[debug] [2024-11-13T01:04:29.777Z] [worker-us-central1-saveChatHistory-e4871d55-be8a-47b3-9c5f-f11003be8e3a]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-e4871d55-be8a-47b3-9c5f-f11003be8e3a]: IDLE"}}
[debug] [2024-11-13T01:04:29.777Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:04:29.777Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:04:29.777Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:05:36.199Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T01:05:37.201Z] Validating nodejs source
[debug] [2024-11-13T01:05:38.143Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:05:38.143Z] Building nodejs source
[debug] [2024-11-13T01:05:38.143Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:05:38.144Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:05:38.153Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8065

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:05:38.867Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:05:42.891Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:05:42.892Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:05:42.893Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-13T01:05:42.893Z] [worker-us-central1-processChat-df2acf2e-cebf-4d0b-aff0-cc628efd4455]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-df2acf2e-cebf-4d0b-aff0-cc628efd4455]: FINISHING"}}
[debug] [2024-11-13T01:05:42.893Z] [worker-pool] Shutting down IDLE worker (us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-saveChatHistory)"}}
[debug] [2024-11-13T01:05:42.893Z] [worker-us-central1-saveChatHistory-e4871d55-be8a-47b3-9c5f-f11003be8e3a]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-e4871d55-be8a-47b3-9c5f-f11003be8e3a]: FINISHING"}}
[debug] [2024-11-13T01:05:42.906Z] [worker-us-central1-saveChatHistory-e4871d55-be8a-47b3-9c5f-f11003be8e3a]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-e4871d55-be8a-47b3-9c5f-f11003be8e3a]: exited"}}
[debug] [2024-11-13T01:05:42.906Z] [worker-us-central1-saveChatHistory-e4871d55-be8a-47b3-9c5f-f11003be8e3a]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-e4871d55-be8a-47b3-9c5f-f11003be8e3a]: FINISHED"}}
[debug] [2024-11-13T01:05:42.907Z] [worker-us-central1-processChat-df2acf2e-cebf-4d0b-aff0-cc628efd4455]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-df2acf2e-cebf-4d0b-aff0-cc628efd4455]: exited"}}
[debug] [2024-11-13T01:05:42.907Z] [worker-us-central1-processChat-df2acf2e-cebf-4d0b-aff0-cc628efd4455]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-df2acf2e-cebf-4d0b-aff0-cc628efd4455]: FINISHED"}}
[debug] [2024-11-13T01:06:40.915Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T01:06:41.915Z] Validating nodejs source
[debug] [2024-11-13T01:06:42.949Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:06:42.950Z] Building nodejs source
[debug] [2024-11-13T01:06:42.950Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:06:42.951Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:06:42.964Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8782

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:06:43.662Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:06:47.694Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:06:47.695Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:06:53.595Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T01:06:54.608Z] Validating nodejs source
[debug] [2024-11-13T01:06:55.545Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:06:55.546Z] Building nodejs source
[debug] [2024-11-13T01:06:55.546Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:06:55.548Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:06:55.562Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8835

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:06:56.272Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:07:00.305Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:07:00.306Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:07:02.925Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:07:02.926Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js changed, reloading triggers"}}
[debug] [2024-11-13T01:07:02.952Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:07:02.962Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-13T01:07:03.969Z] Validating nodejs source
[debug] [2024-11-13T01:07:05.023Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:07:05.024Z] Building nodejs source
[debug] [2024-11-13T01:07:05.024Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:07:05.025Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:07:05.033Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8485

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:07:05.774Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:07:09.805Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:07:09.805Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:07:12.039Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:07:12.039Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:07:12.039Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:07:12.039Z"],"workRunningCount":1}
[debug] [2024-11-13T01:07:12.039Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T01:07:12.042Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:07:12.042Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T01:07:12.042Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-13T01:07:12.042Z] [worker-pool] Cleaned up workers for us-central1-saveChatHistory: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-saveChatHistory: 1 --> 0"}}
[debug] [2024-11-13T01:07:12.053Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-13T01:07:12.053Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-13T01:07:13.618Z] [runtime-status] [23568] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23568] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:07:13.620Z] [runtime-status] [23568] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23568] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:07:13.620Z] [runtime-status] [23568] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23568] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T01:07:13.621Z] [runtime-status] [23568] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23568] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T01:07:13.622Z] [runtime-status] [23568] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23568] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:07:13.931Z] [runtime-status] [23568] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23568] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T01:07:13.931Z] [runtime-status] [23568] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23568] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T01:07:13.932Z] [runtime-status] [23568] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23568] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:07:13.938Z] [runtime-status] [23568] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23568] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:07:13.940Z] [runtime-status] [23568] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23568] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:07:13.940Z] [runtime-status] [23568] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23568] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T01:07:14.050Z] [runtime-status] [23568] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23568] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T01:07:14.060Z] [runtime-status] [23568] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23568] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T01:07:14.061Z] [runtime-status] [23568] Listening to port: \\?\pipe\fire_emu_04a7c0751a982af7 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23568] Listening to port: \\\\?\\pipe\\fire_emu_04a7c0751a982af7"}}
[debug] [2024-11-13T01:07:14.142Z] [worker-us-central1-processChat-5428dd12-18ff-4742-8803-2d7825aa9c3e]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5428dd12-18ff-4742-8803-2d7825aa9c3e]: IDLE"}}
[debug] [2024-11-13T01:07:14.143Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T01:07:14.143Z] [worker-us-central1-processChat-5428dd12-18ff-4742-8803-2d7825aa9c3e]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5428dd12-18ff-4742-8803-2d7825aa9c3e]: BUSY"}}
[debug] [2024-11-13T01:07:14.147Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 3.5621ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 3.5621ms"}}
[debug] [2024-11-13T01:07:14.148Z] [worker-us-central1-processChat-5428dd12-18ff-4742-8803-2d7825aa9c3e]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5428dd12-18ff-4742-8803-2d7825aa9c3e]: IDLE"}}
[debug] [2024-11-13T01:07:14.148Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:07:14.148Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:07:14.148Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:07:14.148Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:07:14.148Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:07:14.148Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:07:14.148Z"],"workRunningCount":1}
[debug] [2024-11-13T01:07:14.148Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T01:07:14.149Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:07:14.149Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T01:07:14.149Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T01:07:14.153Z] [worker-us-central1-processChat-5428dd12-18ff-4742-8803-2d7825aa9c3e]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5428dd12-18ff-4742-8803-2d7825aa9c3e]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi' } } {"user":"🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi' } }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi' } }"}}
[info] >  📝 Using chat ID: undefined {"user":"📝 Using chat ID: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: undefined"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 2, {"user":"  messageLength: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 2,"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: undefined {"user":"  chatId: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: undefined"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: chat-1731460034171-cuj30jz8t {"user":"🆕 Creating new chat session: chat-1731460034171-cuj30jz8t","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: chat-1731460034171-cuj30jz8t"}}
[info] >  📝 Chat session created: { chatId: 'chat-1731460034171-cuj30jz8t', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'chat-1731460034171-cuj30jz8t', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'chat-1731460034171-cuj30jz8t', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hi {"user":"💬 Sending message to Gemini: hi","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hi"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  📚 Current Chat History: { {"user":"📚 Current Chat History: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📚 Current Chat History: {"}}
[info] >    chatId: 'chat-1731460034171-cuj30jz8t', {"user":"  chatId: 'chat-1731460034171-cuj30jz8t',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731460034171-cuj30jz8t',"}}
[info] >    historyLength: 6, {"user":"  historyLength: 6,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   historyLength: 6,"}}
[info] >    lastMessages: [ {"user":"  lastMessages: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   lastMessages: ["}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'assistant', parts: [Array] }, {"user":"    { role: 'assistant', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'assistant', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] } {"user":"    { role: 'model', parts: [Array] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Response received: { responseLength: 536, timestamp: '2024-11-13T01:07:17.997Z' } {"user":"✅ Response received: { responseLength: 536, timestamp: '2024-11-13T01:07:17.997Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 536, timestamp: '2024-11-13T01:07:17.997Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: 'Hi there!  To help me understand your relationships and how I can assist you, please tell me a bit more.  For example:\n' + {"user":"  message: 'Hi there!  To help me understand your relationships and how I can assist you, please tell me a bit more.  For example:\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Hi there!  To help me understand your relationships and how I can assist you, please tell me a bit more.  For example:\\n' +"}}
[info] >      '\n' + {"user":"    '\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '\\n' +"}}
[info] >      '* **What kind of relationships are you interested in discussing?** (Romantic, familial, friendships, professional?)\n' + {"user":"    '* **What kind of relationships are you interested in discussing?** (Romantic, familial, friendships, professional?)\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '* **What kind of relationships are you interested in discussing?** (Romantic, familial, friendships, professional?)\\n' +"}}
[info] >      '* **What are your specific concerns or questions?** (e.g., communication problems, conflict resolution, trust issues, intimacy challenges)\n' + {"user":"    '* **What are your specific concerns or questions?** (e.g., communication problems, conflict resolution, trust issues, intimacy challenges)\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '* **What are your specific concerns or questions?** (e.g., communication problems, conflict resolution, trust issues, intimacy challenges)\\n' +"}}
[info] >      '* **What kind of support are you hoping for?** (e.g., advice, tools, strategies, understanding)\n' + {"user":"    '* **What kind of support are you hoping for?** (e.g., advice, tools, strategies, understanding)\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '* **What kind of support are you hoping for?** (e.g., advice, tools, strategies, understanding)\\n' +"}}
[info] >      '\n' + {"user":"    '\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '\\n' +"}}
[info] >      '\n' + {"user":"    '\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '\\n' +"}}
[info] >      'The more information you provide, the better I can assist you.\n', {"user":"    'The more information you provide, the better I can assist you.\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'The more information you provide, the better I can assist you.\\n',"}}
[info] >    userMessage: 'hi', {"user":"  userMessage: 'hi',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hi',"}}
[info] >    timestamp: '2024-11-13T01:07:17.997Z', {"user":"  timestamp: '2024-11-13T01:07:17.997Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T01:07:17.997Z',"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731460034171-cuj30jz8t' {"user":"  chatId: 'chat-1731460034171-cuj30jz8t'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731460034171-cuj30jz8t'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Attempting to save chat history with DETAILED logging: { {"user":"🔍 Attempting to save chat history with DETAILED logging: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Attempting to save chat history with DETAILED logging: {"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731460034171-cuj30jz8t', {"user":"  chatId: 'chat-1731460034171-cuj30jz8t',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731460034171-cuj30jz8t',"}}
[info] >    messageCount: 2, {"user":"  messageCount: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageCount: 2,"}}
[info] >    timestamp: '2024-11-13T01:07:17.998Z', {"user":"  timestamp: '2024-11-13T01:07:17.998Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T01:07:17.998Z',"}}
[info] >    clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' } {"user":"  clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔧 Firebase Client Configuration: { {"user":"🔧 Firebase Client Configuration: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Firebase Client Configuration: {"}}
[info] >    projectId: 'notalone-de4fc', {"user":"  projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   projectId: 'notalone-de4fc',"}}
[info] >    apiKey: 'local-api-key', {"user":"  apiKey: 'local-api-key',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   apiKey: 'local-api-key',"}}
[info] >    authDomain: undefined, {"user":"  authDomain: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   authDomain: undefined,"}}
[info] >    emulatorHost: 'localhost', {"user":"  emulatorHost: 'localhost',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorHost: 'localhost',"}}
[info] >    emulatorPort: 5001 {"user":"  emulatorPort: 5001","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorPort: 5001"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Firebase Functions Object Keys: [ {"user":"🔍 Firebase Functions Object Keys: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Object Keys: ["}}
[info] >    'app', {"user":"  'app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'app',"}}
[info] >    'emulatorOrigin', {"user":"  'emulatorOrigin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'emulatorOrigin',"}}
[info] >    'contextProvider', {"user":"  'contextProvider',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'contextProvider',"}}
[info] >    'deleteService', {"user":"  'deleteService',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'deleteService',"}}
[info] >    'cancelAllRequests', {"user":"  'cancelAllRequests',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'cancelAllRequests',"}}
[info] >    'customDomain', {"user":"  'customDomain',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'customDomain',"}}
[info] >    'region' {"user":"  'region'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'region'"}}
[info] >  ] {"user":"]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ]"}}
[info] >  🔍 Firebase Functions Instance: FunctionsService { {"user":"🔍 Firebase Functions Instance: FunctionsService {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Instance: FunctionsService {"}}
[info] >    app: FirebaseAppImpl { {"user":"  app: FirebaseAppImpl {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   app: FirebaseAppImpl {"}}
[info] >      _isDeleted: false, {"user":"    _isDeleted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _isDeleted: false,"}}
[info] >      _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }, {"user":"    _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },"}}
[info] >      _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false }, {"user":"    _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },"}}
[info] >      _name: '[DEFAULT]', {"user":"    _name: '[DEFAULT]',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _name: '[DEFAULT]',"}}
[info] >      _automaticDataCollectionEnabled: false, {"user":"    _automaticDataCollectionEnabled: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _automaticDataCollectionEnabled: false,"}}
[info] >      _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] } {"user":"    _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    emulatorOrigin: 'http://localhost:5001', {"user":"  emulatorOrigin: 'http://localhost:5001',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorOrigin: 'http://localhost:5001',"}}
[info] >    contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null }, {"user":"  contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },"}}
[info] >    deleteService: [Function (anonymous)], {"user":"  deleteService: [Function (anonymous)],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   deleteService: [Function (anonymous)],"}}
[info] >    cancelAllRequests: Promise { <pending> }, {"user":"  cancelAllRequests: Promise { <pending> },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   cancelAllRequests: Promise { <pending> },"}}
[info] >    customDomain: null, {"user":"  customDomain: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   customDomain: null,"}}
[info] >    region: 'us-central1' {"user":"  region: 'us-central1'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   region: 'us-central1'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' } {"user":"🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[info] >  🔍 Save Chat History Function Details: { {"user":"🔍 Save Chat History Function Details: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Save Chat History Function Details: {"}}
[info] >    functionExists: true, {"user":"  functionExists: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionExists: true,"}}
[info] >    functionType: 'function', {"user":"  functionType: 'function',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionType: 'function',"}}
[info] >    functionName: 'saveChatHistory' {"user":"  functionName: 'saveChatHistory'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionName: 'saveChatHistory'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📤 Chat History Payload: { {"user":"📤 Chat History Payload: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Chat History Payload: {"}}
[info] >    "userId": "xDxECJtJiNdgFeQ9L95cAi5LBwzM", {"user":"  \"userId\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"userId\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\","}}
[info] >    "chatId": "chat-1731460034171-cuj30jz8t", {"user":"  \"chatId\": \"chat-1731460034171-cuj30jz8t\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"chatId\": \"chat-1731460034171-cuj30jz8t\","}}
[info] >    "messages": [ {"user":"  \"messages\": [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"messages\": ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "user", {"user":"      \"role\": \"user\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"user\","}}
[info] >        "content": "hi", {"user":"      \"content\": \"hi\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"hi\","}}
[info] >        "timestamp": "2024-11-13T01:07:18.000Z" {"user":"      \"timestamp\": \"2024-11-13T01:07:18.000Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T01:07:18.000Z\""}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "model", {"user":"      \"role\": \"model\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"model\","}}
[info] >        "content": "Hi there!  To help me understand your relationships and how I can assist you, please tell me a bit more.  For example:\n\n* **What kind of relationships are you interested in discussing?** (Romantic, familial, friendships, professional?)\n* **What are your specific concerns or questions?** (e.g., communication problems, conflict resolution, trust issues, intimacy challenges)\n* **What kind of support are you hoping for?** (e.g., advice, tools, strategies, understanding)\n\n\nThe more information you provide, the better I can assist you.\n", {"user":"      \"content\": \"Hi there!  To help me understand your relationships and how I can assist you, please tell me a bit more.  For example:\\n\\n* **What kind of relationships are you interested in discussing?** (Romantic, familial, friendships, professional?)\\n* **What are your specific concerns or questions?** (e.g., communication problems, conflict resolution, trust issues, intimacy challenges)\\n* **What kind of support are you hoping for?** (e.g., advice, tools, strategies, understanding)\\n\\n\\nThe more information you provide, the better I can assist you.\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"Hi there!  To help me understand your relationships and how I can assist you, please tell me a bit more.  For example:\\n\\n* **What kind of relationships are you interested in discussing?** (Romantic, familial, friendships, professional?)\\n* **What are your specific concerns or questions?** (e.g., communication problems, conflict resolution, trust issues, intimacy challenges)\\n* **What kind of support are you hoping for?** (e.g., advice, tools, strategies, understanding)\\n\\n\\nThe more information you provide, the better I can assist you.\\n\","}}
[info] >        "timestamp": "2024-11-13T01:07:18.000Z" {"user":"      \"timestamp\": \"2024-11-13T01:07:18.000Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T01:07:18.000Z\""}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    "timestamp": "2024-11-13T01:07:18.000Z" {"user":"  \"timestamp\": \"2024-11-13T01:07:18.000Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"timestamp\": \"2024-11-13T01:07:18.000Z\""}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T01:07:18.070Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T01:07:18.070Z"],"queueLength":1,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:07:14.148Z"],"workRunningCount":1}
[debug] [2024-11-13T01:07:18.070Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:07:14.148Z","/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T01:07:18.070Z"],"workRunningCount":2}
[debug] [2024-11-13T01:07:18.070Z] Accepted request POST /notalone-de4fc/us-central1/saveChatHistory --> us-central1-saveChatHistory
[debug] [2024-11-13T01:07:18.072Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:07:18.072Z] [functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/"}}
[debug] [2024-11-13T01:07:18.087Z] [worker-pool] addWorker(us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-saveChatHistory)"}}
[debug] [2024-11-13T01:07:18.088Z] [worker-pool] Adding worker with key us-central1-saveChatHistory, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-saveChatHistory, total=1"}}
[debug] [2024-11-13T01:07:19.848Z] [runtime-status] [33312] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [33312] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:07:19.849Z] [runtime-status] [33312] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [33312] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:07:19.850Z] [runtime-status] [33312] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [33312] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T01:07:19.850Z] [runtime-status] [33312] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [33312] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T01:07:19.851Z] [runtime-status] [33312] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [33312] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:07:20.267Z] [runtime-status] [33312] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [33312] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T01:07:20.267Z] [runtime-status] [33312] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [33312] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T01:07:20.268Z] [runtime-status] [33312] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [33312] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:07:20.275Z] [runtime-status] [33312] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [33312] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:07:20.278Z] [runtime-status] [33312] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [33312] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:07:20.279Z] [runtime-status] [33312] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [33312] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T01:07:20.412Z] [runtime-status] [33312] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [33312] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T01:07:20.424Z] [runtime-status] [33312] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [33312] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T01:07:20.426Z] [runtime-status] [33312] Listening to port: \\?\pipe\fire_emu_f29eef6fb2a104de {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [33312] Listening to port: \\\\?\\pipe\\fire_emu_f29eef6fb2a104de"}}
[debug] [2024-11-13T01:07:20.495Z] [worker-us-central1-saveChatHistory-a21c9a0a-6d2f-4c18-893e-77a8f42f1b68]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-a21c9a0a-6d2f-4c18-893e-77a8f42f1b68]: IDLE"}}
[debug] [2024-11-13T01:07:20.495Z] [worker-pool] submitRequest(triggerId=us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-saveChatHistory)"}}
[info] i  functions: Beginning execution of "us-central1-saveChatHistory" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Beginning execution of \"us-central1-saveChatHistory\""}}
[debug] [2024-11-13T01:07:20.496Z] [worker-us-central1-saveChatHistory-a21c9a0a-6d2f-4c18-893e-77a8f42f1b68]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-a21c9a0a-6d2f-4c18-893e-77a8f42f1b68]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"MISSING\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  {"severity":"ERROR","message":"Unhandled error TypeError: Converting circular structure to JSON\n    --> starting at object with constructor 'Socket'\n    |     property 'parser' -> object with constructor 'HTTPParser'\n    --- property 'socket' closes the circle\n    at JSON.stringify (<anonymous>)\n    at C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js:44:27\n    at C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\onInit.js:33:16\n    at fixedLen (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\providers\\https.js:135:62)\n    at C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:32\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)\n    at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)\n    at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21"} {"user":{"severity":"ERROR","message":"Unhandled error TypeError: Converting circular structure to JSON\n    --> starting at object with constructor 'Socket'\n    |     property 'parser' -> object with constructor 'HTTPParser'\n    --- property 'socket' closes the circle\n    at JSON.stringify (<anonymous>)\n    at C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js:44:27\n    at C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\onInit.js:33:16\n    at fixedLen (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\providers\\https.js:135:62)\n    at C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:32\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)\n    at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)\n    at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"severity\":\"ERROR\",\"message\":\"Unhandled error TypeError: Converting circular structure to JSON\\n    --> starting at object with constructor 'Socket'\\n    |     property 'parser' -> object with constructor 'HTTPParser'\\n    --- property 'socket' closes the circle\\n    at JSON.stringify (<anonymous>)\\n    at C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\lib\\\\chatHistory.js:44:27\\n    at C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\common\\\\onInit.js:33:16\\n    at fixedLen (C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\providers\\\\https.js:135:62)\\n    at C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\common\\\\providers\\\\https.js:467:32\\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\\n    at async runFunction (C:\\\\Users\\\\Rob\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\firebase-tools\\\\lib\\\\emulator\\\\functionsEmulatorRuntime.js:506:9)\\n    at async runHTTPS (C:\\\\Users\\\\Rob\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\firebase-tools\\\\lib\\\\emulator\\\\functionsEmulatorRuntime.js:531:5)\\n    at async C:\\\\Users\\\\Rob\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\firebase-tools\\\\lib\\\\emulator\\\\functionsEmulatorRuntime.js:694:21\"}"}}
[debug] [2024-11-13T01:07:20.521Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-saveChatHistory" in 24.9676ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finished \"us-central1-saveChatHistory\" in 24.9676ms"}}
[debug] [2024-11-13T01:07:20.522Z] [worker-us-central1-saveChatHistory-a21c9a0a-6d2f-4c18-893e-77a8f42f1b68]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-a21c9a0a-6d2f-4c18-893e-77a8f42f1b68]: IDLE"}}
[debug] [2024-11-13T01:07:20.522Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:07:20.523Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:07:20.523Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:07:14.148Z"],"workRunningCount":1}
[info] >  ❌ COMPREHENSIVE Save Chat History Error (Enhanced): { {"user":"❌ COMPREHENSIVE Save Chat History Error (Enhanced): {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ COMPREHENSIVE Save Chat History Error (Enhanced): {"}}
[info] >    errorType: 'object', {"user":"  errorType: 'object',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorType: 'object',"}}
[info] >    errorInstance: true, {"user":"  errorInstance: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorInstance: true,"}}
[info] >    fullErrorObject: [FunctionsError [FirebaseError]: INTERNAL] { {"user":"  fullErrorObject: [FunctionsError [FirebaseError]: INTERNAL] {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   fullErrorObject: [FunctionsError [FirebaseError]: INTERNAL] {"}}
[info] >      code: 'functions/internal', {"user":"    code: 'functions/internal',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 'functions/internal',"}}
[info] >      customData: undefined, {"user":"    customData: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     customData: undefined,"}}
[info] >      details: undefined {"user":"    details: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     details: undefined"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    stringRepresentation: 'FirebaseError: INTERNAL', {"user":"  stringRepresentation: 'FirebaseError: INTERNAL',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   stringRepresentation: 'FirebaseError: INTERNAL',"}}
[info] >    adminAppConfig: { {"user":"  adminAppConfig: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   adminAppConfig: {"}}
[info] >      storageBucket: 'notalone-de4fc.firebasestorage.app', {"user":"    storageBucket: 'notalone-de4fc.firebasestorage.app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     storageBucket: 'notalone-de4fc.firebasestorage.app',"}}
[info] >      projectId: 'notalone-de4fc', {"user":"    projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     projectId: 'notalone-de4fc',"}}
[info] >      credential: RefreshTokenCredential { {"user":"    credential: RefreshTokenCredential {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     credential: RefreshTokenCredential {"}}
[info] >        httpAgent: undefined, {"user":"      httpAgent: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpAgent: undefined,"}}
[info] >        implicit: true, {"user":"      implicit: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       implicit: true,"}}
[info] >        refreshToken: [RefreshToken], {"user":"      refreshToken: [RefreshToken],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       refreshToken: [RefreshToken],"}}
[info] >        httpClient: [HttpClient] {"user":"      httpClient: [HttpClient]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpClient: [HttpClient]"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T01:07:20.545Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 6392.9222ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 6392.9222ms"}}
[debug] [2024-11-13T01:07:20.547Z] [worker-us-central1-processChat-5428dd12-18ff-4742-8803-2d7825aa9c3e]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5428dd12-18ff-4742-8803-2d7825aa9c3e]: IDLE"}}
[debug] [2024-11-13T01:07:20.547Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:07:20.547Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:07:20.547Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  ❌ Detailed Error Breakdown (Enhanced): { {"user":"❌ Detailed Error Breakdown (Enhanced): {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ Detailed Error Breakdown (Enhanced): {"}}
[info] >    errorName: 'FirebaseError', {"user":"  errorName: 'FirebaseError',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorName: 'FirebaseError',"}}
[info] >    errorCode: 'functions/internal', {"user":"  errorCode: 'functions/internal',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorCode: 'functions/internal',"}}
[info] >    errorMessage: 'INTERNAL', {"user":"  errorMessage: 'INTERNAL',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorMessage: 'INTERNAL',"}}
[info] >    errorStack: 'FirebaseError: INTERNAL' {"user":"  errorStack: 'FirebaseError: INTERNAL'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorStack: 'FirebaseError: INTERNAL'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T01:08:52.959Z] File C:\Users\Rob\Apps\not-alone\functions\src\chatHistory.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\chatHistory.ts changed, reloading triggers"}}
[debug] [2024-11-13T01:08:53.969Z] Validating nodejs source
[debug] [2024-11-13T01:08:54.939Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:08:54.939Z] Building nodejs source
[debug] [2024-11-13T01:08:54.940Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:08:54.941Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:08:54.949Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8798

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:08:55.606Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:08:59.641Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:08:59.642Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:08:59.643Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-13T01:08:59.643Z] [worker-us-central1-processChat-5428dd12-18ff-4742-8803-2d7825aa9c3e]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5428dd12-18ff-4742-8803-2d7825aa9c3e]: FINISHING"}}
[debug] [2024-11-13T01:08:59.644Z] [worker-pool] Shutting down IDLE worker (us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-saveChatHistory)"}}
[debug] [2024-11-13T01:08:59.644Z] [worker-us-central1-saveChatHistory-a21c9a0a-6d2f-4c18-893e-77a8f42f1b68]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-a21c9a0a-6d2f-4c18-893e-77a8f42f1b68]: FINISHING"}}
[debug] [2024-11-13T01:08:59.656Z] [worker-us-central1-saveChatHistory-a21c9a0a-6d2f-4c18-893e-77a8f42f1b68]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-a21c9a0a-6d2f-4c18-893e-77a8f42f1b68]: exited"}}
[debug] [2024-11-13T01:08:59.657Z] [worker-us-central1-saveChatHistory-a21c9a0a-6d2f-4c18-893e-77a8f42f1b68]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-a21c9a0a-6d2f-4c18-893e-77a8f42f1b68]: FINISHED"}}
[debug] [2024-11-13T01:08:59.657Z] [worker-us-central1-processChat-5428dd12-18ff-4742-8803-2d7825aa9c3e]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5428dd12-18ff-4742-8803-2d7825aa9c3e]: exited"}}
[debug] [2024-11-13T01:08:59.657Z] [worker-us-central1-processChat-5428dd12-18ff-4742-8803-2d7825aa9c3e]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5428dd12-18ff-4742-8803-2d7825aa9c3e]: FINISHED"}}
[debug] [2024-11-13T01:09:42.272Z] File C:\Users\Rob\Apps\not-alone\functions\src\chatHistory.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\chatHistory.ts changed, reloading triggers"}}
[debug] [2024-11-13T01:09:43.277Z] Validating nodejs source
[debug] [2024-11-13T01:09:44.293Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:09:44.293Z] Building nodejs source
[debug] [2024-11-13T01:09:44.293Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:09:44.295Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:09:44.304Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8340

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:09:44.956Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:09:48.981Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:09:48.982Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:09:53.955Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:09:53.955Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js changed, reloading triggers"}}
[debug] [2024-11-13T01:09:53.988Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:09:53.988Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-13T01:09:54.992Z] Validating nodejs source
[debug] [2024-11-13T01:09:55.933Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:09:55.933Z] Building nodejs source
[debug] [2024-11-13T01:09:55.933Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:09:55.934Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:09:55.943Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8488

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:09:56.641Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:10:00.668Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:10:00.669Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:10:02.806Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:10:02.806Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:10:02.806Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:10:02.806Z"],"workRunningCount":1}
[debug] [2024-11-13T01:10:02.806Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T01:10:02.808Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:10:02.808Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T01:10:02.808Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-13T01:10:02.808Z] [worker-pool] Cleaned up workers for us-central1-saveChatHistory: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-saveChatHistory: 1 --> 0"}}
[debug] [2024-11-13T01:10:02.817Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-13T01:10:02.817Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-13T01:10:04.407Z] [runtime-status] [23636] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23636] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:10:04.409Z] [runtime-status] [23636] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23636] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:10:04.409Z] [runtime-status] [23636] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23636] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T01:10:04.409Z] [runtime-status] [23636] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23636] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T01:10:04.410Z] [runtime-status] [23636] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23636] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:10:04.733Z] [runtime-status] [23636] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23636] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T01:10:04.733Z] [runtime-status] [23636] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23636] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T01:10:04.734Z] [runtime-status] [23636] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23636] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:10:04.739Z] [runtime-status] [23636] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23636] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:10:04.741Z] [runtime-status] [23636] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23636] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:10:04.742Z] [runtime-status] [23636] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23636] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T01:10:04.849Z] [runtime-status] [23636] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23636] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T01:10:04.860Z] [runtime-status] [23636] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23636] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T01:10:04.861Z] [runtime-status] [23636] Listening to port: \\?\pipe\fire_emu_d851a5f0dbf279cc {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23636] Listening to port: \\\\?\\pipe\\fire_emu_d851a5f0dbf279cc"}}
[debug] [2024-11-13T01:10:04.919Z] [worker-us-central1-processChat-ae48ca32-91ed-4572-8aa6-eefcbed815a2]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-ae48ca32-91ed-4572-8aa6-eefcbed815a2]: IDLE"}}
[debug] [2024-11-13T01:10:04.919Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T01:10:04.920Z] [worker-us-central1-processChat-ae48ca32-91ed-4572-8aa6-eefcbed815a2]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-ae48ca32-91ed-4572-8aa6-eefcbed815a2]: BUSY"}}
[debug] [2024-11-13T01:10:04.923Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 3.9568ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 3.9568ms"}}
[debug] [2024-11-13T01:10:04.924Z] [worker-us-central1-processChat-ae48ca32-91ed-4572-8aa6-eefcbed815a2]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-ae48ca32-91ed-4572-8aa6-eefcbed815a2]: IDLE"}}
[debug] [2024-11-13T01:10:04.925Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:10:04.925Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:10:04.925Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:10:04.926Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:10:04.926Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:10:04.926Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:10:04.926Z"],"workRunningCount":1}
[debug] [2024-11-13T01:10:04.926Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T01:10:04.927Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:10:04.927Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T01:10:04.927Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T01:10:04.928Z] [worker-us-central1-processChat-ae48ca32-91ed-4572-8aa6-eefcbed815a2]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-ae48ca32-91ed-4572-8aa6-eefcbed815a2]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi' } } {"user":"🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi' } }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi' } }"}}
[info] >  📝 Using chat ID: undefined {"user":"📝 Using chat ID: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: undefined"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 2, {"user":"  messageLength: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 2,"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: undefined {"user":"  chatId: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: undefined"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: chat-1731460204947-k03uvvwbs {"user":"🆕 Creating new chat session: chat-1731460204947-k03uvvwbs","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: chat-1731460204947-k03uvvwbs"}}
[info] >  📝 Chat session created: { chatId: 'chat-1731460204947-k03uvvwbs', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'chat-1731460204947-k03uvvwbs', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'chat-1731460204947-k03uvvwbs', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hi {"user":"💬 Sending message to Gemini: hi","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hi"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  📚 Current Chat History: { {"user":"📚 Current Chat History: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📚 Current Chat History: {"}}
[info] >    chatId: 'chat-1731460204947-k03uvvwbs', {"user":"  chatId: 'chat-1731460204947-k03uvvwbs',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731460204947-k03uvvwbs',"}}
[info] >    historyLength: 6, {"user":"  historyLength: 6,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   historyLength: 6,"}}
[info] >    lastMessages: [ {"user":"  lastMessages: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   lastMessages: ["}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'assistant', parts: [Array] }, {"user":"    { role: 'assistant', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'assistant', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] } {"user":"    { role: 'model', parts: [Array] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Response received: { responseLength: 168, timestamp: '2024-11-13T01:10:07.154Z' } {"user":"✅ Response received: { responseLength: 168, timestamp: '2024-11-13T01:10:07.154Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 168, timestamp: '2024-11-13T01:10:07.154Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: 'Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\n', {"user":"  message: 'Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\\n',"}}
[info] >    userMessage: 'hi', {"user":"  userMessage: 'hi',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hi',"}}
[info] >    timestamp: '2024-11-13T01:10:07.154Z', {"user":"  timestamp: '2024-11-13T01:10:07.154Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T01:10:07.154Z',"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731460204947-k03uvvwbs' {"user":"  chatId: 'chat-1731460204947-k03uvvwbs'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731460204947-k03uvvwbs'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Attempting to save chat history with DETAILED logging: { {"user":"🔍 Attempting to save chat history with DETAILED logging: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Attempting to save chat history with DETAILED logging: {"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731460204947-k03uvvwbs', {"user":"  chatId: 'chat-1731460204947-k03uvvwbs',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731460204947-k03uvvwbs',"}}
[info] >    messageCount: 2, {"user":"  messageCount: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageCount: 2,"}}
[info] >    timestamp: '2024-11-13T01:10:07.154Z', {"user":"  timestamp: '2024-11-13T01:10:07.154Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T01:10:07.154Z',"}}
[info] >    clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' } {"user":"  clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔧 Firebase Client Configuration: { {"user":"🔧 Firebase Client Configuration: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Firebase Client Configuration: {"}}
[info] >    projectId: 'notalone-de4fc', {"user":"  projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   projectId: 'notalone-de4fc',"}}
[info] >    apiKey: 'local-api-key', {"user":"  apiKey: 'local-api-key',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   apiKey: 'local-api-key',"}}
[info] >    authDomain: undefined, {"user":"  authDomain: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   authDomain: undefined,"}}
[info] >    emulatorHost: 'localhost', {"user":"  emulatorHost: 'localhost',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorHost: 'localhost',"}}
[info] >    emulatorPort: 5001 {"user":"  emulatorPort: 5001","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorPort: 5001"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Firebase Functions Object Keys: [ {"user":"🔍 Firebase Functions Object Keys: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Object Keys: ["}}
[info] >    'app', {"user":"  'app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'app',"}}
[info] >    'emulatorOrigin', {"user":"  'emulatorOrigin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'emulatorOrigin',"}}
[info] >    'contextProvider', {"user":"  'contextProvider',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'contextProvider',"}}
[info] >    'deleteService', {"user":"  'deleteService',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'deleteService',"}}
[info] >    'cancelAllRequests', {"user":"  'cancelAllRequests',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'cancelAllRequests',"}}
[info] >    'customDomain', {"user":"  'customDomain',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'customDomain',"}}
[info] >    'region' {"user":"  'region'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'region'"}}
[info] >  ] {"user":"]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ]"}}
[info] >  🔍 Firebase Functions Instance: FunctionsService { {"user":"🔍 Firebase Functions Instance: FunctionsService {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Instance: FunctionsService {"}}
[info] >    app: FirebaseAppImpl { {"user":"  app: FirebaseAppImpl {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   app: FirebaseAppImpl {"}}
[info] >      _isDeleted: false, {"user":"    _isDeleted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _isDeleted: false,"}}
[info] >      _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }, {"user":"    _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },"}}
[info] >      _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false }, {"user":"    _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },"}}
[info] >      _name: '[DEFAULT]', {"user":"    _name: '[DEFAULT]',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _name: '[DEFAULT]',"}}
[info] >      _automaticDataCollectionEnabled: false, {"user":"    _automaticDataCollectionEnabled: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _automaticDataCollectionEnabled: false,"}}
[info] >      _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] } {"user":"    _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    emulatorOrigin: 'http://localhost:5001', {"user":"  emulatorOrigin: 'http://localhost:5001',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorOrigin: 'http://localhost:5001',"}}
[info] >    contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null }, {"user":"  contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },"}}
[info] >    deleteService: [Function (anonymous)], {"user":"  deleteService: [Function (anonymous)],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   deleteService: [Function (anonymous)],"}}
[info] >    cancelAllRequests: Promise { <pending> }, {"user":"  cancelAllRequests: Promise { <pending> },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   cancelAllRequests: Promise { <pending> },"}}
[info] >    customDomain: null, {"user":"  customDomain: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   customDomain: null,"}}
[info] >    region: 'us-central1' {"user":"  region: 'us-central1'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   region: 'us-central1'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' } {"user":"🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[info] >  🔍 Save Chat History Function Details: { {"user":"🔍 Save Chat History Function Details: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Save Chat History Function Details: {"}}
[info] >    functionExists: true, {"user":"  functionExists: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionExists: true,"}}
[info] >    functionType: 'function', {"user":"  functionType: 'function',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionType: 'function',"}}
[info] >    functionName: 'saveChatHistory' {"user":"  functionName: 'saveChatHistory'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionName: 'saveChatHistory'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📤 Chat History Payload: { {"user":"📤 Chat History Payload: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Chat History Payload: {"}}
[info] >    "userId": "xDxECJtJiNdgFeQ9L95cAi5LBwzM", {"user":"  \"userId\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"userId\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\","}}
[info] >    "chatId": "chat-1731460204947-k03uvvwbs", {"user":"  \"chatId\": \"chat-1731460204947-k03uvvwbs\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"chatId\": \"chat-1731460204947-k03uvvwbs\","}}
[info] >    "messages": [ {"user":"  \"messages\": [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"messages\": ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "user", {"user":"      \"role\": \"user\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"user\","}}
[info] >        "content": "hi", {"user":"      \"content\": \"hi\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"hi\","}}
[info] >        "timestamp": "2024-11-13T01:10:07.156Z" {"user":"      \"timestamp\": \"2024-11-13T01:10:07.156Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T01:10:07.156Z\""}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "model", {"user":"      \"role\": \"model\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"model\","}}
[info] >        "content": "Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\n", {"user":"      \"content\": \"Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\\n\","}}
[info] >        "timestamp": "2024-11-13T01:10:07.156Z" {"user":"      \"timestamp\": \"2024-11-13T01:10:07.156Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T01:10:07.156Z\""}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    "timestamp": "2024-11-13T01:10:07.156Z" {"user":"  \"timestamp\": \"2024-11-13T01:10:07.156Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"timestamp\": \"2024-11-13T01:10:07.156Z\""}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T01:10:07.203Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T01:10:07.203Z"],"queueLength":1,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:10:04.926Z"],"workRunningCount":1}
[debug] [2024-11-13T01:10:07.203Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:10:04.926Z","/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T01:10:07.203Z"],"workRunningCount":2}
[debug] [2024-11-13T01:10:07.203Z] Accepted request POST /notalone-de4fc/us-central1/saveChatHistory --> us-central1-saveChatHistory
[debug] [2024-11-13T01:10:07.204Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:10:07.204Z] [functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/"}}
[debug] [2024-11-13T01:10:07.215Z] [worker-pool] addWorker(us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-saveChatHistory)"}}
[debug] [2024-11-13T01:10:07.215Z] [worker-pool] Adding worker with key us-central1-saveChatHistory, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-saveChatHistory, total=1"}}
[debug] [2024-11-13T01:10:09.026Z] [runtime-status] [1760] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [1760] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:10:09.028Z] [runtime-status] [1760] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [1760] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:10:09.028Z] [runtime-status] [1760] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [1760] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T01:10:09.028Z] [runtime-status] [1760] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [1760] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T01:10:09.029Z] [runtime-status] [1760] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [1760] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:10:09.338Z] [runtime-status] [1760] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [1760] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T01:10:09.338Z] [runtime-status] [1760] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [1760] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T01:10:09.339Z] [runtime-status] [1760] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [1760] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:10:09.343Z] [runtime-status] [1760] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [1760] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:10:09.346Z] [runtime-status] [1760] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [1760] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:10:09.346Z] [runtime-status] [1760] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [1760] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T01:10:09.447Z] [runtime-status] [1760] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [1760] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T01:10:09.458Z] [runtime-status] [1760] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [1760] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T01:10:09.458Z] [runtime-status] [1760] Listening to port: \\?\pipe\fire_emu_7e15708dfbf96ddc {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [1760] Listening to port: \\\\?\\pipe\\fire_emu_7e15708dfbf96ddc"}}
[debug] [2024-11-13T01:10:09.513Z] [worker-us-central1-saveChatHistory-a57de3e8-7909-4b50-8f3a-7975968cb126]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-a57de3e8-7909-4b50-8f3a-7975968cb126]: IDLE"}}
[debug] [2024-11-13T01:10:09.513Z] [worker-pool] submitRequest(triggerId=us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-saveChatHistory)"}}
[info] i  functions: Beginning execution of "us-central1-saveChatHistory" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Beginning execution of \"us-central1-saveChatHistory\""}}
[debug] [2024-11-13T01:10:09.514Z] [worker-us-central1-saveChatHistory-a57de3e8-7909-4b50-8f3a-7975968cb126]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-a57de3e8-7909-4b50-8f3a-7975968cb126]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"MISSING\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🔍 COMPREHENSIVE saveChatHistory function called: { {"user":"🔍 COMPREHENSIVE saveChatHistory function called: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 COMPREHENSIVE saveChatHistory function called: {"}}
[info] >    timestamp: '2024-11-13T01:10:09.529Z', {"user":"  timestamp: '2024-11-13T01:10:09.529Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T01:10:09.529Z',"}}
[info] >    hasAuth: false, {"user":"  hasAuth: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   hasAuth: false,"}}
[info] >    requestDataType: 'object' {"user":"  requestDataType: 'object'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   requestDataType: 'object'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ❌ Invalid or missing userId {"user":"❌ Invalid or missing userId","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ Invalid or missing userId"}}
[debug] [2024-11-13T01:10:09.535Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-saveChatHistory" in 20.4972ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finished \"us-central1-saveChatHistory\" in 20.4972ms"}}
[debug] [2024-11-13T01:10:09.535Z] [worker-us-central1-saveChatHistory-a57de3e8-7909-4b50-8f3a-7975968cb126]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-a57de3e8-7909-4b50-8f3a-7975968cb126]: IDLE"}}
[debug] [2024-11-13T01:10:09.535Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:10:09.535Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:10:09.536Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:10:04.926Z"],"workRunningCount":1}
[info] >  ❌ COMPREHENSIVE Save Chat History Error (Enhanced): { {"user":"❌ COMPREHENSIVE Save Chat History Error (Enhanced): {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ COMPREHENSIVE Save Chat History Error (Enhanced): {"}}
[info] >    errorType: 'object', {"user":"  errorType: 'object',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorType: 'object',"}}
[info] >    errorInstance: true, {"user":"  errorInstance: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorInstance: true,"}}
[info] >    fullErrorObject: [FunctionsError [FirebaseError]: Invalid user ID] { {"user":"  fullErrorObject: [FunctionsError [FirebaseError]: Invalid user ID] {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   fullErrorObject: [FunctionsError [FirebaseError]: Invalid user ID] {"}}
[info] >      code: 'functions/invalid-argument', {"user":"    code: 'functions/invalid-argument',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 'functions/invalid-argument',"}}
[info] >      customData: undefined, {"user":"    customData: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     customData: undefined,"}}
[info] >      details: undefined {"user":"    details: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     details: undefined"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    stringRepresentation: 'FirebaseError: Invalid user ID', {"user":"  stringRepresentation: 'FirebaseError: Invalid user ID',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   stringRepresentation: 'FirebaseError: Invalid user ID',"}}
[info] >    adminAppConfig: { {"user":"  adminAppConfig: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   adminAppConfig: {"}}
[info] >      storageBucket: 'notalone-de4fc.firebasestorage.app', {"user":"    storageBucket: 'notalone-de4fc.firebasestorage.app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     storageBucket: 'notalone-de4fc.firebasestorage.app',"}}
[info] >      projectId: 'notalone-de4fc', {"user":"    projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     projectId: 'notalone-de4fc',"}}
[info] >      credential: RefreshTokenCredential { {"user":"    credential: RefreshTokenCredential {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     credential: RefreshTokenCredential {"}}
[info] >        httpAgent: undefined, {"user":"      httpAgent: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpAgent: undefined,"}}
[info] >        implicit: true, {"user":"      implicit: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       implicit: true,"}}
[info] >        refreshToken: [RefreshToken], {"user":"      refreshToken: [RefreshToken],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       refreshToken: [RefreshToken],"}}
[info] >        httpClient: [HttpClient] {"user":"      httpClient: [HttpClient]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpClient: [HttpClient]"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T01:10:09.550Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4621.6827ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4621.6827ms"}}
[debug] [2024-11-13T01:10:09.550Z] [worker-us-central1-processChat-ae48ca32-91ed-4572-8aa6-eefcbed815a2]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-ae48ca32-91ed-4572-8aa6-eefcbed815a2]: IDLE"}}
[debug] [2024-11-13T01:10:09.550Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:10:09.551Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:10:09.551Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  ❌ Detailed Error Breakdown (Enhanced): { {"user":"❌ Detailed Error Breakdown (Enhanced): {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ Detailed Error Breakdown (Enhanced): {"}}
[info] >    errorName: 'FirebaseError', {"user":"  errorName: 'FirebaseError',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorName: 'FirebaseError',"}}
[info] >    errorCode: 'functions/invalid-argument', {"user":"  errorCode: 'functions/invalid-argument',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorCode: 'functions/invalid-argument',"}}
[info] >    errorMessage: 'Invalid user ID', {"user":"  errorMessage: 'Invalid user ID',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorMessage: 'Invalid user ID',"}}
[info] >    errorStack: 'FirebaseError: Invalid user ID' {"user":"  errorStack: 'FirebaseError: Invalid user ID'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorStack: 'FirebaseError: Invalid user ID'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T01:12:04.661Z] File C:\Users\Rob\Apps\not-alone\functions\src\chatHistory.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\chatHistory.ts changed, reloading triggers"}}
[debug] [2024-11-13T01:12:05.675Z] Validating nodejs source
[debug] [2024-11-13T01:12:06.568Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:12:06.568Z] Building nodejs source
[debug] [2024-11-13T01:12:06.568Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:12:06.570Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:12:06.579Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8909

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:12:07.259Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:12:11.287Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:12:11.288Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:12:11.289Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-13T01:12:11.289Z] [worker-us-central1-processChat-ae48ca32-91ed-4572-8aa6-eefcbed815a2]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-ae48ca32-91ed-4572-8aa6-eefcbed815a2]: FINISHING"}}
[debug] [2024-11-13T01:12:11.290Z] [worker-pool] Shutting down IDLE worker (us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-saveChatHistory)"}}
[debug] [2024-11-13T01:12:11.290Z] [worker-us-central1-saveChatHistory-a57de3e8-7909-4b50-8f3a-7975968cb126]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-a57de3e8-7909-4b50-8f3a-7975968cb126]: FINISHING"}}
[debug] [2024-11-13T01:12:11.301Z] [worker-us-central1-processChat-ae48ca32-91ed-4572-8aa6-eefcbed815a2]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-ae48ca32-91ed-4572-8aa6-eefcbed815a2]: exited"}}
[debug] [2024-11-13T01:12:11.301Z] [worker-us-central1-processChat-ae48ca32-91ed-4572-8aa6-eefcbed815a2]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-ae48ca32-91ed-4572-8aa6-eefcbed815a2]: FINISHED"}}
[debug] [2024-11-13T01:12:11.301Z] [worker-us-central1-saveChatHistory-a57de3e8-7909-4b50-8f3a-7975968cb126]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-a57de3e8-7909-4b50-8f3a-7975968cb126]: exited"}}
[debug] [2024-11-13T01:12:11.301Z] [worker-us-central1-saveChatHistory-a57de3e8-7909-4b50-8f3a-7975968cb126]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-a57de3e8-7909-4b50-8f3a-7975968cb126]: FINISHED"}}
[debug] [2024-11-13T01:12:28.406Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:12:28.406Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js changed, reloading triggers"}}
[debug] [2024-11-13T01:12:28.438Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:12:28.438Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-13T01:12:29.451Z] Validating nodejs source
[debug] [2024-11-13T01:12:30.573Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:12:30.574Z] Building nodejs source
[debug] [2024-11-13T01:12:30.574Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:12:30.575Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:12:30.586Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8003

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:12:31.376Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:12:34.256Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:12:34.256Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:12:34.256Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:12:34.256Z"],"workRunningCount":1}
[debug] [2024-11-13T01:12:34.256Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T01:12:34.258Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:12:34.259Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T01:12:34.259Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-13T01:12:34.259Z] [worker-pool] Cleaned up workers for us-central1-saveChatHistory: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-saveChatHistory: 1 --> 0"}}
[debug] [2024-11-13T01:12:34.267Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-13T01:12:34.267Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-13T01:12:35.413Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:12:35.414Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:12:35.933Z] [runtime-status] [20992] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [20992] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:12:35.935Z] [runtime-status] [20992] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [20992] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:12:35.935Z] [runtime-status] [20992] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [20992] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T01:12:35.936Z] [runtime-status] [20992] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [20992] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T01:12:35.937Z] [runtime-status] [20992] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [20992] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:12:36.282Z] [runtime-status] [20992] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [20992] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T01:12:36.282Z] [runtime-status] [20992] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [20992] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T01:12:36.283Z] [runtime-status] [20992] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [20992] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:12:36.288Z] [runtime-status] [20992] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [20992] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:12:36.291Z] [runtime-status] [20992] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [20992] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:12:36.291Z] [runtime-status] [20992] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [20992] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T01:12:36.398Z] [runtime-status] [20992] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [20992] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T01:12:36.408Z] [runtime-status] [20992] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [20992] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T01:12:36.409Z] [runtime-status] [20992] Listening to port: \\?\pipe\fire_emu_a7ae31702e75c3fb {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [20992] Listening to port: \\\\?\\pipe\\fire_emu_a7ae31702e75c3fb"}}
[debug] [2024-11-13T01:12:36.472Z] [worker-us-central1-processChat-4f2a7cac-fcb8-4c23-911a-1f270a6a5a04]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4f2a7cac-fcb8-4c23-911a-1f270a6a5a04]: IDLE"}}
[debug] [2024-11-13T01:12:36.472Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T01:12:36.473Z] [worker-us-central1-processChat-4f2a7cac-fcb8-4c23-911a-1f270a6a5a04]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4f2a7cac-fcb8-4c23-911a-1f270a6a5a04]: BUSY"}}
[debug] [2024-11-13T01:12:36.477Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 3.8424ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 3.8424ms"}}
[debug] [2024-11-13T01:12:36.478Z] [worker-us-central1-processChat-4f2a7cac-fcb8-4c23-911a-1f270a6a5a04]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4f2a7cac-fcb8-4c23-911a-1f270a6a5a04]: IDLE"}}
[debug] [2024-11-13T01:12:36.478Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:12:36.478Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:12:36.478Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:12:36.480Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:12:36.480Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:12:36.480Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:12:36.480Z"],"workRunningCount":1}
[debug] [2024-11-13T01:12:36.480Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T01:12:36.481Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:12:36.481Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T01:12:36.481Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T01:12:36.482Z] [worker-us-central1-processChat-4f2a7cac-fcb8-4c23-911a-1f270a6a5a04]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4f2a7cac-fcb8-4c23-911a-1f270a6a5a04]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello' } } {"user":"🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello' } }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello' } }"}}
[info] >  📝 Using chat ID: undefined {"user":"📝 Using chat ID: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: undefined"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 5, {"user":"  messageLength: 5,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 5,"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: undefined {"user":"  chatId: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: undefined"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: chat-1731460356497-zliut1kse {"user":"🆕 Creating new chat session: chat-1731460356497-zliut1kse","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: chat-1731460356497-zliut1kse"}}
[info] >  📝 Chat session created: { chatId: 'chat-1731460356497-zliut1kse', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'chat-1731460356497-zliut1kse', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'chat-1731460356497-zliut1kse', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  📚 Current Chat History: { {"user":"📚 Current Chat History: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📚 Current Chat History: {"}}
[info] >    chatId: 'chat-1731460356497-zliut1kse', {"user":"  chatId: 'chat-1731460356497-zliut1kse',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731460356497-zliut1kse',"}}
[info] >    historyLength: 6, {"user":"  historyLength: 6,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   historyLength: 6,"}}
[info] >    lastMessages: [ {"user":"  lastMessages: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   lastMessages: ["}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'assistant', parts: [Array] }, {"user":"    { role: 'assistant', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'assistant', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] } {"user":"    { role: 'model', parts: [Array] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Response received: { responseLength: 143, timestamp: '2024-11-13T01:12:38.762Z' } {"user":"✅ Response received: { responseLength: 143, timestamp: '2024-11-13T01:12:38.762Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 143, timestamp: '2024-11-13T01:12:38.762Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: "Hello there!  How can I help you today?  To give you the best advice, it's helpful to know what kind of relationship challenges you're facing.\n", {"user":"  message: \"Hello there!  How can I help you today?  To give you the best advice, it's helpful to know what kind of relationship challenges you're facing.\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: \"Hello there!  How can I help you today?  To give you the best advice, it's helpful to know what kind of relationship challenges you're facing.\\n\","}}
[info] >    userMessage: 'hello', {"user":"  userMessage: 'hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hello',"}}
[info] >    timestamp: '2024-11-13T01:12:38.763Z', {"user":"  timestamp: '2024-11-13T01:12:38.763Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T01:12:38.763Z',"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731460356497-zliut1kse' {"user":"  chatId: 'chat-1731460356497-zliut1kse'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731460356497-zliut1kse'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Attempting to save chat history with DETAILED logging: { {"user":"🔍 Attempting to save chat history with DETAILED logging: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Attempting to save chat history with DETAILED logging: {"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731460356497-zliut1kse', {"user":"  chatId: 'chat-1731460356497-zliut1kse',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731460356497-zliut1kse',"}}
[info] >    messageCount: 2, {"user":"  messageCount: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageCount: 2,"}}
[info] >    timestamp: '2024-11-13T01:12:38.763Z', {"user":"  timestamp: '2024-11-13T01:12:38.763Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T01:12:38.763Z',"}}
[info] >    clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' } {"user":"  clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔧 Firebase Client Configuration: { {"user":"🔧 Firebase Client Configuration: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Firebase Client Configuration: {"}}
[info] >    projectId: 'notalone-de4fc', {"user":"  projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   projectId: 'notalone-de4fc',"}}
[info] >    apiKey: 'local-api-key', {"user":"  apiKey: 'local-api-key',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   apiKey: 'local-api-key',"}}
[info] >    authDomain: undefined, {"user":"  authDomain: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   authDomain: undefined,"}}
[info] >    emulatorHost: 'localhost', {"user":"  emulatorHost: 'localhost',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorHost: 'localhost',"}}
[info] >    emulatorPort: 5001 {"user":"  emulatorPort: 5001","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorPort: 5001"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Firebase Functions Object Keys: [ {"user":"🔍 Firebase Functions Object Keys: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Object Keys: ["}}
[info] >    'app', {"user":"  'app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'app',"}}
[info] >    'emulatorOrigin', {"user":"  'emulatorOrigin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'emulatorOrigin',"}}
[info] >    'contextProvider', {"user":"  'contextProvider',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'contextProvider',"}}
[info] >    'deleteService', {"user":"  'deleteService',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'deleteService',"}}
[info] >    'cancelAllRequests', {"user":"  'cancelAllRequests',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'cancelAllRequests',"}}
[info] >    'customDomain', {"user":"  'customDomain',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'customDomain',"}}
[info] >    'region' {"user":"  'region'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'region'"}}
[info] >  ] {"user":"]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ]"}}
[info] >  🔍 Firebase Functions Instance: FunctionsService { {"user":"🔍 Firebase Functions Instance: FunctionsService {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Instance: FunctionsService {"}}
[info] >    app: FirebaseAppImpl { {"user":"  app: FirebaseAppImpl {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   app: FirebaseAppImpl {"}}
[info] >      _isDeleted: false, {"user":"    _isDeleted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _isDeleted: false,"}}
[info] >      _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }, {"user":"    _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },"}}
[info] >      _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false }, {"user":"    _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },"}}
[info] >      _name: '[DEFAULT]', {"user":"    _name: '[DEFAULT]',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _name: '[DEFAULT]',"}}
[info] >      _automaticDataCollectionEnabled: false, {"user":"    _automaticDataCollectionEnabled: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _automaticDataCollectionEnabled: false,"}}
[info] >      _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] } {"user":"    _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    emulatorOrigin: 'http://localhost:5001', {"user":"  emulatorOrigin: 'http://localhost:5001',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorOrigin: 'http://localhost:5001',"}}
[info] >    contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null }, {"user":"  contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },"}}
[info] >    deleteService: [Function (anonymous)], {"user":"  deleteService: [Function (anonymous)],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   deleteService: [Function (anonymous)],"}}
[info] >    cancelAllRequests: Promise { <pending> }, {"user":"  cancelAllRequests: Promise { <pending> },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   cancelAllRequests: Promise { <pending> },"}}
[info] >    customDomain: null, {"user":"  customDomain: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   customDomain: null,"}}
[info] >    region: 'us-central1' {"user":"  region: 'us-central1'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   region: 'us-central1'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' } {"user":"🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[info] >  🔍 Save Chat History Function Details: { {"user":"🔍 Save Chat History Function Details: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Save Chat History Function Details: {"}}
[info] >    functionExists: true, {"user":"  functionExists: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionExists: true,"}}
[info] >    functionType: 'function', {"user":"  functionType: 'function',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionType: 'function',"}}
[info] >    functionName: 'saveChatHistory' {"user":"  functionName: 'saveChatHistory'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionName: 'saveChatHistory'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📤 Chat History Payload: { {"user":"📤 Chat History Payload: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Chat History Payload: {"}}
[info] >    "userId": "xDxECJtJiNdgFeQ9L95cAi5LBwzM", {"user":"  \"userId\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"userId\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\","}}
[info] >    "chatId": "chat-1731460356497-zliut1kse", {"user":"  \"chatId\": \"chat-1731460356497-zliut1kse\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"chatId\": \"chat-1731460356497-zliut1kse\","}}
[info] >    "messages": [ {"user":"  \"messages\": [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"messages\": ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "user", {"user":"      \"role\": \"user\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"user\","}}
[info] >        "content": "hello", {"user":"      \"content\": \"hello\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"hello\","}}
[info] >        "timestamp": "2024-11-13T01:12:38.765Z" {"user":"      \"timestamp\": \"2024-11-13T01:12:38.765Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T01:12:38.765Z\""}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "model", {"user":"      \"role\": \"model\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"model\","}}
[info] >        "content": "Hello there!  How can I help you today?  To give you the best advice, it's helpful to know what kind of relationship challenges you're facing.\n", {"user":"      \"content\": \"Hello there!  How can I help you today?  To give you the best advice, it's helpful to know what kind of relationship challenges you're facing.\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"Hello there!  How can I help you today?  To give you the best advice, it's helpful to know what kind of relationship challenges you're facing.\\n\","}}
[info] >        "timestamp": "2024-11-13T01:12:38.765Z" {"user":"      \"timestamp\": \"2024-11-13T01:12:38.765Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T01:12:38.765Z\""}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    "timestamp": "2024-11-13T01:12:38.765Z" {"user":"  \"timestamp\": \"2024-11-13T01:12:38.765Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"timestamp\": \"2024-11-13T01:12:38.765Z\""}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T01:12:38.837Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T01:12:38.837Z"],"queueLength":1,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:12:36.480Z"],"workRunningCount":1}
[debug] [2024-11-13T01:12:38.837Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:12:36.480Z","/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T01:12:38.837Z"],"workRunningCount":2}
[debug] [2024-11-13T01:12:38.837Z] Accepted request POST /notalone-de4fc/us-central1/saveChatHistory --> us-central1-saveChatHistory
[debug] [2024-11-13T01:12:38.838Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:12:38.839Z] [functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/"}}
[debug] [2024-11-13T01:12:38.855Z] [worker-pool] addWorker(us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-saveChatHistory)"}}
[debug] [2024-11-13T01:12:38.856Z] [worker-pool] Adding worker with key us-central1-saveChatHistory, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-saveChatHistory, total=1"}}
[debug] [2024-11-13T01:12:40.515Z] [runtime-status] [23976] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [23976] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:12:40.517Z] [runtime-status] [23976] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [23976] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:12:40.517Z] [runtime-status] [23976] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [23976] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T01:12:40.518Z] [runtime-status] [23976] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [23976] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T01:12:40.519Z] [runtime-status] [23976] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [23976] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:12:40.853Z] [runtime-status] [23976] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [23976] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T01:12:40.854Z] [runtime-status] [23976] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [23976] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T01:12:40.854Z] [runtime-status] [23976] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [23976] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:12:40.859Z] [runtime-status] [23976] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [23976] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:12:40.862Z] [runtime-status] [23976] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [23976] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:12:40.862Z] [runtime-status] [23976] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [23976] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T01:12:40.992Z] [runtime-status] [23976] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [23976] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T01:12:41.008Z] [runtime-status] [23976] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [23976] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T01:12:41.009Z] [runtime-status] [23976] Listening to port: \\?\pipe\fire_emu_757bf392bccc1347 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [23976] Listening to port: \\\\?\\pipe\\fire_emu_757bf392bccc1347"}}
[debug] [2024-11-13T01:12:41.064Z] [worker-us-central1-saveChatHistory-7e518087-3d95-4ce5-a173-ee1389d595bd]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-7e518087-3d95-4ce5-a173-ee1389d595bd]: IDLE"}}
[debug] [2024-11-13T01:12:41.064Z] [worker-pool] submitRequest(triggerId=us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-saveChatHistory)"}}
[info] i  functions: Beginning execution of "us-central1-saveChatHistory" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Beginning execution of \"us-central1-saveChatHistory\""}}
[debug] [2024-11-13T01:12:41.065Z] [worker-us-central1-saveChatHistory-7e518087-3d95-4ce5-a173-ee1389d595bd]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-7e518087-3d95-4ce5-a173-ee1389d595bd]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"MISSING\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  {"severity":"ERROR","message":"Unhandled error TypeError: Converting circular structure to JSON\n    --> starting at object with constructor 'Socket'\n    |     property 'parser' -> object with constructor 'HTTPParser'\n    --- property 'socket' closes the circle\n    at JSON.stringify (<anonymous>)\n    at C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js:45:23\n    at C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\onInit.js:33:16\n    at fixedLen (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\providers\\https.js:135:62)\n    at C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:32\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)\n    at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)\n    at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21"} {"user":{"severity":"ERROR","message":"Unhandled error TypeError: Converting circular structure to JSON\n    --> starting at object with constructor 'Socket'\n    |     property 'parser' -> object with constructor 'HTTPParser'\n    --- property 'socket' closes the circle\n    at JSON.stringify (<anonymous>)\n    at C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js:45:23\n    at C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\onInit.js:33:16\n    at fixedLen (C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\providers\\https.js:135:62)\n    at C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:32\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)\n    at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)\n    at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"severity\":\"ERROR\",\"message\":\"Unhandled error TypeError: Converting circular structure to JSON\\n    --> starting at object with constructor 'Socket'\\n    |     property 'parser' -> object with constructor 'HTTPParser'\\n    --- property 'socket' closes the circle\\n    at JSON.stringify (<anonymous>)\\n    at C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\lib\\\\chatHistory.js:45:23\\n    at C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\common\\\\onInit.js:33:16\\n    at fixedLen (C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\providers\\\\https.js:135:62)\\n    at C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\common\\\\providers\\\\https.js:467:32\\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\\n    at async runFunction (C:\\\\Users\\\\Rob\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\firebase-tools\\\\lib\\\\emulator\\\\functionsEmulatorRuntime.js:506:9)\\n    at async runHTTPS (C:\\\\Users\\\\Rob\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\firebase-tools\\\\lib\\\\emulator\\\\functionsEmulatorRuntime.js:531:5)\\n    at async C:\\\\Users\\\\Rob\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\firebase-tools\\\\lib\\\\emulator\\\\functionsEmulatorRuntime.js:694:21\"}"}}
[debug] [2024-11-13T01:12:41.087Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-saveChatHistory" in 22.9225ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finished \"us-central1-saveChatHistory\" in 22.9225ms"}}
[debug] [2024-11-13T01:12:41.088Z] [worker-us-central1-saveChatHistory-7e518087-3d95-4ce5-a173-ee1389d595bd]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-7e518087-3d95-4ce5-a173-ee1389d595bd]: IDLE"}}
[debug] [2024-11-13T01:12:41.089Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:12:41.089Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:12:41.089Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:12:36.480Z"],"workRunningCount":1}
[info] >  ❌ COMPREHENSIVE Save Chat History Error (Enhanced): { {"user":"❌ COMPREHENSIVE Save Chat History Error (Enhanced): {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ COMPREHENSIVE Save Chat History Error (Enhanced): {"}}
[info] >    errorType: 'object', {"user":"  errorType: 'object',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorType: 'object',"}}
[info] >    errorInstance: true, {"user":"  errorInstance: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorInstance: true,"}}
[info] >    fullErrorObject: [FunctionsError [FirebaseError]: INTERNAL] { {"user":"  fullErrorObject: [FunctionsError [FirebaseError]: INTERNAL] {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   fullErrorObject: [FunctionsError [FirebaseError]: INTERNAL] {"}}
[info] >      code: 'functions/internal', {"user":"    code: 'functions/internal',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 'functions/internal',"}}
[info] >      customData: undefined, {"user":"    customData: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     customData: undefined,"}}
[info] >      details: undefined {"user":"    details: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     details: undefined"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    stringRepresentation: 'FirebaseError: INTERNAL', {"user":"  stringRepresentation: 'FirebaseError: INTERNAL',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   stringRepresentation: 'FirebaseError: INTERNAL',"}}
[info] >    adminAppConfig: { {"user":"  adminAppConfig: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   adminAppConfig: {"}}
[info] >      storageBucket: 'notalone-de4fc.firebasestorage.app', {"user":"    storageBucket: 'notalone-de4fc.firebasestorage.app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     storageBucket: 'notalone-de4fc.firebasestorage.app',"}}
[info] >      projectId: 'notalone-de4fc', {"user":"    projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     projectId: 'notalone-de4fc',"}}
[info] >      credential: RefreshTokenCredential { {"user":"    credential: RefreshTokenCredential {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     credential: RefreshTokenCredential {"}}
[info] >        httpAgent: undefined, {"user":"      httpAgent: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpAgent: undefined,"}}
[info] >        implicit: true, {"user":"      implicit: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       implicit: true,"}}
[info] >        refreshToken: [RefreshToken], {"user":"      refreshToken: [RefreshToken],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       refreshToken: [RefreshToken],"}}
[info] >        httpClient: [HttpClient] {"user":"      httpClient: [HttpClient]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpClient: [HttpClient]"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T01:12:41.108Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4626.0345ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4626.0345ms"}}
[debug] [2024-11-13T01:12:41.109Z] [worker-us-central1-processChat-4f2a7cac-fcb8-4c23-911a-1f270a6a5a04]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4f2a7cac-fcb8-4c23-911a-1f270a6a5a04]: IDLE"}}
[debug] [2024-11-13T01:12:41.109Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:12:41.109Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:12:41.109Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  ❌ Detailed Error Breakdown (Enhanced): { {"user":"❌ Detailed Error Breakdown (Enhanced): {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ Detailed Error Breakdown (Enhanced): {"}}
[info] >    errorName: 'FirebaseError', {"user":"  errorName: 'FirebaseError',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorName: 'FirebaseError',"}}
[info] >    errorCode: 'functions/internal', {"user":"  errorCode: 'functions/internal',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorCode: 'functions/internal',"}}
[info] >    errorMessage: 'INTERNAL', {"user":"  errorMessage: 'INTERNAL',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorMessage: 'INTERNAL',"}}
[info] >    errorStack: 'FirebaseError: INTERNAL' {"user":"  errorStack: 'FirebaseError: INTERNAL'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorStack: 'FirebaseError: INTERNAL'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T01:14:34.426Z] File C:\Users\Rob\Apps\not-alone\functions\src\chatHistory.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\chatHistory.ts changed, reloading triggers"}}
[debug] [2024-11-13T01:14:35.429Z] Validating nodejs source
[debug] [2024-11-13T01:14:36.414Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:14:36.415Z] Building nodejs source
[debug] [2024-11-13T01:14:36.415Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:14:36.416Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:14:36.427Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8221

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:14:37.118Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:14:41.144Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:14:41.145Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:14:41.146Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-13T01:14:41.146Z] [worker-us-central1-processChat-4f2a7cac-fcb8-4c23-911a-1f270a6a5a04]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4f2a7cac-fcb8-4c23-911a-1f270a6a5a04]: FINISHING"}}
[debug] [2024-11-13T01:14:41.147Z] [worker-pool] Shutting down IDLE worker (us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-saveChatHistory)"}}
[debug] [2024-11-13T01:14:41.147Z] [worker-us-central1-saveChatHistory-7e518087-3d95-4ce5-a173-ee1389d595bd]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-7e518087-3d95-4ce5-a173-ee1389d595bd]: FINISHING"}}
[debug] [2024-11-13T01:14:41.161Z] [worker-us-central1-saveChatHistory-7e518087-3d95-4ce5-a173-ee1389d595bd]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-7e518087-3d95-4ce5-a173-ee1389d595bd]: exited"}}
[debug] [2024-11-13T01:14:41.161Z] [worker-us-central1-saveChatHistory-7e518087-3d95-4ce5-a173-ee1389d595bd]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-7e518087-3d95-4ce5-a173-ee1389d595bd]: FINISHED"}}
[debug] [2024-11-13T01:14:41.162Z] [worker-us-central1-processChat-4f2a7cac-fcb8-4c23-911a-1f270a6a5a04]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4f2a7cac-fcb8-4c23-911a-1f270a6a5a04]: exited"}}
[debug] [2024-11-13T01:14:41.162Z] [worker-us-central1-processChat-4f2a7cac-fcb8-4c23-911a-1f270a6a5a04]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-4f2a7cac-fcb8-4c23-911a-1f270a6a5a04]: FINISHED"}}
[debug] [2024-11-13T01:15:08.516Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:15:08.516Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js changed, reloading triggers"}}
[debug] [2024-11-13T01:15:08.541Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:15:08.542Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-13T01:15:09.555Z] Validating nodejs source
[debug] [2024-11-13T01:15:10.623Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:15:10.623Z] Building nodejs source
[debug] [2024-11-13T01:15:10.623Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:15:10.624Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:15:10.634Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8253

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:15:11.388Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:15:15.420Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:15:15.421Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:15:17.752Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:15:17.755Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js changed, reloading triggers"}}
[debug] [2024-11-13T01:15:17.782Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:15:17.783Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-13T01:15:18.795Z] Validating nodejs source
[debug] [2024-11-13T01:15:19.861Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:15:19.861Z] Building nodejs source
[debug] [2024-11-13T01:15:19.861Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:15:19.862Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:15:19.872Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8361

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:15:20.559Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:15:24.586Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:15:24.586Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:15:26.923Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:15:26.924Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js changed, reloading triggers"}}
[debug] [2024-11-13T01:15:26.954Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:15:26.955Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-13T01:15:27.646Z] File C:\Users\Rob\Apps\not-alone\functions\src\chatHistory.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\chatHistory.ts changed, reloading triggers"}}
[debug] [2024-11-13T01:15:28.649Z] Validating nodejs source
[debug] [2024-11-13T01:15:29.673Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:15:29.675Z] Building nodejs source
[debug] [2024-11-13T01:15:29.675Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:15:29.677Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:15:29.689Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8912

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:15:30.516Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:15:33.191Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:15:33.192Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js changed, reloading triggers"}}
[debug] [2024-11-13T01:15:33.220Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:15:33.221Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-13T01:15:34.235Z] Validating nodejs source
[debug] [2024-11-13T01:15:35.187Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:15:35.187Z] Building nodejs source
[debug] [2024-11-13T01:15:35.187Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:15:35.188Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:15:35.197Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[debug] [2024-11-13T01:15:35.207Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:15:35.211Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[info] Serving at port 8465

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:15:35.861Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:15:39.889Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:15:39.891Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:15:42.823Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:15:42.823Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:15:42.823Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:15:42.823Z"],"workRunningCount":1}
[debug] [2024-11-13T01:15:42.823Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T01:15:42.826Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:15:42.826Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T01:15:42.826Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-13T01:15:42.826Z] [worker-pool] Cleaned up workers for us-central1-saveChatHistory: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-saveChatHistory: 1 --> 0"}}
[debug] [2024-11-13T01:15:42.836Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-13T01:15:42.836Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-13T01:15:44.534Z] [runtime-status] [23312] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23312] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:15:44.536Z] [runtime-status] [23312] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23312] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:15:44.537Z] [runtime-status] [23312] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23312] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T01:15:44.537Z] [runtime-status] [23312] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23312] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T01:15:44.538Z] [runtime-status] [23312] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23312] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:15:44.906Z] [runtime-status] [23312] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23312] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T01:15:44.906Z] [runtime-status] [23312] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23312] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T01:15:44.907Z] [runtime-status] [23312] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23312] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:15:44.912Z] [runtime-status] [23312] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23312] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:15:44.915Z] [runtime-status] [23312] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23312] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:15:44.915Z] [runtime-status] [23312] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23312] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T01:15:45.056Z] [runtime-status] [23312] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23312] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T01:15:45.067Z] [runtime-status] [23312] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23312] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T01:15:45.068Z] [runtime-status] [23312] Listening to port: \\?\pipe\fire_emu_e644ff589ac42576 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [23312] Listening to port: \\\\?\\pipe\\fire_emu_e644ff589ac42576"}}
[debug] [2024-11-13T01:15:45.156Z] [worker-us-central1-processChat-96e8f6be-90ac-4384-a879-727bceda836f]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-96e8f6be-90ac-4384-a879-727bceda836f]: IDLE"}}
[debug] [2024-11-13T01:15:45.156Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T01:15:45.157Z] [worker-us-central1-processChat-96e8f6be-90ac-4384-a879-727bceda836f]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-96e8f6be-90ac-4384-a879-727bceda836f]: BUSY"}}
[debug] [2024-11-13T01:15:45.161Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4.1329ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4.1329ms"}}
[debug] [2024-11-13T01:15:45.162Z] [worker-us-central1-processChat-96e8f6be-90ac-4384-a879-727bceda836f]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-96e8f6be-90ac-4384-a879-727bceda836f]: IDLE"}}
[debug] [2024-11-13T01:15:45.162Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:15:45.162Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:15:45.162Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:15:45.163Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:15:45.163Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:15:45.163Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:15:45.163Z"],"workRunningCount":1}
[debug] [2024-11-13T01:15:45.163Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T01:15:45.164Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:15:45.164Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T01:15:45.164Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T01:15:45.165Z] [worker-us-central1-processChat-96e8f6be-90ac-4384-a879-727bceda836f]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-96e8f6be-90ac-4384-a879-727bceda836f]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi' } } {"user":"🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi' } }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi' } }"}}
[info] >  📝 Using chat ID: undefined {"user":"📝 Using chat ID: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: undefined"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 2, {"user":"  messageLength: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 2,"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: undefined {"user":"  chatId: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: undefined"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: chat-1731460545189-p97sybnjh {"user":"🆕 Creating new chat session: chat-1731460545189-p97sybnjh","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: chat-1731460545189-p97sybnjh"}}
[info] >  📝 Chat session created: { chatId: 'chat-1731460545189-p97sybnjh', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'chat-1731460545189-p97sybnjh', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'chat-1731460545189-p97sybnjh', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hi {"user":"💬 Sending message to Gemini: hi","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hi"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  📚 Current Chat History: { {"user":"📚 Current Chat History: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📚 Current Chat History: {"}}
[info] >    chatId: 'chat-1731460545189-p97sybnjh', {"user":"  chatId: 'chat-1731460545189-p97sybnjh',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731460545189-p97sybnjh',"}}
[info] >    historyLength: 6, {"user":"  historyLength: 6,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   historyLength: 6,"}}
[info] >    lastMessages: [ {"user":"  lastMessages: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   lastMessages: ["}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'assistant', parts: [Array] }, {"user":"    { role: 'assistant', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'assistant', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] } {"user":"    { role: 'model', parts: [Array] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Response received: { responseLength: 293, timestamp: '2024-11-13T01:15:48.159Z' } {"user":"✅ Response received: { responseLength: 293, timestamp: '2024-11-13T01:15:48.159Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 293, timestamp: '2024-11-13T01:15:48.159Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: "Hi there!  How can I help you today with your relationships?  To best assist you, please tell me a bit more about what's on your mind.  For example, are you struggling with a specific issue, or are you just looking for general advice?  The more information you provide, the better I can help.\n", {"user":"  message: \"Hi there!  How can I help you today with your relationships?  To best assist you, please tell me a bit more about what's on your mind.  For example, are you struggling with a specific issue, or are you just looking for general advice?  The more information you provide, the better I can help.\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: \"Hi there!  How can I help you today with your relationships?  To best assist you, please tell me a bit more about what's on your mind.  For example, are you struggling with a specific issue, or are you just looking for general advice?  The more information you provide, the better I can help.\\n\","}}
[info] >    userMessage: 'hi', {"user":"  userMessage: 'hi',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hi',"}}
[info] >    timestamp: '2024-11-13T01:15:48.159Z', {"user":"  timestamp: '2024-11-13T01:15:48.159Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T01:15:48.159Z',"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731460545189-p97sybnjh' {"user":"  chatId: 'chat-1731460545189-p97sybnjh'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731460545189-p97sybnjh'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Attempting to save chat history with DETAILED logging: { {"user":"🔍 Attempting to save chat history with DETAILED logging: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Attempting to save chat history with DETAILED logging: {"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731460545189-p97sybnjh', {"user":"  chatId: 'chat-1731460545189-p97sybnjh',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731460545189-p97sybnjh',"}}
[info] >    messageCount: 2, {"user":"  messageCount: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageCount: 2,"}}
[info] >    timestamp: '2024-11-13T01:15:48.160Z', {"user":"  timestamp: '2024-11-13T01:15:48.160Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T01:15:48.160Z',"}}
[info] >    clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' } {"user":"  clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔧 Firebase Client Configuration: { {"user":"🔧 Firebase Client Configuration: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Firebase Client Configuration: {"}}
[info] >    projectId: 'notalone-de4fc', {"user":"  projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   projectId: 'notalone-de4fc',"}}
[info] >    apiKey: 'local-api-key', {"user":"  apiKey: 'local-api-key',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   apiKey: 'local-api-key',"}}
[info] >    authDomain: undefined, {"user":"  authDomain: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   authDomain: undefined,"}}
[info] >    emulatorHost: 'localhost', {"user":"  emulatorHost: 'localhost',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorHost: 'localhost',"}}
[info] >    emulatorPort: 5001 {"user":"  emulatorPort: 5001","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorPort: 5001"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Firebase Functions Object Keys: [ {"user":"🔍 Firebase Functions Object Keys: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Object Keys: ["}}
[info] >    'app', {"user":"  'app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'app',"}}
[info] >    'emulatorOrigin', {"user":"  'emulatorOrigin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'emulatorOrigin',"}}
[info] >    'contextProvider', {"user":"  'contextProvider',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'contextProvider',"}}
[info] >    'deleteService', {"user":"  'deleteService',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'deleteService',"}}
[info] >    'cancelAllRequests', {"user":"  'cancelAllRequests',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'cancelAllRequests',"}}
[info] >    'customDomain', {"user":"  'customDomain',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'customDomain',"}}
[info] >    'region' {"user":"  'region'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'region'"}}
[info] >  ] {"user":"]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ]"}}
[info] >  🔍 Firebase Functions Instance: FunctionsService { {"user":"🔍 Firebase Functions Instance: FunctionsService {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Instance: FunctionsService {"}}
[info] >    app: FirebaseAppImpl { {"user":"  app: FirebaseAppImpl {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   app: FirebaseAppImpl {"}}
[info] >      _isDeleted: false, {"user":"    _isDeleted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _isDeleted: false,"}}
[info] >      _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }, {"user":"    _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },"}}
[info] >      _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false }, {"user":"    _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },"}}
[info] >      _name: '[DEFAULT]', {"user":"    _name: '[DEFAULT]',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _name: '[DEFAULT]',"}}
[info] >      _automaticDataCollectionEnabled: false, {"user":"    _automaticDataCollectionEnabled: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _automaticDataCollectionEnabled: false,"}}
[info] >      _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] } {"user":"    _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    emulatorOrigin: 'http://localhost:5001', {"user":"  emulatorOrigin: 'http://localhost:5001',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorOrigin: 'http://localhost:5001',"}}
[info] >    contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null }, {"user":"  contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },"}}
[info] >    deleteService: [Function (anonymous)], {"user":"  deleteService: [Function (anonymous)],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   deleteService: [Function (anonymous)],"}}
[info] >    cancelAllRequests: Promise { <pending> }, {"user":"  cancelAllRequests: Promise { <pending> },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   cancelAllRequests: Promise { <pending> },"}}
[info] >    customDomain: null, {"user":"  customDomain: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   customDomain: null,"}}
[info] >    region: 'us-central1' {"user":"  region: 'us-central1'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   region: 'us-central1'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' } {"user":"🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[info] >  🔍 Save Chat History Function Details: { {"user":"🔍 Save Chat History Function Details: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Save Chat History Function Details: {"}}
[info] >    functionExists: true, {"user":"  functionExists: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionExists: true,"}}
[info] >    functionType: 'function', {"user":"  functionType: 'function',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionType: 'function',"}}
[info] >    functionName: 'saveChatHistory' {"user":"  functionName: 'saveChatHistory'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionName: 'saveChatHistory'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📤 Chat History Payload: { {"user":"📤 Chat History Payload: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Chat History Payload: {"}}
[info] >    "userId": "xDxECJtJiNdgFeQ9L95cAi5LBwzM", {"user":"  \"userId\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"userId\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\","}}
[info] >    "chatId": "chat-1731460545189-p97sybnjh", {"user":"  \"chatId\": \"chat-1731460545189-p97sybnjh\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"chatId\": \"chat-1731460545189-p97sybnjh\","}}
[info] >    "messages": [ {"user":"  \"messages\": [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"messages\": ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "user", {"user":"      \"role\": \"user\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"user\","}}
[info] >        "content": "hi", {"user":"      \"content\": \"hi\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"hi\","}}
[info] >        "timestamp": "2024-11-13T01:15:48.162Z" {"user":"      \"timestamp\": \"2024-11-13T01:15:48.162Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T01:15:48.162Z\""}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "model", {"user":"      \"role\": \"model\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"model\","}}
[info] >        "content": "Hi there!  How can I help you today with your relationships?  To best assist you, please tell me a bit more about what's on your mind.  For example, are you struggling with a specific issue, or are you just looking for general advice?  The more information you provide, the better I can help.\n", {"user":"      \"content\": \"Hi there!  How can I help you today with your relationships?  To best assist you, please tell me a bit more about what's on your mind.  For example, are you struggling with a specific issue, or are you just looking for general advice?  The more information you provide, the better I can help.\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"Hi there!  How can I help you today with your relationships?  To best assist you, please tell me a bit more about what's on your mind.  For example, are you struggling with a specific issue, or are you just looking for general advice?  The more information you provide, the better I can help.\\n\","}}
[info] >        "timestamp": "2024-11-13T01:15:48.162Z" {"user":"      \"timestamp\": \"2024-11-13T01:15:48.162Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T01:15:48.162Z\""}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    "timestamp": "2024-11-13T01:15:48.162Z" {"user":"  \"timestamp\": \"2024-11-13T01:15:48.162Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"timestamp\": \"2024-11-13T01:15:48.162Z\""}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T01:15:48.245Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T01:15:48.245Z"],"queueLength":1,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:15:45.163Z"],"workRunningCount":1}
[debug] [2024-11-13T01:15:48.245Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:15:45.163Z","/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T01:15:48.245Z"],"workRunningCount":2}
[debug] [2024-11-13T01:15:48.245Z] Accepted request POST /notalone-de4fc/us-central1/saveChatHistory --> us-central1-saveChatHistory
[debug] [2024-11-13T01:15:48.247Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:15:48.247Z] [functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/"}}
[debug] [2024-11-13T01:15:48.267Z] [worker-pool] addWorker(us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-saveChatHistory)"}}
[debug] [2024-11-13T01:15:48.267Z] [worker-pool] Adding worker with key us-central1-saveChatHistory, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-saveChatHistory, total=1"}}
[debug] [2024-11-13T01:15:49.966Z] [runtime-status] [3444] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3444] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:15:49.968Z] [runtime-status] [3444] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3444] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:15:49.969Z] [runtime-status] [3444] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3444] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T01:15:49.969Z] [runtime-status] [3444] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3444] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T01:15:49.970Z] [runtime-status] [3444] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3444] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:15:50.333Z] [runtime-status] [3444] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3444] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T01:15:50.333Z] [runtime-status] [3444] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3444] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T01:15:50.334Z] [runtime-status] [3444] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3444] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:15:50.339Z] [runtime-status] [3444] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3444] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:15:50.341Z] [runtime-status] [3444] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3444] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:15:50.341Z] [runtime-status] [3444] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3444] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T01:15:50.447Z] [runtime-status] [3444] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3444] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T01:15:50.458Z] [runtime-status] [3444] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3444] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T01:15:50.461Z] [runtime-status] [3444] Listening to port: \\?\pipe\fire_emu_e61a40eac98c15f2 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [3444] Listening to port: \\\\?\\pipe\\fire_emu_e61a40eac98c15f2"}}
[debug] [2024-11-13T01:15:50.471Z] [worker-us-central1-saveChatHistory-51524424-4a1b-4c07-89f8-9e4fcf83dd58]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-51524424-4a1b-4c07-89f8-9e4fcf83dd58]: IDLE"}}
[debug] [2024-11-13T01:15:50.471Z] [worker-pool] submitRequest(triggerId=us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-saveChatHistory)"}}
[info] i  functions: Beginning execution of "us-central1-saveChatHistory" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Beginning execution of \"us-central1-saveChatHistory\""}}
[debug] [2024-11-13T01:15:50.472Z] [worker-us-central1-saveChatHistory-51524424-4a1b-4c07-89f8-9e4fcf83dd58]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-51524424-4a1b-4c07-89f8-9e4fcf83dd58]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"MISSING\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🔍 Saving Chat History { {"user":"🔍 Saving Chat History {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Saving Chat History {"}}
[info] >    data: { {"user":"  data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: {"}}
[info] >      rawRequest: IncomingMessage { {"user":"    rawRequest: IncomingMessage {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     rawRequest: IncomingMessage {"}}
[info] >        _events: [Object], {"user":"      _events: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _events: [Object],"}}
[info] >        _readableState: [ReadableState], {"user":"      _readableState: [ReadableState],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _readableState: [ReadableState],"}}
[info] >        _maxListeners: undefined, {"user":"      _maxListeners: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _maxListeners: undefined,"}}
[info] >        socket: [Socket], {"user":"      socket: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       socket: [Socket],"}}
[info] >        httpVersionMajor: 1, {"user":"      httpVersionMajor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMajor: 1,"}}
[info] >        httpVersionMinor: 1, {"user":"      httpVersionMinor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMinor: 1,"}}
[info] >        httpVersion: '1.1', {"user":"      httpVersion: '1.1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersion: '1.1',"}}
[info] >        complete: true, {"user":"      complete: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       complete: true,"}}
[info] >        rawHeaders: [Array], {"user":"      rawHeaders: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawHeaders: [Array],"}}
[info] >        rawTrailers: [], {"user":"      rawTrailers: [],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawTrailers: [],"}}
[info] >        joinDuplicateHeaders: null, {"user":"      joinDuplicateHeaders: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       joinDuplicateHeaders: null,"}}
[info] >        aborted: false, {"user":"      aborted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       aborted: false,"}}
[info] >        upgrade: false, {"user":"      upgrade: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       upgrade: false,"}}
[info] >        url: '/', {"user":"      url: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       url: '/',"}}
[info] >        method: 'POST', {"user":"      method: 'POST',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       method: 'POST',"}}
[info] >        statusCode: null, {"user":"      statusCode: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusCode: null,"}}
[info] >        statusMessage: null, {"user":"      statusMessage: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusMessage: null,"}}
[info] >        client: [Socket], {"user":"      client: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       client: [Socket],"}}
[info] >        _consuming: true, {"user":"      _consuming: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _consuming: true,"}}
[info] >        _dumped: false, {"user":"      _dumped: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _dumped: false,"}}
[info] >        next: [Function: next], {"user":"      next: [Function: next],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       next: [Function: next],"}}
[info] >        baseUrl: '', {"user":"      baseUrl: '',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       baseUrl: '',"}}
[info] >        originalUrl: '/', {"user":"      originalUrl: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       originalUrl: '/',"}}
[info] >        _parsedUrl: [Url], {"user":"      _parsedUrl: [Url],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _parsedUrl: [Url],"}}
[info] >        params: [Object], {"user":"      params: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       params: [Object],"}}
[info] >        query: {}, {"user":"      query: {},","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       query: {},"}}
[info] >        res: [ServerResponse], {"user":"      res: [ServerResponse],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       res: [ServerResponse],"}}
[info] >        body: [Object], {"user":"      body: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       body: [Object],"}}
[info] >        _body: true, {"user":"      _body: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _body: true,"}}
[info] >        length: undefined, {"user":"      length: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       length: undefined,"}}
[info] >        _eventsCount: 0, {"user":"      _eventsCount: 0,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _eventsCount: 0,"}}
[info] >        rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 78 44 78 45 43 4a 74 4a 69 4e 64 67 46 65 51 39 4c 39 35 63 41 69 35 4c 42 77 7a 4d 22 2c 22 ... 525 more bytes>, {"user":"      rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 78 44 78 45 43 4a 74 4a 69 4e 64 67 46 65 51 39 4c 39 35 63 41 69 35 4c 42 77 7a 4d 22 2c 22 ... 525 more bytes>,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 78 44 78 45 43 4a 74 4a 69 4e 64 67 46 65 51 39 4c 39 35 63 41 69 35 4c 42 77 7a 4d 22 2c 22 ... 525 more bytes>,"}}
[info] >        route: [Route], {"user":"      route: [Route],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       route: [Route],"}}
[info] >        [Symbol(shapeMode)]: true, {"user":"      [Symbol(shapeMode)]: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(shapeMode)]: true,"}}
[info] >        [Symbol(kCapture)]: false, {"user":"      [Symbol(kCapture)]: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kCapture)]: false,"}}
[info] >        [Symbol(kHeaders)]: [Object], {"user":"      [Symbol(kHeaders)]: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeaders)]: [Object],"}}
[info] >        [Symbol(kHeadersCount)]: 18, {"user":"      [Symbol(kHeadersCount)]: 18,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeadersCount)]: 18,"}}
[info] >        [Symbol(kTrailers)]: null, {"user":"      [Symbol(kTrailers)]: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailers)]: null,"}}
[info] >        [Symbol(kTrailersCount)]: 0 {"user":"      [Symbol(kTrailersCount)]: 0","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailersCount)]: 0"}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      data: { {"user":"    data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     data: {"}}
[info] >        userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"      userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >        chatId: 'chat-1731460545189-p97sybnjh', {"user":"      chatId: 'chat-1731460545189-p97sybnjh',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       chatId: 'chat-1731460545189-p97sybnjh',"}}
[info] >        messages: [Array], {"user":"      messages: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       messages: [Array],"}}
[info] >        timestamp: '2024-11-13T01:15:48.162Z' {"user":"      timestamp: '2024-11-13T01:15:48.162Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       timestamp: '2024-11-13T01:15:48.162Z'"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ❌ Missing userId or chatId {"user":"❌ Missing userId or chatId","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ Missing userId or chatId"}}
[debug] [2024-11-13T01:15:50.556Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-saveChatHistory" in 84.552ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finished \"us-central1-saveChatHistory\" in 84.552ms"}}
[debug] [2024-11-13T01:15:50.558Z] [worker-us-central1-saveChatHistory-51524424-4a1b-4c07-89f8-9e4fcf83dd58]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-51524424-4a1b-4c07-89f8-9e4fcf83dd58]: IDLE"}}
[debug] [2024-11-13T01:15:50.558Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:15:50.558Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:15:50.558Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:15:45.163Z"],"workRunningCount":1}
[info] >  ❌ COMPREHENSIVE Save Chat History Error (Enhanced): { {"user":"❌ COMPREHENSIVE Save Chat History Error (Enhanced): {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ COMPREHENSIVE Save Chat History Error (Enhanced): {"}}
[info] >    errorType: 'object', {"user":"  errorType: 'object',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorType: 'object',"}}
[info] >    errorInstance: true, {"user":"  errorInstance: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorInstance: true,"}}
[info] >    fullErrorObject: [FunctionsError [FirebaseError]: User ID and Chat ID are required] { {"user":"  fullErrorObject: [FunctionsError [FirebaseError]: User ID and Chat ID are required] {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   fullErrorObject: [FunctionsError [FirebaseError]: User ID and Chat ID are required] {"}}
[info] >      code: 'functions/invalid-argument', {"user":"    code: 'functions/invalid-argument',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 'functions/invalid-argument',"}}
[info] >      customData: undefined, {"user":"    customData: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     customData: undefined,"}}
[info] >      details: undefined {"user":"    details: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     details: undefined"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    stringRepresentation: 'FirebaseError: User ID and Chat ID are required', {"user":"  stringRepresentation: 'FirebaseError: User ID and Chat ID are required',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   stringRepresentation: 'FirebaseError: User ID and Chat ID are required',"}}
[info] >    adminAppConfig: { {"user":"  adminAppConfig: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   adminAppConfig: {"}}
[info] >      storageBucket: 'notalone-de4fc.firebasestorage.app', {"user":"    storageBucket: 'notalone-de4fc.firebasestorage.app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     storageBucket: 'notalone-de4fc.firebasestorage.app',"}}
[info] >      projectId: 'notalone-de4fc', {"user":"    projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     projectId: 'notalone-de4fc',"}}
[info] >      credential: RefreshTokenCredential { {"user":"    credential: RefreshTokenCredential {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     credential: RefreshTokenCredential {"}}
[info] >        httpAgent: undefined, {"user":"      httpAgent: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpAgent: undefined,"}}
[info] >        implicit: true, {"user":"      implicit: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       implicit: true,"}}
[info] >        refreshToken: [RefreshToken], {"user":"      refreshToken: [RefreshToken],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       refreshToken: [RefreshToken],"}}
[info] >        httpClient: [HttpClient] {"user":"      httpClient: [HttpClient]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpClient: [HttpClient]"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T01:15:50.581Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 5416.627ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 5416.627ms"}}
[debug] [2024-11-13T01:15:50.583Z] [worker-us-central1-processChat-96e8f6be-90ac-4384-a879-727bceda836f]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-96e8f6be-90ac-4384-a879-727bceda836f]: IDLE"}}
[debug] [2024-11-13T01:15:50.583Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:15:50.583Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:15:50.583Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  ❌ Detailed Error Breakdown (Enhanced): { {"user":"❌ Detailed Error Breakdown (Enhanced): {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ Detailed Error Breakdown (Enhanced): {"}}
[info] >    errorName: 'FirebaseError', {"user":"  errorName: 'FirebaseError',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorName: 'FirebaseError',"}}
[info] >    errorCode: 'functions/invalid-argument', {"user":"  errorCode: 'functions/invalid-argument',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorCode: 'functions/invalid-argument',"}}
[info] >    errorMessage: 'User ID and Chat ID are required', {"user":"  errorMessage: 'User ID and Chat ID are required',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorMessage: 'User ID and Chat ID are required',"}}
[info] >    errorStack: 'FirebaseError: User ID and Chat ID are required' {"user":"  errorStack: 'FirebaseError: User ID and Chat ID are required'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorStack: 'FirebaseError: User ID and Chat ID are required'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T01:16:47.250Z] File C:\Users\Rob\Apps\not-alone\functions\src\chatHistory.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\chatHistory.ts changed, reloading triggers"}}
[debug] [2024-11-13T01:16:48.262Z] Validating nodejs source
[debug] [2024-11-13T01:16:49.216Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:16:49.216Z] Building nodejs source
[debug] [2024-11-13T01:16:49.216Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:16:49.217Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:16:49.225Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8144

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:16:49.866Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:16:53.889Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:16:53.890Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:16:53.891Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-13T01:16:53.891Z] [worker-us-central1-processChat-96e8f6be-90ac-4384-a879-727bceda836f]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-96e8f6be-90ac-4384-a879-727bceda836f]: FINISHING"}}
[debug] [2024-11-13T01:16:53.891Z] [worker-pool] Shutting down IDLE worker (us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-saveChatHistory)"}}
[debug] [2024-11-13T01:16:53.892Z] [worker-us-central1-saveChatHistory-51524424-4a1b-4c07-89f8-9e4fcf83dd58]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-51524424-4a1b-4c07-89f8-9e4fcf83dd58]: FINISHING"}}
[debug] [2024-11-13T01:16:53.903Z] [worker-us-central1-saveChatHistory-51524424-4a1b-4c07-89f8-9e4fcf83dd58]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-51524424-4a1b-4c07-89f8-9e4fcf83dd58]: exited"}}
[debug] [2024-11-13T01:16:53.903Z] [worker-us-central1-saveChatHistory-51524424-4a1b-4c07-89f8-9e4fcf83dd58]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-51524424-4a1b-4c07-89f8-9e4fcf83dd58]: FINISHED"}}
[debug] [2024-11-13T01:16:53.903Z] [worker-us-central1-processChat-96e8f6be-90ac-4384-a879-727bceda836f]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-96e8f6be-90ac-4384-a879-727bceda836f]: exited"}}
[debug] [2024-11-13T01:16:53.903Z] [worker-us-central1-processChat-96e8f6be-90ac-4384-a879-727bceda836f]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-96e8f6be-90ac-4384-a879-727bceda836f]: FINISHED"}}
[debug] [2024-11-13T01:16:57.243Z] File C:\Users\Rob\Apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T01:16:58.245Z] Validating nodejs source
[debug] [2024-11-13T01:16:59.201Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:16:59.201Z] Building nodejs source
[debug] [2024-11-13T01:16:59.201Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:16:59.202Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:16:59.210Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8263

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:16:59.863Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:17:03.885Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:17:03.886Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:17:25.200Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:17:25.201Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js changed, reloading triggers"}}
[debug] [2024-11-13T01:17:25.227Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:17:25.228Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-13T01:17:26.241Z] Validating nodejs source
[debug] [2024-11-13T01:17:27.191Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:17:27.191Z] Building nodejs source
[debug] [2024-11-13T01:17:27.192Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:17:27.193Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:17:27.202Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8744

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:17:27.887Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:17:31.925Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:17:31.926Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:17:41.178Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:17:41.178Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:17:41.178Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:17:41.178Z"],"workRunningCount":1}
[debug] [2024-11-13T01:17:41.178Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T01:17:41.182Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:17:41.182Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T01:17:41.182Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-13T01:17:41.182Z] [worker-pool] Cleaned up workers for us-central1-saveChatHistory: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-saveChatHistory: 1 --> 0"}}
[debug] [2024-11-13T01:17:41.192Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-13T01:17:41.192Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-13T01:17:42.811Z] [runtime-status] [30700] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [30700] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:17:42.813Z] [runtime-status] [30700] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [30700] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:17:42.813Z] [runtime-status] [30700] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [30700] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T01:17:42.814Z] [runtime-status] [30700] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [30700] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T01:17:42.815Z] [runtime-status] [30700] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [30700] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:17:43.136Z] [runtime-status] [30700] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [30700] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T01:17:43.137Z] [runtime-status] [30700] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [30700] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T01:17:43.137Z] [runtime-status] [30700] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [30700] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:17:43.146Z] [runtime-status] [30700] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [30700] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:17:43.150Z] [runtime-status] [30700] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [30700] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:17:43.150Z] [runtime-status] [30700] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [30700] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T01:17:43.319Z] [runtime-status] [30700] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [30700] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T01:17:43.338Z] [runtime-status] [30700] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [30700] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T01:17:43.339Z] [runtime-status] [30700] Listening to port: \\?\pipe\fire_emu_aba0c17733f8b13d {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [30700] Listening to port: \\\\?\\pipe\\fire_emu_aba0c17733f8b13d"}}
[debug] [2024-11-13T01:17:43.406Z] [worker-us-central1-processChat-b32ac1fb-0559-49d3-89c4-9b7ec4386d60]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-b32ac1fb-0559-49d3-89c4-9b7ec4386d60]: IDLE"}}
[debug] [2024-11-13T01:17:43.406Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T01:17:43.407Z] [worker-us-central1-processChat-b32ac1fb-0559-49d3-89c4-9b7ec4386d60]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-b32ac1fb-0559-49d3-89c4-9b7ec4386d60]: BUSY"}}
[debug] [2024-11-13T01:17:43.415Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 8.047ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 8.047ms"}}
[debug] [2024-11-13T01:17:43.416Z] [worker-us-central1-processChat-b32ac1fb-0559-49d3-89c4-9b7ec4386d60]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-b32ac1fb-0559-49d3-89c4-9b7ec4386d60]: IDLE"}}
[debug] [2024-11-13T01:17:43.417Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:17:43.417Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:17:43.417Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:17:43.419Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:17:43.419Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:17:43.419Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:17:43.419Z"],"workRunningCount":1}
[debug] [2024-11-13T01:17:43.420Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T01:17:43.421Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:17:43.422Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T01:17:43.422Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T01:17:43.423Z] [worker-us-central1-processChat-b32ac1fb-0559-49d3-89c4-9b7ec4386d60]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-b32ac1fb-0559-49d3-89c4-9b7ec4386d60]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'hi', chatId: 'chat-1731460545189-p97sybnjh' } {"user":"  data: { message: 'hi', chatId: 'chat-1731460545189-p97sybnjh' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'hi', chatId: 'chat-1731460545189-p97sybnjh' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📝 Using chat ID: chat-1731460545189-p97sybnjh {"user":"📝 Using chat ID: chat-1731460545189-p97sybnjh","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: chat-1731460545189-p97sybnjh"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 2, {"user":"  messageLength: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 2,"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731460545189-p97sybnjh' {"user":"  chatId: 'chat-1731460545189-p97sybnjh'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731460545189-p97sybnjh'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: chat-1731460545189-p97sybnjh {"user":"🆕 Creating new chat session: chat-1731460545189-p97sybnjh","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: chat-1731460545189-p97sybnjh"}}
[info] >  📝 Chat session created: { chatId: 'chat-1731460545189-p97sybnjh', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'chat-1731460545189-p97sybnjh', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'chat-1731460545189-p97sybnjh', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hi {"user":"💬 Sending message to Gemini: hi","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hi"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  📚 Current Chat History: { {"user":"📚 Current Chat History: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📚 Current Chat History: {"}}
[info] >    chatId: 'chat-1731460545189-p97sybnjh', {"user":"  chatId: 'chat-1731460545189-p97sybnjh',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731460545189-p97sybnjh',"}}
[info] >    historyLength: 6, {"user":"  historyLength: 6,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   historyLength: 6,"}}
[info] >    lastMessages: [ {"user":"  lastMessages: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   lastMessages: ["}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'assistant', parts: [Array] }, {"user":"    { role: 'assistant', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'assistant', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] } {"user":"    { role: 'model', parts: [Array] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Response received: { responseLength: 531, timestamp: '2024-11-13T01:17:47.424Z' } {"user":"✅ Response received: { responseLength: 531, timestamp: '2024-11-13T01:17:47.424Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 531, timestamp: '2024-11-13T01:17:47.424Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: 'Hi there!  To help me understand your relationships so I can offer helpful advice, tell me:\n' + {"user":"  message: 'Hi there!  To help me understand your relationships so I can offer helpful advice, tell me:\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Hi there!  To help me understand your relationships so I can offer helpful advice, tell me:\\n' +"}}
[info] >      '\n' + {"user":"    '\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '\\n' +"}}
[info] >      '* **What kind of relationships are you interested in discussing?** (e.g., romantic, familial, friendships, work relationships)\n' + {"user":"    '* **What kind of relationships are you interested in discussing?** (e.g., romantic, familial, friendships, work relationships)\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '* **What kind of relationships are you interested in discussing?** (e.g., romantic, familial, friendships, work relationships)\\n' +"}}
[info] >      '* **What are your specific concerns or questions?** (e.g., communication problems, conflict resolution, trust issues, feeling unsupported)\n' + {"user":"    '* **What are your specific concerns or questions?** (e.g., communication problems, conflict resolution, trust issues, feeling unsupported)\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '* **What are your specific concerns or questions?** (e.g., communication problems, conflict resolution, trust issues, feeling unsupported)\\n' +"}}
[info] >      "* **Can you give me some examples of what's happening?**  (Be as specific as you feel comfortable sharing.)\n" + {"user":"    \"* **Can you give me some examples of what's happening?**  (Be as specific as you feel comfortable sharing.)\\n\" +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"* **Can you give me some examples of what's happening?**  (Be as specific as you feel comfortable sharing.)\\n\" +"}}
[info] >      '\n' + {"user":"    '\\n' +","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     '\\n' +"}}
[info] >      'The more information you give me, the better I can assist you.\n', {"user":"    'The more information you give me, the better I can assist you.\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     'The more information you give me, the better I can assist you.\\n',"}}
[info] >    userMessage: 'hi', {"user":"  userMessage: 'hi',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hi',"}}
[info] >    timestamp: '2024-11-13T01:17:47.425Z', {"user":"  timestamp: '2024-11-13T01:17:47.425Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T01:17:47.425Z',"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731460545189-p97sybnjh' {"user":"  chatId: 'chat-1731460545189-p97sybnjh'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731460545189-p97sybnjh'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Attempting to save chat history with DETAILED logging: { {"user":"🔍 Attempting to save chat history with DETAILED logging: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Attempting to save chat history with DETAILED logging: {"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731460545189-p97sybnjh', {"user":"  chatId: 'chat-1731460545189-p97sybnjh',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731460545189-p97sybnjh',"}}
[info] >    messageCount: 2, {"user":"  messageCount: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageCount: 2,"}}
[info] >    timestamp: '2024-11-13T01:17:47.425Z', {"user":"  timestamp: '2024-11-13T01:17:47.425Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T01:17:47.425Z',"}}
[info] >    clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' } {"user":"  clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔧 Firebase Client Configuration: { {"user":"🔧 Firebase Client Configuration: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Firebase Client Configuration: {"}}
[info] >    projectId: 'notalone-de4fc', {"user":"  projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   projectId: 'notalone-de4fc',"}}
[info] >    apiKey: 'local-api-key', {"user":"  apiKey: 'local-api-key',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   apiKey: 'local-api-key',"}}
[info] >    authDomain: undefined, {"user":"  authDomain: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   authDomain: undefined,"}}
[info] >    emulatorHost: 'localhost', {"user":"  emulatorHost: 'localhost',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorHost: 'localhost',"}}
[info] >    emulatorPort: 5001 {"user":"  emulatorPort: 5001","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorPort: 5001"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Firebase Functions Object Keys: [ {"user":"🔍 Firebase Functions Object Keys: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Object Keys: ["}}
[info] >    'app', {"user":"  'app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'app',"}}
[info] >    'emulatorOrigin', {"user":"  'emulatorOrigin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'emulatorOrigin',"}}
[info] >    'contextProvider', {"user":"  'contextProvider',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'contextProvider',"}}
[info] >    'deleteService', {"user":"  'deleteService',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'deleteService',"}}
[info] >    'cancelAllRequests', {"user":"  'cancelAllRequests',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'cancelAllRequests',"}}
[info] >    'customDomain', {"user":"  'customDomain',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'customDomain',"}}
[info] >    'region' {"user":"  'region'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'region'"}}
[info] >  ] {"user":"]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ]"}}
[info] >  🔍 Firebase Functions Instance: FunctionsService { {"user":"🔍 Firebase Functions Instance: FunctionsService {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Instance: FunctionsService {"}}
[info] >    app: FirebaseAppImpl { {"user":"  app: FirebaseAppImpl {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   app: FirebaseAppImpl {"}}
[info] >      _isDeleted: false, {"user":"    _isDeleted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _isDeleted: false,"}}
[info] >      _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }, {"user":"    _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },"}}
[info] >      _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false }, {"user":"    _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },"}}
[info] >      _name: '[DEFAULT]', {"user":"    _name: '[DEFAULT]',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _name: '[DEFAULT]',"}}
[info] >      _automaticDataCollectionEnabled: false, {"user":"    _automaticDataCollectionEnabled: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _automaticDataCollectionEnabled: false,"}}
[info] >      _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] } {"user":"    _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    emulatorOrigin: 'http://localhost:5001', {"user":"  emulatorOrigin: 'http://localhost:5001',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorOrigin: 'http://localhost:5001',"}}
[info] >    contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null }, {"user":"  contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },"}}
[info] >    deleteService: [Function (anonymous)], {"user":"  deleteService: [Function (anonymous)],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   deleteService: [Function (anonymous)],"}}
[info] >    cancelAllRequests: Promise { <pending> }, {"user":"  cancelAllRequests: Promise { <pending> },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   cancelAllRequests: Promise { <pending> },"}}
[info] >    customDomain: null, {"user":"  customDomain: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   customDomain: null,"}}
[info] >    region: 'us-central1' {"user":"  region: 'us-central1'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   region: 'us-central1'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' } {"user":"🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[info] >  🔍 Save Chat History Function Details: { {"user":"🔍 Save Chat History Function Details: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Save Chat History Function Details: {"}}
[info] >    functionExists: true, {"user":"  functionExists: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionExists: true,"}}
[info] >    functionType: 'function', {"user":"  functionType: 'function',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionType: 'function',"}}
[info] >    functionName: 'saveChatHistory' {"user":"  functionName: 'saveChatHistory'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionName: 'saveChatHistory'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📤 Chat History Payload: { {"user":"📤 Chat History Payload: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Chat History Payload: {"}}
[info] >    "userId": "xDxECJtJiNdgFeQ9L95cAi5LBwzM", {"user":"  \"userId\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"userId\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\","}}
[info] >    "chatId": "chat-1731460545189-p97sybnjh", {"user":"  \"chatId\": \"chat-1731460545189-p97sybnjh\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"chatId\": \"chat-1731460545189-p97sybnjh\","}}
[info] >    "messages": [ {"user":"  \"messages\": [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"messages\": ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "user", {"user":"      \"role\": \"user\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"user\","}}
[info] >        "content": "hi", {"user":"      \"content\": \"hi\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"hi\","}}
[info] >        "timestamp": "2024-11-13T01:17:47.427Z" {"user":"      \"timestamp\": \"2024-11-13T01:17:47.427Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T01:17:47.427Z\""}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "model", {"user":"      \"role\": \"model\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"model\","}}
[info] >        "content": "Hi there!  To help me understand your relationships so I can offer helpful advice, tell me:\n\n* **What kind of relationships are you interested in discussing?** (e.g., romantic, familial, friendships, work relationships)\n* **What are your specific concerns or questions?** (e.g., communication problems, conflict resolution, trust issues, feeling unsupported)\n* **Can you give me some examples of what's happening?**  (Be as specific as you feel comfortable sharing.)\n\nThe more information you give me, the better I can assist you.\n", {"user":"      \"content\": \"Hi there!  To help me understand your relationships so I can offer helpful advice, tell me:\\n\\n* **What kind of relationships are you interested in discussing?** (e.g., romantic, familial, friendships, work relationships)\\n* **What are your specific concerns or questions?** (e.g., communication problems, conflict resolution, trust issues, feeling unsupported)\\n* **Can you give me some examples of what's happening?**  (Be as specific as you feel comfortable sharing.)\\n\\nThe more information you give me, the better I can assist you.\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"Hi there!  To help me understand your relationships so I can offer helpful advice, tell me:\\n\\n* **What kind of relationships are you interested in discussing?** (e.g., romantic, familial, friendships, work relationships)\\n* **What are your specific concerns or questions?** (e.g., communication problems, conflict resolution, trust issues, feeling unsupported)\\n* **Can you give me some examples of what's happening?**  (Be as specific as you feel comfortable sharing.)\\n\\nThe more information you give me, the better I can assist you.\\n\","}}
[info] >        "timestamp": "2024-11-13T01:17:47.427Z" {"user":"      \"timestamp\": \"2024-11-13T01:17:47.427Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T01:17:47.427Z\""}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    "timestamp": "2024-11-13T01:17:47.427Z", {"user":"  \"timestamp\": \"2024-11-13T01:17:47.427Z\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"timestamp\": \"2024-11-13T01:17:47.427Z\","}}
[info] >    "authDetails": { {"user":"  \"authDetails\": {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"authDetails\": {"}}
[info] >      "uid": "xDxECJtJiNdgFeQ9L95cAi5LBwzM", {"user":"    \"uid\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"uid\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\","}}
[info] >      "token": "Present" {"user":"    \"token\": \"Present\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"token\": \"Present\""}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T01:17:47.479Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T01:17:47.479Z"],"queueLength":1,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:17:43.419Z"],"workRunningCount":1}
[debug] [2024-11-13T01:17:47.479Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:17:43.419Z","/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T01:17:47.479Z"],"workRunningCount":2}
[debug] [2024-11-13T01:17:47.479Z] Accepted request POST /notalone-de4fc/us-central1/saveChatHistory --> us-central1-saveChatHistory
[debug] [2024-11-13T01:17:47.479Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:17:47.480Z] [functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/"}}
[debug] [2024-11-13T01:17:47.489Z] [worker-pool] addWorker(us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-saveChatHistory)"}}
[debug] [2024-11-13T01:17:47.490Z] [worker-pool] Adding worker with key us-central1-saveChatHistory, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-saveChatHistory, total=1"}}
[debug] [2024-11-13T01:17:48.927Z] [runtime-status] [31340] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31340] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:17:48.929Z] [runtime-status] [31340] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31340] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:17:48.929Z] [runtime-status] [31340] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31340] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T01:17:48.930Z] [runtime-status] [31340] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31340] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T01:17:48.931Z] [runtime-status] [31340] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31340] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:17:49.240Z] [runtime-status] [31340] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31340] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T01:17:49.240Z] [runtime-status] [31340] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31340] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T01:17:49.241Z] [runtime-status] [31340] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31340] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:17:49.247Z] [runtime-status] [31340] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31340] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:17:49.250Z] [runtime-status] [31340] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31340] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:17:49.250Z] [runtime-status] [31340] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31340] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T01:17:49.356Z] [runtime-status] [31340] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31340] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T01:17:49.367Z] [runtime-status] [31340] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31340] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T01:17:49.368Z] [runtime-status] [31340] Listening to port: \\?\pipe\fire_emu_e874d7019aeb26f2 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31340] Listening to port: \\\\?\\pipe\\fire_emu_e874d7019aeb26f2"}}
[debug] [2024-11-13T01:17:49.468Z] [worker-us-central1-saveChatHistory-f8819115-622e-4718-b3a1-e2bd3a9997e2]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-f8819115-622e-4718-b3a1-e2bd3a9997e2]: IDLE"}}
[debug] [2024-11-13T01:17:49.468Z] [worker-pool] submitRequest(triggerId=us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-saveChatHistory)"}}
[info] i  functions: Beginning execution of "us-central1-saveChatHistory" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Beginning execution of \"us-central1-saveChatHistory\""}}
[debug] [2024-11-13T01:17:49.469Z] [worker-us-central1-saveChatHistory-f8819115-622e-4718-b3a1-e2bd3a9997e2]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-f8819115-622e-4718-b3a1-e2bd3a9997e2]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"MISSING\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🔍 Saving Chat History { {"user":"🔍 Saving Chat History {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Saving Chat History {"}}
[info] >    data: { {"user":"  data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: {"}}
[info] >      rawRequest: IncomingMessage { {"user":"    rawRequest: IncomingMessage {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     rawRequest: IncomingMessage {"}}
[info] >        _events: [Object], {"user":"      _events: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _events: [Object],"}}
[info] >        _readableState: [ReadableState], {"user":"      _readableState: [ReadableState],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _readableState: [ReadableState],"}}
[info] >        _maxListeners: undefined, {"user":"      _maxListeners: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _maxListeners: undefined,"}}
[info] >        socket: [Socket], {"user":"      socket: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       socket: [Socket],"}}
[info] >        httpVersionMajor: 1, {"user":"      httpVersionMajor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMajor: 1,"}}
[info] >        httpVersionMinor: 1, {"user":"      httpVersionMinor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMinor: 1,"}}
[info] >        httpVersion: '1.1', {"user":"      httpVersion: '1.1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersion: '1.1',"}}
[info] >        complete: true, {"user":"      complete: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       complete: true,"}}
[info] >        rawHeaders: [Array], {"user":"      rawHeaders: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawHeaders: [Array],"}}
[info] >        rawTrailers: [], {"user":"      rawTrailers: [],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawTrailers: [],"}}
[info] >        joinDuplicateHeaders: null, {"user":"      joinDuplicateHeaders: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       joinDuplicateHeaders: null,"}}
[info] >        aborted: false, {"user":"      aborted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       aborted: false,"}}
[info] >        upgrade: false, {"user":"      upgrade: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       upgrade: false,"}}
[info] >        url: '/', {"user":"      url: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       url: '/',"}}
[info] >        method: 'POST', {"user":"      method: 'POST',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       method: 'POST',"}}
[info] >        statusCode: null, {"user":"      statusCode: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusCode: null,"}}
[info] >        statusMessage: null, {"user":"      statusMessage: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusMessage: null,"}}
[info] >        client: [Socket], {"user":"      client: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       client: [Socket],"}}
[info] >        _consuming: true, {"user":"      _consuming: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _consuming: true,"}}
[info] >        _dumped: false, {"user":"      _dumped: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _dumped: false,"}}
[info] >        next: [Function: next], {"user":"      next: [Function: next],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       next: [Function: next],"}}
[info] >        baseUrl: '', {"user":"      baseUrl: '',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       baseUrl: '',"}}
[info] >        originalUrl: '/', {"user":"      originalUrl: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       originalUrl: '/',"}}
[info] >        _parsedUrl: [Url], {"user":"      _parsedUrl: [Url],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _parsedUrl: [Url],"}}
[info] >        params: [Object], {"user":"      params: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       params: [Object],"}}
[info] >        query: {}, {"user":"      query: {},","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       query: {},"}}
[info] >        res: [ServerResponse], {"user":"      res: [ServerResponse],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       res: [ServerResponse],"}}
[info] >        body: [Object], {"user":"      body: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       body: [Object],"}}
[info] >        _body: true, {"user":"      _body: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _body: true,"}}
[info] >        length: undefined, {"user":"      length: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       length: undefined,"}}
[info] >        _eventsCount: 0, {"user":"      _eventsCount: 0,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _eventsCount: 0,"}}
[info] >        rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 78 44 78 45 43 4a 74 4a 69 4e 64 67 46 65 51 39 4c 39 35 63 41 69 35 4c 42 77 7a 4d 22 2c 22 ... 769 more bytes>, {"user":"      rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 78 44 78 45 43 4a 74 4a 69 4e 64 67 46 65 51 39 4c 39 35 63 41 69 35 4c 42 77 7a 4d 22 2c 22 ... 769 more bytes>,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 78 44 78 45 43 4a 74 4a 69 4e 64 67 46 65 51 39 4c 39 35 63 41 69 35 4c 42 77 7a 4d 22 2c 22 ... 769 more bytes>,"}}
[info] >        route: [Route], {"user":"      route: [Route],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       route: [Route],"}}
[info] >        [Symbol(shapeMode)]: true, {"user":"      [Symbol(shapeMode)]: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(shapeMode)]: true,"}}
[info] >        [Symbol(kCapture)]: false, {"user":"      [Symbol(kCapture)]: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kCapture)]: false,"}}
[info] >        [Symbol(kHeaders)]: [Object], {"user":"      [Symbol(kHeaders)]: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeaders)]: [Object],"}}
[info] >        [Symbol(kHeadersCount)]: 18, {"user":"      [Symbol(kHeadersCount)]: 18,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeadersCount)]: 18,"}}
[info] >        [Symbol(kTrailers)]: null, {"user":"      [Symbol(kTrailers)]: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailers)]: null,"}}
[info] >        [Symbol(kTrailersCount)]: 0 {"user":"      [Symbol(kTrailersCount)]: 0","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailersCount)]: 0"}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      data: { {"user":"    data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     data: {"}}
[info] >        userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"      userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >        chatId: 'chat-1731460545189-p97sybnjh', {"user":"      chatId: 'chat-1731460545189-p97sybnjh',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       chatId: 'chat-1731460545189-p97sybnjh',"}}
[info] >        messages: [Array], {"user":"      messages: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       messages: [Array],"}}
[info] >        timestamp: '2024-11-13T01:17:47.427Z' {"user":"      timestamp: '2024-11-13T01:17:47.427Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       timestamp: '2024-11-13T01:17:47.427Z'"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ❌ Missing userId or chatId {"user":"❌ Missing userId or chatId","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ Missing userId or chatId"}}
[debug] [2024-11-13T01:17:49.524Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-saveChatHistory" in 54.8398ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finished \"us-central1-saveChatHistory\" in 54.8398ms"}}
[debug] [2024-11-13T01:17:49.525Z] [worker-us-central1-saveChatHistory-f8819115-622e-4718-b3a1-e2bd3a9997e2]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-f8819115-622e-4718-b3a1-e2bd3a9997e2]: IDLE"}}
[debug] [2024-11-13T01:17:49.525Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:17:49.525Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:17:49.525Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:17:43.419Z"],"workRunningCount":1}
[info] >  ❌ COMPREHENSIVE Save Chat History Error (Enhanced): { {"user":"❌ COMPREHENSIVE Save Chat History Error (Enhanced): {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ COMPREHENSIVE Save Chat History Error (Enhanced): {"}}
[info] >    errorType: 'object', {"user":"  errorType: 'object',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorType: 'object',"}}
[info] >    errorInstance: true, {"user":"  errorInstance: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorInstance: true,"}}
[info] >    fullErrorObject: [FunctionsError [FirebaseError]: User ID and Chat ID are required] { {"user":"  fullErrorObject: [FunctionsError [FirebaseError]: User ID and Chat ID are required] {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   fullErrorObject: [FunctionsError [FirebaseError]: User ID and Chat ID are required] {"}}
[info] >      code: 'functions/invalid-argument', {"user":"    code: 'functions/invalid-argument',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 'functions/invalid-argument',"}}
[info] >      customData: undefined, {"user":"    customData: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     customData: undefined,"}}
[info] >      details: undefined {"user":"    details: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     details: undefined"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    stringRepresentation: 'FirebaseError: User ID and Chat ID are required', {"user":"  stringRepresentation: 'FirebaseError: User ID and Chat ID are required',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   stringRepresentation: 'FirebaseError: User ID and Chat ID are required',"}}
[info] >    adminAppConfig: { {"user":"  adminAppConfig: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   adminAppConfig: {"}}
[info] >      storageBucket: 'notalone-de4fc.firebasestorage.app', {"user":"    storageBucket: 'notalone-de4fc.firebasestorage.app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     storageBucket: 'notalone-de4fc.firebasestorage.app',"}}
[info] >      projectId: 'notalone-de4fc', {"user":"    projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     projectId: 'notalone-de4fc',"}}
[info] >      credential: RefreshTokenCredential { {"user":"    credential: RefreshTokenCredential {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     credential: RefreshTokenCredential {"}}
[info] >        httpAgent: undefined, {"user":"      httpAgent: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpAgent: undefined,"}}
[info] >        implicit: true, {"user":"      implicit: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       implicit: true,"}}
[info] >        refreshToken: [RefreshToken], {"user":"      refreshToken: [RefreshToken],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       refreshToken: [RefreshToken],"}}
[info] >        httpClient: [HttpClient] {"user":"      httpClient: [HttpClient]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpClient: [HttpClient]"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T01:17:49.543Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 6120.2516ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 6120.2516ms"}}
[debug] [2024-11-13T01:17:49.545Z] [worker-us-central1-processChat-b32ac1fb-0559-49d3-89c4-9b7ec4386d60]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-b32ac1fb-0559-49d3-89c4-9b7ec4386d60]: IDLE"}}
[debug] [2024-11-13T01:17:49.545Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:17:49.545Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:17:49.545Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  ❌ Detailed Error Breakdown (Enhanced): { {"user":"❌ Detailed Error Breakdown (Enhanced): {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ Detailed Error Breakdown (Enhanced): {"}}
[info] >    errorName: 'FirebaseError', {"user":"  errorName: 'FirebaseError',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorName: 'FirebaseError',"}}
[info] >    errorCode: 'functions/invalid-argument', {"user":"  errorCode: 'functions/invalid-argument',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorCode: 'functions/invalid-argument',"}}
[info] >    errorMessage: 'User ID and Chat ID are required', {"user":"  errorMessage: 'User ID and Chat ID are required',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorMessage: 'User ID and Chat ID are required',"}}
[info] >    errorStack: 'FirebaseError: User ID and Chat ID are required' {"user":"  errorStack: 'FirebaseError: User ID and Chat ID are required'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorStack: 'FirebaseError: User ID and Chat ID are required'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T01:18:02.122Z] File C:\Users\Rob\Apps\not-alone\functions\src\chatHistory.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\chatHistory.ts changed, reloading triggers"}}
[debug] [2024-11-13T01:18:03.135Z] Validating nodejs source
[debug] [2024-11-13T01:18:04.278Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:18:04.278Z] Building nodejs source
[debug] [2024-11-13T01:18:04.278Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:18:04.279Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:18:04.288Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8308

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:18:05.135Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:18:09.159Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:18:09.160Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:18:09.161Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-13T01:18:09.161Z] [worker-us-central1-processChat-b32ac1fb-0559-49d3-89c4-9b7ec4386d60]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-b32ac1fb-0559-49d3-89c4-9b7ec4386d60]: FINISHING"}}
[debug] [2024-11-13T01:18:09.161Z] [worker-pool] Shutting down IDLE worker (us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-saveChatHistory)"}}
[debug] [2024-11-13T01:18:09.161Z] [worker-us-central1-saveChatHistory-f8819115-622e-4718-b3a1-e2bd3a9997e2]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-f8819115-622e-4718-b3a1-e2bd3a9997e2]: FINISHING"}}
[debug] [2024-11-13T01:18:09.173Z] [worker-us-central1-saveChatHistory-f8819115-622e-4718-b3a1-e2bd3a9997e2]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-f8819115-622e-4718-b3a1-e2bd3a9997e2]: exited"}}
[debug] [2024-11-13T01:18:09.174Z] [worker-us-central1-saveChatHistory-f8819115-622e-4718-b3a1-e2bd3a9997e2]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-f8819115-622e-4718-b3a1-e2bd3a9997e2]: FINISHED"}}
[debug] [2024-11-13T01:18:09.174Z] [worker-us-central1-processChat-b32ac1fb-0559-49d3-89c4-9b7ec4386d60]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-b32ac1fb-0559-49d3-89c4-9b7ec4386d60]: exited"}}
[debug] [2024-11-13T01:18:09.174Z] [worker-us-central1-processChat-b32ac1fb-0559-49d3-89c4-9b7ec4386d60]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-b32ac1fb-0559-49d3-89c4-9b7ec4386d60]: FINISHED"}}
[debug] [2024-11-13T01:18:20.978Z] File C:\Users\Rob\Apps\not-alone\functions\src\chatHistory.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\chatHistory.ts changed, reloading triggers"}}
[debug] [2024-11-13T01:18:21.993Z] Validating nodejs source
[debug] [2024-11-13T01:18:22.966Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:18:22.966Z] Building nodejs source
[debug] [2024-11-13T01:18:22.966Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:18:22.968Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:18:22.978Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8809

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:18:23.730Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:18:27.762Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:18:27.763Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:18:36.669Z] File C:\Users\Rob\Apps\not-alone\functions\src\chatHistory.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\chatHistory.ts changed, reloading triggers"}}
[debug] [2024-11-13T01:18:37.678Z] Validating nodejs source
[debug] [2024-11-13T01:18:39.021Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:18:39.022Z] Building nodejs source
[debug] [2024-11-13T01:18:39.022Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:18:39.023Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:18:39.036Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8806

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:18:39.787Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:18:43.816Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:18:43.817Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:18:48.077Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:18:48.079Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js changed, reloading triggers"}}
[debug] [2024-11-13T01:18:48.113Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:18:48.115Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-13T01:18:49.129Z] Validating nodejs source
[debug] [2024-11-13T01:18:50.112Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:18:50.113Z] Building nodejs source
[debug] [2024-11-13T01:18:50.113Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:18:50.114Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:18:50.122Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8892

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:18:50.930Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:18:54.964Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:18:54.965Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:18:59.288Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:18:59.288Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:18:59.288Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:18:59.288Z"],"workRunningCount":1}
[debug] [2024-11-13T01:18:59.288Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T01:18:59.291Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:18:59.291Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T01:18:59.291Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-13T01:18:59.291Z] [worker-pool] Cleaned up workers for us-central1-saveChatHistory: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-saveChatHistory: 1 --> 0"}}
[debug] [2024-11-13T01:18:59.300Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-13T01:18:59.300Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-13T01:19:01.044Z] [runtime-status] [35160] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35160] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:19:01.047Z] [runtime-status] [35160] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35160] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:19:01.047Z] [runtime-status] [35160] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35160] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T01:19:01.048Z] [runtime-status] [35160] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35160] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T01:19:01.049Z] [runtime-status] [35160] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35160] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:19:01.520Z] [runtime-status] [35160] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35160] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T01:19:01.520Z] [runtime-status] [35160] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35160] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T01:19:01.521Z] [runtime-status] [35160] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35160] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:19:01.526Z] [runtime-status] [35160] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35160] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:19:01.529Z] [runtime-status] [35160] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35160] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:19:01.529Z] [runtime-status] [35160] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35160] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T01:19:01.655Z] [runtime-status] [35160] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35160] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T01:19:01.667Z] [runtime-status] [35160] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35160] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T01:19:01.669Z] [runtime-status] [35160] Listening to port: \\?\pipe\fire_emu_5f82c8130f5bd5c1 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [35160] Listening to port: \\\\?\\pipe\\fire_emu_5f82c8130f5bd5c1"}}
[debug] [2024-11-13T01:19:01.717Z] [worker-us-central1-processChat-dc532822-8553-44c6-9a73-47787f8160d6]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-dc532822-8553-44c6-9a73-47787f8160d6]: IDLE"}}
[debug] [2024-11-13T01:19:01.718Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T01:19:01.719Z] [worker-us-central1-processChat-dc532822-8553-44c6-9a73-47787f8160d6]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-dc532822-8553-44c6-9a73-47787f8160d6]: BUSY"}}
[debug] [2024-11-13T01:19:01.724Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4.723ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4.723ms"}}
[debug] [2024-11-13T01:19:01.725Z] [worker-us-central1-processChat-dc532822-8553-44c6-9a73-47787f8160d6]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-dc532822-8553-44c6-9a73-47787f8160d6]: IDLE"}}
[debug] [2024-11-13T01:19:01.725Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:19:01.725Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:19:01.726Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:19:01.727Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:19:01.727Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:19:01.727Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:19:01.727Z"],"workRunningCount":1}
[debug] [2024-11-13T01:19:01.727Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T01:19:01.728Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:19:01.728Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T01:19:01.728Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T01:19:01.730Z] [worker-us-central1-processChat-dc532822-8553-44c6-9a73-47787f8160d6]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-dc532822-8553-44c6-9a73-47787f8160d6]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi' } } {"user":"🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi' } }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi' } }"}}
[info] >  📝 Using chat ID: undefined {"user":"📝 Using chat ID: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: undefined"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 2, {"user":"  messageLength: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 2,"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: undefined {"user":"  chatId: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: undefined"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: chat-1731460741748-3rb09v6zt {"user":"🆕 Creating new chat session: chat-1731460741748-3rb09v6zt","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: chat-1731460741748-3rb09v6zt"}}
[info] >  📝 Chat session created: { chatId: 'chat-1731460741748-3rb09v6zt', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'chat-1731460741748-3rb09v6zt', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'chat-1731460741748-3rb09v6zt', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hi {"user":"💬 Sending message to Gemini: hi","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hi"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  📚 Current Chat History: { {"user":"📚 Current Chat History: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📚 Current Chat History: {"}}
[info] >    chatId: 'chat-1731460741748-3rb09v6zt', {"user":"  chatId: 'chat-1731460741748-3rb09v6zt',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731460741748-3rb09v6zt',"}}
[info] >    historyLength: 6, {"user":"  historyLength: 6,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   historyLength: 6,"}}
[info] >    lastMessages: [ {"user":"  lastMessages: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   lastMessages: ["}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'assistant', parts: [Array] }, {"user":"    { role: 'assistant', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'assistant', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] } {"user":"    { role: 'model', parts: [Array] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Response received: { responseLength: 156, timestamp: '2024-11-13T01:19:04.017Z' } {"user":"✅ Response received: { responseLength: 156, timestamp: '2024-11-13T01:19:04.017Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 156, timestamp: '2024-11-13T01:19:04.017Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: "Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in general relationship advice?  Let's talk!\n", {"user":"  message: \"Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in general relationship advice?  Let's talk!\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: \"Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in general relationship advice?  Let's talk!\\n\","}}
[info] >    userMessage: 'hi', {"user":"  userMessage: 'hi',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hi',"}}
[info] >    timestamp: '2024-11-13T01:19:04.018Z', {"user":"  timestamp: '2024-11-13T01:19:04.018Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T01:19:04.018Z',"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731460741748-3rb09v6zt' {"user":"  chatId: 'chat-1731460741748-3rb09v6zt'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731460741748-3rb09v6zt'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Attempting to save chat history with DETAILED logging: { {"user":"🔍 Attempting to save chat history with DETAILED logging: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Attempting to save chat history with DETAILED logging: {"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731460741748-3rb09v6zt', {"user":"  chatId: 'chat-1731460741748-3rb09v6zt',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731460741748-3rb09v6zt',"}}
[info] >    messageCount: 2, {"user":"  messageCount: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageCount: 2,"}}
[info] >    timestamp: '2024-11-13T01:19:04.018Z', {"user":"  timestamp: '2024-11-13T01:19:04.018Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T01:19:04.018Z',"}}
[info] >    clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' } {"user":"  clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔧 Firebase Client Configuration: { {"user":"🔧 Firebase Client Configuration: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Firebase Client Configuration: {"}}
[info] >    projectId: 'notalone-de4fc', {"user":"  projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   projectId: 'notalone-de4fc',"}}
[info] >    apiKey: 'local-api-key', {"user":"  apiKey: 'local-api-key',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   apiKey: 'local-api-key',"}}
[info] >    authDomain: undefined, {"user":"  authDomain: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   authDomain: undefined,"}}
[info] >    emulatorHost: 'localhost', {"user":"  emulatorHost: 'localhost',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorHost: 'localhost',"}}
[info] >    emulatorPort: 5001 {"user":"  emulatorPort: 5001","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorPort: 5001"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Firebase Functions Object Keys: [ {"user":"🔍 Firebase Functions Object Keys: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Object Keys: ["}}
[info] >    'app', {"user":"  'app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'app',"}}
[info] >    'emulatorOrigin', {"user":"  'emulatorOrigin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'emulatorOrigin',"}}
[info] >    'contextProvider', {"user":"  'contextProvider',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'contextProvider',"}}
[info] >    'deleteService', {"user":"  'deleteService',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'deleteService',"}}
[info] >    'cancelAllRequests', {"user":"  'cancelAllRequests',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'cancelAllRequests',"}}
[info] >    'customDomain', {"user":"  'customDomain',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'customDomain',"}}
[info] >    'region' {"user":"  'region'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'region'"}}
[info] >  ] {"user":"]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ]"}}
[info] >  🔍 Firebase Functions Instance: FunctionsService { {"user":"🔍 Firebase Functions Instance: FunctionsService {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Instance: FunctionsService {"}}
[info] >    app: FirebaseAppImpl { {"user":"  app: FirebaseAppImpl {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   app: FirebaseAppImpl {"}}
[info] >      _isDeleted: false, {"user":"    _isDeleted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _isDeleted: false,"}}
[info] >      _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }, {"user":"    _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },"}}
[info] >      _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false }, {"user":"    _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },"}}
[info] >      _name: '[DEFAULT]', {"user":"    _name: '[DEFAULT]',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _name: '[DEFAULT]',"}}
[info] >      _automaticDataCollectionEnabled: false, {"user":"    _automaticDataCollectionEnabled: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _automaticDataCollectionEnabled: false,"}}
[info] >      _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] } {"user":"    _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    emulatorOrigin: 'http://localhost:5001', {"user":"  emulatorOrigin: 'http://localhost:5001',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorOrigin: 'http://localhost:5001',"}}
[info] >    contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null }, {"user":"  contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },"}}
[info] >    deleteService: [Function (anonymous)], {"user":"  deleteService: [Function (anonymous)],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   deleteService: [Function (anonymous)],"}}
[info] >    cancelAllRequests: Promise { <pending> }, {"user":"  cancelAllRequests: Promise { <pending> },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   cancelAllRequests: Promise { <pending> },"}}
[info] >    customDomain: null, {"user":"  customDomain: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   customDomain: null,"}}
[info] >    region: 'us-central1' {"user":"  region: 'us-central1'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   region: 'us-central1'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' } {"user":"🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[info] >  🔍 Save Chat History Function Details: { {"user":"🔍 Save Chat History Function Details: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Save Chat History Function Details: {"}}
[info] >    functionExists: true, {"user":"  functionExists: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionExists: true,"}}
[info] >    functionType: 'function', {"user":"  functionType: 'function',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionType: 'function',"}}
[info] >    functionName: 'saveChatHistory' {"user":"  functionName: 'saveChatHistory'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionName: 'saveChatHistory'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📤 Chat History Payload: { {"user":"📤 Chat History Payload: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Chat History Payload: {"}}
[info] >    "userId": "xDxECJtJiNdgFeQ9L95cAi5LBwzM", {"user":"  \"userId\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"userId\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\","}}
[info] >    "chatId": "chat-1731460741748-3rb09v6zt", {"user":"  \"chatId\": \"chat-1731460741748-3rb09v6zt\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"chatId\": \"chat-1731460741748-3rb09v6zt\","}}
[info] >    "messages": [ {"user":"  \"messages\": [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"messages\": ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "user", {"user":"      \"role\": \"user\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"user\","}}
[info] >        "content": "hi", {"user":"      \"content\": \"hi\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"hi\","}}
[info] >        "timestamp": "2024-11-13T01:19:04.020Z" {"user":"      \"timestamp\": \"2024-11-13T01:19:04.020Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T01:19:04.020Z\""}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "model", {"user":"      \"role\": \"model\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"model\","}}
[info] >        "content": "Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in general relationship advice?  Let's talk!\n", {"user":"      \"content\": \"Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in general relationship advice?  Let's talk!\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in general relationship advice?  Let's talk!\\n\","}}
[info] >        "timestamp": "2024-11-13T01:19:04.020Z" {"user":"      \"timestamp\": \"2024-11-13T01:19:04.020Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T01:19:04.020Z\""}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    "timestamp": "2024-11-13T01:19:04.020Z", {"user":"  \"timestamp\": \"2024-11-13T01:19:04.020Z\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"timestamp\": \"2024-11-13T01:19:04.020Z\","}}
[info] >    "authDetails": { {"user":"  \"authDetails\": {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"authDetails\": {"}}
[info] >      "uid": "xDxECJtJiNdgFeQ9L95cAi5LBwzM", {"user":"    \"uid\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"uid\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\","}}
[info] >      "token": "Present" {"user":"    \"token\": \"Present\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"token\": \"Present\""}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T01:19:04.076Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T01:19:04.076Z"],"queueLength":1,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:19:01.727Z"],"workRunningCount":1}
[debug] [2024-11-13T01:19:04.076Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:19:01.727Z","/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T01:19:04.076Z"],"workRunningCount":2}
[debug] [2024-11-13T01:19:04.076Z] Accepted request POST /notalone-de4fc/us-central1/saveChatHistory --> us-central1-saveChatHistory
[debug] [2024-11-13T01:19:04.077Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:19:04.077Z] [functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/"}}
[debug] [2024-11-13T01:19:04.089Z] [worker-pool] addWorker(us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-saveChatHistory)"}}
[debug] [2024-11-13T01:19:04.089Z] [worker-pool] Adding worker with key us-central1-saveChatHistory, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-saveChatHistory, total=1"}}
[debug] [2024-11-13T01:19:05.651Z] [runtime-status] [15944] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [15944] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:19:05.653Z] [runtime-status] [15944] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [15944] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:19:05.653Z] [runtime-status] [15944] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [15944] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T01:19:05.653Z] [runtime-status] [15944] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [15944] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T01:19:05.654Z] [runtime-status] [15944] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [15944] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:19:05.954Z] [runtime-status] [15944] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [15944] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T01:19:05.954Z] [runtime-status] [15944] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [15944] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T01:19:05.955Z] [runtime-status] [15944] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [15944] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:19:05.959Z] [runtime-status] [15944] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [15944] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:19:05.962Z] [runtime-status] [15944] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [15944] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:19:05.962Z] [runtime-status] [15944] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [15944] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T01:19:06.061Z] [runtime-status] [15944] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [15944] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T01:19:06.071Z] [runtime-status] [15944] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [15944] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T01:19:06.072Z] [runtime-status] [15944] Listening to port: \\?\pipe\fire_emu_e30b058fcf50d022 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [15944] Listening to port: \\\\?\\pipe\\fire_emu_e30b058fcf50d022"}}
[debug] [2024-11-13T01:19:06.183Z] [worker-us-central1-saveChatHistory-06592eb7-8859-4669-ac8d-7cfa543e8028]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-06592eb7-8859-4669-ac8d-7cfa543e8028]: IDLE"}}
[debug] [2024-11-13T01:19:06.183Z] [worker-pool] submitRequest(triggerId=us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-saveChatHistory)"}}
[info] i  functions: Beginning execution of "us-central1-saveChatHistory" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Beginning execution of \"us-central1-saveChatHistory\""}}
[debug] [2024-11-13T01:19:06.184Z] [worker-us-central1-saveChatHistory-06592eb7-8859-4669-ac8d-7cfa543e8028]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-06592eb7-8859-4669-ac8d-7cfa543e8028]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"MISSING\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🔍 Saving Chat History { {"user":"🔍 Saving Chat History {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Saving Chat History {"}}
[info] >    data: { {"user":"  data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: {"}}
[info] >      rawRequest: IncomingMessage { {"user":"    rawRequest: IncomingMessage {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     rawRequest: IncomingMessage {"}}
[info] >        _events: [Object], {"user":"      _events: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _events: [Object],"}}
[info] >        _readableState: [ReadableState], {"user":"      _readableState: [ReadableState],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _readableState: [ReadableState],"}}
[info] >        _maxListeners: undefined, {"user":"      _maxListeners: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _maxListeners: undefined,"}}
[info] >        socket: [Socket], {"user":"      socket: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       socket: [Socket],"}}
[info] >        httpVersionMajor: 1, {"user":"      httpVersionMajor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMajor: 1,"}}
[info] >        httpVersionMinor: 1, {"user":"      httpVersionMinor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMinor: 1,"}}
[info] >        httpVersion: '1.1', {"user":"      httpVersion: '1.1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersion: '1.1',"}}
[info] >        complete: true, {"user":"      complete: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       complete: true,"}}
[info] >        rawHeaders: [Array], {"user":"      rawHeaders: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawHeaders: [Array],"}}
[info] >        rawTrailers: [], {"user":"      rawTrailers: [],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawTrailers: [],"}}
[info] >        joinDuplicateHeaders: null, {"user":"      joinDuplicateHeaders: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       joinDuplicateHeaders: null,"}}
[info] >        aborted: false, {"user":"      aborted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       aborted: false,"}}
[info] >        upgrade: false, {"user":"      upgrade: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       upgrade: false,"}}
[info] >        url: '/', {"user":"      url: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       url: '/',"}}
[info] >        method: 'POST', {"user":"      method: 'POST',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       method: 'POST',"}}
[info] >        statusCode: null, {"user":"      statusCode: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusCode: null,"}}
[info] >        statusMessage: null, {"user":"      statusMessage: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusMessage: null,"}}
[info] >        client: [Socket], {"user":"      client: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       client: [Socket],"}}
[info] >        _consuming: true, {"user":"      _consuming: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _consuming: true,"}}
[info] >        _dumped: false, {"user":"      _dumped: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _dumped: false,"}}
[info] >        next: [Function: next], {"user":"      next: [Function: next],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       next: [Function: next],"}}
[info] >        baseUrl: '', {"user":"      baseUrl: '',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       baseUrl: '',"}}
[info] >        originalUrl: '/', {"user":"      originalUrl: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       originalUrl: '/',"}}
[info] >        _parsedUrl: [Url], {"user":"      _parsedUrl: [Url],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _parsedUrl: [Url],"}}
[info] >        params: [Object], {"user":"      params: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       params: [Object],"}}
[info] >        query: {}, {"user":"      query: {},","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       query: {},"}}
[info] >        res: [ServerResponse], {"user":"      res: [ServerResponse],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       res: [ServerResponse],"}}
[info] >        body: [Object], {"user":"      body: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       body: [Object],"}}
[info] >        _body: true, {"user":"      _body: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _body: true,"}}
[info] >        length: undefined, {"user":"      length: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       length: undefined,"}}
[info] >        _eventsCount: 0, {"user":"      _eventsCount: 0,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _eventsCount: 0,"}}
[info] >        rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 78 44 78 45 43 4a 74 4a 69 4e 64 67 46 65 51 39 4c 39 35 63 41 69 35 4c 42 77 7a 4d 22 2c 22 ... 388 more bytes>, {"user":"      rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 78 44 78 45 43 4a 74 4a 69 4e 64 67 46 65 51 39 4c 39 35 63 41 69 35 4c 42 77 7a 4d 22 2c 22 ... 388 more bytes>,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 78 44 78 45 43 4a 74 4a 69 4e 64 67 46 65 51 39 4c 39 35 63 41 69 35 4c 42 77 7a 4d 22 2c 22 ... 388 more bytes>,"}}
[info] >        route: [Route], {"user":"      route: [Route],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       route: [Route],"}}
[info] >        [Symbol(shapeMode)]: true, {"user":"      [Symbol(shapeMode)]: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(shapeMode)]: true,"}}
[info] >        [Symbol(kCapture)]: false, {"user":"      [Symbol(kCapture)]: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kCapture)]: false,"}}
[info] >        [Symbol(kHeaders)]: [Object], {"user":"      [Symbol(kHeaders)]: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeaders)]: [Object],"}}
[info] >        [Symbol(kHeadersCount)]: 18, {"user":"      [Symbol(kHeadersCount)]: 18,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeadersCount)]: 18,"}}
[info] >        [Symbol(kTrailers)]: null, {"user":"      [Symbol(kTrailers)]: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailers)]: null,"}}
[info] >        [Symbol(kTrailersCount)]: 0 {"user":"      [Symbol(kTrailersCount)]: 0","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailersCount)]: 0"}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      data: { {"user":"    data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     data: {"}}
[info] >        userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"      userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >        chatId: 'chat-1731460741748-3rb09v6zt', {"user":"      chatId: 'chat-1731460741748-3rb09v6zt',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       chatId: 'chat-1731460741748-3rb09v6zt',"}}
[info] >        messages: [Array], {"user":"      messages: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       messages: [Array],"}}
[info] >        timestamp: '2024-11-13T01:19:04.020Z' {"user":"      timestamp: '2024-11-13T01:19:04.020Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       timestamp: '2024-11-13T01:19:04.020Z'"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ❌ Missing userId or chatId {"user":"❌ Missing userId or chatId","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ Missing userId or chatId"}}
[debug] [2024-11-13T01:19:06.228Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-saveChatHistory" in 44.4554ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finished \"us-central1-saveChatHistory\" in 44.4554ms"}}
[debug] [2024-11-13T01:19:06.229Z] [worker-us-central1-saveChatHistory-06592eb7-8859-4669-ac8d-7cfa543e8028]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-06592eb7-8859-4669-ac8d-7cfa543e8028]: IDLE"}}
[debug] [2024-11-13T01:19:06.229Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:19:06.229Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:19:06.229Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:19:01.727Z"],"workRunningCount":1}
[info] >  ❌ COMPREHENSIVE Save Chat History Error (Enhanced): { {"user":"❌ COMPREHENSIVE Save Chat History Error (Enhanced): {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ COMPREHENSIVE Save Chat History Error (Enhanced): {"}}
[info] >    errorType: 'object', {"user":"  errorType: 'object',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorType: 'object',"}}
[info] >    errorInstance: true, {"user":"  errorInstance: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorInstance: true,"}}
[info] >    fullErrorObject: [FunctionsError [FirebaseError]: User ID and Chat ID are required] { {"user":"  fullErrorObject: [FunctionsError [FirebaseError]: User ID and Chat ID are required] {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   fullErrorObject: [FunctionsError [FirebaseError]: User ID and Chat ID are required] {"}}
[info] >      code: 'functions/invalid-argument', {"user":"    code: 'functions/invalid-argument',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 'functions/invalid-argument',"}}
[info] >      customData: undefined, {"user":"    customData: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     customData: undefined,"}}
[info] >      details: undefined {"user":"    details: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     details: undefined"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    stringRepresentation: 'FirebaseError: User ID and Chat ID are required', {"user":"  stringRepresentation: 'FirebaseError: User ID and Chat ID are required',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   stringRepresentation: 'FirebaseError: User ID and Chat ID are required',"}}
[info] >    adminAppConfig: { {"user":"  adminAppConfig: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   adminAppConfig: {"}}
[info] >      storageBucket: 'notalone-de4fc.firebasestorage.app', {"user":"    storageBucket: 'notalone-de4fc.firebasestorage.app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     storageBucket: 'notalone-de4fc.firebasestorage.app',"}}
[info] >      projectId: 'notalone-de4fc', {"user":"    projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     projectId: 'notalone-de4fc',"}}
[info] >      credential: RefreshTokenCredential { {"user":"    credential: RefreshTokenCredential {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     credential: RefreshTokenCredential {"}}
[info] >        httpAgent: undefined, {"user":"      httpAgent: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpAgent: undefined,"}}
[info] >        implicit: true, {"user":"      implicit: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       implicit: true,"}}
[info] >        refreshToken: [RefreshToken], {"user":"      refreshToken: [RefreshToken],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       refreshToken: [RefreshToken],"}}
[info] >        httpClient: [HttpClient] {"user":"      httpClient: [HttpClient]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpClient: [HttpClient]"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T01:19:06.245Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4515.2155ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4515.2155ms"}}
[debug] [2024-11-13T01:19:06.246Z] [worker-us-central1-processChat-dc532822-8553-44c6-9a73-47787f8160d6]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-dc532822-8553-44c6-9a73-47787f8160d6]: IDLE"}}
[debug] [2024-11-13T01:19:06.246Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:19:06.246Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:19:06.246Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[info] >  ❌ Detailed Error Breakdown (Enhanced): { {"user":"❌ Detailed Error Breakdown (Enhanced): {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ❌ Detailed Error Breakdown (Enhanced): {"}}
[info] >    errorName: 'FirebaseError', {"user":"  errorName: 'FirebaseError',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorName: 'FirebaseError',"}}
[info] >    errorCode: 'functions/invalid-argument', {"user":"  errorCode: 'functions/invalid-argument',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorCode: 'functions/invalid-argument',"}}
[info] >    errorMessage: 'User ID and Chat ID are required', {"user":"  errorMessage: 'User ID and Chat ID are required',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorMessage: 'User ID and Chat ID are required',"}}
[info] >    errorStack: 'FirebaseError: User ID and Chat ID are required' {"user":"  errorStack: 'FirebaseError: User ID and Chat ID are required'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   errorStack: 'FirebaseError: User ID and Chat ID are required'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T01:19:38.071Z] File C:\Users\Rob\Apps\not-alone\functions\src\chatHistory.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\src\\chatHistory.ts changed, reloading triggers"}}
[debug] [2024-11-13T01:19:39.081Z] Validating nodejs source
[debug] [2024-11-13T01:19:40.078Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:19:40.078Z] Building nodejs source
[debug] [2024-11-13T01:19:40.078Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:19:40.079Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:19:40.090Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8060

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:19:40.789Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:19:44.821Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:19:44.822Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:19:44.822Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-13T01:19:44.822Z] [worker-us-central1-processChat-dc532822-8553-44c6-9a73-47787f8160d6]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-dc532822-8553-44c6-9a73-47787f8160d6]: FINISHING"}}
[debug] [2024-11-13T01:19:44.823Z] [worker-pool] Shutting down IDLE worker (us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-saveChatHistory)"}}
[debug] [2024-11-13T01:19:44.823Z] [worker-us-central1-saveChatHistory-06592eb7-8859-4669-ac8d-7cfa543e8028]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-06592eb7-8859-4669-ac8d-7cfa543e8028]: FINISHING"}}
[debug] [2024-11-13T01:19:44.835Z] [worker-us-central1-processChat-dc532822-8553-44c6-9a73-47787f8160d6]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-dc532822-8553-44c6-9a73-47787f8160d6]: exited"}}
[debug] [2024-11-13T01:19:44.835Z] [worker-us-central1-processChat-dc532822-8553-44c6-9a73-47787f8160d6]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-dc532822-8553-44c6-9a73-47787f8160d6]: FINISHED"}}
[debug] [2024-11-13T01:19:44.835Z] [worker-us-central1-saveChatHistory-06592eb7-8859-4669-ac8d-7cfa543e8028]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-06592eb7-8859-4669-ac8d-7cfa543e8028]: exited"}}
[debug] [2024-11-13T01:19:44.835Z] [worker-us-central1-saveChatHistory-06592eb7-8859-4669-ac8d-7cfa543e8028]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-06592eb7-8859-4669-ac8d-7cfa543e8028]: FINISHED"}}
[debug] [2024-11-13T01:20:32.896Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:20:32.896Z] File C:\Users\Rob\Apps\not-alone\functions\lib\chatHistory.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\chatHistory.js changed, reloading triggers"}}
[debug] [2024-11-13T01:20:32.924Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-13T01:20:32.927Z] File C:\Users\Rob\Apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\Apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-13T01:20:33.936Z] Validating nodejs source
[debug] [2024-11-13T01:20:35.100Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T01:20:35.100Z] Building nodejs source
[debug] [2024-11-13T01:20:35.101Z] Failed to find version of module node: reached end of search path C:\Users\Rob\Apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T01:20:35.102Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T01:20:35.114Z] Found firebase-functions binary at 'C:\Users\Rob\Apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8317

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T01:20:35.951Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T01:20:39.979Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T01:20:39.980Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T01:20:43.155Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:20:43.155Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:20:43.155Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:20:43.155Z"],"workRunningCount":1}
[debug] [2024-11-13T01:20:43.155Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T01:20:43.158Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:20:43.158Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T01:20:43.158Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-13T01:20:43.158Z] [worker-pool] Cleaned up workers for us-central1-saveChatHistory: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-saveChatHistory: 1 --> 0"}}
[debug] [2024-11-13T01:20:43.167Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-13T01:20:43.167Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-13T01:20:44.772Z] [runtime-status] [4760] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4760] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:20:44.774Z] [runtime-status] [4760] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4760] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:20:44.774Z] [runtime-status] [4760] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4760] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T01:20:44.774Z] [runtime-status] [4760] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4760] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T01:20:44.775Z] [runtime-status] [4760] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4760] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:20:45.098Z] [runtime-status] [4760] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4760] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T01:20:45.098Z] [runtime-status] [4760] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4760] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T01:20:45.099Z] [runtime-status] [4760] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4760] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:20:45.104Z] [runtime-status] [4760] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4760] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:20:45.106Z] [runtime-status] [4760] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4760] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:20:45.107Z] [runtime-status] [4760] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4760] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T01:20:45.223Z] [runtime-status] [4760] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4760] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T01:20:45.234Z] [runtime-status] [4760] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4760] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T01:20:45.235Z] [runtime-status] [4760] Listening to port: \\?\pipe\fire_emu_b6b9cddf4d5b6381 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4760] Listening to port: \\\\?\\pipe\\fire_emu_b6b9cddf4d5b6381"}}
[debug] [2024-11-13T01:20:45.280Z] [worker-us-central1-processChat-fc35868e-9508-4384-a68c-d1a706c865e2]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-fc35868e-9508-4384-a68c-d1a706c865e2]: IDLE"}}
[debug] [2024-11-13T01:20:45.281Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T01:20:45.281Z] [worker-us-central1-processChat-fc35868e-9508-4384-a68c-d1a706c865e2]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-fc35868e-9508-4384-a68c-d1a706c865e2]: BUSY"}}
[debug] [2024-11-13T01:20:45.287Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 6.0926ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 6.0926ms"}}
[debug] [2024-11-13T01:20:45.289Z] [worker-us-central1-processChat-fc35868e-9508-4384-a68c-d1a706c865e2]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-fc35868e-9508-4384-a68c-d1a706c865e2]: IDLE"}}
[debug] [2024-11-13T01:20:45.289Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:20:45.289Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:20:45.289Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:20:45.290Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:20:45.290Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T01:20:45.290Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:20:45.290Z"],"workRunningCount":1}
[debug] [2024-11-13T01:20:45.290Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T01:20:45.291Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:20:45.291Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T01:20:45.292Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T01:20:45.292Z] [worker-us-central1-processChat-fc35868e-9508-4384-a68c-d1a706c865e2]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-fc35868e-9508-4384-a68c-d1a706c865e2]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi' } } {"user":"🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi' } }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hi' } }"}}
[info] >  📝 Using chat ID: undefined {"user":"📝 Using chat ID: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: undefined"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 2, {"user":"  messageLength: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 2,"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: undefined {"user":"  chatId: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: undefined"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: chat-1731460845312-qxrqkichj {"user":"🆕 Creating new chat session: chat-1731460845312-qxrqkichj","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: chat-1731460845312-qxrqkichj"}}
[info] >  📝 Chat session created: { chatId: 'chat-1731460845312-qxrqkichj', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'chat-1731460845312-qxrqkichj', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'chat-1731460845312-qxrqkichj', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hi {"user":"💬 Sending message to Gemini: hi","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hi"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  📚 Current Chat History: { {"user":"📚 Current Chat History: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📚 Current Chat History: {"}}
[info] >    chatId: 'chat-1731460845312-qxrqkichj', {"user":"  chatId: 'chat-1731460845312-qxrqkichj',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731460845312-qxrqkichj',"}}
[info] >    historyLength: 6, {"user":"  historyLength: 6,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   historyLength: 6,"}}
[info] >    lastMessages: [ {"user":"  lastMessages: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   lastMessages: ["}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'assistant', parts: [Array] }, {"user":"    { role: 'assistant', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'assistant', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] } {"user":"    { role: 'model', parts: [Array] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Response received: { responseLength: 168, timestamp: '2024-11-13T01:20:47.615Z' } {"user":"✅ Response received: { responseLength: 168, timestamp: '2024-11-13T01:20:47.615Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 168, timestamp: '2024-11-13T01:20:47.615Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: 'Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\n', {"user":"  message: 'Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\\n',"}}
[info] >    userMessage: 'hi', {"user":"  userMessage: 'hi',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hi',"}}
[info] >    timestamp: '2024-11-13T01:20:47.616Z', {"user":"  timestamp: '2024-11-13T01:20:47.616Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T01:20:47.616Z',"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731460845312-qxrqkichj' {"user":"  chatId: 'chat-1731460845312-qxrqkichj'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731460845312-qxrqkichj'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Attempting to save chat history with DETAILED logging: { {"user":"🔍 Attempting to save chat history with DETAILED logging: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Attempting to save chat history with DETAILED logging: {"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731460845312-qxrqkichj', {"user":"  chatId: 'chat-1731460845312-qxrqkichj',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731460845312-qxrqkichj',"}}
[info] >    messageCount: 2, {"user":"  messageCount: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageCount: 2,"}}
[info] >    timestamp: '2024-11-13T01:20:47.616Z', {"user":"  timestamp: '2024-11-13T01:20:47.616Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T01:20:47.616Z',"}}
[info] >    clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' } {"user":"  clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔧 Firebase Client Configuration: { {"user":"🔧 Firebase Client Configuration: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Firebase Client Configuration: {"}}
[info] >    projectId: 'notalone-de4fc', {"user":"  projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   projectId: 'notalone-de4fc',"}}
[info] >    apiKey: 'local-api-key', {"user":"  apiKey: 'local-api-key',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   apiKey: 'local-api-key',"}}
[info] >    authDomain: undefined, {"user":"  authDomain: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   authDomain: undefined,"}}
[info] >    emulatorHost: 'localhost', {"user":"  emulatorHost: 'localhost',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorHost: 'localhost',"}}
[info] >    emulatorPort: 5001 {"user":"  emulatorPort: 5001","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorPort: 5001"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Firebase Functions Object Keys: [ {"user":"🔍 Firebase Functions Object Keys: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Object Keys: ["}}
[info] >    'app', {"user":"  'app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'app',"}}
[info] >    'emulatorOrigin', {"user":"  'emulatorOrigin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'emulatorOrigin',"}}
[info] >    'contextProvider', {"user":"  'contextProvider',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'contextProvider',"}}
[info] >    'deleteService', {"user":"  'deleteService',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'deleteService',"}}
[info] >    'cancelAllRequests', {"user":"  'cancelAllRequests',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'cancelAllRequests',"}}
[info] >    'customDomain', {"user":"  'customDomain',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'customDomain',"}}
[info] >    'region' {"user":"  'region'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'region'"}}
[info] >  ] {"user":"]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ]"}}
[info] >  🔍 Firebase Functions Instance: FunctionsService { {"user":"🔍 Firebase Functions Instance: FunctionsService {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Instance: FunctionsService {"}}
[info] >    app: FirebaseAppImpl { {"user":"  app: FirebaseAppImpl {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   app: FirebaseAppImpl {"}}
[info] >      _isDeleted: false, {"user":"    _isDeleted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _isDeleted: false,"}}
[info] >      _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }, {"user":"    _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },"}}
[info] >      _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false }, {"user":"    _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },"}}
[info] >      _name: '[DEFAULT]', {"user":"    _name: '[DEFAULT]',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _name: '[DEFAULT]',"}}
[info] >      _automaticDataCollectionEnabled: false, {"user":"    _automaticDataCollectionEnabled: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _automaticDataCollectionEnabled: false,"}}
[info] >      _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] } {"user":"    _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    emulatorOrigin: 'http://localhost:5001', {"user":"  emulatorOrigin: 'http://localhost:5001',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorOrigin: 'http://localhost:5001',"}}
[info] >    contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null }, {"user":"  contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },"}}
[info] >    deleteService: [Function (anonymous)], {"user":"  deleteService: [Function (anonymous)],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   deleteService: [Function (anonymous)],"}}
[info] >    cancelAllRequests: Promise { <pending> }, {"user":"  cancelAllRequests: Promise { <pending> },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   cancelAllRequests: Promise { <pending> },"}}
[info] >    customDomain: null, {"user":"  customDomain: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   customDomain: null,"}}
[info] >    region: 'us-central1' {"user":"  region: 'us-central1'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   region: 'us-central1'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' } {"user":"🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[info] >  🔍 Save Chat History Function Details: { {"user":"🔍 Save Chat History Function Details: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Save Chat History Function Details: {"}}
[info] >    functionExists: true, {"user":"  functionExists: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionExists: true,"}}
[info] >    functionType: 'function', {"user":"  functionType: 'function',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionType: 'function',"}}
[info] >    functionName: 'saveChatHistory' {"user":"  functionName: 'saveChatHistory'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionName: 'saveChatHistory'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📤 Chat History Payload: { {"user":"📤 Chat History Payload: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Chat History Payload: {"}}
[info] >    "userId": "xDxECJtJiNdgFeQ9L95cAi5LBwzM", {"user":"  \"userId\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"userId\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\","}}
[info] >    "chatId": "chat-1731460845312-qxrqkichj", {"user":"  \"chatId\": \"chat-1731460845312-qxrqkichj\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"chatId\": \"chat-1731460845312-qxrqkichj\","}}
[info] >    "messages": [ {"user":"  \"messages\": [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"messages\": ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "user", {"user":"      \"role\": \"user\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"user\","}}
[info] >        "content": "hi", {"user":"      \"content\": \"hi\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"hi\","}}
[info] >        "timestamp": "2024-11-13T01:20:47.619Z" {"user":"      \"timestamp\": \"2024-11-13T01:20:47.619Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T01:20:47.619Z\""}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "model", {"user":"      \"role\": \"model\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"model\","}}
[info] >        "content": "Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\n", {"user":"      \"content\": \"Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"Hi there! How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\\n\","}}
[info] >        "timestamp": "2024-11-13T01:20:47.619Z" {"user":"      \"timestamp\": \"2024-11-13T01:20:47.619Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T01:20:47.619Z\""}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    "timestamp": "2024-11-13T01:20:47.619Z", {"user":"  \"timestamp\": \"2024-11-13T01:20:47.619Z\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"timestamp\": \"2024-11-13T01:20:47.619Z\","}}
[info] >    "authDetails": { {"user":"  \"authDetails\": {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"authDetails\": {"}}
[info] >      "uid": "xDxECJtJiNdgFeQ9L95cAi5LBwzM", {"user":"    \"uid\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"uid\": \"xDxECJtJiNdgFeQ9L95cAi5LBwzM\","}}
[info] >      "token": "Present" {"user":"    \"token\": \"Present\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"token\": \"Present\""}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T01:20:47.695Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T01:20:47.695Z"],"queueLength":1,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:20:45.290Z"],"workRunningCount":1}
[debug] [2024-11-13T01:20:47.695Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:20:45.290Z","/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T01:20:47.695Z"],"workRunningCount":2}
[debug] [2024-11-13T01:20:47.695Z] Accepted request POST /notalone-de4fc/us-central1/saveChatHistory --> us-central1-saveChatHistory
[debug] [2024-11-13T01:20:47.696Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T01:20:47.696Z] [functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/"}}
[debug] [2024-11-13T01:20:47.711Z] [worker-pool] addWorker(us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-saveChatHistory)"}}
[debug] [2024-11-13T01:20:47.711Z] [worker-pool] Adding worker with key us-central1-saveChatHistory, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-saveChatHistory, total=1"}}
[debug] [2024-11-13T01:20:49.456Z] [runtime-status] [19988] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [19988] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:20:49.458Z] [runtime-status] [19988] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [19988] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:20:49.458Z] [runtime-status] [19988] Found local functions config: C:\Users\Rob\Apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [19988] Found local functions config: C:\\Users\\Rob\\Apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T01:20:49.458Z] [runtime-status] [19988] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [19988] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T01:20:49.459Z] [runtime-status] [19988] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [19988] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:20:49.800Z] [runtime-status] [19988] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [19988] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T01:20:49.801Z] [runtime-status] [19988] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [19988] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T01:20:49.801Z] [runtime-status] [19988] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [19988] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:20:49.807Z] [runtime-status] [19988] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [19988] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T01:20:49.810Z] [runtime-status] [19988] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [19988] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T01:20:49.810Z] [runtime-status] [19988] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\Apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [19988] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T01:20:49.931Z] [runtime-status] [19988] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [19988] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T01:20:49.942Z] [runtime-status] [19988] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\Apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [19988] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\Apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T01:20:49.943Z] [runtime-status] [19988] Listening to port: \\?\pipe\fire_emu_9fa08829b785c137 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [19988] Listening to port: \\\\?\\pipe\\fire_emu_9fa08829b785c137"}}
[debug] [2024-11-13T01:20:50.030Z] [worker-us-central1-saveChatHistory-622472c6-6d9f-4734-8b16-a72727947847]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-622472c6-6d9f-4734-8b16-a72727947847]: IDLE"}}
[debug] [2024-11-13T01:20:50.030Z] [worker-pool] submitRequest(triggerId=us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-saveChatHistory)"}}
[info] i  functions: Beginning execution of "us-central1-saveChatHistory" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Beginning execution of \"us-central1-saveChatHistory\""}}
[debug] [2024-11-13T01:20:50.031Z] [worker-us-central1-saveChatHistory-622472c6-6d9f-4734-8b16-a72727947847]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-622472c6-6d9f-4734-8b16-a72727947847]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"MISSING\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🔍 Saving Chat History { {"user":"🔍 Saving Chat History {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Saving Chat History {"}}
[info] >    request: { {"user":"  request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   request: {"}}
[info] >      rawRequest: IncomingMessage { {"user":"    rawRequest: IncomingMessage {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     rawRequest: IncomingMessage {"}}
[info] >        _events: [Object], {"user":"      _events: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _events: [Object],"}}
[info] >        _readableState: [ReadableState], {"user":"      _readableState: [ReadableState],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _readableState: [ReadableState],"}}
[info] >        _maxListeners: undefined, {"user":"      _maxListeners: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _maxListeners: undefined,"}}
[info] >        socket: [Socket], {"user":"      socket: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       socket: [Socket],"}}
[info] >        httpVersionMajor: 1, {"user":"      httpVersionMajor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMajor: 1,"}}
[info] >        httpVersionMinor: 1, {"user":"      httpVersionMinor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMinor: 1,"}}
[info] >        httpVersion: '1.1', {"user":"      httpVersion: '1.1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersion: '1.1',"}}
[info] >        complete: true, {"user":"      complete: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       complete: true,"}}
[info] >        rawHeaders: [Array], {"user":"      rawHeaders: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawHeaders: [Array],"}}
[info] >        rawTrailers: [], {"user":"      rawTrailers: [],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawTrailers: [],"}}
[info] >        joinDuplicateHeaders: null, {"user":"      joinDuplicateHeaders: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       joinDuplicateHeaders: null,"}}
[info] >        aborted: false, {"user":"      aborted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       aborted: false,"}}
[info] >        upgrade: false, {"user":"      upgrade: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       upgrade: false,"}}
[info] >        url: '/', {"user":"      url: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       url: '/',"}}
[info] >        method: 'POST', {"user":"      method: 'POST',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       method: 'POST',"}}
[info] >        statusCode: null, {"user":"      statusCode: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusCode: null,"}}
[info] >        statusMessage: null, {"user":"      statusMessage: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusMessage: null,"}}
[info] >        client: [Socket], {"user":"      client: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       client: [Socket],"}}
[info] >        _consuming: true, {"user":"      _consuming: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _consuming: true,"}}
[info] >        _dumped: false, {"user":"      _dumped: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _dumped: false,"}}
[info] >        next: [Function: next], {"user":"      next: [Function: next],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       next: [Function: next],"}}
[info] >        baseUrl: '', {"user":"      baseUrl: '',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       baseUrl: '',"}}
[info] >        originalUrl: '/', {"user":"      originalUrl: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       originalUrl: '/',"}}
[info] >        _parsedUrl: [Url], {"user":"      _parsedUrl: [Url],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _parsedUrl: [Url],"}}
[info] >        params: [Object], {"user":"      params: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       params: [Object],"}}
[info] >        query: {}, {"user":"      query: {},","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       query: {},"}}
[info] >        res: [ServerResponse], {"user":"      res: [ServerResponse],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       res: [ServerResponse],"}}
[info] >        body: [Object], {"user":"      body: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       body: [Object],"}}
[info] >        _body: true, {"user":"      _body: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _body: true,"}}
[info] >        length: undefined, {"user":"      length: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       length: undefined,"}}
[info] >        _eventsCount: 0, {"user":"      _eventsCount: 0,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _eventsCount: 0,"}}
[info] >        rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 78 44 78 45 43 4a 74 4a 69 4e 64 67 46 65 51 39 4c 39 35 63 41 69 35 4c 42 77 7a 4d 22 2c 22 ... 400 more bytes>, {"user":"      rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 78 44 78 45 43 4a 74 4a 69 4e 64 67 46 65 51 39 4c 39 35 63 41 69 35 4c 42 77 7a 4d 22 2c 22 ... 400 more bytes>,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 78 44 78 45 43 4a 74 4a 69 4e 64 67 46 65 51 39 4c 39 35 63 41 69 35 4c 42 77 7a 4d 22 2c 22 ... 400 more bytes>,"}}
[info] >        route: [Route], {"user":"      route: [Route],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       route: [Route],"}}
[info] >        [Symbol(shapeMode)]: true, {"user":"      [Symbol(shapeMode)]: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(shapeMode)]: true,"}}
[info] >        [Symbol(kCapture)]: false, {"user":"      [Symbol(kCapture)]: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kCapture)]: false,"}}
[info] >        [Symbol(kHeaders)]: [Object], {"user":"      [Symbol(kHeaders)]: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeaders)]: [Object],"}}
[info] >        [Symbol(kHeadersCount)]: 18, {"user":"      [Symbol(kHeadersCount)]: 18,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeadersCount)]: 18,"}}
[info] >        [Symbol(kTrailers)]: null, {"user":"      [Symbol(kTrailers)]: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailers)]: null,"}}
[info] >        [Symbol(kTrailersCount)]: 0 {"user":"      [Symbol(kTrailersCount)]: 0","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailersCount)]: 0"}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      data: { {"user":"    data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     data: {"}}
[info] >        userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"      userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >        chatId: 'chat-1731460845312-qxrqkichj', {"user":"      chatId: 'chat-1731460845312-qxrqkichj',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       chatId: 'chat-1731460845312-qxrqkichj',"}}
[info] >        messages: [Array], {"user":"      messages: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       messages: [Array],"}}
[info] >        timestamp: '2024-11-13T01:20:47.619Z' {"user":"      timestamp: '2024-11-13T01:20:47.619Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       timestamp: '2024-11-13T01:20:47.619Z'"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Extracted Data: { {"user":"🔍 Extracted Data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Extracted Data: {"}}
[info] >    userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM', {"user":"  userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'xDxECJtJiNdgFeQ9L95cAi5LBwzM',"}}
[info] >    chatId: 'chat-1731460845312-qxrqkichj', {"user":"  chatId: 'chat-1731460845312-qxrqkichj',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731460845312-qxrqkichj',"}}
[info] >    messagesCount: 2 {"user":"  messagesCount: 2","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   messagesCount: 2"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Chat history saved: chat-1731460845312-qxrqkichj {"user":"✅ Chat history saved: chat-1731460845312-qxrqkichj","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Chat history saved: chat-1731460845312-qxrqkichj"}}
[debug] [2024-11-13T01:20:50.544Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-saveChatHistory" in 512.9275ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finished \"us-central1-saveChatHistory\" in 512.9275ms"}}
[debug] [2024-11-13T01:20:50.545Z] [worker-us-central1-saveChatHistory-622472c6-6d9f-4734-8b16-a72727947847]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-622472c6-6d9f-4734-8b16-a72727947847]: IDLE"}}
[debug] [2024-11-13T01:20:50.545Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:20:50.545Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:20:50.545Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T01:20:45.290Z"],"workRunningCount":1}
[info] >  ✅ Chat history save result: { data: { success: true, message: 'Chat history saved' } } {"user":"✅ Chat history save result: { data: { success: true, message: 'Chat history saved' } }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Chat history save result: { data: { success: true, message: 'Chat history saved' } }"}}
[debug] [2024-11-13T01:20:50.548Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 5255.5072ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 5255.5072ms"}}
[debug] [2024-11-13T01:20:50.548Z] [worker-us-central1-processChat-fc35868e-9508-4384-a68c-d1a706c865e2]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-fc35868e-9508-4384-a68c-d1a706c865e2]: IDLE"}}
[debug] [2024-11-13T01:20:50.548Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T01:20:50.549Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T01:20:50.549Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
