[debug] [2024-11-13T03:34:46.518Z] ----------------------------------------------------------------------
[debug] [2024-11-13T03:34:46.521Z] Command:       C:\Program Files\nodejs\node.exe C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\bin\firebase.js emulators:start
[debug] [2024-11-13T03:34:46.522Z] CLI Version:   13.24.2
[debug] [2024-11-13T03:34:46.522Z] Platform:      win32
[debug] [2024-11-13T03:34:46.522Z] Node Version:  v20.18.0
[debug] [2024-11-13T03:34:46.522Z] Time:          Wed Nov 13 2024 14:34:46 GMT+1100 (Australian Eastern Daylight Time)
[debug] [2024-11-13T03:34:46.522Z] ----------------------------------------------------------------------
[debug] 
[debug] [2024-11-13T03:34:46.654Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2024-11-13T03:34:46.654Z] > authorizing via signed-in user (lisakhun58@gmail.com)
[debug] [2024-11-13T03:34:46.770Z] java version "21.0.5" 2024-10-15 LTS

[debug] [2024-11-13T03:34:46.771Z] Java(TM) SE Runtime Environment (build 21.0.5+9-LTS-239)
Java HotSpot(TM) 64-Bit Server VM (build 21.0.5+9-LTS-239, mixed mode, sharing)

[debug] [2024-11-13T03:34:46.798Z] Parsed Java major version: 21
[info] i  emulators: Starting emulators: auth, functions, firestore, extensions {"metadata":{"emulator":{"name":"hub"},"message":"Starting emulators: auth, functions, firestore, extensions"}}
[debug] [2024-11-13T03:34:46.801Z] Checked if tokens are valid: true, expires at: 1731472478120
[debug] [2024-11-13T03:34:46.801Z] Checked if tokens are valid: true, expires at: 1731472478120
[debug] [2024-11-13T03:34:46.803Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc [none]
[debug] [2024-11-13T03:34:47.359Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc 200
[debug] [2024-11-13T03:34:47.359Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc {"projectId":"notalone-de4fc","projectNumber":"784029337452","displayName":"NotAlone","name":"projects/notalone-de4fc","resources":{"hostingSite":"notalone-de4fc"},"state":"ACTIVE","etag":"1_570ddbb0-4c2c-4e94-b3b3-0005c847d3e1"}
[debug] [2024-11-13T03:34:47.375Z] [logging] Logging Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-13T03:34:47.376Z] [auth] Authentication Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-13T03:34:47.376Z] [firestore] Firestore Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-13T03:34:47.376Z] [firestore.websocket] websocket server for firestore only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-13T03:34:47.376Z] assigned listening specs for emulators {"user":{"hub":[{"address":"127.0.0.1","family":"IPv4","port":4400},{"address":"::1","family":"IPv6","port":4400}],"ui":[{"address":"127.0.0.1","family":"IPv4","port":4000},{"address":"::1","family":"IPv6","port":4000}],"logging":[{"address":"127.0.0.1","family":"IPv4","port":4500}],"auth":[{"address":"127.0.0.1","family":"IPv4","port":9099}],"firestore":[{"address":"127.0.0.1","family":"IPv4","port":8080}],"firestore.websocket":[{"address":"127.0.0.1","family":"IPv4","port":9150}]},"metadata":{"message":"assigned listening specs for emulators"}}
[debug] [2024-11-13T03:34:47.383Z] [hub] writing locator at C:\Users\Rob\AppData\Local\Temp\hub-notalone-de4fc.json
[debug] [2024-11-13T03:34:47.392Z] [Extensions] Started Extensions emulator, this is a noop.
[debug] [2024-11-13T03:34:47.398Z] [functions] Functions Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-13T03:34:47.398Z] [eventarc] Eventarc Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-13T03:34:47.398Z] [tasks] Cloud Tasks Emulator only supports listening on one address (127.0.0.1). Not listening on ::1
[debug] [2024-11-13T03:34:47.398Z] late-assigned ports for functions and eventarc emulators {"user":{"hub":[{"address":"127.0.0.1","family":"IPv4","port":4400},{"address":"::1","family":"IPv6","port":4400}],"ui":[{"address":"127.0.0.1","family":"IPv4","port":4000},{"address":"::1","family":"IPv6","port":4000}],"logging":[{"address":"127.0.0.1","family":"IPv4","port":4500}],"auth":[{"address":"127.0.0.1","family":"IPv4","port":9099}],"firestore":[{"address":"127.0.0.1","family":"IPv4","port":8080}],"firestore.websocket":[{"address":"127.0.0.1","family":"IPv4","port":9150}],"functions":[{"address":"127.0.0.1","family":"IPv4","port":5001}],"eventarc":[{"address":"127.0.0.1","family":"IPv4","port":9299}],"tasks":[{"address":"127.0.0.1","family":"IPv4","port":9499}]},"metadata":{"message":"late-assigned ports for functions and eventarc emulators"}}
[warn] !  functions: The following emulators are not running, calls to these services from the Functions emulator will affect production: database, hosting, pubsub, storage, dataconnect {"metadata":{"emulator":{"name":"functions"},"message":"The following emulators are not running, calls to these services from the Functions emulator will affect production: \u001b[1mdatabase, hosting, pubsub, storage, dataconnect\u001b[22m"}}
[debug] [2024-11-13T03:34:47.403Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T03:34:47.406Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[debug] [2024-11-13T03:34:47.407Z] Checked if tokens are valid: true, expires at: 1731472478120
[debug] [2024-11-13T03:34:47.407Z] Checked if tokens are valid: true, expires at: 1731472478120
[debug] [2024-11-13T03:34:47.407Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc/adminSdkConfig [none]
[debug] [2024-11-13T03:34:47.858Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc/adminSdkConfig 200
[debug] [2024-11-13T03:34:47.858Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/notalone-de4fc/adminSdkConfig {"projectId":"notalone-de4fc","storageBucket":"notalone-de4fc.firebasestorage.app"}
[debug] [2024-11-13T03:34:47.879Z] Ignoring unsupported arg: auto_download {"metadata":{"emulator":{"name":"firestore"},"message":"Ignoring unsupported arg: auto_download"}}
[debug] [2024-11-13T03:34:47.879Z] Ignoring unsupported arg: single_project_mode_error {"metadata":{"emulator":{"name":"firestore"},"message":"Ignoring unsupported arg: single_project_mode_error"}}
[debug] [2024-11-13T03:34:47.879Z] Starting Firestore Emulator with command {"binary":"java","args":["-Dgoogle.cloud_firestore.debug_log_level=FINE","-Duser.language=en","-jar","C:\\Users\\Rob\\.cache\\firebase\\emulators\\cloud-firestore-emulator-v1.19.8.jar","--host","127.0.0.1","--port",8080,"--websocket_port",9150,"--project_id","notalone-de4fc","--rules","C:\\Users\\Rob\\apps\\not-alone\\firestore.rules","--single_project_mode",true,"--functions_emulator","127.0.0.1:5001"],"optionalArgs":["port","webchannel_port","host","rules","websocket_port","functions_emulator","seed_from_export","project_id","single_project_mode"],"joinArgs":false,"shell":false,"port":8080} {"metadata":{"emulator":{"name":"firestore"},"message":"Starting Firestore Emulator with command {\"binary\":\"java\",\"args\":[\"-Dgoogle.cloud_firestore.debug_log_level=FINE\",\"-Duser.language=en\",\"-jar\",\"C:\\\\Users\\\\Rob\\\\.cache\\\\firebase\\\\emulators\\\\cloud-firestore-emulator-v1.19.8.jar\",\"--host\",\"127.0.0.1\",\"--port\",8080,\"--websocket_port\",9150,\"--project_id\",\"notalone-de4fc\",\"--rules\",\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\firestore.rules\",\"--single_project_mode\",true,\"--functions_emulator\",\"127.0.0.1:5001\"],\"optionalArgs\":[\"port\",\"webchannel_port\",\"host\",\"rules\",\"websocket_port\",\"functions_emulator\",\"seed_from_export\",\"project_id\",\"single_project_mode\"],\"joinArgs\":false,\"shell\":false,\"port\":8080}"}}
[info] i  firestore: Firestore Emulator logging to firestore-debug.log {"metadata":{"emulator":{"name":"firestore"},"message":"Firestore Emulator logging to \u001b[1mfirestore-debug.log\u001b[22m"}}
[info] +  firestore: Firestore Emulator UI websocket is running on 9150. {"metadata":{"emulator":{"name":"firestore"},"message":"Firestore Emulator UI websocket is running on 9150."}}
[debug] [2024-11-13T03:34:57.661Z] Ignoring unsupported arg: auto_download {"metadata":{"emulator":{"name":"ui"},"message":"Ignoring unsupported arg: auto_download"}}
[debug] [2024-11-13T03:34:57.661Z] Ignoring unsupported arg: port {"metadata":{"emulator":{"name":"ui"},"message":"Ignoring unsupported arg: port"}}
[debug] [2024-11-13T03:34:57.661Z] Starting Emulator UI with command {"binary":"node","args":["C:\\Users\\Rob\\.cache\\firebase\\emulators\\ui-v1.14.0\\server\\server.mjs"],"optionalArgs":[],"joinArgs":false,"shell":false,"port":4000} {"metadata":{"emulator":{"name":"ui"},"message":"Starting Emulator UI with command {\"binary\":\"node\",\"args\":[\"C:\\\\Users\\\\Rob\\\\.cache\\\\firebase\\\\emulators\\\\ui-v1.14.0\\\\server\\\\server.mjs\"],\"optionalArgs\":[],\"joinArgs\":false,\"shell\":false,\"port\":4000}"}}
[info] i  ui: Emulator UI logging to ui-debug.log {"metadata":{"emulator":{"name":"ui"},"message":"Emulator UI logging to \u001b[1mui-debug.log\u001b[22m"}}
[debug] [2024-11-13T03:34:57.818Z] Web / API server started at 127.0.0.1:4000
 {"metadata":{"emulator":{"name":"ui"},"message":"Web / API server started at 127.0.0.1:4000\n"}}
[debug] [2024-11-13T03:34:57.819Z] Web / API server started at ::1:4000
 {"metadata":{"emulator":{"name":"ui"},"message":"Web / API server started at ::1:4000\n"}}
[debug] [2024-11-13T03:34:57.880Z] [Extensions] Connecting Extensions emulator, this is a noop.
[info] i  functions: Watching "C:\Users\Rob\apps\not-alone\functions" for Cloud Functions... {"metadata":{"emulator":{"name":"functions"},"message":"Watching \"C:\\Users\\Rob\\apps\\not-alone\\functions\" for Cloud Functions..."}}
[debug] [2024-11-13T03:34:57.887Z] Validating nodejs source
[debug] [2024-11-13T03:34:58.963Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T03:34:58.963Z] Building nodejs source
[debug] [2024-11-13T03:34:58.963Z] Failed to find version of module node: reached end of search path C:\Users\Rob\apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T03:34:58.965Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T03:34:58.975Z] Found firebase-functions binary at 'C:\Users\Rob\apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8581

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T03:34:59.931Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T03:35:03.969Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T03:35:03.970Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[info] +  functions[us-central1-saveChatHistory]: http function initialized (http://127.0.0.1:5001/notalone-de4fc/us-central1/saveChatHistory). {"metadata":{"emulator":{"name":"functions"},"message":"\u001b[1mhttp\u001b[22m function initialized (http://127.0.0.1:5001/notalone-de4fc/us-central1/saveChatHistory)."}}
[info] +  functions[us-central1-processChat]: http function initialized (http://127.0.0.1:5001/notalone-de4fc/us-central1/processChat). {"metadata":{"emulator":{"name":"functions"},"message":"\u001b[1mhttp\u001b[22m function initialized (http://127.0.0.1:5001/notalone-de4fc/us-central1/processChat)."}}
[debug] [2024-11-13T03:35:03.979Z] Could not find VSCode notification endpoint: FetchError: request to http://localhost:40001/vscode/notify failed, reason: . If you are not running the Firebase Data Connect VSCode extension, this is expected and not an issue.
[info] 
┌─────────────────────────────────────────────────────────────┐
│ ✔  All emulators ready! It is now safe to connect your app. │
│ i  View Emulator UI at http://127.0.0.1:4000/               │
└─────────────────────────────────────────────────────────────┘

┌────────────────┬────────────────┬──────────────────────────────────┐
│ Emulator       │ Host:Port      │ View in Emulator UI              │
├────────────────┼────────────────┼──────────────────────────────────┤
│ Authentication │ 127.0.0.1:9099 │ http://127.0.0.1:4000/auth       │
├────────────────┼────────────────┼──────────────────────────────────┤
│ Functions      │ 127.0.0.1:5001 │ http://127.0.0.1:4000/functions  │
├────────────────┼────────────────┼──────────────────────────────────┤
│ Firestore      │ 127.0.0.1:8080 │ http://127.0.0.1:4000/firestore  │
├────────────────┼────────────────┼──────────────────────────────────┤
│ Extensions     │ 127.0.0.1:5001 │ http://127.0.0.1:4000/extensions │
└────────────────┴────────────────┴──────────────────────────────────┘
  Emulator Hub running at 127.0.0.1:4400
  Other reserved ports: 4500, 9150
┌─────────────────────────┬───────────────┬─────────────────────┐
│ Extension Instance Name │ Extension Ref │ View in Emulator UI │
└─────────────────────────┴───────────────┴─────────────────────┘
Issues? Report them at https://github.com/firebase/firebase-tools/issues and attach the *-debug.log files.
 
[debug] [2024-11-13T03:37:12.236Z] >>> [apiv2][query] POST http://127.0.0.1:5001/functions/projects/notalone-de4fc/trigger_multicast [none]
[debug] [2024-11-13T03:37:12.236Z] >>> [apiv2][body] POST http://127.0.0.1:5001/functions/projects/notalone-de4fc/trigger_multicast {"eventId":"580e9ad4-56d0-46c4-afa1-e5b0315119ae","eventType":"providers/firebase.auth/eventTypes/user.create","resource":{"name":"projects/notalone-de4fc","service":"firebaseauth.googleapis.com"},"params":{},"timestamp":"2024-11-13T03:37:12.236Z","data":{"uid":"k6hl0WpTQ5fsHjYfrDRxSUjVxEr1","email":"grass.panda.447@example.com","emailVerified":true,"displayName":"Grass Panda","metadata":{"creationTime":"2024-11-13T03:37:12.235Z","lastSignInTime":"2024-11-13T03:37:12.235Z"},"customClaims":{},"providerData":[{"providerId":"google.com","rawId":"9140768851012161299493509697448848415114","federatedId":"9140768851012161299493509697448848415114","displayName":"Grass Panda","email":"grass.panda.447@example.com","screenName":"panda_grass"}]}}
[debug] [2024-11-13T03:37:12.247Z] <<< [apiv2][status] POST http://127.0.0.1:5001/functions/projects/notalone-de4fc/trigger_multicast 200
[debug] [2024-11-13T03:37:12.247Z] <<< [apiv2][body] POST http://127.0.0.1:5001/functions/projects/notalone-de4fc/trigger_multicast {"status":"multicast_acknowledged"}
[debug] [2024-11-13T03:37:15.480Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:37:15.480Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:37:15.480Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:37:15.480Z"],"workRunningCount":1}
[debug] [2024-11-13T03:37:15.481Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T03:37:15.486Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T03:37:15.487Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T03:37:15.500Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-13T03:37:15.501Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-13T03:37:17.365Z] [runtime-status] [32512] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32512] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T03:37:17.367Z] [runtime-status] [32512] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32512] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T03:37:17.368Z] [runtime-status] [32512] Found local functions config: C:\Users\Rob\apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32512] Found local functions config: C:\\Users\\Rob\\apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T03:37:17.368Z] [runtime-status] [32512] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32512] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T03:37:17.369Z] [runtime-status] [32512] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32512] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T03:37:17.762Z] [runtime-status] [32512] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32512] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T03:37:17.763Z] [runtime-status] [32512] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32512] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T03:37:17.764Z] [runtime-status] [32512] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32512] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T03:37:17.772Z] [runtime-status] [32512] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32512] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T03:37:17.775Z] [runtime-status] [32512] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32512] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T03:37:17.776Z] [runtime-status] [32512] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32512] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T03:37:17.882Z] [runtime-status] [32512] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32512] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T03:37:17.892Z] [runtime-status] [32512] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32512] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T03:37:17.893Z] [runtime-status] [32512] Listening to port: \\?\pipe\fire_emu_7789672c3f9f1fa8 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [32512] Listening to port: \\\\?\\pipe\\fire_emu_7789672c3f9f1fa8"}}
[debug] [2024-11-13T03:37:17.926Z] [worker-us-central1-processChat-3ea34fee-238f-4cc2-a08b-8a55ea84221b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3ea34fee-238f-4cc2-a08b-8a55ea84221b]: IDLE"}}
[debug] [2024-11-13T03:37:17.926Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T03:37:17.927Z] [worker-us-central1-processChat-3ea34fee-238f-4cc2-a08b-8a55ea84221b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3ea34fee-238f-4cc2-a08b-8a55ea84221b]: BUSY"}}
[debug] [2024-11-13T03:37:17.932Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4.7976ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4.7976ms"}}
[debug] [2024-11-13T03:37:17.933Z] [worker-us-central1-processChat-3ea34fee-238f-4cc2-a08b-8a55ea84221b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3ea34fee-238f-4cc2-a08b-8a55ea84221b]: IDLE"}}
[debug] [2024-11-13T03:37:17.933Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T03:37:17.933Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T03:37:17.933Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:37:17.934Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:37:17.934Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:37:17.934Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:37:17.934Z"],"workRunningCount":1}
[debug] [2024-11-13T03:37:17.934Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T03:37:17.935Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T03:37:17.935Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T03:37:17.935Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T03:37:17.936Z] [worker-us-central1-processChat-3ea34fee-238f-4cc2-a08b-8a55ea84221b]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3ea34fee-238f-4cc2-a08b-8a55ea84221b]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello' } } {"user":"🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello' } }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello' } }"}}
[info] >  📝 Using chat ID: undefined {"user":"📝 Using chat ID: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: undefined"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 5, {"user":"  messageLength: 5,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 5,"}}
[info] >    userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1', {"user":"  userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',"}}
[info] >    chatId: undefined {"user":"  chatId: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: undefined"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: chat-1731469037953-ttk8uytjd {"user":"🆕 Creating new chat session: chat-1731469037953-ttk8uytjd","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: chat-1731469037953-ttk8uytjd"}}
[info] >  📝 Chat session created: { chatId: 'chat-1731469037953-ttk8uytjd', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'chat-1731469037953-ttk8uytjd', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'chat-1731469037953-ttk8uytjd', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  📚 Current Chat History: { {"user":"📚 Current Chat History: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📚 Current Chat History: {"}}
[info] >    chatId: 'chat-1731469037953-ttk8uytjd', {"user":"  chatId: 'chat-1731469037953-ttk8uytjd',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731469037953-ttk8uytjd',"}}
[info] >    historyLength: 6, {"user":"  historyLength: 6,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   historyLength: 6,"}}
[info] >    lastMessages: [ {"user":"  lastMessages: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   lastMessages: ["}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'assistant', parts: [Array] }, {"user":"    { role: 'assistant', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'assistant', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] } {"user":"    { role: 'model', parts: [Array] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Response received: { responseLength: 172, timestamp: '2024-11-13T03:37:20.096Z' } {"user":"✅ Response received: { responseLength: 172, timestamp: '2024-11-13T03:37:20.096Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 172, timestamp: '2024-11-13T03:37:20.096Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: 'Hello there!  How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\n', {"user":"  message: 'Hello there!  How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Hello there!  How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\\n',"}}
[info] >    userMessage: 'hello', {"user":"  userMessage: 'hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hello',"}}
[info] >    timestamp: '2024-11-13T03:37:20.097Z', {"user":"  timestamp: '2024-11-13T03:37:20.097Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T03:37:20.097Z',"}}
[info] >    userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1', {"user":"  userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',"}}
[info] >    chatId: 'chat-1731469037953-ttk8uytjd' {"user":"  chatId: 'chat-1731469037953-ttk8uytjd'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731469037953-ttk8uytjd'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Attempting to save chat history with DETAILED logging: { {"user":"🔍 Attempting to save chat history with DETAILED logging: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Attempting to save chat history with DETAILED logging: {"}}
[info] >    userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1', {"user":"  userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',"}}
[info] >    chatId: 'chat-1731469037953-ttk8uytjd', {"user":"  chatId: 'chat-1731469037953-ttk8uytjd',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731469037953-ttk8uytjd',"}}
[info] >    messageCount: 2, {"user":"  messageCount: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageCount: 2,"}}
[info] >    timestamp: '2024-11-13T03:37:20.097Z', {"user":"  timestamp: '2024-11-13T03:37:20.097Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T03:37:20.097Z',"}}
[info] >    clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' } {"user":"  clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔧 Firebase Client Configuration: { {"user":"🔧 Firebase Client Configuration: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Firebase Client Configuration: {"}}
[info] >    projectId: 'notalone-de4fc', {"user":"  projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   projectId: 'notalone-de4fc',"}}
[info] >    apiKey: 'local-api-key', {"user":"  apiKey: 'local-api-key',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   apiKey: 'local-api-key',"}}
[info] >    authDomain: undefined, {"user":"  authDomain: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   authDomain: undefined,"}}
[info] >    emulatorHost: 'localhost', {"user":"  emulatorHost: 'localhost',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorHost: 'localhost',"}}
[info] >    emulatorPort: 5001 {"user":"  emulatorPort: 5001","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorPort: 5001"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Firebase Functions Object Keys: [ {"user":"🔍 Firebase Functions Object Keys: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Object Keys: ["}}
[info] >    'app', {"user":"  'app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'app',"}}
[info] >    'emulatorOrigin', {"user":"  'emulatorOrigin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'emulatorOrigin',"}}
[info] >    'contextProvider', {"user":"  'contextProvider',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'contextProvider',"}}
[info] >    'deleteService', {"user":"  'deleteService',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'deleteService',"}}
[info] >    'cancelAllRequests', {"user":"  'cancelAllRequests',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'cancelAllRequests',"}}
[info] >    'customDomain', {"user":"  'customDomain',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'customDomain',"}}
[info] >    'region' {"user":"  'region'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'region'"}}
[info] >  ] {"user":"]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ]"}}
[info] >  🔍 Firebase Functions Instance: FunctionsService { {"user":"🔍 Firebase Functions Instance: FunctionsService {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Instance: FunctionsService {"}}
[info] >    app: FirebaseAppImpl { {"user":"  app: FirebaseAppImpl {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   app: FirebaseAppImpl {"}}
[info] >      _isDeleted: false, {"user":"    _isDeleted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _isDeleted: false,"}}
[info] >      _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }, {"user":"    _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },"}}
[info] >      _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false }, {"user":"    _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },"}}
[info] >      _name: '[DEFAULT]', {"user":"    _name: '[DEFAULT]',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _name: '[DEFAULT]',"}}
[info] >      _automaticDataCollectionEnabled: false, {"user":"    _automaticDataCollectionEnabled: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _automaticDataCollectionEnabled: false,"}}
[info] >      _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] } {"user":"    _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    emulatorOrigin: 'http://localhost:5001', {"user":"  emulatorOrigin: 'http://localhost:5001',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorOrigin: 'http://localhost:5001',"}}
[info] >    contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null }, {"user":"  contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },"}}
[info] >    deleteService: [Function (anonymous)], {"user":"  deleteService: [Function (anonymous)],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   deleteService: [Function (anonymous)],"}}
[info] >    cancelAllRequests: Promise { <pending> }, {"user":"  cancelAllRequests: Promise { <pending> },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   cancelAllRequests: Promise { <pending> },"}}
[info] >    customDomain: null, {"user":"  customDomain: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   customDomain: null,"}}
[info] >    region: 'us-central1' {"user":"  region: 'us-central1'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   region: 'us-central1'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' } {"user":"🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[info] >  🔍 Save Chat History Function Details: { {"user":"🔍 Save Chat History Function Details: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Save Chat History Function Details: {"}}
[info] >    functionExists: true, {"user":"  functionExists: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionExists: true,"}}
[info] >    functionType: 'function', {"user":"  functionType: 'function',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionType: 'function',"}}
[info] >    functionName: 'saveChatHistory' {"user":"  functionName: 'saveChatHistory'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionName: 'saveChatHistory'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📤 Chat History Payload: { {"user":"📤 Chat History Payload: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Chat History Payload: {"}}
[info] >    "userId": "k6hl0WpTQ5fsHjYfrDRxSUjVxEr1", {"user":"  \"userId\": \"k6hl0WpTQ5fsHjYfrDRxSUjVxEr1\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"userId\": \"k6hl0WpTQ5fsHjYfrDRxSUjVxEr1\","}}
[info] >    "chatId": "chat-1731469037953-ttk8uytjd", {"user":"  \"chatId\": \"chat-1731469037953-ttk8uytjd\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"chatId\": \"chat-1731469037953-ttk8uytjd\","}}
[info] >    "messages": [ {"user":"  \"messages\": [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"messages\": ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "user", {"user":"      \"role\": \"user\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"user\","}}
[info] >        "content": "hello", {"user":"      \"content\": \"hello\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"hello\","}}
[info] >        "timestamp": "2024-11-13T03:37:20.100Z" {"user":"      \"timestamp\": \"2024-11-13T03:37:20.100Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T03:37:20.100Z\""}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "model", {"user":"      \"role\": \"model\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"model\","}}
[info] >        "content": "Hello there!  How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\n", {"user":"      \"content\": \"Hello there!  How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"Hello there!  How can I help you today?  Are you looking to discuss a specific relationship, or are you interested in learning more about relationship dynamics in general?\\n\","}}
[info] >        "timestamp": "2024-11-13T03:37:20.100Z" {"user":"      \"timestamp\": \"2024-11-13T03:37:20.100Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T03:37:20.100Z\""}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    "timestamp": "2024-11-13T03:37:20.100Z", {"user":"  \"timestamp\": \"2024-11-13T03:37:20.100Z\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"timestamp\": \"2024-11-13T03:37:20.100Z\","}}
[info] >    "authDetails": { {"user":"  \"authDetails\": {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"authDetails\": {"}}
[info] >      "uid": "k6hl0WpTQ5fsHjYfrDRxSUjVxEr1", {"user":"    \"uid\": \"k6hl0WpTQ5fsHjYfrDRxSUjVxEr1\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"uid\": \"k6hl0WpTQ5fsHjYfrDRxSUjVxEr1\","}}
[info] >      "token": "Present" {"user":"    \"token\": \"Present\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"token\": \"Present\""}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T03:37:20.154Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T03:37:20.154Z"],"queueLength":1,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:37:17.934Z"],"workRunningCount":1}
[debug] [2024-11-13T03:37:20.155Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:37:17.934Z","/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T03:37:20.154Z"],"workRunningCount":2}
[debug] [2024-11-13T03:37:20.155Z] Accepted request POST /notalone-de4fc/us-central1/saveChatHistory --> us-central1-saveChatHistory
[debug] [2024-11-13T03:37:20.156Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T03:37:20.157Z] [functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/"}}
[debug] [2024-11-13T03:37:20.164Z] [worker-pool] addWorker(us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-saveChatHistory)"}}
[debug] [2024-11-13T03:37:20.164Z] [worker-pool] Adding worker with key us-central1-saveChatHistory, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-saveChatHistory, total=1"}}
[debug] [2024-11-13T03:37:21.702Z] [runtime-status] [34688] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [34688] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T03:37:21.704Z] [runtime-status] [34688] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [34688] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T03:37:21.705Z] [runtime-status] [34688] Found local functions config: C:\Users\Rob\apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [34688] Found local functions config: C:\\Users\\Rob\\apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T03:37:21.705Z] [runtime-status] [34688] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [34688] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T03:37:21.706Z] [runtime-status] [34688] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [34688] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T03:37:21.994Z] [runtime-status] [34688] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [34688] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T03:37:21.995Z] [runtime-status] [34688] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [34688] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T03:37:21.995Z] [runtime-status] [34688] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [34688] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T03:37:22.001Z] [runtime-status] [34688] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [34688] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T03:37:22.004Z] [runtime-status] [34688] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [34688] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T03:37:22.004Z] [runtime-status] [34688] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [34688] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T03:37:22.110Z] [runtime-status] [34688] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [34688] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T03:37:22.120Z] [runtime-status] [34688] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [34688] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T03:37:22.121Z] [runtime-status] [34688] Listening to port: \\?\pipe\fire_emu_fb23c24e7e1dfb41 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [34688] Listening to port: \\\\?\\pipe\\fire_emu_fb23c24e7e1dfb41"}}
[debug] [2024-11-13T03:37:22.147Z] [worker-us-central1-saveChatHistory-40560ddb-c2cb-4571-ae59-47f6bc008a6e]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-40560ddb-c2cb-4571-ae59-47f6bc008a6e]: IDLE"}}
[debug] [2024-11-13T03:37:22.147Z] [worker-pool] submitRequest(triggerId=us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-saveChatHistory)"}}
[info] i  functions: Beginning execution of "us-central1-saveChatHistory" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Beginning execution of \"us-central1-saveChatHistory\""}}
[debug] [2024-11-13T03:37:22.148Z] [worker-us-central1-saveChatHistory-40560ddb-c2cb-4571-ae59-47f6bc008a6e]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-40560ddb-c2cb-4571-ae59-47f6bc008a6e]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"MISSING\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🔍 Saving Chat History { {"user":"🔍 Saving Chat History {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Saving Chat History {"}}
[info] >    request: { {"user":"  request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   request: {"}}
[info] >      rawRequest: IncomingMessage { {"user":"    rawRequest: IncomingMessage {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     rawRequest: IncomingMessage {"}}
[info] >        _events: [Object], {"user":"      _events: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _events: [Object],"}}
[info] >        _readableState: [ReadableState], {"user":"      _readableState: [ReadableState],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _readableState: [ReadableState],"}}
[info] >        _maxListeners: undefined, {"user":"      _maxListeners: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _maxListeners: undefined,"}}
[info] >        socket: [Socket], {"user":"      socket: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       socket: [Socket],"}}
[info] >        httpVersionMajor: 1, {"user":"      httpVersionMajor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMajor: 1,"}}
[info] >        httpVersionMinor: 1, {"user":"      httpVersionMinor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMinor: 1,"}}
[info] >        httpVersion: '1.1', {"user":"      httpVersion: '1.1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersion: '1.1',"}}
[info] >        complete: true, {"user":"      complete: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       complete: true,"}}
[info] >        rawHeaders: [Array], {"user":"      rawHeaders: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawHeaders: [Array],"}}
[info] >        rawTrailers: [], {"user":"      rawTrailers: [],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawTrailers: [],"}}
[info] >        joinDuplicateHeaders: null, {"user":"      joinDuplicateHeaders: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       joinDuplicateHeaders: null,"}}
[info] >        aborted: false, {"user":"      aborted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       aborted: false,"}}
[info] >        upgrade: false, {"user":"      upgrade: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       upgrade: false,"}}
[info] >        url: '/', {"user":"      url: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       url: '/',"}}
[info] >        method: 'POST', {"user":"      method: 'POST',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       method: 'POST',"}}
[info] >        statusCode: null, {"user":"      statusCode: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusCode: null,"}}
[info] >        statusMessage: null, {"user":"      statusMessage: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusMessage: null,"}}
[info] >        client: [Socket], {"user":"      client: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       client: [Socket],"}}
[info] >        _consuming: true, {"user":"      _consuming: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _consuming: true,"}}
[info] >        _dumped: false, {"user":"      _dumped: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _dumped: false,"}}
[info] >        next: [Function: next], {"user":"      next: [Function: next],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       next: [Function: next],"}}
[info] >        baseUrl: '', {"user":"      baseUrl: '',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       baseUrl: '',"}}
[info] >        originalUrl: '/', {"user":"      originalUrl: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       originalUrl: '/',"}}
[info] >        _parsedUrl: [Url], {"user":"      _parsedUrl: [Url],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _parsedUrl: [Url],"}}
[info] >        params: [Object], {"user":"      params: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       params: [Object],"}}
[info] >        query: {}, {"user":"      query: {},","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       query: {},"}}
[info] >        res: [ServerResponse], {"user":"      res: [ServerResponse],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       res: [ServerResponse],"}}
[info] >        body: [Object], {"user":"      body: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       body: [Object],"}}
[info] >        _body: true, {"user":"      _body: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _body: true,"}}
[info] >        length: undefined, {"user":"      length: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       length: undefined,"}}
[info] >        _eventsCount: 0, {"user":"      _eventsCount: 0,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _eventsCount: 0,"}}
[info] >        rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 6b 36 68 6c 30 57 70 54 51 35 66 73 48 6a 59 66 72 44 52 78 53 55 6a 56 78 45 72 31 22 2c 22 ... 407 more bytes>, {"user":"      rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 6b 36 68 6c 30 57 70 54 51 35 66 73 48 6a 59 66 72 44 52 78 53 55 6a 56 78 45 72 31 22 2c 22 ... 407 more bytes>,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 6b 36 68 6c 30 57 70 54 51 35 66 73 48 6a 59 66 72 44 52 78 53 55 6a 56 78 45 72 31 22 2c 22 ... 407 more bytes>,"}}
[info] >        route: [Route], {"user":"      route: [Route],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       route: [Route],"}}
[info] >        [Symbol(shapeMode)]: true, {"user":"      [Symbol(shapeMode)]: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(shapeMode)]: true,"}}
[info] >        [Symbol(kCapture)]: false, {"user":"      [Symbol(kCapture)]: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kCapture)]: false,"}}
[info] >        [Symbol(kHeaders)]: [Object], {"user":"      [Symbol(kHeaders)]: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeaders)]: [Object],"}}
[info] >        [Symbol(kHeadersCount)]: 18, {"user":"      [Symbol(kHeadersCount)]: 18,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeadersCount)]: 18,"}}
[info] >        [Symbol(kTrailers)]: null, {"user":"      [Symbol(kTrailers)]: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailers)]: null,"}}
[info] >        [Symbol(kTrailersCount)]: 0 {"user":"      [Symbol(kTrailersCount)]: 0","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailersCount)]: 0"}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      data: { {"user":"    data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     data: {"}}
[info] >        userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1', {"user":"      userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',"}}
[info] >        chatId: 'chat-1731469037953-ttk8uytjd', {"user":"      chatId: 'chat-1731469037953-ttk8uytjd',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       chatId: 'chat-1731469037953-ttk8uytjd',"}}
[info] >        messages: [Array], {"user":"      messages: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       messages: [Array],"}}
[info] >        timestamp: '2024-11-13T03:37:20.100Z' {"user":"      timestamp: '2024-11-13T03:37:20.100Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       timestamp: '2024-11-13T03:37:20.100Z'"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Extracted Data: { {"user":"🔍 Extracted Data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Extracted Data: {"}}
[info] >    userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1', {"user":"  userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',"}}
[info] >    chatId: 'chat-1731469037953-ttk8uytjd', {"user":"  chatId: 'chat-1731469037953-ttk8uytjd',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731469037953-ttk8uytjd',"}}
[info] >    messagesCount: 2 {"user":"  messagesCount: 2","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   messagesCount: 2"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Chat history saved: chat-1731469037953-ttk8uytjd {"user":"✅ Chat history saved: chat-1731469037953-ttk8uytjd","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Chat history saved: chat-1731469037953-ttk8uytjd"}}
[debug] [2024-11-13T03:37:22.693Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-saveChatHistory" in 545.638ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finished \"us-central1-saveChatHistory\" in 545.638ms"}}
[debug] [2024-11-13T03:37:22.694Z] [worker-us-central1-saveChatHistory-40560ddb-c2cb-4571-ae59-47f6bc008a6e]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-40560ddb-c2cb-4571-ae59-47f6bc008a6e]: IDLE"}}
[debug] [2024-11-13T03:37:22.695Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T03:37:22.695Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T03:37:22.695Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:37:17.934Z"],"workRunningCount":1}
[info] >  ✅ Chat history save result: { data: { success: true, message: 'Chat history saved' } } {"user":"✅ Chat history save result: { data: { success: true, message: 'Chat history saved' } }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Chat history save result: { data: { success: true, message: 'Chat history saved' } }"}}
[debug] [2024-11-13T03:37:22.698Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4762.662ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4762.662ms"}}
[debug] [2024-11-13T03:37:22.699Z] [worker-us-central1-processChat-3ea34fee-238f-4cc2-a08b-8a55ea84221b]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3ea34fee-238f-4cc2-a08b-8a55ea84221b]: IDLE"}}
[debug] [2024-11-13T03:37:22.699Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T03:37:22.699Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T03:37:22.699Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:45:17.567Z] File C:\Users\Rob\apps\not-alone\functions\src\chatHistory.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\src\\chatHistory.ts changed, reloading triggers"}}
[debug] [2024-11-13T03:45:18.581Z] Validating nodejs source
[debug] [2024-11-13T03:45:19.441Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T03:45:19.442Z] Building nodejs source
[debug] [2024-11-13T03:45:19.442Z] Failed to find version of module node: reached end of search path C:\Users\Rob\apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T03:45:19.443Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T03:45:19.452Z] Found firebase-functions binary at 'C:\Users\Rob\apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8170

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T03:45:20.080Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T03:45:24.106Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T03:45:24.107Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T03:45:24.108Z] [worker-pool] Shutting down IDLE worker (us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-processChat)"}}
[debug] [2024-11-13T03:45:24.108Z] [worker-us-central1-processChat-3ea34fee-238f-4cc2-a08b-8a55ea84221b]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3ea34fee-238f-4cc2-a08b-8a55ea84221b]: FINISHING"}}
[debug] [2024-11-13T03:45:24.108Z] [worker-pool] Shutting down IDLE worker (us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Shutting down IDLE worker (us-central1-saveChatHistory)"}}
[debug] [2024-11-13T03:45:24.108Z] [worker-us-central1-saveChatHistory-40560ddb-c2cb-4571-ae59-47f6bc008a6e]: FINISHING {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-40560ddb-c2cb-4571-ae59-47f6bc008a6e]: FINISHING"}}
[debug] [2024-11-13T03:45:24.124Z] [worker-us-central1-saveChatHistory-40560ddb-c2cb-4571-ae59-47f6bc008a6e]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-40560ddb-c2cb-4571-ae59-47f6bc008a6e]: exited"}}
[debug] [2024-11-13T03:45:24.124Z] [worker-us-central1-saveChatHistory-40560ddb-c2cb-4571-ae59-47f6bc008a6e]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-40560ddb-c2cb-4571-ae59-47f6bc008a6e]: FINISHED"}}
[debug] [2024-11-13T03:45:24.126Z] [worker-us-central1-processChat-3ea34fee-238f-4cc2-a08b-8a55ea84221b]: exited {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3ea34fee-238f-4cc2-a08b-8a55ea84221b]: exited"}}
[debug] [2024-11-13T03:45:24.126Z] [worker-us-central1-processChat-3ea34fee-238f-4cc2-a08b-8a55ea84221b]: FINISHED {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-3ea34fee-238f-4cc2-a08b-8a55ea84221b]: FINISHED"}}
[debug] [2024-11-13T03:46:44.348Z] File C:\Users\Rob\apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T03:46:45.359Z] Validating nodejs source
[debug] [2024-11-13T03:46:46.197Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T03:46:46.198Z] Building nodejs source
[debug] [2024-11-13T03:46:46.198Z] Failed to find version of module node: reached end of search path C:\Users\Rob\apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T03:46:46.200Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T03:46:46.211Z] Found firebase-functions binary at 'C:\Users\Rob\apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8469

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T03:46:46.840Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T03:46:50.863Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T03:46:50.864Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T03:47:01.247Z] File C:\Users\Rob\apps\not-alone\functions\src\index.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\src\\index.ts changed, reloading triggers"}}
[debug] [2024-11-13T03:47:02.251Z] Validating nodejs source
[debug] [2024-11-13T03:47:03.067Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T03:47:03.067Z] Building nodejs source
[debug] [2024-11-13T03:47:03.067Z] Failed to find version of module node: reached end of search path C:\Users\Rob\apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T03:47:03.068Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T03:47:03.077Z] Found firebase-functions binary at 'C:\Users\Rob\apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8014

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T03:47:03.704Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T03:47:07.725Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T03:47:07.726Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T03:47:20.055Z] File C:\Users\Rob\apps\not-alone\functions\src\chatHistory.ts changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\src\\chatHistory.ts changed, reloading triggers"}}
[debug] [2024-11-13T03:47:21.064Z] Validating nodejs source
[debug] [2024-11-13T03:47:21.927Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T03:47:21.927Z] Building nodejs source
[debug] [2024-11-13T03:47:21.927Z] Failed to find version of module node: reached end of search path C:\Users\Rob\apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T03:47:21.928Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T03:47:21.936Z] Found firebase-functions binary at 'C:\Users\Rob\apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8296

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T03:47:22.574Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T03:47:26.606Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T03:47:26.607Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T03:48:07.569Z] File C:\Users\Rob\apps\not-alone\functions\lib\chatHistory.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\chatHistory.js.map changed, reloading triggers"}}
[debug] [2024-11-13T03:48:07.570Z] File C:\Users\Rob\apps\not-alone\functions\lib\chatHistory.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\chatHistory.js changed, reloading triggers"}}
[debug] [2024-11-13T03:48:07.600Z] File C:\Users\Rob\apps\not-alone\functions\lib\index.js.map changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js.map changed, reloading triggers"}}
[debug] [2024-11-13T03:48:07.602Z] File C:\Users\Rob\apps\not-alone\functions\lib\index.js changed, reloading triggers {"metadata":{"emulator":{"name":"functions"},"message":"File C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js changed, reloading triggers"}}
[debug] [2024-11-13T03:48:08.607Z] Validating nodejs source
[debug] [2024-11-13T03:48:09.503Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/vertexai": "^1.9.0",
    "firebase": "^11.0.1",
    "firebase-admin": "^12.7.0",
    "firebase-functions": "^6.1.0"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "dotenv": "^16.4.5",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2024-11-13T03:48:09.503Z] Building nodejs source
[debug] [2024-11-13T03:48:09.503Z] Failed to find version of module node: reached end of search path C:\Users\Rob\apps\not-alone\functions\node_modules
[warn] !  functions: Your requested "node" version "18" doesn't match your global version "20". Using node@20 from host. 
[debug] [2024-11-13T03:48:09.504Z] Could not find functions.yaml. Must use http discovery
[debug] [2024-11-13T03:48:09.512Z] Found firebase-functions binary at 'C:\Users\Rob\apps\not-alone\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8631

[info] 🔧 Configured Firebase Functions to use local emulator

[info] Connecting to Firestore Emulator: localhost:8080

[debug] [2024-11-13T03:48:10.127Z] Got response from /__/functions.yaml {"endpoints":{"saveChatHistory":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"saveChatHistory"},"processChat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"processChat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[debug] [2024-11-13T03:48:14.162Z] defaultcredentials: writing to file C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json
[debug] [2024-11-13T03:48:14.164Z] Setting GAC to C:\Users\Rob\AppData\Roaming\firebase\lisakhun58_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Rob\\AppData\\Roaming\\firebase\\lisakhun58_gmail_com_application_default_credentials.json"}}
[info] +  functions: Loaded functions definitions from source: saveChatHistory, processChat. {"metadata":{"emulator":{"name":"functions"},"message":"Loaded functions definitions from source: saveChatHistory, processChat."}}
[debug] [2024-11-13T03:48:21.060Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:48:21.060Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:48:21.060Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:48:21.060Z"],"workRunningCount":1}
[debug] [2024-11-13T03:48:21.060Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T03:48:21.063Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T03:48:21.063Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T03:48:21.063Z] [worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-processChat: 1 --> 0"}}
[debug] [2024-11-13T03:48:21.063Z] [worker-pool] Cleaned up workers for us-central1-saveChatHistory: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for us-central1-saveChatHistory: 1 --> 0"}}
[debug] [2024-11-13T03:48:21.069Z] [worker-pool] addWorker(us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-processChat)"}}
[debug] [2024-11-13T03:48:21.069Z] [worker-pool] Adding worker with key us-central1-processChat, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-processChat, total=1"}}
[debug] [2024-11-13T03:48:22.484Z] [runtime-status] [4196] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4196] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T03:48:22.486Z] [runtime-status] [4196] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4196] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T03:48:22.486Z] [runtime-status] [4196] Found local functions config: C:\Users\Rob\apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4196] Found local functions config: C:\\Users\\Rob\\apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T03:48:22.486Z] [runtime-status] [4196] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4196] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T03:48:22.487Z] [runtime-status] [4196] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4196] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T03:48:22.780Z] [runtime-status] [4196] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4196] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T03:48:22.781Z] [runtime-status] [4196] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4196] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T03:48:22.781Z] [runtime-status] [4196] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4196] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T03:48:22.786Z] [runtime-status] [4196] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4196] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T03:48:22.789Z] [runtime-status] [4196] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4196] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T03:48:22.789Z] [runtime-status] [4196] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4196] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T03:48:22.887Z] [runtime-status] [4196] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4196] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T03:48:22.897Z] [runtime-status] [4196] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4196] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T03:48:22.897Z] [runtime-status] [4196] Listening to port: \\?\pipe\fire_emu_e1dfe2221927d59a {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[runtime-status] [4196] Listening to port: \\\\?\\pipe\\fire_emu_e1dfe2221927d59a"}}
[debug] [2024-11-13T03:48:22.946Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE"}}
[debug] [2024-11-13T03:48:22.946Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T03:48:22.946Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY"}}
[debug] [2024-11-13T03:48:22.951Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 5.0534ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 5.0534ms"}}
[debug] [2024-11-13T03:48:22.952Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE"}}
[debug] [2024-11-13T03:48:22.952Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T03:48:22.952Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T03:48:22.952Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:48:22.953Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:48:22.953Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:48:22.953Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:48:22.953Z"],"workRunningCount":1}
[debug] [2024-11-13T03:48:22.953Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T03:48:22.954Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T03:48:22.955Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T03:48:22.955Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T03:48:22.955Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello' } } {"user":"🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello' } }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: { auth: 'Authenticated', data: { message: 'hello' } }"}}
[info] >  📝 Using chat ID: undefined {"user":"📝 Using chat ID: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: undefined"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 5, {"user":"  messageLength: 5,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 5,"}}
[info] >    userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1', {"user":"  userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',"}}
[info] >    chatId: undefined {"user":"  chatId: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: undefined"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🆕 Creating new chat session: chat-1731469702971-8gzrstds3 {"user":"🆕 Creating new chat session: chat-1731469702971-8gzrstds3","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🆕 Creating new chat session: chat-1731469702971-8gzrstds3"}}
[info] >  📝 Chat session created: { chatId: 'chat-1731469702971-8gzrstds3', sessionExists: true } {"user":"📝 Chat session created: { chatId: 'chat-1731469702971-8gzrstds3', sessionExists: true }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Chat session created: { chatId: 'chat-1731469702971-8gzrstds3', sessionExists: true }"}}
[info] >  💬 Sending message to Gemini: hello {"user":"💬 Sending message to Gemini: hello","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: hello"}}
[warn] !  Google API requested!
   - URL: "https://oauth2.googleapis.com/token"
   - Be careful, this may be a production service. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Google API requested!\n   - URL: \"https://oauth2.googleapis.com/token\"\n   - Be careful, this may be a production service."}}
[info] >  📚 Current Chat History: { {"user":"📚 Current Chat History: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📚 Current Chat History: {"}}
[info] >    chatId: 'chat-1731469702971-8gzrstds3', {"user":"  chatId: 'chat-1731469702971-8gzrstds3',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731469702971-8gzrstds3',"}}
[info] >    historyLength: 6, {"user":"  historyLength: 6,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   historyLength: 6,"}}
[info] >    lastMessages: [ {"user":"  lastMessages: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   lastMessages: ["}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'assistant', parts: [Array] }, {"user":"    { role: 'assistant', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'assistant', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] } {"user":"    { role: 'model', parts: [Array] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Response received: { responseLength: 162, timestamp: '2024-11-13T03:48:25.127Z' } {"user":"✅ Response received: { responseLength: 162, timestamp: '2024-11-13T03:48:25.127Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 162, timestamp: '2024-11-13T03:48:25.127Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: 'Hello there! How can I help you today?  Are you looking to discuss a specific relationship, or do you have some general questions about relationships in general?\n', {"user":"  message: 'Hello there! How can I help you today?  Are you looking to discuss a specific relationship, or do you have some general questions about relationships in general?\\n',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: 'Hello there! How can I help you today?  Are you looking to discuss a specific relationship, or do you have some general questions about relationships in general?\\n',"}}
[info] >    userMessage: 'hello', {"user":"  userMessage: 'hello',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'hello',"}}
[info] >    timestamp: '2024-11-13T03:48:25.127Z', {"user":"  timestamp: '2024-11-13T03:48:25.127Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T03:48:25.127Z',"}}
[info] >    userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1', {"user":"  userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',"}}
[info] >    chatId: 'chat-1731469702971-8gzrstds3' {"user":"  chatId: 'chat-1731469702971-8gzrstds3'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731469702971-8gzrstds3'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Attempting to save chat history with DETAILED logging: { {"user":"🔍 Attempting to save chat history with DETAILED logging: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Attempting to save chat history with DETAILED logging: {"}}
[info] >    userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1', {"user":"  userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',"}}
[info] >    chatId: 'chat-1731469702971-8gzrstds3', {"user":"  chatId: 'chat-1731469702971-8gzrstds3',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731469702971-8gzrstds3',"}}
[info] >    messageCount: 2, {"user":"  messageCount: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageCount: 2,"}}
[info] >    timestamp: '2024-11-13T03:48:25.127Z', {"user":"  timestamp: '2024-11-13T03:48:25.127Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T03:48:25.127Z',"}}
[info] >    clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' } {"user":"  clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔧 Firebase Client Configuration: { {"user":"🔧 Firebase Client Configuration: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Firebase Client Configuration: {"}}
[info] >    projectId: 'notalone-de4fc', {"user":"  projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   projectId: 'notalone-de4fc',"}}
[info] >    apiKey: 'local-api-key', {"user":"  apiKey: 'local-api-key',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   apiKey: 'local-api-key',"}}
[info] >    authDomain: undefined, {"user":"  authDomain: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   authDomain: undefined,"}}
[info] >    emulatorHost: 'localhost', {"user":"  emulatorHost: 'localhost',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorHost: 'localhost',"}}
[info] >    emulatorPort: 5001 {"user":"  emulatorPort: 5001","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorPort: 5001"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Firebase Functions Object Keys: [ {"user":"🔍 Firebase Functions Object Keys: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Object Keys: ["}}
[info] >    'app', {"user":"  'app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'app',"}}
[info] >    'emulatorOrigin', {"user":"  'emulatorOrigin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'emulatorOrigin',"}}
[info] >    'contextProvider', {"user":"  'contextProvider',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'contextProvider',"}}
[info] >    'deleteService', {"user":"  'deleteService',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'deleteService',"}}
[info] >    'cancelAllRequests', {"user":"  'cancelAllRequests',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'cancelAllRequests',"}}
[info] >    'customDomain', {"user":"  'customDomain',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'customDomain',"}}
[info] >    'region' {"user":"  'region'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'region'"}}
[info] >  ] {"user":"]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ]"}}
[info] >  🔍 Firebase Functions Instance: FunctionsService { {"user":"🔍 Firebase Functions Instance: FunctionsService {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Instance: FunctionsService {"}}
[info] >    app: FirebaseAppImpl { {"user":"  app: FirebaseAppImpl {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   app: FirebaseAppImpl {"}}
[info] >      _isDeleted: false, {"user":"    _isDeleted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _isDeleted: false,"}}
[info] >      _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }, {"user":"    _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },"}}
[info] >      _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false }, {"user":"    _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },"}}
[info] >      _name: '[DEFAULT]', {"user":"    _name: '[DEFAULT]',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _name: '[DEFAULT]',"}}
[info] >      _automaticDataCollectionEnabled: false, {"user":"    _automaticDataCollectionEnabled: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _automaticDataCollectionEnabled: false,"}}
[info] >      _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] } {"user":"    _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    emulatorOrigin: 'http://localhost:5001', {"user":"  emulatorOrigin: 'http://localhost:5001',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorOrigin: 'http://localhost:5001',"}}
[info] >    contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null }, {"user":"  contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },"}}
[info] >    deleteService: [Function (anonymous)], {"user":"  deleteService: [Function (anonymous)],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   deleteService: [Function (anonymous)],"}}
[info] >    cancelAllRequests: Promise { <pending> }, {"user":"  cancelAllRequests: Promise { <pending> },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   cancelAllRequests: Promise { <pending> },"}}
[info] >    customDomain: null, {"user":"  customDomain: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   customDomain: null,"}}
[info] >    region: 'us-central1' {"user":"  region: 'us-central1'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   region: 'us-central1'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' } {"user":"🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[info] >  🔍 Save Chat History Function Details: { {"user":"🔍 Save Chat History Function Details: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Save Chat History Function Details: {"}}
[info] >    functionExists: true, {"user":"  functionExists: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionExists: true,"}}
[info] >    functionType: 'function', {"user":"  functionType: 'function',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionType: 'function',"}}
[info] >    functionName: 'saveChatHistory' {"user":"  functionName: 'saveChatHistory'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionName: 'saveChatHistory'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📤 Chat History Payload: { {"user":"📤 Chat History Payload: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Chat History Payload: {"}}
[info] >    "userId": "k6hl0WpTQ5fsHjYfrDRxSUjVxEr1", {"user":"  \"userId\": \"k6hl0WpTQ5fsHjYfrDRxSUjVxEr1\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"userId\": \"k6hl0WpTQ5fsHjYfrDRxSUjVxEr1\","}}
[info] >    "chatId": "chat-1731469702971-8gzrstds3", {"user":"  \"chatId\": \"chat-1731469702971-8gzrstds3\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"chatId\": \"chat-1731469702971-8gzrstds3\","}}
[info] >    "messages": [ {"user":"  \"messages\": [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"messages\": ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "user", {"user":"      \"role\": \"user\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"user\","}}
[info] >        "content": "hello", {"user":"      \"content\": \"hello\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"hello\","}}
[info] >        "timestamp": "2024-11-13T03:48:25.129Z" {"user":"      \"timestamp\": \"2024-11-13T03:48:25.129Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T03:48:25.129Z\""}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "model", {"user":"      \"role\": \"model\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"model\","}}
[info] >        "content": "Hello there! How can I help you today?  Are you looking to discuss a specific relationship, or do you have some general questions about relationships in general?\n", {"user":"      \"content\": \"Hello there! How can I help you today?  Are you looking to discuss a specific relationship, or do you have some general questions about relationships in general?\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"Hello there! How can I help you today?  Are you looking to discuss a specific relationship, or do you have some general questions about relationships in general?\\n\","}}
[info] >        "timestamp": "2024-11-13T03:48:25.129Z" {"user":"      \"timestamp\": \"2024-11-13T03:48:25.129Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T03:48:25.129Z\""}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    "timestamp": "2024-11-13T03:48:25.129Z", {"user":"  \"timestamp\": \"2024-11-13T03:48:25.129Z\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"timestamp\": \"2024-11-13T03:48:25.129Z\","}}
[info] >    "authDetails": { {"user":"  \"authDetails\": {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"authDetails\": {"}}
[info] >      "uid": "k6hl0WpTQ5fsHjYfrDRxSUjVxEr1", {"user":"    \"uid\": \"k6hl0WpTQ5fsHjYfrDRxSUjVxEr1\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"uid\": \"k6hl0WpTQ5fsHjYfrDRxSUjVxEr1\","}}
[info] >      "token": "Present" {"user":"    \"token\": \"Present\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"token\": \"Present\""}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T03:48:25.164Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T03:48:25.164Z"],"queueLength":1,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:48:22.953Z"],"workRunningCount":1}
[debug] [2024-11-13T03:48:25.164Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:48:22.953Z","/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T03:48:25.164Z"],"workRunningCount":2}
[debug] [2024-11-13T03:48:25.164Z] Accepted request POST /notalone-de4fc/us-central1/saveChatHistory --> us-central1-saveChatHistory
[debug] [2024-11-13T03:48:25.165Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T03:48:25.165Z] [functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/"}}
[debug] [2024-11-13T03:48:25.173Z] [worker-pool] addWorker(us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(us-central1-saveChatHistory)"}}
[debug] [2024-11-13T03:48:25.173Z] [worker-pool] Adding worker with key us-central1-saveChatHistory, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key us-central1-saveChatHistory, total=1"}}
[debug] [2024-11-13T03:48:26.714Z] [runtime-status] [31684] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31684] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T03:48:26.716Z] [runtime-status] [31684] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31684] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T03:48:26.716Z] [runtime-status] [31684] Found local functions config: C:\Users\Rob\apps\not-alone\functions/.runtimeconfig.json {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31684] Found local functions config: C:\\Users\\Rob\\apps\\not-alone\\functions/.runtimeconfig.json"}}
[debug] [2024-11-13T03:48:26.716Z] [runtime-status] [31684] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31684] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2024-11-13T03:48:26.717Z] [runtime-status] [31684] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31684] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T03:48:27.043Z] [runtime-status] [31684] Checked functions.config() {"config":{"vertex":{"project":"notalone-de4fc","location":"australia-southeast1","model":"gemini-1.5-flash-002"},"environment":{"mode":"development"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31684] Checked functions.config() {\"config\":{\"vertex\":{\"project\":\"notalone-de4fc\",\"location\":\"australia-southeast1\",\"model\":\"gemini-1.5-flash-002\"},\"environment\":{\"mode\":\"development\"}}}"}}
[debug] [2024-11-13T03:48:27.043Z] [runtime-status] [31684] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31684] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}}"}}
[debug] [2024-11-13T03:48:27.044Z] [runtime-status] [31684] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31684] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T03:48:27.048Z] [runtime-status] [31684] Resolved module firebase-admin {"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31684] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2024-11-13T03:48:27.050Z] [runtime-status] [31684] Resolved module firebase-functions {"declared":true,"installed":true,"version":"6.1.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\v2\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31684] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"6.1.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\v2\\\\index.js\"}"}}
[debug] [2024-11-13T03:48:27.050Z] [runtime-status] [31684] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"12.7.0","resolution":"C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31684] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"12.7.0\",\"resolution\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[debug] [2024-11-13T03:48:27.154Z] [runtime-status] [31684] initializeApp(DEFAULT) {"storageBucket":"notalone-de4fc.firebasestorage.app","projectId":"notalone-de4fc"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31684] initializeApp(DEFAULT) {\"storageBucket\":\"notalone-de4fc.firebasestorage.app\",\"projectId\":\"notalone-de4fc\"}"}}
[info] >  Connecting to Firestore Emulator: localhost:8080 {"user":"Connecting to Firestore Emulator: localhost:8080","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m Connecting to Firestore Emulator: localhost:8080"}}
[debug] [2024-11-13T03:48:27.169Z] [runtime-status] [31684] Functions runtime initialized. {"cwd":"C:\\Users\\Rob\\apps\\not-alone\\functions","node_version":"20.18.0"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31684] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Rob\\\\apps\\\\not-alone\\\\functions\",\"node_version\":\"20.18.0\"}"}}
[debug] [2024-11-13T03:48:27.170Z] [runtime-status] [31684] Listening to port: \\?\pipe\fire_emu_0ff854b5a4395535 {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[runtime-status] [31684] Listening to port: \\\\?\\pipe\\fire_emu_0ff854b5a4395535"}}
[debug] [2024-11-13T03:48:27.268Z] [worker-us-central1-saveChatHistory-2165a9ad-8465-4859-90ce-6438e4ec2022]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-2165a9ad-8465-4859-90ce-6438e4ec2022]: IDLE"}}
[debug] [2024-11-13T03:48:27.268Z] [worker-pool] submitRequest(triggerId=us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-saveChatHistory)"}}
[info] i  functions: Beginning execution of "us-central1-saveChatHistory" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Beginning execution of \"us-central1-saveChatHistory\""}}
[debug] [2024-11-13T03:48:27.269Z] [worker-us-central1-saveChatHistory-2165a9ad-8465-4859-90ce-6438e4ec2022]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-2165a9ad-8465-4859-90ce-6438e4ec2022]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"MISSING\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🔍 Saving Chat History { {"user":"🔍 Saving Chat History {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Saving Chat History {"}}
[info] >    request: { {"user":"  request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   request: {"}}
[info] >      rawRequest: IncomingMessage { {"user":"    rawRequest: IncomingMessage {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     rawRequest: IncomingMessage {"}}
[info] >        _events: [Object], {"user":"      _events: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _events: [Object],"}}
[info] >        _readableState: [ReadableState], {"user":"      _readableState: [ReadableState],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _readableState: [ReadableState],"}}
[info] >        _maxListeners: undefined, {"user":"      _maxListeners: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _maxListeners: undefined,"}}
[info] >        socket: [Socket], {"user":"      socket: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       socket: [Socket],"}}
[info] >        httpVersionMajor: 1, {"user":"      httpVersionMajor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMajor: 1,"}}
[info] >        httpVersionMinor: 1, {"user":"      httpVersionMinor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMinor: 1,"}}
[info] >        httpVersion: '1.1', {"user":"      httpVersion: '1.1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersion: '1.1',"}}
[info] >        complete: true, {"user":"      complete: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       complete: true,"}}
[info] >        rawHeaders: [Array], {"user":"      rawHeaders: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawHeaders: [Array],"}}
[info] >        rawTrailers: [], {"user":"      rawTrailers: [],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawTrailers: [],"}}
[info] >        joinDuplicateHeaders: null, {"user":"      joinDuplicateHeaders: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       joinDuplicateHeaders: null,"}}
[info] >        aborted: false, {"user":"      aborted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       aborted: false,"}}
[info] >        upgrade: false, {"user":"      upgrade: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       upgrade: false,"}}
[info] >        url: '/', {"user":"      url: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       url: '/',"}}
[info] >        method: 'POST', {"user":"      method: 'POST',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       method: 'POST',"}}
[info] >        statusCode: null, {"user":"      statusCode: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusCode: null,"}}
[info] >        statusMessage: null, {"user":"      statusMessage: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusMessage: null,"}}
[info] >        client: [Socket], {"user":"      client: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       client: [Socket],"}}
[info] >        _consuming: true, {"user":"      _consuming: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _consuming: true,"}}
[info] >        _dumped: false, {"user":"      _dumped: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _dumped: false,"}}
[info] >        next: [Function: next], {"user":"      next: [Function: next],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       next: [Function: next],"}}
[info] >        baseUrl: '', {"user":"      baseUrl: '',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       baseUrl: '',"}}
[info] >        originalUrl: '/', {"user":"      originalUrl: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       originalUrl: '/',"}}
[info] >        _parsedUrl: [Url], {"user":"      _parsedUrl: [Url],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _parsedUrl: [Url],"}}
[info] >        params: [Object], {"user":"      params: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       params: [Object],"}}
[info] >        query: {}, {"user":"      query: {},","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       query: {},"}}
[info] >        res: [ServerResponse], {"user":"      res: [ServerResponse],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       res: [ServerResponse],"}}
[info] >        body: [Object], {"user":"      body: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       body: [Object],"}}
[info] >        _body: true, {"user":"      _body: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _body: true,"}}
[info] >        length: undefined, {"user":"      length: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       length: undefined,"}}
[info] >        _eventsCount: 0, {"user":"      _eventsCount: 0,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _eventsCount: 0,"}}
[info] >        rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 6b 36 68 6c 30 57 70 54 51 35 66 73 48 6a 59 66 72 44 52 78 53 55 6a 56 78 45 72 31 22 2c 22 ... 397 more bytes>, {"user":"      rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 6b 36 68 6c 30 57 70 54 51 35 66 73 48 6a 59 66 72 44 52 78 53 55 6a 56 78 45 72 31 22 2c 22 ... 397 more bytes>,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 6b 36 68 6c 30 57 70 54 51 35 66 73 48 6a 59 66 72 44 52 78 53 55 6a 56 78 45 72 31 22 2c 22 ... 397 more bytes>,"}}
[info] >        route: [Route], {"user":"      route: [Route],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       route: [Route],"}}
[info] >        [Symbol(shapeMode)]: true, {"user":"      [Symbol(shapeMode)]: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(shapeMode)]: true,"}}
[info] >        [Symbol(kCapture)]: false, {"user":"      [Symbol(kCapture)]: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kCapture)]: false,"}}
[info] >        [Symbol(kHeaders)]: [Object], {"user":"      [Symbol(kHeaders)]: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeaders)]: [Object],"}}
[info] >        [Symbol(kHeadersCount)]: 18, {"user":"      [Symbol(kHeadersCount)]: 18,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeadersCount)]: 18,"}}
[info] >        [Symbol(kTrailers)]: null, {"user":"      [Symbol(kTrailers)]: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailers)]: null,"}}
[info] >        [Symbol(kTrailersCount)]: 0 {"user":"      [Symbol(kTrailersCount)]: 0","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailersCount)]: 0"}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      data: { {"user":"    data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     data: {"}}
[info] >        userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1', {"user":"      userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',"}}
[info] >        chatId: 'chat-1731469702971-8gzrstds3', {"user":"      chatId: 'chat-1731469702971-8gzrstds3',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       chatId: 'chat-1731469702971-8gzrstds3',"}}
[info] >        messages: [Array], {"user":"      messages: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       messages: [Array],"}}
[info] >        timestamp: '2024-11-13T03:48:25.129Z' {"user":"      timestamp: '2024-11-13T03:48:25.129Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       timestamp: '2024-11-13T03:48:25.129Z'"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Extracted Data: { {"user":"🔍 Extracted Data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Extracted Data: {"}}
[info] >    userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1', {"user":"  userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',"}}
[info] >    chatId: 'chat-1731469702971-8gzrstds3', {"user":"  chatId: 'chat-1731469702971-8gzrstds3',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731469702971-8gzrstds3',"}}
[info] >    messagesCount: 2 {"user":"  messagesCount: 2","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   messagesCount: 2"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Chat history saved/updated: chat-1731469702971-8gzrstds3 { totalMessageCount: 2, newMessagesAdded: 2 } {"user":"✅ Chat history saved/updated: chat-1731469702971-8gzrstds3 { totalMessageCount: 2, newMessagesAdded: 2 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Chat history saved/updated: chat-1731469702971-8gzrstds3 { totalMessageCount: 2, newMessagesAdded: 2 }"}}
[debug] [2024-11-13T03:48:27.662Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-saveChatHistory" in 394.0974ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finished \"us-central1-saveChatHistory\" in 394.0974ms"}}
[debug] [2024-11-13T03:48:27.663Z] [worker-us-central1-saveChatHistory-2165a9ad-8465-4859-90ce-6438e4ec2022]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-2165a9ad-8465-4859-90ce-6438e4ec2022]: IDLE"}}
[debug] [2024-11-13T03:48:27.663Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T03:48:27.663Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T03:48:27.663Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:48:22.953Z"],"workRunningCount":1}
[info] >  ✅ Chat history save result: { {"user":"✅ Chat history save result: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Chat history save result: {"}}
[info] >    data: { success: true, message: 'Chat history saved', totalMessages: 2 } {"user":"  data: { success: true, message: 'Chat history saved', totalMessages: 2 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { success: true, message: 'Chat history saved', totalMessages: 2 }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T03:48:27.666Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 4711.2749ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 4711.2749ms"}}
[debug] [2024-11-13T03:48:27.667Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE"}}
[debug] [2024-11-13T03:48:27.668Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T03:48:27.668Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T03:48:27.668Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:48:42.225Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:48:42.225Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:48:42.225Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:48:42.225Z"],"workRunningCount":1}
[debug] [2024-11-13T03:48:42.225Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T03:48:42.228Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T03:48:42.228Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T03:48:42.228Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T03:48:42.228Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY"}}
[debug] [2024-11-13T03:48:42.232Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 3.5552ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 3.5552ms"}}
[debug] [2024-11-13T03:48:42.233Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE"}}
[debug] [2024-11-13T03:48:42.233Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T03:48:42.233Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T03:48:42.233Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:48:42.236Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:48:42.236Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:48:42.236Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:48:42.236Z"],"workRunningCount":1}
[debug] [2024-11-13T03:48:42.236Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T03:48:42.239Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T03:48:42.239Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T03:48:42.239Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T03:48:42.245Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { {"user":"  data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: {"}}
[info] >      message: 'how are you doing', {"user":"    message: 'how are you doing',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     message: 'how are you doing',"}}
[info] >      chatId: 'chat-1731469702971-8gzrstds3' {"user":"    chatId: 'chat-1731469702971-8gzrstds3'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     chatId: 'chat-1731469702971-8gzrstds3'"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📝 Using chat ID: chat-1731469702971-8gzrstds3 {"user":"📝 Using chat ID: chat-1731469702971-8gzrstds3","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: chat-1731469702971-8gzrstds3"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 17, {"user":"  messageLength: 17,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 17,"}}
[info] >    userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1', {"user":"  userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',"}}
[info] >    chatId: 'chat-1731469702971-8gzrstds3' {"user":"  chatId: 'chat-1731469702971-8gzrstds3'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731469702971-8gzrstds3'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: how are you doing {"user":"💬 Sending message to Gemini: how are you doing","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: how are you doing"}}
[info] >  📚 Current Chat History: { {"user":"📚 Current Chat History: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📚 Current Chat History: {"}}
[info] >    chatId: 'chat-1731469702971-8gzrstds3', {"user":"  chatId: 'chat-1731469702971-8gzrstds3',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731469702971-8gzrstds3',"}}
[info] >    historyLength: 8, {"user":"  historyLength: 8,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   historyLength: 8,"}}
[info] >    lastMessages: [ {"user":"  lastMessages: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   lastMessages: ["}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] }, {"user":"    { role: 'model', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] } {"user":"    { role: 'model', parts: [Array] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Response received: { responseLength: 210, timestamp: '2024-11-13T03:48:44.045Z' } {"user":"✅ Response received: { responseLength: 210, timestamp: '2024-11-13T03:48:44.045Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 210, timestamp: '2024-11-13T03:48:44.045Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: "I'm doing well, thank you for asking!  As an AI, I don't experience emotions in the same way humans do, but I'm functioning optimally and ready to assist you.  How can I help you today with your relationships?\n", {"user":"  message: \"I'm doing well, thank you for asking!  As an AI, I don't experience emotions in the same way humans do, but I'm functioning optimally and ready to assist you.  How can I help you today with your relationships?\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: \"I'm doing well, thank you for asking!  As an AI, I don't experience emotions in the same way humans do, but I'm functioning optimally and ready to assist you.  How can I help you today with your relationships?\\n\","}}
[info] >    userMessage: 'how are you doing', {"user":"  userMessage: 'how are you doing',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'how are you doing',"}}
[info] >    timestamp: '2024-11-13T03:48:44.045Z', {"user":"  timestamp: '2024-11-13T03:48:44.045Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T03:48:44.045Z',"}}
[info] >    userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1', {"user":"  userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',"}}
[info] >    chatId: 'chat-1731469702971-8gzrstds3' {"user":"  chatId: 'chat-1731469702971-8gzrstds3'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731469702971-8gzrstds3'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Attempting to save chat history with DETAILED logging: { {"user":"🔍 Attempting to save chat history with DETAILED logging: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Attempting to save chat history with DETAILED logging: {"}}
[info] >    userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1', {"user":"  userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',"}}
[info] >    chatId: 'chat-1731469702971-8gzrstds3', {"user":"  chatId: 'chat-1731469702971-8gzrstds3',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731469702971-8gzrstds3',"}}
[info] >    messageCount: 2, {"user":"  messageCount: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageCount: 2,"}}
[info] >    timestamp: '2024-11-13T03:48:44.046Z', {"user":"  timestamp: '2024-11-13T03:48:44.046Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T03:48:44.046Z',"}}
[info] >    clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' } {"user":"  clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔧 Firebase Client Configuration: { {"user":"🔧 Firebase Client Configuration: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Firebase Client Configuration: {"}}
[info] >    projectId: 'notalone-de4fc', {"user":"  projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   projectId: 'notalone-de4fc',"}}
[info] >    apiKey: 'local-api-key', {"user":"  apiKey: 'local-api-key',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   apiKey: 'local-api-key',"}}
[info] >    authDomain: undefined, {"user":"  authDomain: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   authDomain: undefined,"}}
[info] >    emulatorHost: 'localhost', {"user":"  emulatorHost: 'localhost',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorHost: 'localhost',"}}
[info] >    emulatorPort: 5001 {"user":"  emulatorPort: 5001","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorPort: 5001"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Firebase Functions Object Keys: [ {"user":"🔍 Firebase Functions Object Keys: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Object Keys: ["}}
[info] >    'app', {"user":"  'app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'app',"}}
[info] >    'emulatorOrigin', {"user":"  'emulatorOrigin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'emulatorOrigin',"}}
[info] >    'contextProvider', {"user":"  'contextProvider',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'contextProvider',"}}
[info] >    'deleteService', {"user":"  'deleteService',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'deleteService',"}}
[info] >    'cancelAllRequests', {"user":"  'cancelAllRequests',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'cancelAllRequests',"}}
[info] >    'customDomain', {"user":"  'customDomain',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'customDomain',"}}
[info] >    'region' {"user":"  'region'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'region'"}}
[info] >  ] {"user":"]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ]"}}
[info] >  🔍 Firebase Functions Instance: FunctionsService { {"user":"🔍 Firebase Functions Instance: FunctionsService {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Instance: FunctionsService {"}}
[info] >    app: FirebaseAppImpl { {"user":"  app: FirebaseAppImpl {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   app: FirebaseAppImpl {"}}
[info] >      _isDeleted: false, {"user":"    _isDeleted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _isDeleted: false,"}}
[info] >      _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }, {"user":"    _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },"}}
[info] >      _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false }, {"user":"    _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },"}}
[info] >      _name: '[DEFAULT]', {"user":"    _name: '[DEFAULT]',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _name: '[DEFAULT]',"}}
[info] >      _automaticDataCollectionEnabled: false, {"user":"    _automaticDataCollectionEnabled: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _automaticDataCollectionEnabled: false,"}}
[info] >      _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] } {"user":"    _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    emulatorOrigin: 'http://localhost:5001', {"user":"  emulatorOrigin: 'http://localhost:5001',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorOrigin: 'http://localhost:5001',"}}
[info] >    contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null }, {"user":"  contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },"}}
[info] >    deleteService: [Function (anonymous)], {"user":"  deleteService: [Function (anonymous)],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   deleteService: [Function (anonymous)],"}}
[info] >    cancelAllRequests: Promise { <pending> }, {"user":"  cancelAllRequests: Promise { <pending> },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   cancelAllRequests: Promise { <pending> },"}}
[info] >    customDomain: null, {"user":"  customDomain: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   customDomain: null,"}}
[info] >    region: 'us-central1' {"user":"  region: 'us-central1'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   region: 'us-central1'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' } {"user":"🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[info] >  🔍 Save Chat History Function Details: { {"user":"🔍 Save Chat History Function Details: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Save Chat History Function Details: {"}}
[info] >    functionExists: true, {"user":"  functionExists: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionExists: true,"}}
[info] >    functionType: 'function', {"user":"  functionType: 'function',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionType: 'function',"}}
[info] >    functionName: 'saveChatHistory' {"user":"  functionName: 'saveChatHistory'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionName: 'saveChatHistory'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📤 Chat History Payload: { {"user":"📤 Chat History Payload: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Chat History Payload: {"}}
[info] >    "userId": "k6hl0WpTQ5fsHjYfrDRxSUjVxEr1", {"user":"  \"userId\": \"k6hl0WpTQ5fsHjYfrDRxSUjVxEr1\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"userId\": \"k6hl0WpTQ5fsHjYfrDRxSUjVxEr1\","}}
[info] >    "chatId": "chat-1731469702971-8gzrstds3", {"user":"  \"chatId\": \"chat-1731469702971-8gzrstds3\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"chatId\": \"chat-1731469702971-8gzrstds3\","}}
[info] >    "messages": [ {"user":"  \"messages\": [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"messages\": ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "user", {"user":"      \"role\": \"user\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"user\","}}
[info] >        "content": "how are you doing", {"user":"      \"content\": \"how are you doing\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"how are you doing\","}}
[info] >        "timestamp": "2024-11-13T03:48:44.047Z" {"user":"      \"timestamp\": \"2024-11-13T03:48:44.047Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T03:48:44.047Z\""}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "model", {"user":"      \"role\": \"model\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"model\","}}
[info] >        "content": "I'm doing well, thank you for asking!  As an AI, I don't experience emotions in the same way humans do, but I'm functioning optimally and ready to assist you.  How can I help you today with your relationships?\n", {"user":"      \"content\": \"I'm doing well, thank you for asking!  As an AI, I don't experience emotions in the same way humans do, but I'm functioning optimally and ready to assist you.  How can I help you today with your relationships?\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"I'm doing well, thank you for asking!  As an AI, I don't experience emotions in the same way humans do, but I'm functioning optimally and ready to assist you.  How can I help you today with your relationships?\\n\","}}
[info] >        "timestamp": "2024-11-13T03:48:44.047Z" {"user":"      \"timestamp\": \"2024-11-13T03:48:44.047Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T03:48:44.047Z\""}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    "timestamp": "2024-11-13T03:48:44.047Z", {"user":"  \"timestamp\": \"2024-11-13T03:48:44.047Z\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"timestamp\": \"2024-11-13T03:48:44.047Z\","}}
[info] >    "authDetails": { {"user":"  \"authDetails\": {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"authDetails\": {"}}
[info] >      "uid": "k6hl0WpTQ5fsHjYfrDRxSUjVxEr1", {"user":"    \"uid\": \"k6hl0WpTQ5fsHjYfrDRxSUjVxEr1\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"uid\": \"k6hl0WpTQ5fsHjYfrDRxSUjVxEr1\","}}
[info] >      "token": "Present" {"user":"    \"token\": \"Present\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"token\": \"Present\""}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T03:48:44.084Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T03:48:44.084Z"],"queueLength":1,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:48:42.236Z"],"workRunningCount":1}
[debug] [2024-11-13T03:48:44.084Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:48:42.236Z","/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T03:48:44.084Z"],"workRunningCount":2}
[debug] [2024-11-13T03:48:44.084Z] Accepted request POST /notalone-de4fc/us-central1/saveChatHistory --> us-central1-saveChatHistory
[debug] [2024-11-13T03:48:44.085Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T03:48:44.085Z] [functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/"}}
[debug] [2024-11-13T03:48:44.085Z] [worker-pool] submitRequest(triggerId=us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-saveChatHistory)"}}
[info] i  functions: Beginning execution of "us-central1-saveChatHistory" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Beginning execution of \"us-central1-saveChatHistory\""}}
[debug] [2024-11-13T03:48:44.085Z] [worker-us-central1-saveChatHistory-2165a9ad-8465-4859-90ce-6438e4ec2022]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-2165a9ad-8465-4859-90ce-6438e4ec2022]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"MISSING\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🔍 Saving Chat History { {"user":"🔍 Saving Chat History {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Saving Chat History {"}}
[info] >    request: { {"user":"  request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   request: {"}}
[info] >      rawRequest: IncomingMessage { {"user":"    rawRequest: IncomingMessage {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     rawRequest: IncomingMessage {"}}
[info] >        _events: [Object], {"user":"      _events: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _events: [Object],"}}
[info] >        _readableState: [ReadableState], {"user":"      _readableState: [ReadableState],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _readableState: [ReadableState],"}}
[info] >        _maxListeners: undefined, {"user":"      _maxListeners: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _maxListeners: undefined,"}}
[info] >        socket: [Socket], {"user":"      socket: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       socket: [Socket],"}}
[info] >        httpVersionMajor: 1, {"user":"      httpVersionMajor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMajor: 1,"}}
[info] >        httpVersionMinor: 1, {"user":"      httpVersionMinor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMinor: 1,"}}
[info] >        httpVersion: '1.1', {"user":"      httpVersion: '1.1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersion: '1.1',"}}
[info] >        complete: true, {"user":"      complete: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       complete: true,"}}
[info] >        rawHeaders: [Array], {"user":"      rawHeaders: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawHeaders: [Array],"}}
[info] >        rawTrailers: [], {"user":"      rawTrailers: [],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawTrailers: [],"}}
[info] >        joinDuplicateHeaders: null, {"user":"      joinDuplicateHeaders: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       joinDuplicateHeaders: null,"}}
[info] >        aborted: false, {"user":"      aborted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       aborted: false,"}}
[info] >        upgrade: false, {"user":"      upgrade: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       upgrade: false,"}}
[info] >        url: '/', {"user":"      url: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       url: '/',"}}
[info] >        method: 'POST', {"user":"      method: 'POST',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       method: 'POST',"}}
[info] >        statusCode: null, {"user":"      statusCode: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusCode: null,"}}
[info] >        statusMessage: null, {"user":"      statusMessage: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusMessage: null,"}}
[info] >        client: [Socket], {"user":"      client: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       client: [Socket],"}}
[info] >        _consuming: true, {"user":"      _consuming: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _consuming: true,"}}
[info] >        _dumped: false, {"user":"      _dumped: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _dumped: false,"}}
[info] >        next: [Function: next], {"user":"      next: [Function: next],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       next: [Function: next],"}}
[info] >        baseUrl: '', {"user":"      baseUrl: '',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       baseUrl: '',"}}
[info] >        originalUrl: '/', {"user":"      originalUrl: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       originalUrl: '/',"}}
[info] >        _parsedUrl: [Url], {"user":"      _parsedUrl: [Url],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _parsedUrl: [Url],"}}
[info] >        params: [Object], {"user":"      params: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       params: [Object],"}}
[info] >        query: {}, {"user":"      query: {},","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       query: {},"}}
[info] >        res: [ServerResponse], {"user":"      res: [ServerResponse],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       res: [ServerResponse],"}}
[info] >        body: [Object], {"user":"      body: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       body: [Object],"}}
[info] >        _body: true, {"user":"      _body: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _body: true,"}}
[info] >        length: undefined, {"user":"      length: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       length: undefined,"}}
[info] >        _eventsCount: 0, {"user":"      _eventsCount: 0,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _eventsCount: 0,"}}
[info] >        rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 6b 36 68 6c 30 57 70 54 51 35 66 73 48 6a 59 66 72 44 52 78 53 55 6a 56 78 45 72 31 22 2c 22 ... 457 more bytes>, {"user":"      rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 6b 36 68 6c 30 57 70 54 51 35 66 73 48 6a 59 66 72 44 52 78 53 55 6a 56 78 45 72 31 22 2c 22 ... 457 more bytes>,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 6b 36 68 6c 30 57 70 54 51 35 66 73 48 6a 59 66 72 44 52 78 53 55 6a 56 78 45 72 31 22 2c 22 ... 457 more bytes>,"}}
[info] >        route: [Route], {"user":"      route: [Route],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       route: [Route],"}}
[info] >        [Symbol(shapeMode)]: true, {"user":"      [Symbol(shapeMode)]: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(shapeMode)]: true,"}}
[info] >        [Symbol(kCapture)]: false, {"user":"      [Symbol(kCapture)]: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kCapture)]: false,"}}
[info] >        [Symbol(kHeaders)]: [Object], {"user":"      [Symbol(kHeaders)]: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeaders)]: [Object],"}}
[info] >        [Symbol(kHeadersCount)]: 18, {"user":"      [Symbol(kHeadersCount)]: 18,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeadersCount)]: 18,"}}
[info] >        [Symbol(kTrailers)]: null, {"user":"      [Symbol(kTrailers)]: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailers)]: null,"}}
[info] >        [Symbol(kTrailersCount)]: 0 {"user":"      [Symbol(kTrailersCount)]: 0","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailersCount)]: 0"}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      data: { {"user":"    data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     data: {"}}
[info] >        userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1', {"user":"      userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',"}}
[info] >        chatId: 'chat-1731469702971-8gzrstds3', {"user":"      chatId: 'chat-1731469702971-8gzrstds3',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       chatId: 'chat-1731469702971-8gzrstds3',"}}
[info] >        messages: [Array], {"user":"      messages: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       messages: [Array],"}}
[info] >        timestamp: '2024-11-13T03:48:44.047Z' {"user":"      timestamp: '2024-11-13T03:48:44.047Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       timestamp: '2024-11-13T03:48:44.047Z'"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Extracted Data: { {"user":"🔍 Extracted Data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Extracted Data: {"}}
[info] >    userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1', {"user":"  userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',"}}
[info] >    chatId: 'chat-1731469702971-8gzrstds3', {"user":"  chatId: 'chat-1731469702971-8gzrstds3',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731469702971-8gzrstds3',"}}
[info] >    messagesCount: 2 {"user":"  messagesCount: 2","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   messagesCount: 2"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Chat history saved/updated: chat-1731469702971-8gzrstds3 { totalMessageCount: 4, newMessagesAdded: 2 } {"user":"✅ Chat history saved/updated: chat-1731469702971-8gzrstds3 { totalMessageCount: 4, newMessagesAdded: 2 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Chat history saved/updated: chat-1731469702971-8gzrstds3 { totalMessageCount: 4, newMessagesAdded: 2 }"}}
[debug] [2024-11-13T03:48:44.131Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-saveChatHistory" in 46.1717ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finished \"us-central1-saveChatHistory\" in 46.1717ms"}}
[debug] [2024-11-13T03:48:44.132Z] [worker-us-central1-saveChatHistory-2165a9ad-8465-4859-90ce-6438e4ec2022]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-2165a9ad-8465-4859-90ce-6438e4ec2022]: IDLE"}}
[debug] [2024-11-13T03:48:44.132Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T03:48:44.132Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T03:48:44.132Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:48:42.236Z"],"workRunningCount":1}
[info] >  ✅ Chat history save result: { {"user":"✅ Chat history save result: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Chat history save result: {"}}
[info] >    data: { success: true, message: 'Chat history saved', totalMessages: 4 } {"user":"  data: { success: true, message: 'Chat history saved', totalMessages: 4 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { success: true, message: 'Chat history saved', totalMessages: 4 }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T03:48:44.135Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 1890.2714999999998ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 1890.2714999999998ms"}}
[debug] [2024-11-13T03:48:44.135Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE"}}
[debug] [2024-11-13T03:48:44.136Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T03:48:44.136Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T03:48:44.136Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:48:55.436Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:48:55.436Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:48:55.436Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:48:55.436Z"],"workRunningCount":1}
[debug] [2024-11-13T03:48:55.436Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T03:48:55.439Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T03:48:55.439Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T03:48:55.439Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T03:48:55.440Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY"}}
[debug] [2024-11-13T03:48:55.442Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2.6359ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2.6359ms"}}
[debug] [2024-11-13T03:48:55.443Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE"}}
[debug] [2024-11-13T03:48:55.443Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T03:48:55.443Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T03:48:55.443Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:48:55.443Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:48:55.443Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:48:55.444Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:48:55.443Z"],"workRunningCount":1}
[debug] [2024-11-13T03:48:55.444Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T03:48:55.446Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T03:48:55.446Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T03:48:55.446Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T03:48:55.447Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'thank you ', chatId: 'chat-1731469702971-8gzrstds3' } {"user":"  data: { message: 'thank you ', chatId: 'chat-1731469702971-8gzrstds3' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'thank you ', chatId: 'chat-1731469702971-8gzrstds3' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📝 Using chat ID: chat-1731469702971-8gzrstds3 {"user":"📝 Using chat ID: chat-1731469702971-8gzrstds3","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: chat-1731469702971-8gzrstds3"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 10, {"user":"  messageLength: 10,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 10,"}}
[info] >    userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1', {"user":"  userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',"}}
[info] >    chatId: 'chat-1731469702971-8gzrstds3' {"user":"  chatId: 'chat-1731469702971-8gzrstds3'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731469702971-8gzrstds3'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: thank you  {"user":"💬 Sending message to Gemini: thank you ","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: thank you "}}
[info] >  💥 Chat processing error: ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {"error":{"code":429,"message":"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","status":"RESOURCE_EXHAUSTED"}} {"user":"💥 Chat processing error: ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {\"error\":{\"code\":429,\"message\":\"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.\",\"status\":\"RESOURCE_EXHAUSTED\"}}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💥 Chat processing error: ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {\"error\":{\"code\":429,\"message\":\"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.\",\"status\":\"RESOURCE_EXHAUSTED\"}}"}}
[info] >      at throwErrorIfNotOK (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:27) {"user":"    at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:27)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:27)"}}
[info] >      at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >      ... 6 lines matching cause stack trace ... {"user":"    ... 6 lines matching cause stack trace ...","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     ... 6 lines matching cause stack trace ..."}}
[info] >      at async C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:694:21 { {"user":"    at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {"}}
[info] >    stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff. {"user":"  stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff."}}
[info] >        at throwErrorIfNotOK (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:66) {"user":"      at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)"}}
[info] >        at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >        at async generateContent (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\generate_content.js:58:5) {"user":"      at async generateContent (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:58:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async generateContent (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:58:5)"}}
[info] >        at async ChatSessionPreview.sendMessage (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\models\chat_session.js:241:39) {"user":"      at async ChatSessionPreview.sendMessage (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\models\\chat_session.js:241:39)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async ChatSessionPreview.sendMessage (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\models\\chat_session.js:241:39)"}}
[info] >        at async C:\Users\Rob\apps\not-alone\functions\lib\index.js:143:24 {"user":"      at async C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js:143:24","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js:143:24"}}
[info] >        at async C:\Users\Rob\apps\not-alone\functions\node_modules\firebase-functions\lib\common\providers\https.js:467:26 {"user":"      at async C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26"}}
[info] >        at async runFunction (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:506:9) {"user":"      at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)"}}
[info] >        at async runHTTPS (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:531:5) {"user":"      at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)"}}
[info] >        at async C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:694:21 { {"user":"      at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {"}}
[info] >      code: 429, {"user":"    code: 429,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 429,"}}
[info] >      status: 'RESOURCE_EXHAUSTED', {"user":"    status: 'RESOURCE_EXHAUSTED',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     status: 'RESOURCE_EXHAUSTED',"}}
[info] >      errorDetails: undefined {"user":"    errorDetails: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     errorDetails: undefined"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff. {"user":"  [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff."}}
[info] >        at throwErrorIfNotOK (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:66) {"user":"      at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)"}}
[info] >        at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >        at async generateContent (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\generate_content.js:58:5) {"user":"      at async generateContent (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:58:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async generateContent (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:58:5)"}}
[info] >        at async ChatSessionPreview.sendMessage (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\models\chat_session.js:241:39) {"user":"      at async ChatSessionPreview.sendMessage (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\models\\chat_session.js:241:39)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async ChatSessionPreview.sendMessage (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\models\\chat_session.js:241:39)"}}
[info] >        at async C:\Users\Rob\apps\not-alone\functions\lib\index.js:143:24 {"user":"      at async C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js:143:24","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js:143:24"}}
[info] >        at async C:\Users\Rob\apps\not-alone\functions\node_modules\firebase-functions\lib\common\providers\https.js:467:26 {"user":"      at async C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26"}}
[info] >        at async runFunction (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:506:9) {"user":"      at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)"}}
[info] >        at async runHTTPS (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:531:5) {"user":"      at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)"}}
[info] >        at async C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:694:21 { {"user":"      at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {"}}
[info] >      code: 429, {"user":"    code: 429,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 429,"}}
[info] >      status: 'RESOURCE_EXHAUSTED', {"user":"    status: 'RESOURCE_EXHAUSTED',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     status: 'RESOURCE_EXHAUSTED',"}}
[info] >      errorDetails: undefined {"user":"    errorDetails: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     errorDetails: undefined"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T03:48:55.793Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 346.1594ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 346.1594ms"}}
[debug] [2024-11-13T03:48:55.793Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE"}}
[debug] [2024-11-13T03:48:55.793Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T03:48:55.793Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T03:48:55.793Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:49:00.802Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:49:00.802Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:49:00.803Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:49:00.802Z"],"workRunningCount":1}
[debug] [2024-11-13T03:49:00.803Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T03:49:00.805Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T03:49:00.805Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T03:49:00.805Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T03:49:00.806Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY"}}
[debug] [2024-11-13T03:49:00.808Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 3.119ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 3.119ms"}}
[debug] [2024-11-13T03:49:00.809Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE"}}
[debug] [2024-11-13T03:49:00.809Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T03:49:00.810Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T03:49:00.810Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:49:00.810Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:49:00.810Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:49:00.810Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:49:00.810Z"],"workRunningCount":1}
[debug] [2024-11-13T03:49:00.810Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T03:49:00.812Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T03:49:00.812Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T03:49:00.813Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T03:49:00.813Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'thank you ', chatId: 'chat-1731469702971-8gzrstds3' } {"user":"  data: { message: 'thank you ', chatId: 'chat-1731469702971-8gzrstds3' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'thank you ', chatId: 'chat-1731469702971-8gzrstds3' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📝 Using chat ID: chat-1731469702971-8gzrstds3 {"user":"📝 Using chat ID: chat-1731469702971-8gzrstds3","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: chat-1731469702971-8gzrstds3"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 10, {"user":"  messageLength: 10,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 10,"}}
[info] >    userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1', {"user":"  userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',"}}
[info] >    chatId: 'chat-1731469702971-8gzrstds3' {"user":"  chatId: 'chat-1731469702971-8gzrstds3'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731469702971-8gzrstds3'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: thank you  {"user":"💬 Sending message to Gemini: thank you ","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: thank you "}}
[info] >  💥 Chat processing error: ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {"error":{"code":429,"message":"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","status":"RESOURCE_EXHAUSTED"}} {"user":"💥 Chat processing error: ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {\"error\":{\"code\":429,\"message\":\"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.\",\"status\":\"RESOURCE_EXHAUSTED\"}}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💥 Chat processing error: ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {\"error\":{\"code\":429,\"message\":\"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.\",\"status\":\"RESOURCE_EXHAUSTED\"}}"}}
[info] >      at throwErrorIfNotOK (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:27) {"user":"    at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:27)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:27)"}}
[info] >      at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >      ... 6 lines matching cause stack trace ... {"user":"    ... 6 lines matching cause stack trace ...","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     ... 6 lines matching cause stack trace ..."}}
[info] >      at async C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:694:21 { {"user":"    at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {"}}
[info] >    stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff. {"user":"  stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff."}}
[info] >        at throwErrorIfNotOK (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:66) {"user":"      at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)"}}
[info] >        at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >        at async generateContent (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\generate_content.js:58:5) {"user":"      at async generateContent (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:58:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async generateContent (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:58:5)"}}
[info] >        at async ChatSessionPreview.sendMessage (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\models\chat_session.js:241:39) {"user":"      at async ChatSessionPreview.sendMessage (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\models\\chat_session.js:241:39)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async ChatSessionPreview.sendMessage (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\models\\chat_session.js:241:39)"}}
[info] >        at async C:\Users\Rob\apps\not-alone\functions\lib\index.js:143:24 {"user":"      at async C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js:143:24","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js:143:24"}}
[info] >        at async C:\Users\Rob\apps\not-alone\functions\node_modules\firebase-functions\lib\common\providers\https.js:467:26 {"user":"      at async C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26"}}
[info] >        at async runFunction (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:506:9) {"user":"      at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)"}}
[info] >        at async runHTTPS (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:531:5) {"user":"      at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)"}}
[info] >        at async C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:694:21 { {"user":"      at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {"}}
[info] >      code: 429, {"user":"    code: 429,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 429,"}}
[info] >      status: 'RESOURCE_EXHAUSTED', {"user":"    status: 'RESOURCE_EXHAUSTED',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     status: 'RESOURCE_EXHAUSTED',"}}
[info] >      errorDetails: undefined {"user":"    errorDetails: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     errorDetails: undefined"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff. {"user":"  [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff."}}
[info] >        at throwErrorIfNotOK (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:66) {"user":"      at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)"}}
[info] >        at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >        at async generateContent (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\generate_content.js:58:5) {"user":"      at async generateContent (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:58:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async generateContent (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:58:5)"}}
[info] >        at async ChatSessionPreview.sendMessage (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\models\chat_session.js:241:39) {"user":"      at async ChatSessionPreview.sendMessage (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\models\\chat_session.js:241:39)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async ChatSessionPreview.sendMessage (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\models\\chat_session.js:241:39)"}}
[info] >        at async C:\Users\Rob\apps\not-alone\functions\lib\index.js:143:24 {"user":"      at async C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js:143:24","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js:143:24"}}
[info] >        at async C:\Users\Rob\apps\not-alone\functions\node_modules\firebase-functions\lib\common\providers\https.js:467:26 {"user":"      at async C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26"}}
[info] >        at async runFunction (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:506:9) {"user":"      at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)"}}
[info] >        at async runHTTPS (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:531:5) {"user":"      at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)"}}
[info] >        at async C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:694:21 { {"user":"      at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {"}}
[info] >      code: 429, {"user":"    code: 429,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 429,"}}
[info] >      status: 'RESOURCE_EXHAUSTED', {"user":"    status: 'RESOURCE_EXHAUSTED',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     status: 'RESOURCE_EXHAUSTED',"}}
[info] >      errorDetails: undefined {"user":"    errorDetails: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     errorDetails: undefined"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T03:49:01.037Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 224.044ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 224.044ms"}}
[debug] [2024-11-13T03:49:01.037Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE"}}
[debug] [2024-11-13T03:49:01.038Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T03:49:01.038Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T03:49:01.038Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:49:06.051Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:49:06.051Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:49:06.051Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:49:06.051Z"],"workRunningCount":1}
[debug] [2024-11-13T03:49:06.051Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T03:49:06.052Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T03:49:06.052Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T03:49:06.052Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T03:49:06.052Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY"}}
[debug] [2024-11-13T03:49:06.055Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2.4828ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2.4828ms"}}
[debug] [2024-11-13T03:49:06.055Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE"}}
[debug] [2024-11-13T03:49:06.056Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T03:49:06.056Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T03:49:06.056Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:49:06.056Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:49:06.056Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:49:06.057Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:49:06.056Z"],"workRunningCount":1}
[debug] [2024-11-13T03:49:06.057Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T03:49:06.059Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T03:49:06.059Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T03:49:06.059Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T03:49:06.059Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'thank you ', chatId: 'chat-1731469702971-8gzrstds3' } {"user":"  data: { message: 'thank you ', chatId: 'chat-1731469702971-8gzrstds3' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'thank you ', chatId: 'chat-1731469702971-8gzrstds3' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📝 Using chat ID: chat-1731469702971-8gzrstds3 {"user":"📝 Using chat ID: chat-1731469702971-8gzrstds3","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: chat-1731469702971-8gzrstds3"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 10, {"user":"  messageLength: 10,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 10,"}}
[info] >    userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1', {"user":"  userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',"}}
[info] >    chatId: 'chat-1731469702971-8gzrstds3' {"user":"  chatId: 'chat-1731469702971-8gzrstds3'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731469702971-8gzrstds3'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: thank you  {"user":"💬 Sending message to Gemini: thank you ","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: thank you "}}
[info] >  💥 Chat processing error: ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {"error":{"code":429,"message":"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","status":"RESOURCE_EXHAUSTED"}} {"user":"💥 Chat processing error: ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {\"error\":{\"code\":429,\"message\":\"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.\",\"status\":\"RESOURCE_EXHAUSTED\"}}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💥 Chat processing error: ClientError: [VertexAI.ClientError]: got status: 429 Too Many Requests. {\"error\":{\"code\":429,\"message\":\"Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.\",\"status\":\"RESOURCE_EXHAUSTED\"}}"}}
[info] >      at throwErrorIfNotOK (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:27) {"user":"    at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:27)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:27)"}}
[info] >      at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >      ... 6 lines matching cause stack trace ... {"user":"    ... 6 lines matching cause stack trace ...","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     ... 6 lines matching cause stack trace ..."}}
[info] >      at async C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:694:21 { {"user":"    at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {"}}
[info] >    stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff. {"user":"  stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   stackTrace: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff."}}
[info] >        at throwErrorIfNotOK (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:66) {"user":"      at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)"}}
[info] >        at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >        at async generateContent (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\generate_content.js:58:5) {"user":"      at async generateContent (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:58:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async generateContent (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:58:5)"}}
[info] >        at async ChatSessionPreview.sendMessage (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\models\chat_session.js:241:39) {"user":"      at async ChatSessionPreview.sendMessage (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\models\\chat_session.js:241:39)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async ChatSessionPreview.sendMessage (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\models\\chat_session.js:241:39)"}}
[info] >        at async C:\Users\Rob\apps\not-alone\functions\lib\index.js:143:24 {"user":"      at async C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js:143:24","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js:143:24"}}
[info] >        at async C:\Users\Rob\apps\not-alone\functions\node_modules\firebase-functions\lib\common\providers\https.js:467:26 {"user":"      at async C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26"}}
[info] >        at async runFunction (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:506:9) {"user":"      at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)"}}
[info] >        at async runHTTPS (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:531:5) {"user":"      at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)"}}
[info] >        at async C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:694:21 { {"user":"      at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {"}}
[info] >      code: 429, {"user":"    code: 429,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 429,"}}
[info] >      status: 'RESOURCE_EXHAUSTED', {"user":"    status: 'RESOURCE_EXHAUSTED',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     status: 'RESOURCE_EXHAUSTED',"}}
[info] >      errorDetails: undefined {"user":"    errorDetails: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     errorDetails: undefined"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff. {"user":"  [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff.","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   [cause]: GoogleApiError: Online prediction request quota exceeded for gemini-1.5-flash. Please try again later with backoff."}}
[info] >        at throwErrorIfNotOK (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\post_fetch_processing.js:32:66) {"user":"      at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at throwErrorIfNotOK (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\post_fetch_processing.js:32:66)"}}
[info] >        at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {"user":"      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"}}
[info] >        at async generateContent (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\functions\generate_content.js:58:5) {"user":"      at async generateContent (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:58:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async generateContent (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\functions\\generate_content.js:58:5)"}}
[info] >        at async ChatSessionPreview.sendMessage (C:\Users\Rob\apps\not-alone\functions\node_modules\@google-cloud\vertexai\build\src\models\chat_session.js:241:39) {"user":"      at async ChatSessionPreview.sendMessage (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\models\\chat_session.js:241:39)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async ChatSessionPreview.sendMessage (C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\@google-cloud\\vertexai\\build\\src\\models\\chat_session.js:241:39)"}}
[info] >        at async C:\Users\Rob\apps\not-alone\functions\lib\index.js:143:24 {"user":"      at async C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js:143:24","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\apps\\not-alone\\functions\\lib\\index.js:143:24"}}
[info] >        at async C:\Users\Rob\apps\not-alone\functions\node_modules\firebase-functions\lib\common\providers\https.js:467:26 {"user":"      at async C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\apps\\not-alone\\functions\\node_modules\\firebase-functions\\lib\\common\\providers\\https.js:467:26"}}
[info] >        at async runFunction (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:506:9) {"user":"      at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async runFunction (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:506:9)"}}
[info] >        at async runHTTPS (C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:531:5) {"user":"      at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async runHTTPS (C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:531:5)"}}
[info] >        at async C:\Users\Rob\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:694:21 { {"user":"      at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       at async C:\\Users\\Rob\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:694:21 {"}}
[info] >      code: 429, {"user":"    code: 429,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     code: 429,"}}
[info] >      status: 'RESOURCE_EXHAUSTED', {"user":"    status: 'RESOURCE_EXHAUSTED',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     status: 'RESOURCE_EXHAUSTED',"}}
[info] >      errorDetails: undefined {"user":"    errorDetails: undefined","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     errorDetails: undefined"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T03:49:06.269Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 209.4753ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 209.4753ms"}}
[debug] [2024-11-13T03:49:06.269Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE"}}
[debug] [2024-11-13T03:49:06.269Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T03:49:06.269Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T03:49:06.270Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:49:11.280Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:49:11.280Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:49:11.280Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:49:11.280Z"],"workRunningCount":1}
[debug] [2024-11-13T03:49:11.280Z] Accepted request OPTIONS /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T03:49:11.282Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T03:49:11.282Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T03:49:11.282Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T03:49:11.282Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY"}}
[debug] [2024-11-13T03:49:11.285Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 2.4589ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 2.4589ms"}}
[debug] [2024-11-13T03:49:11.285Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE"}}
[debug] [2024-11-13T03:49:11.285Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T03:49:11.285Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T03:49:11.286Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:49:11.286Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:49:11.286Z"],"queueLength":1,"runningWork":[],"workRunningCount":0}
[debug] [2024-11-13T03:49:11.286Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:49:11.286Z"],"workRunningCount":1}
[debug] [2024-11-13T03:49:11.286Z] Accepted request POST /notalone-de4fc/us-central1/processChat --> us-central1-processChat
[debug] [2024-11-13T03:49:11.288Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T03:49:11.288Z] [functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/processChat, mapping to path=/"}}
[debug] [2024-11-13T03:49:11.288Z] [worker-pool] submitRequest(triggerId=us-central1-processChat) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-processChat)"}}
[info] i  functions: Beginning execution of "us-central1-processChat" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Beginning execution of \"us-central1-processChat\""}}
[debug] [2024-11-13T03:49:11.289Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"VALID"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"VALID\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🚀 Incoming request: { {"user":"🚀 Incoming request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🚀 Incoming request: {"}}
[info] >    auth: 'Authenticated', {"user":"  auth: 'Authenticated',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   auth: 'Authenticated',"}}
[info] >    data: { message: 'thank you ', chatId: 'chat-1731469702971-8gzrstds3' } {"user":"  data: { message: 'thank you ', chatId: 'chat-1731469702971-8gzrstds3' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { message: 'thank you ', chatId: 'chat-1731469702971-8gzrstds3' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📝 Using chat ID: chat-1731469702971-8gzrstds3 {"user":"📝 Using chat ID: chat-1731469702971-8gzrstds3","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📝 Using chat ID: chat-1731469702971-8gzrstds3"}}
[info] >  📥 Processing request: { {"user":"📥 Processing request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📥 Processing request: {"}}
[info] >    messageLength: 10, {"user":"  messageLength: 10,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageLength: 10,"}}
[info] >    userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1', {"user":"  userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',"}}
[info] >    chatId: 'chat-1731469702971-8gzrstds3' {"user":"  chatId: 'chat-1731469702971-8gzrstds3'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731469702971-8gzrstds3'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  💬 Sending message to Gemini: thank you  {"user":"💬 Sending message to Gemini: thank you ","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 💬 Sending message to Gemini: thank you "}}
[info] >  📚 Current Chat History: { {"user":"📚 Current Chat History: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📚 Current Chat History: {"}}
[info] >    chatId: 'chat-1731469702971-8gzrstds3', {"user":"  chatId: 'chat-1731469702971-8gzrstds3',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731469702971-8gzrstds3',"}}
[info] >    historyLength: 13, {"user":"  historyLength: 13,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   historyLength: 13,"}}
[info] >    lastMessages: [ {"user":"  lastMessages: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   lastMessages: ["}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'user', parts: [Array] }, {"user":"    { role: 'user', parts: [Array] },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'user', parts: [Array] },"}}
[info] >      { role: 'model', parts: [Array] } {"user":"    { role: 'model', parts: [Array] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     { role: 'model', parts: [Array] }"}}
[info] >    ] {"user":"  ]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ]"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  ✅ Response received: { responseLength: 95, timestamp: '2024-11-13T03:49:12.293Z' } {"user":"✅ Response received: { responseLength: 95, timestamp: '2024-11-13T03:49:12.293Z' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Response received: { responseLength: 95, timestamp: '2024-11-13T03:49:12.293Z' }"}}
[info] >  📤 Sending response: { {"user":"📤 Sending response: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Sending response: {"}}
[info] >    message: "You're welcome! Is there anything else I can help you with today regarding your relationships?\n", {"user":"  message: \"You're welcome! Is there anything else I can help you with today regarding your relationships?\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   message: \"You're welcome! Is there anything else I can help you with today regarding your relationships?\\n\","}}
[info] >    userMessage: 'thank you ', {"user":"  userMessage: 'thank you ',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userMessage: 'thank you ',"}}
[info] >    timestamp: '2024-11-13T03:49:12.293Z', {"user":"  timestamp: '2024-11-13T03:49:12.293Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T03:49:12.293Z',"}}
[info] >    userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1', {"user":"  userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',"}}
[info] >    chatId: 'chat-1731469702971-8gzrstds3' {"user":"  chatId: 'chat-1731469702971-8gzrstds3'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731469702971-8gzrstds3'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Attempting to save chat history with DETAILED logging: { {"user":"🔍 Attempting to save chat history with DETAILED logging: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Attempting to save chat history with DETAILED logging: {"}}
[info] >    userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1', {"user":"  userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',"}}
[info] >    chatId: 'chat-1731469702971-8gzrstds3', {"user":"  chatId: 'chat-1731469702971-8gzrstds3',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731469702971-8gzrstds3',"}}
[info] >    messageCount: 2, {"user":"  messageCount: 2,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   messageCount: 2,"}}
[info] >    timestamp: '2024-11-13T03:49:12.293Z', {"user":"  timestamp: '2024-11-13T03:49:12.293Z',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   timestamp: '2024-11-13T03:49:12.293Z',"}}
[info] >    clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' } {"user":"  clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   clientAppConfig: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔧 Firebase Client Configuration: { {"user":"🔧 Firebase Client Configuration: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Firebase Client Configuration: {"}}
[info] >    projectId: 'notalone-de4fc', {"user":"  projectId: 'notalone-de4fc',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   projectId: 'notalone-de4fc',"}}
[info] >    apiKey: 'local-api-key', {"user":"  apiKey: 'local-api-key',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   apiKey: 'local-api-key',"}}
[info] >    authDomain: undefined, {"user":"  authDomain: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   authDomain: undefined,"}}
[info] >    emulatorHost: 'localhost', {"user":"  emulatorHost: 'localhost',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorHost: 'localhost',"}}
[info] >    emulatorPort: 5001 {"user":"  emulatorPort: 5001","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorPort: 5001"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Firebase Functions Object Keys: [ {"user":"🔍 Firebase Functions Object Keys: [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Object Keys: ["}}
[info] >    'app', {"user":"  'app',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'app',"}}
[info] >    'emulatorOrigin', {"user":"  'emulatorOrigin',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'emulatorOrigin',"}}
[info] >    'contextProvider', {"user":"  'contextProvider',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'contextProvider',"}}
[info] >    'deleteService', {"user":"  'deleteService',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'deleteService',"}}
[info] >    'cancelAllRequests', {"user":"  'cancelAllRequests',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'cancelAllRequests',"}}
[info] >    'customDomain', {"user":"  'customDomain',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'customDomain',"}}
[info] >    'region' {"user":"  'region'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   'region'"}}
[info] >  ] {"user":"]","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ]"}}
[info] >  🔍 Firebase Functions Instance: FunctionsService { {"user":"🔍 Firebase Functions Instance: FunctionsService {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Firebase Functions Instance: FunctionsService {"}}
[info] >    app: FirebaseAppImpl { {"user":"  app: FirebaseAppImpl {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   app: FirebaseAppImpl {"}}
[info] >      _isDeleted: false, {"user":"    _isDeleted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _isDeleted: false,"}}
[info] >      _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' }, {"user":"    _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _options: { projectId: 'notalone-de4fc', apiKey: 'local-api-key' },"}}
[info] >      _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false }, {"user":"    _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _config: { name: '[DEFAULT]', automaticDataCollectionEnabled: false },"}}
[info] >      _name: '[DEFAULT]', {"user":"    _name: '[DEFAULT]',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _name: '[DEFAULT]',"}}
[info] >      _automaticDataCollectionEnabled: false, {"user":"    _automaticDataCollectionEnabled: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _automaticDataCollectionEnabled: false,"}}
[info] >      _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] } {"user":"    _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     _container: ComponentContainer { name: '[DEFAULT]', providers: [Map] }"}}
[info] >    }, {"user":"  },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   },"}}
[info] >    emulatorOrigin: 'http://localhost:5001', {"user":"  emulatorOrigin: 'http://localhost:5001',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   emulatorOrigin: 'http://localhost:5001',"}}
[info] >    contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null }, {"user":"  contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   contextProvider: ContextProvider { auth: null, messaging: null, appCheck: null },"}}
[info] >    deleteService: [Function (anonymous)], {"user":"  deleteService: [Function (anonymous)],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   deleteService: [Function (anonymous)],"}}
[info] >    cancelAllRequests: Promise { <pending> }, {"user":"  cancelAllRequests: Promise { <pending> },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   cancelAllRequests: Promise { <pending> },"}}
[info] >    customDomain: null, {"user":"  customDomain: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   customDomain: null,"}}
[info] >    region: 'us-central1' {"user":"  region: 'us-central1'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   region: 'us-central1'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' } {"user":"🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Admin App Project Configuration: { projectId: 'notalone-de4fc', name: '[DEFAULT]' }"}}
[info] >  🔧 Configured Firebase Functions to use local emulator {"user":"🔧 Configured Firebase Functions to use local emulator","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔧 Configured Firebase Functions to use local emulator"}}
[info] >  🔍 Save Chat History Function Details: { {"user":"🔍 Save Chat History Function Details: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Save Chat History Function Details: {"}}
[info] >    functionExists: true, {"user":"  functionExists: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionExists: true,"}}
[info] >    functionType: 'function', {"user":"  functionType: 'function',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionType: 'function',"}}
[info] >    functionName: 'saveChatHistory' {"user":"  functionName: 'saveChatHistory'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   functionName: 'saveChatHistory'"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  📤 Chat History Payload: { {"user":"📤 Chat History Payload: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m 📤 Chat History Payload: {"}}
[info] >    "userId": "k6hl0WpTQ5fsHjYfrDRxSUjVxEr1", {"user":"  \"userId\": \"k6hl0WpTQ5fsHjYfrDRxSUjVxEr1\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"userId\": \"k6hl0WpTQ5fsHjYfrDRxSUjVxEr1\","}}
[info] >    "chatId": "chat-1731469702971-8gzrstds3", {"user":"  \"chatId\": \"chat-1731469702971-8gzrstds3\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"chatId\": \"chat-1731469702971-8gzrstds3\","}}
[info] >    "messages": [ {"user":"  \"messages\": [","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"messages\": ["}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "user", {"user":"      \"role\": \"user\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"user\","}}
[info] >        "content": "thank you ", {"user":"      \"content\": \"thank you \",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"thank you \","}}
[info] >        "timestamp": "2024-11-13T03:49:12.294Z" {"user":"      \"timestamp\": \"2024-11-13T03:49:12.294Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T03:49:12.294Z\""}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      { {"user":"    {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     {"}}
[info] >        "role": "model", {"user":"      \"role\": \"model\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"role\": \"model\","}}
[info] >        "content": "You're welcome! Is there anything else I can help you with today regarding your relationships?\n", {"user":"      \"content\": \"You're welcome! Is there anything else I can help you with today regarding your relationships?\\n\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"content\": \"You're welcome! Is there anything else I can help you with today regarding your relationships?\\n\","}}
[info] >        "timestamp": "2024-11-13T03:49:12.294Z" {"user":"      \"timestamp\": \"2024-11-13T03:49:12.294Z\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m       \"timestamp\": \"2024-11-13T03:49:12.294Z\""}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    ], {"user":"  ],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   ],"}}
[info] >    "timestamp": "2024-11-13T03:49:12.294Z", {"user":"  \"timestamp\": \"2024-11-13T03:49:12.294Z\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"timestamp\": \"2024-11-13T03:49:12.294Z\","}}
[info] >    "authDetails": { {"user":"  \"authDetails\": {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   \"authDetails\": {"}}
[info] >      "uid": "k6hl0WpTQ5fsHjYfrDRxSUjVxEr1", {"user":"    \"uid\": \"k6hl0WpTQ5fsHjYfrDRxSUjVxEr1\",","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"uid\": \"k6hl0WpTQ5fsHjYfrDRxSUjVxEr1\","}}
[info] >      "token": "Present" {"user":"    \"token\": \"Present\"","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m     \"token\": \"Present\""}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T03:49:12.331Z] [work-queue] {"queuedWork":["/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T03:49:12.331Z"],"queueLength":1,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:49:11.286Z"],"workRunningCount":1}
[debug] [2024-11-13T03:49:12.331Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:49:11.286Z","/notalone-de4fc/us-central1/saveChatHistory-2024-11-13T03:49:12.331Z"],"workRunningCount":2}
[debug] [2024-11-13T03:49:12.331Z] Accepted request POST /notalone-de4fc/us-central1/saveChatHistory --> us-central1-saveChatHistory
[debug] [2024-11-13T03:49:12.332Z] [functions] Runtime ready! Sending request! {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Runtime ready! Sending request!"}}
[debug] [2024-11-13T03:49:12.332Z] [functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/ {"metadata":{"emulator":{"name":"functions"},"message":"[functions] Got req.url=/notalone-de4fc/us-central1/saveChatHistory, mapping to path=/"}}
[debug] [2024-11-13T03:49:12.332Z] [worker-pool] submitRequest(triggerId=us-central1-saveChatHistory) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitRequest(triggerId=us-central1-saveChatHistory)"}}
[info] i  functions: Beginning execution of "us-central1-saveChatHistory" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Beginning execution of \"us-central1-saveChatHistory\""}}
[debug] [2024-11-13T03:49:12.332Z] [worker-us-central1-saveChatHistory-2165a9ad-8465-4859-90ce-6438e4ec2022]: BUSY {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-2165a9ad-8465-4859-90ce-6438e4ec2022]: BUSY"}}
[info] >  {"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"} {"user":{"verifications":{"app":"MISSING","auth":"MISSING"},"logging.googleapis.com/labels":{"firebase-log-type":"callable-request-verification"},"severity":"DEBUG","message":"Callable request verification passed"},"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m {\"verifications\":{\"app\":\"MISSING\",\"auth\":\"MISSING\"},\"logging.googleapis.com/labels\":{\"firebase-log-type\":\"callable-request-verification\"},\"severity\":\"DEBUG\",\"message\":\"Callable request verification passed\"}"}}
[info] >  🔍 Saving Chat History { {"user":"🔍 Saving Chat History {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Saving Chat History {"}}
[info] >    request: { {"user":"  request: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   request: {"}}
[info] >      rawRequest: IncomingMessage { {"user":"    rawRequest: IncomingMessage {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     rawRequest: IncomingMessage {"}}
[info] >        _events: [Object], {"user":"      _events: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _events: [Object],"}}
[info] >        _readableState: [ReadableState], {"user":"      _readableState: [ReadableState],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _readableState: [ReadableState],"}}
[info] >        _maxListeners: undefined, {"user":"      _maxListeners: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _maxListeners: undefined,"}}
[info] >        socket: [Socket], {"user":"      socket: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       socket: [Socket],"}}
[info] >        httpVersionMajor: 1, {"user":"      httpVersionMajor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMajor: 1,"}}
[info] >        httpVersionMinor: 1, {"user":"      httpVersionMinor: 1,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersionMinor: 1,"}}
[info] >        httpVersion: '1.1', {"user":"      httpVersion: '1.1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       httpVersion: '1.1',"}}
[info] >        complete: true, {"user":"      complete: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       complete: true,"}}
[info] >        rawHeaders: [Array], {"user":"      rawHeaders: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawHeaders: [Array],"}}
[info] >        rawTrailers: [], {"user":"      rawTrailers: [],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawTrailers: [],"}}
[info] >        joinDuplicateHeaders: null, {"user":"      joinDuplicateHeaders: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       joinDuplicateHeaders: null,"}}
[info] >        aborted: false, {"user":"      aborted: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       aborted: false,"}}
[info] >        upgrade: false, {"user":"      upgrade: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       upgrade: false,"}}
[info] >        url: '/', {"user":"      url: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       url: '/',"}}
[info] >        method: 'POST', {"user":"      method: 'POST',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       method: 'POST',"}}
[info] >        statusCode: null, {"user":"      statusCode: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusCode: null,"}}
[info] >        statusMessage: null, {"user":"      statusMessage: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       statusMessage: null,"}}
[info] >        client: [Socket], {"user":"      client: [Socket],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       client: [Socket],"}}
[info] >        _consuming: true, {"user":"      _consuming: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _consuming: true,"}}
[info] >        _dumped: false, {"user":"      _dumped: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _dumped: false,"}}
[info] >        next: [Function: next], {"user":"      next: [Function: next],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       next: [Function: next],"}}
[info] >        baseUrl: '', {"user":"      baseUrl: '',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       baseUrl: '',"}}
[info] >        originalUrl: '/', {"user":"      originalUrl: '/',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       originalUrl: '/',"}}
[info] >        _parsedUrl: [Url], {"user":"      _parsedUrl: [Url],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _parsedUrl: [Url],"}}
[info] >        params: [Object], {"user":"      params: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       params: [Object],"}}
[info] >        query: {}, {"user":"      query: {},","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       query: {},"}}
[info] >        res: [ServerResponse], {"user":"      res: [ServerResponse],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       res: [ServerResponse],"}}
[info] >        body: [Object], {"user":"      body: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       body: [Object],"}}
[info] >        _body: true, {"user":"      _body: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _body: true,"}}
[info] >        length: undefined, {"user":"      length: undefined,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       length: undefined,"}}
[info] >        _eventsCount: 0, {"user":"      _eventsCount: 0,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       _eventsCount: 0,"}}
[info] >        rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 6b 36 68 6c 30 57 70 54 51 35 66 73 48 6a 59 66 72 44 52 78 53 55 6a 56 78 45 72 31 22 2c 22 ... 335 more bytes>, {"user":"      rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 6b 36 68 6c 30 57 70 54 51 35 66 73 48 6a 59 66 72 44 52 78 53 55 6a 56 78 45 72 31 22 2c 22 ... 335 more bytes>,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       rawBody: <Buffer 7b 22 64 61 74 61 22 3a 7b 22 75 73 65 72 49 64 22 3a 22 6b 36 68 6c 30 57 70 54 51 35 66 73 48 6a 59 66 72 44 52 78 53 55 6a 56 78 45 72 31 22 2c 22 ... 335 more bytes>,"}}
[info] >        route: [Route], {"user":"      route: [Route],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       route: [Route],"}}
[info] >        [Symbol(shapeMode)]: true, {"user":"      [Symbol(shapeMode)]: true,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(shapeMode)]: true,"}}
[info] >        [Symbol(kCapture)]: false, {"user":"      [Symbol(kCapture)]: false,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kCapture)]: false,"}}
[info] >        [Symbol(kHeaders)]: [Object], {"user":"      [Symbol(kHeaders)]: [Object],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeaders)]: [Object],"}}
[info] >        [Symbol(kHeadersCount)]: 18, {"user":"      [Symbol(kHeadersCount)]: 18,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kHeadersCount)]: 18,"}}
[info] >        [Symbol(kTrailers)]: null, {"user":"      [Symbol(kTrailers)]: null,","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailers)]: null,"}}
[info] >        [Symbol(kTrailersCount)]: 0 {"user":"      [Symbol(kTrailersCount)]: 0","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       [Symbol(kTrailersCount)]: 0"}}
[info] >      }, {"user":"    },","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     },"}}
[info] >      data: { {"user":"    data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     data: {"}}
[info] >        userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1', {"user":"      userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',"}}
[info] >        chatId: 'chat-1731469702971-8gzrstds3', {"user":"      chatId: 'chat-1731469702971-8gzrstds3',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       chatId: 'chat-1731469702971-8gzrstds3',"}}
[info] >        messages: [Array], {"user":"      messages: [Array],","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       messages: [Array],"}}
[info] >        timestamp: '2024-11-13T03:49:12.294Z' {"user":"      timestamp: '2024-11-13T03:49:12.294Z'","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m       timestamp: '2024-11-13T03:49:12.294Z'"}}
[info] >      } {"user":"    }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m     }"}}
[info] >    } {"user":"  }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[info] >  🔍 Extracted Data: { {"user":"🔍 Extracted Data: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m 🔍 Extracted Data: {"}}
[info] >    userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1', {"user":"  userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   userId: 'k6hl0WpTQ5fsHjYfrDRxSUjVxEr1',"}}
[info] >    chatId: 'chat-1731469702971-8gzrstds3', {"user":"  chatId: 'chat-1731469702971-8gzrstds3',","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   chatId: 'chat-1731469702971-8gzrstds3',"}}
[info] >    messagesCount: 2 {"user":"  messagesCount: 2","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m   messagesCount: 2"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T03:49:12.372Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-saveChatHistory" in 40.1805ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finished \"us-central1-saveChatHistory\" in 40.1805ms"}}
[debug] [2024-11-13T03:49:12.373Z] [worker-us-central1-saveChatHistory-2165a9ad-8465-4859-90ce-6438e4ec2022]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"[worker-us-central1-saveChatHistory-2165a9ad-8465-4859-90ce-6438e4ec2022]: IDLE"}}
[debug] [2024-11-13T03:49:12.373Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T03:49:12.373Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T03:49:12.373Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":["/notalone-de4fc/us-central1/processChat-2024-11-13T03:49:11.286Z"],"workRunningCount":1}
[info] >  ✅ Chat history saved/updated: chat-1731469702971-8gzrstds3 { totalMessageCount: 6, newMessagesAdded: 2 } {"user":"✅ Chat history saved/updated: chat-1731469702971-8gzrstds3 { totalMessageCount: 6, newMessagesAdded: 2 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-saveChatHistory"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Chat history saved/updated: chat-1731469702971-8gzrstds3 { totalMessageCount: 6, newMessagesAdded: 2 }"}}
[info] >  ✅ Chat history save result: { {"user":"✅ Chat history save result: {","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m ✅ Chat history save result: {"}}
[info] >    data: { success: true, message: 'Chat history saved', totalMessages: 6 } {"user":"  data: { success: true, message: 'Chat history saved', totalMessages: 6 }","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m   data: { success: true, message: 'Chat history saved', totalMessages: 6 }"}}
[info] >  } {"user":"}","metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"\u001b[90m> \u001b[39m }"}}
[debug] [2024-11-13T03:49:12.376Z] Finishing up request with event=pause {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=pause"}}
[info] i  functions: Finished "us-central1-processChat" in 1087.1812ms {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finished \"us-central1-processChat\" in 1087.1812ms"}}
[debug] [2024-11-13T03:49:12.377Z] [worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"[worker-us-central1-processChat-5af733be-ad78-4393-a533-b657977c205c]: IDLE"}}
[debug] [2024-11-13T03:49:12.377Z] Finishing up request with event=finish {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=finish"}}
[debug] [2024-11-13T03:49:12.377Z] Finishing up request with event=close {"metadata":{"emulator":{"name":"functions"},"function":{"name":"us-central1-processChat"},"extension":{},"message":"Finishing up request with event=close"}}
[debug] [2024-11-13T03:49:12.377Z] [work-queue] {"queuedWork":[],"queueLength":0,"runningWork":[],"workRunningCount":0}
